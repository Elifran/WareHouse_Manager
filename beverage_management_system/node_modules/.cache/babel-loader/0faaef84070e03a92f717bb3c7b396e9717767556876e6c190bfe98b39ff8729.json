{"ast":null,"code":"var _jsxFileName = \"/home/el-ifran/WareHouse_Manager/beverage_management_system/src/pages/Inventory.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport api from '../services/api';\nimport Table from '../components/Table';\nimport Button from '../components/Button';\nimport PrintButton from '../components/PrintButton';\nimport './Inventory.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Inventory = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [products, setProducts] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [taxClasses, setTaxClasses] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [editingProduct, setEditingProduct] = useState(null);\n  const [filters, setFilters] = useState({\n    category: '',\n    stockStatus: '',\n    search: ''\n  });\n  useEffect(() => {\n    fetchProducts();\n    fetchCategories();\n    fetchTaxClasses();\n  }, []);\n  const fetchProducts = async (filterParams = {}) => {\n    try {\n      setLoading(true);\n      const params = new URLSearchParams();\n\n      // Add filters to params\n      if (filterParams.category) params.append('category', filterParams.category);\n      if (filterParams.search) params.append('search', filterParams.search);\n      if (filterParams.is_active !== undefined) params.append('is_active', filterParams.is_active);\n      if (filterParams.stock_quantity !== undefined) params.append('stock_quantity', filterParams.stock_quantity);\n      const url = `/products/${params.toString() ? '?' + params.toString() : ''}`;\n      const response = await api.get(url);\n      let products = response.data.results || response.data;\n\n      // Handle low stock filter on frontend since it's a calculated field\n      if (filterParams.stockStatus === 'low') {\n        products = products.filter(product => product.is_low_stock);\n      }\n      setProducts(products);\n    } catch (err) {\n      setError('Failed to load products');\n      console.error('Products error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const fetchCategories = async () => {\n    try {\n      const response = await api.get('/products/categories/');\n      setCategories(response.data.results || response.data);\n    } catch (err) {\n      console.error('Categories error:', err);\n    }\n  };\n  const fetchTaxClasses = async () => {\n    try {\n      const response = await api.get('/products/tax-classes/');\n      setTaxClasses(response.data.results || response.data);\n    } catch (err) {\n      console.error('Tax classes error:', err);\n    }\n  };\n  const handleAddProduct = () => {\n    setEditingProduct(null);\n    setShowAddModal(true);\n  };\n  const handleEditProduct = async product => {\n    try {\n      // Fetch full product details including cost_price and category ID\n      const response = await api.get(`/products/${product.id}/`);\n      setEditingProduct(response.data);\n      setShowAddModal(true);\n    } catch (err) {\n      setError('Failed to load product details');\n      console.error('Product details error:', err);\n    }\n  };\n  const handleDeleteProduct = async product => {\n    if (window.confirm(`Are you sure you want to delete ${product.name}?`)) {\n      try {\n        await api.delete(`/products/${product.id}/`);\n        fetchProducts(filters);\n      } catch (err) {\n        setError('Failed to delete product');\n        console.error('Delete error:', err);\n      }\n    }\n  };\n  const handleFilterChange = (filterType, value) => {\n    const newFilters = {\n      ...filters,\n      [filterType]: value\n    };\n    setFilters(newFilters);\n\n    // Convert stock status filter to API parameters\n    const apiParams = {\n      ...newFilters\n    };\n    if (newFilters.stockStatus === 'out') {\n      // For out of stock, filter by stock_quantity = 0\n      apiParams.stock_quantity = 0;\n    }\n    fetchProducts(apiParams);\n  };\n  const clearFilters = () => {\n    const clearedFilters = {\n      category: '',\n      stockStatus: '',\n      search: ''\n    };\n    setFilters(clearedFilters);\n    fetchProducts(clearedFilters);\n  };\n  const columns = [{\n    key: 'name',\n    header: 'Product Name',\n    render: (value, row) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-name\",\n        children: value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-sku\",\n        children: row.sku\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }, this)\n  }, {\n    key: 'category_name',\n    header: 'Category'\n  }, {\n    key: 'stock_quantity',\n    header: 'Stock',\n    render: (value, row) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `stock-quantity ${row.is_low_stock ? 'low-stock' : ''} ${row.is_out_of_stock ? 'out-of-stock' : ''}`,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"base-stock\",\n        children: [value, \" \", row.unit, row.is_low_stock && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stock-warning\",\n          children: \"Low\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 32\n        }, this), row.is_out_of_stock && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stock-warning\",\n          children: \"Out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 35\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 11\n      }, this), row.stock_in_units && row.stock_in_units.length > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stock-in-units\",\n        children: row.stock_in_units.filter(stockUnit => !stockUnit.is_base_unit).map(stockUnit => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"unit-stock\",\n          children: [stockUnit.quantity, \" \", stockUnit.unit_symbol]\n        }, stockUnit.unit_id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 19\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }, this)\n  }, {\n    key: 'price',\n    header: 'Price',\n    render: value => `$${parseFloat(value).toFixed(2)}`\n  }, {\n    key: 'actions',\n    header: 'Actions',\n    render: (value, row) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"action-buttons\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        size: \"small\",\n        variant: \"outline\",\n        onClick: () => handleEditProduct(row),\n        children: \"Edit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 11\n      }, this), (user === null || user === void 0 ? void 0 : user.role) === 'admin' && /*#__PURE__*/_jsxDEV(Button, {\n        size: \"small\",\n        variant: \"danger\",\n        onClick: () => handleDeleteProduct(row),\n        children: \"Delete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 9\n    }, this)\n  }];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"inventory\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inventory-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Inventory Management\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-actions\",\n        children: [/*#__PURE__*/_jsxDEV(PrintButton, {\n          data: {\n            ...products,\n            user_name: (user === null || user === void 0 ? void 0 : user.username) || 'Unknown User',\n            user_id: (user === null || user === void 0 ? void 0 : user.id) || 'unknown',\n            print_timestamp: new Date().toISOString(),\n            print_id: `PRINT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\n          },\n          title: \"Inventory Report\",\n          type: \"inventory\",\n          printText: \"Print Inventory\",\n          className: \"print-inventory-btn\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleAddProduct,\n          children: \"Add Product\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inventory-filters\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"filter-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Category:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: filters.category,\n          onChange: e => handleFilterChange('category', e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"All Categories\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this), categories.map(category => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: category.id,\n            children: category.name\n          }, category.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"filter-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Stock Status:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: filters.stockStatus,\n          onChange: e => handleFilterChange('stockStatus', e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"low\",\n            children: \"Low Stock\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"out\",\n            children: \"Out of Stock\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"filter-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Search:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Search products...\",\n          value: filters.search,\n          onChange: e => handleFilterChange('search', e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"filter-group\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          size: \"small\",\n          onClick: clearFilters,\n          children: \"Clear Filters\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      data: products,\n      columns: columns,\n      loading: loading,\n      emptyMessage: \"No products found\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 7\n    }, this), showAddModal && /*#__PURE__*/_jsxDEV(ProductModal, {\n      product: editingProduct,\n      categories: categories,\n      taxClasses: taxClasses,\n      onClose: () => setShowAddModal(false),\n      onSave: () => {\n        setShowAddModal(false);\n        fetchProducts(filters);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 201,\n    columnNumber: 5\n  }, this);\n};\n_s(Inventory, \"ITBJtwR7biPNbGWe3ohvj4C6obc=\", false, function () {\n  return [useAuth];\n});\n_c = Inventory;\nconst ProductModal = ({\n  product,\n  categories,\n  taxClasses,\n  onClose,\n  onSave\n}) => {\n  _s2();\n  var _product$base_unit, _product$is_active;\n  const [formData, setFormData] = useState({\n    name: (product === null || product === void 0 ? void 0 : product.name) || '',\n    description: (product === null || product === void 0 ? void 0 : product.description) || '',\n    category: (product === null || product === void 0 ? void 0 : product.category) || '',\n    tax_class: (product === null || product === void 0 ? void 0 : product.tax_class) || '',\n    sku: (product === null || product === void 0 ? void 0 : product.sku) || '',\n    price: (product === null || product === void 0 ? void 0 : product.price) || '',\n    cost_price: (product === null || product === void 0 ? void 0 : product.cost_price) || '',\n    stock_quantity: (product === null || product === void 0 ? void 0 : product.stock_quantity) || 0,\n    min_stock_level: (product === null || product === void 0 ? void 0 : product.min_stock_level) || 10,\n    max_stock_level: (product === null || product === void 0 ? void 0 : product.max_stock_level) || 1000,\n    base_unit: (product === null || product === void 0 ? void 0 : (_product$base_unit = product.base_unit) === null || _product$base_unit === void 0 ? void 0 : _product$base_unit.id) || (product === null || product === void 0 ? void 0 : product.base_unit) || '',\n    is_active: (_product$is_active = product === null || product === void 0 ? void 0 : product.is_active) !== null && _product$is_active !== void 0 ? _product$is_active : true\n  });\n  const [units, setUnits] = useState([]);\n  const [allUnits, setAllUnits] = useState([]);\n  const [compatibleUnits, setCompatibleUnits] = useState([]);\n  const [showUnitSelector, setShowUnitSelector] = useState(false);\n  const [convertibleUnits, setConvertibleUnits] = useState([]);\n  const [selectedDisplayUnit, setSelectedDisplayUnit] = useState(null);\n  const [unitConversions, setUnitConversions] = useState([]);\n  const [baseValues, setBaseValues] = useState(null); // Store original base unit values\n\n  // Function to get conversion factor between units\n  const getConversionFactor = useCallback((fromUnitId, toUnitId) => {\n    if (fromUnitId === toUnitId) return 1;\n\n    // Look for direct conversion\n    let conversion = unitConversions.find(conv => conv.from_unit === fromUnitId && conv.to_unit === toUnitId);\n    if (conversion) {\n      console.log('Found direct conversion:', conversion);\n      return conversion.conversion_factor;\n    }\n\n    // Look for reverse conversion\n    conversion = unitConversions.find(conv => conv.from_unit === toUnitId && conv.to_unit === fromUnitId);\n    if (conversion) {\n      console.log('Found reverse conversion:', conversion);\n      return 1 / conversion.conversion_factor;\n    }\n    console.log('No conversion found between', fromUnitId, 'and', toUnitId);\n    console.log('Available conversions:', unitConversions.map(c => `${c.from_unit}->${c.to_unit}: ${c.conversion_factor}`));\n    return null;\n  }, [unitConversions]);\n\n  // Function to convert quantity from base unit to display unit\n  const convertQuantity = useCallback((baseQuantity, baseUnitId, displayUnitId) => {\n    const factor = getConversionFactor(baseUnitId, displayUnitId);\n    return factor ? baseQuantity / factor : baseQuantity;\n  }, [getConversionFactor]);\n\n  // Function to convert price from base unit to display unit\n  const convertPrice = useCallback((basePrice, baseUnitId, displayUnitId) => {\n    const factor = getConversionFactor(baseUnitId, displayUnitId);\n    return factor ? basePrice * factor : basePrice;\n  }, [getConversionFactor]);\n\n  // Load base units when component mounts (for product creation/editing)\n  useEffect(() => {\n    const fetchUnits = async () => {\n      try {\n        console.log('=== FETCHING UNITS ===');\n\n        // Fetch base units\n        const baseUnitsResponse = await api.get('/products/base-units/');\n        console.log('Base units response:', baseUnitsResponse.data);\n        const baseUnits = baseUnitsResponse.data.results || baseUnitsResponse.data;\n        setUnits(baseUnits);\n        console.log('Setting base units:', baseUnits);\n\n        // Fetch ALL units with pagination\n        let allUnitsData = [];\n        let nextUrl = '/products/units/';\n        while (nextUrl) {\n          const response = await api.get(nextUrl);\n          const data = response.data;\n          allUnitsData = allUnitsData.concat(data.results || data);\n          nextUrl = data.next;\n          console.log('Fetched page, total units so far:', allUnitsData.length);\n        }\n        console.log('All units fetched:', allUnitsData);\n        setAllUnits(allUnitsData);\n\n        // Handle pagination for conversions\n        let allConversions = [];\n        nextUrl = '/products/unit-conversions/';\n        while (nextUrl) {\n          const response = await api.get(nextUrl);\n          const data = response.data;\n          allConversions = allConversions.concat(data.results || data);\n          nextUrl = data.next;\n        }\n        console.log('Setting unit conversions:', allConversions);\n        setUnitConversions(allConversions);\n        console.log('=== UNITS LOADED ===');\n      } catch (err) {\n        console.error('Failed to load units:', err);\n      }\n    };\n    fetchUnits();\n  }, []);\n\n  // Load compatible units when editing a product\n  useEffect(() => {\n    if (product && product.compatible_units) {\n      setCompatibleUnits(product.compatible_units);\n\n      // Store the original base values\n      setBaseValues({\n        price: parseFloat(product.price || 0),\n        cost_price: parseFloat(product.cost_price || 0),\n        stock_quantity: parseFloat(product.stock_quantity || 0),\n        min_stock_level: parseFloat(product.min_stock_level || 0),\n        max_stock_level: parseFloat(product.max_stock_level || 0)\n      });\n    } else {\n      setCompatibleUnits([]);\n      setBaseValues(null);\n    }\n  }, [product]);\n\n  // Set default display unit when base unit changes or product loads\n  useEffect(() => {\n    if (formData.base_unit && allUnits.length > 0 && compatibleUnits.length > 0) {\n      // Find the default compatible unit\n      const defaultCompatibleUnit = compatibleUnits.find(cu => cu.is_default);\n      let displayUnit;\n      if (defaultCompatibleUnit) {\n        // Use the default compatible unit\n        displayUnit = allUnits.find(unit => unit.id === defaultCompatibleUnit.unit);\n        console.log('Setting display unit to default compatible unit:', displayUnit);\n      } else {\n        // Fallback to base unit\n        displayUnit = allUnits.find(unit => unit.id === parseInt(formData.base_unit));\n        console.log('Setting display unit to base unit:', displayUnit);\n      }\n      if (displayUnit) {\n        setSelectedDisplayUnit(displayUnit);\n\n        // Convert values if not using base unit\n        if (baseValues && displayUnit.id !== parseInt(formData.base_unit)) {\n          const baseUnitId = parseInt(formData.base_unit);\n          const displayUnitId = displayUnit.id;\n\n          // Convert quantities and prices from base values\n          const convertedStock = convertQuantity(baseValues.stock_quantity, baseUnitId, displayUnitId);\n          const convertedMinStock = convertQuantity(baseValues.min_stock_level, baseUnitId, displayUnitId);\n          const convertedMaxStock = convertQuantity(baseValues.max_stock_level, baseUnitId, displayUnitId);\n          const convertedPrice = convertPrice(baseValues.price, baseUnitId, displayUnitId);\n          const convertedCostPrice = convertPrice(baseValues.cost_price, baseUnitId, displayUnitId);\n\n          // Update form data with converted values\n          setFormData(prev => ({\n            ...prev,\n            stock_quantity: convertedStock.toFixed(2),\n            min_stock_level: convertedMinStock.toFixed(2),\n            max_stock_level: convertedMaxStock.toFixed(2),\n            price: convertedPrice.toFixed(2),\n            cost_price: convertedCostPrice.toFixed(2)\n          }));\n        }\n      }\n    }\n  }, [formData.base_unit, allUnits, compatibleUnits, baseValues, convertPrice, convertQuantity]);\n\n  // Debug: Monitor formData changes\n  useEffect(() => {\n    console.log('FormData changed:', formData);\n  }, [formData]);\n\n  // Debug: Monitor allUnits changes\n  useEffect(() => {\n    console.log('AllUnits changed:', allUnits);\n  }, [allUnits]);\n\n  // Debug: Monitor units changes\n  useEffect(() => {\n    console.log('Units changed:', units);\n  }, [units]);\n\n  // Fetch convertible units when base unit changes\n  useEffect(() => {\n    const fetchConvertibleUnits = async () => {\n      if (formData.base_unit) {\n        try {\n          // Use a unified approach for both new and existing products\n          // Get all unit conversions and find units that can be converted to/from the base unit\n          // Handle pagination to get all conversions\n          let allConversions = [];\n          let nextUrl = '/products/unit-conversions/';\n          while (nextUrl) {\n            const response = await api.get(nextUrl);\n            const data = response.data;\n            allConversions = allConversions.concat(data.results || data);\n            nextUrl = data.next; // Next page URL\n          }\n          const conversions = allConversions;\n          const baseUnitId = parseInt(formData.base_unit);\n          const convertible = [];\n\n          // Find units that have conversions with the base unit\n          conversions.forEach(conversion => {\n            if (conversion.from_unit === baseUnitId && !convertible.find(u => u.id === conversion.to_unit)) {\n              // Find the unit details\n              const unit = allUnits.find(u => u.id === conversion.to_unit);\n              if (unit) {\n                convertible.push({\n                  id: unit.id,\n                  name: unit.name,\n                  symbol: unit.symbol,\n                  is_base_unit: unit.is_base_unit\n                });\n              }\n            } else if (conversion.to_unit === baseUnitId && !convertible.find(u => u.id === conversion.from_unit)) {\n              // Find the unit details\n              const unit = allUnits.find(u => u.id === conversion.from_unit);\n              if (unit) {\n                convertible.push({\n                  id: unit.id,\n                  name: unit.name,\n                  symbol: unit.symbol,\n                  is_base_unit: unit.is_base_unit\n                });\n              }\n            }\n          });\n          setConvertibleUnits(convertible);\n        } catch (err) {\n          console.error('Failed to fetch convertible units:', err);\n          setConvertibleUnits([]);\n        }\n      } else {\n        setConvertibleUnits([]);\n      }\n    };\n    fetchConvertibleUnits();\n  }, [formData.base_unit, allUnits]);\n\n  // Update form data when product changes (for editing)\n  useEffect(() => {\n    if (product) {\n      var _product$base_unit2, _product$is_active2;\n      setFormData({\n        name: product.name || '',\n        description: product.description || '',\n        category: product.category || '',\n        tax_class: product.tax_class || '',\n        sku: product.sku || '',\n        price: product.price || '',\n        cost_price: product.cost_price || '',\n        stock_quantity: product.stock_quantity || 0,\n        min_stock_level: product.min_stock_level || 10,\n        max_stock_level: product.max_stock_level || 1000,\n        base_unit: ((_product$base_unit2 = product.base_unit) === null || _product$base_unit2 === void 0 ? void 0 : _product$base_unit2.id) || product.base_unit || '',\n        is_active: (_product$is_active2 = product.is_active) !== null && _product$is_active2 !== void 0 ? _product$is_active2 : true\n      });\n    }\n  }, [product]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  // Function to convert values back to base unit for saving\n  const convertToBaseUnit = (displayValue, displayUnitId, baseUnitId) => {\n    const factor = getConversionFactor(displayUnitId, baseUnitId);\n    return factor ? displayValue / factor : displayValue;\n  };\n\n  // Function to get available units for display (base unit + compatible units)\n  const getAvailableDisplayUnits = () => {\n    if (!formData.base_unit || allUnits.length === 0) {\n      console.log('No base unit or allUnits empty', {\n        hasBaseUnit: !!formData.base_unit,\n        baseUnit: formData.base_unit,\n        allUnitsLength: allUnits.length,\n        allUnits: allUnits\n      });\n      return [];\n    }\n    const baseUnit = allUnits.find(unit => unit.id === parseInt(formData.base_unit));\n    if (!baseUnit) {\n      console.log('Base unit not found:', formData.base_unit);\n      return [];\n    }\n    console.log('Base unit found:', baseUnit);\n    console.log('Compatible units:', compatibleUnits);\n    console.log('Unit conversions:', unitConversions.length);\n    const availableUnits = [baseUnit]; // Base unit is always first\n\n    // Add compatible units that have conversions\n    compatibleUnits.forEach(cu => {\n      const unit = allUnits.find(u => u.id === cu.unit);\n      if (unit && unit.id !== baseUnit.id) {\n        // Don't add base unit again\n        // Check if there's a conversion between base unit and this unit\n        const hasConversion = unitConversions.some(conv => conv.from_unit === baseUnit.id && conv.to_unit === unit.id || conv.to_unit === baseUnit.id && conv.from_unit === unit.id);\n        if (hasConversion) {\n          availableUnits.push(unit);\n          console.log('Added compatible unit:', unit);\n        } else {\n          console.log('No conversion found for unit:', unit);\n        }\n      }\n    });\n    console.log('Available display units:', availableUnits);\n    return availableUnits;\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value,\n      type,\n      checked\n    } = e.target;\n    setFormData({\n      ...formData,\n      [name]: type === 'checkbox' ? checked : value\n    });\n  };\n  const handleDisplayUnitChange = unitId => {\n    const unit = allUnits.find(u => u.id === parseInt(unitId));\n    setSelectedDisplayUnit(unit);\n    console.log('=== DISPLAY UNIT CHANGE ===');\n    console.log('Selected unit:', unit);\n    console.log('Current formData:', formData);\n\n    // Update form data to show converted values\n    if (unit && formData.base_unit && baseValues) {\n      const baseUnitId = parseInt(formData.base_unit);\n      const displayUnitId = unit.id;\n      console.log('Converting from base unit', baseUnitId, 'to display unit', displayUnitId);\n      console.log('Base values:', baseValues);\n\n      // Convert quantities from base values\n      const convertedStock = convertQuantity(baseValues.stock_quantity, baseUnitId, displayUnitId);\n      const convertedMinStock = convertQuantity(baseValues.min_stock_level, baseUnitId, displayUnitId);\n      const convertedMaxStock = convertQuantity(baseValues.max_stock_level, baseUnitId, displayUnitId);\n\n      // Convert prices from base values\n      const convertedPrice = convertPrice(baseValues.price, baseUnitId, displayUnitId);\n      const convertedCostPrice = convertPrice(baseValues.cost_price, baseUnitId, displayUnitId);\n      console.log('Converted values:', {\n        stock: convertedStock,\n        price: convertedPrice,\n        minStock: convertedMinStock,\n        maxStock: convertedMaxStock\n      });\n\n      // Update form data with converted values\n      const newFormData = {\n        ...formData,\n        stock_quantity: convertedStock.toFixed(2),\n        min_stock_level: convertedMinStock.toFixed(2),\n        max_stock_level: convertedMaxStock.toFixed(2),\n        price: convertedPrice.toFixed(2),\n        cost_price: convertedCostPrice.toFixed(2)\n      };\n      console.log('New formData:', newFormData);\n      setFormData(newFormData);\n      console.log('=== END DISPLAY UNIT CHANGE ===');\n    }\n  };\n  const addCompatibleUnit = async unitId => {\n    if (!product) return;\n\n    // Check if the unit is already the base unit\n    if (parseInt(unitId) === parseInt(formData.base_unit)) {\n      alert('Cannot add the base unit as a compatible unit.');\n      return;\n    }\n\n    // Check if the unit is already added\n    const alreadyAdded = compatibleUnits.some(cu => cu.unit === parseInt(unitId));\n    if (alreadyAdded) {\n      alert('This unit is already added as a compatible unit.');\n      return;\n    }\n    try {\n      const response = await api.post(`/products/${product.id}/units/`, {\n        unit: parseInt(unitId),\n        is_default: false,\n        is_active: true\n      });\n      setCompatibleUnits([...compatibleUnits, response.data]);\n      setShowUnitSelector(false);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Failed to add compatible unit:', err);\n      alert(`Failed to add compatible unit: ${((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || err.message}`);\n    }\n  };\n  const removeCompatibleUnit = async productUnitId => {\n    if (!product) return;\n    try {\n      await api.delete(`/products/${product.id}/units/${productUnitId}/`);\n      setCompatibleUnits(compatibleUnits.filter(cu => cu.id !== productUnitId));\n    } catch (err) {\n      console.error('Failed to remove compatible unit:', err);\n    }\n  };\n  const setDefaultUnit = async productUnitId => {\n    if (!product) return;\n    try {\n      // First, set all units to non-default\n      for (const cu of compatibleUnits) {\n        if (cu.is_default) {\n          await api.put(`/products/${product.id}/units/${cu.id}/`, {\n            ...cu,\n            is_default: false\n          });\n        }\n      }\n\n      // Then set the selected unit as default\n      const unitToUpdate = compatibleUnits.find(cu => cu.id === productUnitId);\n      if (unitToUpdate) {\n        await api.put(`/products/${product.id}/units/${productUnitId}/`, {\n          ...unitToUpdate,\n          is_default: true\n        });\n\n        // Update local state\n        setCompatibleUnits(compatibleUnits.map(cu => ({\n          ...cu,\n          is_default: cu.id === productUnitId\n        })));\n\n        // Auto-change display unit to the new default unit\n        const newDefaultUnit = compatibleUnits.find(cu => cu.id === productUnitId);\n        if (newDefaultUnit && allUnits.length > 0) {\n          const displayUnit = allUnits.find(u => u.id === newDefaultUnit.unit);\n          if (displayUnit) {\n            console.log('Auto-changing display unit to new default:', displayUnit);\n            setSelectedDisplayUnit(displayUnit);\n\n            // Also update the form data to show converted values\n            const baseUnitId = parseInt(formData.base_unit);\n            const displayUnitId = displayUnit.id;\n\n            // Use base values instead of current form values to avoid accumulation\n            if (baseValues) {\n              // Convert quantities and prices from base values\n              const convertedStock = convertQuantity(baseValues.stock_quantity, baseUnitId, displayUnitId);\n              const convertedMinStock = convertQuantity(baseValues.min_stock_level, baseUnitId, displayUnitId);\n              const convertedMaxStock = convertQuantity(baseValues.max_stock_level, baseUnitId, displayUnitId);\n              const convertedPrice = convertPrice(baseValues.price, baseUnitId, displayUnitId);\n              const convertedCostPrice = convertPrice(baseValues.cost_price, baseUnitId, displayUnitId);\n\n              // Update form data with converted values\n              setFormData(prev => ({\n                ...prev,\n                stock_quantity: convertedStock.toFixed(2),\n                min_stock_level: convertedMinStock.toFixed(2),\n                max_stock_level: convertedMaxStock.toFixed(2),\n                price: convertedPrice.toFixed(2),\n                cost_price: convertedCostPrice.toFixed(2)\n              }));\n            }\n          }\n        }\n      }\n    } catch (err) {\n      console.error('Failed to set default unit:', err);\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    try {\n      // Convert values back to base unit if a display unit is selected\n      let finalFormData = {\n        ...formData\n      };\n      if (selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit)) {\n        const baseUnitId = parseInt(formData.base_unit);\n        const displayUnitId = selectedDisplayUnit.id;\n\n        // Convert back to base unit\n        finalFormData = {\n          ...formData,\n          stock_quantity: convertToBaseUnit(parseFloat(formData.stock_quantity || 0), displayUnitId, baseUnitId).toString(),\n          min_stock_level: convertToBaseUnit(parseFloat(formData.min_stock_level || 0), displayUnitId, baseUnitId).toString(),\n          max_stock_level: convertToBaseUnit(parseFloat(formData.max_stock_level || 0), displayUnitId, baseUnitId).toString(),\n          price: convertToBaseUnit(parseFloat(formData.price || 0), displayUnitId, baseUnitId).toString(),\n          cost_price: convertToBaseUnit(parseFloat(formData.cost_price || 0), displayUnitId, baseUnitId).toString()\n        };\n      }\n\n      // Prepare data for submission\n      const submitData = {\n        ...finalFormData,\n        base_unit: finalFormData.base_unit ? parseInt(finalFormData.base_unit) : null\n      };\n      if (product) {\n        await api.put(`/products/${product.id}/`, submitData);\n      } else {\n        await api.post('/products/', submitData);\n      }\n      onSave();\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.detail) || 'Failed to save product');\n      console.error('Save error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal-overlay\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: product ? 'Edit Product' : 'Add Product'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 919,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"modal-close\",\n          onClick: onClose,\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 920,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 918,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"modal-form\",\n        children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 925,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Product Name *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 932,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"name\",\n              value: formData.name,\n              onChange: handleChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 933,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 931,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"SKU *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 942,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"sku\",\n              value: formData.sku,\n              onChange: handleChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 943,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 941,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 930,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Description\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 954,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            name: \"description\",\n            value: formData.description,\n            onChange: handleChange,\n            rows: \"3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 955,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 953,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Category *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 965,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              name: \"category\",\n              value: formData.category,\n              onChange: handleChange,\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Select Category\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 972,\n                columnNumber: 17\n              }, this), categories.map(category => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: category.id,\n                children: category.name\n              }, category.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 974,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 966,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 964,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Tax Class\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 981,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              name: \"tax_class\",\n              value: formData.tax_class,\n              onChange: handleChange,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"No Tax Class\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 987,\n                columnNumber: 17\n              }, this), taxClasses.map(taxClass => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: taxClass.id,\n                children: [taxClass.name, \" (\", taxClass.tax_rate, \"%)\"]\n              }, taxClass.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 989,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 982,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 980,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 963,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Base Unit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 999,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              name: \"base_unit\",\n              value: formData.base_unit,\n              onChange: handleChange,\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Select Base Unit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1006,\n                columnNumber: 17\n              }, this), units.map(unit => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: unit.id,\n                children: [unit.name, \" (\", unit.symbol, \")\"]\n              }, unit.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1008,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1000,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 998,\n            columnNumber: 13\n          }, this), formData.base_unit && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Display Unit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1018,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: (selectedDisplayUnit === null || selectedDisplayUnit === void 0 ? void 0 : selectedDisplayUnit.id) || '',\n              onChange: e => handleDisplayUnitChange(e.target.value),\n              children: getAvailableDisplayUnits().map(unit => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: unit.id,\n                children: [unit.name, \" (\", unit.symbol, \")\"]\n              }, unit.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1024,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1019,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"form-help\",\n              children: \"Select a unit to view quantities and prices in that unit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1029,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1017,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 11\n        }, this), product && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Compatible Units\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1040,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"compatible-units-note\",\n              children: \"Only units that can be converted to/from the base unit can be added as compatible units.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1041,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"compatible-units-section\",\n              children: [compatibleUnits.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"compatible-units-list\",\n                children: compatibleUnits.map(compatibleUnit => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"compatible-unit-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"unit-info\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"unit-name\",\n                      children: [compatibleUnit.unit_name, \" (\", compatibleUnit.unit_symbol, \")\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1050,\n                      columnNumber: 29\n                    }, this), compatibleUnit.is_default && /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"default-badge\",\n                      children: \"Default\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1054,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1049,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"unit-actions\",\n                    children: [!compatibleUnit.is_default && /*#__PURE__*/_jsxDEV(Button, {\n                      size: \"small\",\n                      variant: \"outline\",\n                      onClick: () => setDefaultUnit(compatibleUnit.id),\n                      children: \"Set Default\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1059,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      size: \"small\",\n                      variant: \"danger\",\n                      onClick: () => removeCompatibleUnit(compatibleUnit.id),\n                      children: \"Remove\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1067,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1057,\n                    columnNumber: 27\n                  }, this)]\n                }, compatibleUnit.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1048,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1046,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"no-units-message\",\n                children: \"No compatible units added yet.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1079,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                type: \"button\",\n                variant: \"outline\",\n                onClick: () => setShowUnitSelector(true),\n                className: \"add-unit-button\",\n                disabled: !formData.base_unit || convertibleUnits.filter(unit => {\n                  const isAlreadyAdded = compatibleUnits.some(cu => cu.unit === unit.id);\n                  const isBaseUnit = unit.id === parseInt(formData.base_unit);\n                  return !isAlreadyAdded && !isBaseUnit;\n                }).length === 0,\n                children: [\"+ Add Compatible Unit\", !formData.base_unit && \" (Select base unit first)\", formData.base_unit && convertibleUnits.filter(unit => {\n                  const isAlreadyAdded = compatibleUnits.some(cu => cu.unit === unit.id);\n                  const isBaseUnit = unit.id === parseInt(formData.base_unit);\n                  return !isAlreadyAdded && !isBaseUnit;\n                }).length === 0 && \" (No convertible units)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1082,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1044,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1039,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1038,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: [\"Price * \", selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(per ${selectedDisplayUnit.name})`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1108,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              step: \"0.01\",\n              name: \"price\",\n              value: formData.price,\n              onChange: handleChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1109,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1107,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: [\"Cost Price \", selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(per ${selectedDisplayUnit.name})`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1119,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              step: \"0.01\",\n              name: \"cost_price\",\n              value: formData.cost_price,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1120,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1118,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1106,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: [\"Stock Quantity \", selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(${selectedDisplayUnit.name})`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1132,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              name: \"stock_quantity\",\n              value: formData.stock_quantity,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1133,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1131,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: [\"Min Stock Level \", selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(${selectedDisplayUnit.name})`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1141,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              name: \"min_stock_level\",\n              value: formData.min_stock_level,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1142,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1140,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Max Stock Level \", selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(${selectedDisplayUnit.name})`]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1152,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            name: \"max_stock_level\",\n            value: formData.max_stock_level,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1153,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1151,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              name: \"is_active\",\n              checked: formData.is_active,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1163,\n              columnNumber: 15\n            }, this), \"Active\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1162,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1161,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            type: \"button\",\n            variant: \"outline\",\n            onClick: onClose,\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1174,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            loading: loading,\n            children: product ? 'Update' : 'Create'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1177,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1173,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 923,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 917,\n      columnNumber: 7\n    }, this), showUnitSelector && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content unit-selector-modal\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Add Compatible Unit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1189,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"modal-close\",\n            onClick: () => setShowUnitSelector(false),\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1190,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1188,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Select a unit to add as compatible for this product:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1198,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"unit-selector-note\",\n            children: \"Only units that can be converted to/from the base unit are shown.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1199,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"unit-selector-list\",\n            children: [convertibleUnits.filter(unit => {\n              const isAlreadyAdded = compatibleUnits.some(cu => cu.unit === unit.id);\n              const isBaseUnit = unit.id === parseInt(formData.base_unit);\n              return !isAlreadyAdded && !isBaseUnit;\n            }).map(unit => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"unit-selector-item\",\n              onClick: () => addCompatibleUnit(unit.id),\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"unit-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"unit-name\",\n                  children: unit.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1216,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"unit-symbol\",\n                  children: [\"(\", unit.symbol, \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1217,\n                  columnNumber: 25\n                }, this), unit.is_base_unit && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"base-unit-badge\",\n                  children: \"Base Unit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1219,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1215,\n                columnNumber: 23\n              }, this)\n            }, unit.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1210,\n              columnNumber: 21\n            }, this)), convertibleUnits.filter(unit => !compatibleUnits.some(cu => cu.unit === unit.id) && unit.id !== parseInt(formData.base_unit)).length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"no-units-available\",\n              children: formData.base_unit ? \"No convertible units available for the selected base unit.\" : \"Please select a base unit first.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1228,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1202,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1197,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-actions\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"button\",\n            variant: \"outline\",\n            onClick: () => setShowUnitSelector(false),\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1238,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1237,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1187,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1186,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 916,\n    columnNumber: 5\n  }, this);\n};\n_s2(ProductModal, \"4XxUqNUdPPsAjfXPJzQAuuhfuhQ=\");\n_c2 = ProductModal;\nexport default Inventory;\nvar _c, _c2;\n$RefreshReg$(_c, \"Inventory\");\n$RefreshReg$(_c2, \"ProductModal\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useAuth","api","Table","Button","PrintButton","jsxDEV","_jsxDEV","Inventory","_s","user","products","setProducts","categories","setCategories","taxClasses","setTaxClasses","loading","setLoading","error","setError","showAddModal","setShowAddModal","editingProduct","setEditingProduct","filters","setFilters","category","stockStatus","search","fetchProducts","fetchCategories","fetchTaxClasses","filterParams","params","URLSearchParams","append","is_active","undefined","stock_quantity","url","toString","response","get","data","results","filter","product","is_low_stock","err","console","handleAddProduct","handleEditProduct","id","handleDeleteProduct","window","confirm","name","delete","handleFilterChange","filterType","value","newFilters","apiParams","clearFilters","clearedFilters","columns","key","header","render","row","children","className","fileName","_jsxFileName","lineNumber","columnNumber","sku","is_out_of_stock","unit","stock_in_units","length","stockUnit","is_base_unit","map","quantity","unit_symbol","unit_id","parseFloat","toFixed","size","variant","onClick","role","user_name","username","user_id","print_timestamp","Date","toISOString","print_id","now","Math","random","substr","title","type","printText","onChange","e","target","placeholder","emptyMessage","ProductModal","onClose","onSave","_c","_s2","_product$base_unit","_product$is_active","formData","setFormData","description","tax_class","price","cost_price","min_stock_level","max_stock_level","base_unit","units","setUnits","allUnits","setAllUnits","compatibleUnits","setCompatibleUnits","showUnitSelector","setShowUnitSelector","convertibleUnits","setConvertibleUnits","selectedDisplayUnit","setSelectedDisplayUnit","unitConversions","setUnitConversions","baseValues","setBaseValues","getConversionFactor","fromUnitId","toUnitId","conversion","find","conv","from_unit","to_unit","log","conversion_factor","c","convertQuantity","baseQuantity","baseUnitId","displayUnitId","factor","convertPrice","basePrice","fetchUnits","baseUnitsResponse","baseUnits","allUnitsData","nextUrl","concat","next","allConversions","compatible_units","defaultCompatibleUnit","cu","is_default","displayUnit","parseInt","convertedStock","convertedMinStock","convertedMaxStock","convertedPrice","convertedCostPrice","prev","fetchConvertibleUnits","conversions","convertible","forEach","u","push","symbol","_product$base_unit2","_product$is_active2","convertToBaseUnit","displayValue","getAvailableDisplayUnits","hasBaseUnit","baseUnit","allUnitsLength","availableUnits","hasConversion","some","handleChange","checked","handleDisplayUnitChange","unitId","stock","minStock","maxStock","newFormData","addCompatibleUnit","alert","alreadyAdded","post","_err$response","_err$response$data","detail","message","removeCompatibleUnit","productUnitId","setDefaultUnit","put","unitToUpdate","newDefaultUnit","handleSubmit","preventDefault","finalFormData","submitData","_err$response2","_err$response2$data","onSubmit","required","rows","taxClass","tax_rate","compatibleUnit","unit_name","disabled","isAlreadyAdded","isBaseUnit","step","_c2","$RefreshReg$"],"sources":["/home/el-ifran/WareHouse_Manager/beverage_management_system/src/pages/Inventory.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport api from '../services/api';\nimport Table from '../components/Table';\nimport Button from '../components/Button';\nimport PrintButton from '../components/PrintButton';\nimport './Inventory.css';\n\nconst Inventory = () => {\n  const { user } = useAuth();\n  const [products, setProducts] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [taxClasses, setTaxClasses] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [editingProduct, setEditingProduct] = useState(null);\n  const [filters, setFilters] = useState({\n    category: '',\n    stockStatus: '',\n    search: ''\n  });\n\n  useEffect(() => {\n    fetchProducts();\n    fetchCategories();\n    fetchTaxClasses();\n  }, []);\n\n  const fetchProducts = async (filterParams = {}) => {\n    try {\n      setLoading(true);\n      const params = new URLSearchParams();\n      \n      // Add filters to params\n      if (filterParams.category) params.append('category', filterParams.category);\n      if (filterParams.search) params.append('search', filterParams.search);\n      if (filterParams.is_active !== undefined) params.append('is_active', filterParams.is_active);\n      if (filterParams.stock_quantity !== undefined) params.append('stock_quantity', filterParams.stock_quantity);\n      \n      const url = `/products/${params.toString() ? '?' + params.toString() : ''}`;\n      const response = await api.get(url);\n      let products = response.data.results || response.data;\n      \n      // Handle low stock filter on frontend since it's a calculated field\n      if (filterParams.stockStatus === 'low') {\n        products = products.filter(product => product.is_low_stock);\n      }\n      \n      setProducts(products);\n    } catch (err) {\n      setError('Failed to load products');\n      console.error('Products error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchCategories = async () => {\n    try {\n      const response = await api.get('/products/categories/');\n      setCategories(response.data.results || response.data);\n    } catch (err) {\n      console.error('Categories error:', err);\n    }\n  };\n\n  const fetchTaxClasses = async () => {\n    try {\n      const response = await api.get('/products/tax-classes/');\n      setTaxClasses(response.data.results || response.data);\n    } catch (err) {\n      console.error('Tax classes error:', err);\n    }\n  };\n\n  const handleAddProduct = () => {\n    setEditingProduct(null);\n    setShowAddModal(true);\n  };\n\n  const handleEditProduct = async (product) => {\n    try {\n      // Fetch full product details including cost_price and category ID\n      const response = await api.get(`/products/${product.id}/`);\n      setEditingProduct(response.data);\n      setShowAddModal(true);\n    } catch (err) {\n      setError('Failed to load product details');\n      console.error('Product details error:', err);\n    }\n  };\n\n  const handleDeleteProduct = async (product) => {\n    if (window.confirm(`Are you sure you want to delete ${product.name}?`)) {\n      try {\n        await api.delete(`/products/${product.id}/`);\n        fetchProducts(filters);\n      } catch (err) {\n        setError('Failed to delete product');\n        console.error('Delete error:', err);\n      }\n    }\n  };\n\n  const handleFilterChange = (filterType, value) => {\n    const newFilters = { ...filters, [filterType]: value };\n    setFilters(newFilters);\n    \n    // Convert stock status filter to API parameters\n    const apiParams = { ...newFilters };\n    if (newFilters.stockStatus === 'out') {\n      // For out of stock, filter by stock_quantity = 0\n      apiParams.stock_quantity = 0;\n    }\n    \n    fetchProducts(apiParams);\n  };\n\n  const clearFilters = () => {\n    const clearedFilters = { category: '', stockStatus: '', search: '' };\n    setFilters(clearedFilters);\n    fetchProducts(clearedFilters);\n  };\n\n  const columns = [\n    {\n      key: 'name',\n      header: 'Product Name',\n      render: (value, row) => (\n        <div>\n          <div className=\"product-name\">{value}</div>\n          <div className=\"product-sku\">{row.sku}</div>\n        </div>\n      )\n    },\n    {\n      key: 'category_name',\n      header: 'Category'\n    },\n    {\n      key: 'stock_quantity',\n      header: 'Stock',\n      render: (value, row) => (\n        <div className={`stock-quantity ${row.is_low_stock ? 'low-stock' : ''} ${row.is_out_of_stock ? 'out-of-stock' : ''}`}>\n          {/* Base unit stock */}\n          <div className=\"base-stock\">\n          {value} {row.unit}\n          {row.is_low_stock && <span className=\"stock-warning\">Low</span>}\n          {row.is_out_of_stock && <span className=\"stock-warning\">Out</span>}\n          </div>\n          \n          {/* Stock in other units */}\n          {row.stock_in_units && row.stock_in_units.length > 1 && (\n            <div className=\"stock-in-units\">\n              {row.stock_in_units\n                .filter(stockUnit => !stockUnit.is_base_unit)\n                .map(stockUnit => (\n                  <div key={stockUnit.unit_id} className=\"unit-stock\">\n                    {stockUnit.quantity} {stockUnit.unit_symbol}\n                  </div>\n                ))\n              }\n            </div>\n          )}\n        </div>\n      )\n    },\n    {\n      key: 'price',\n      header: 'Price',\n      render: (value) => `$${parseFloat(value).toFixed(2)}`\n    },\n    {\n      key: 'actions',\n      header: 'Actions',\n      render: (value, row) => (\n        <div className=\"action-buttons\">\n          <Button\n            size=\"small\"\n            variant=\"outline\"\n            onClick={() => handleEditProduct(row)}\n          >\n            Edit\n          </Button>\n          {user?.role === 'admin' && (\n            <Button\n              size=\"small\"\n              variant=\"danger\"\n              onClick={() => handleDeleteProduct(row)}\n            >\n              Delete\n            </Button>\n          )}\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <div className=\"inventory\">\n      <div className=\"inventory-header\">\n        <h1>Inventory Management</h1>\n        <div className=\"header-actions\">\n          <PrintButton\n            data={{\n              ...products,\n              user_name: user?.username || 'Unknown User',\n              user_id: user?.id || 'unknown',\n              print_timestamp: new Date().toISOString(),\n              print_id: `PRINT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\n            }}\n            title=\"Inventory Report\"\n            type=\"inventory\"\n            printText=\"Print Inventory\"\n            className=\"print-inventory-btn\"\n          />\n        <Button onClick={handleAddProduct}>\n          Add Product\n        </Button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"error-message\">\n          {error}\n        </div>\n      )}\n\n      <div className=\"inventory-filters\">\n        <div className=\"filter-group\">\n          <label>Category:</label>\n          <select \n            value={filters.category} \n            onChange={(e) => handleFilterChange('category', e.target.value)}\n          >\n            <option value=\"\">All Categories</option>\n            {categories.map(category => (\n              <option key={category.id} value={category.id}>\n                {category.name}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div className=\"filter-group\">\n          <label>Stock Status:</label>\n          <select \n            value={filters.stockStatus} \n            onChange={(e) => handleFilterChange('stockStatus', e.target.value)}\n          >\n            <option value=\"\">All</option>\n            <option value=\"low\">Low Stock</option>\n            <option value=\"out\">Out of Stock</option>\n          </select>\n        </div>\n        <div className=\"filter-group\">\n          <label>Search:</label>\n          <input\n            type=\"text\"\n            placeholder=\"Search products...\"\n            value={filters.search}\n            onChange={(e) => handleFilterChange('search', e.target.value)}\n          />\n        </div>\n        <div className=\"filter-group\">\n          <Button variant=\"outline\" size=\"small\" onClick={clearFilters}>\n            Clear Filters\n          </Button>\n        </div>\n      </div>\n\n      <Table\n        data={products}\n        columns={columns}\n        loading={loading}\n        emptyMessage=\"No products found\"\n      />\n\n      {showAddModal && (\n        <ProductModal\n          product={editingProduct}\n          categories={categories}\n          taxClasses={taxClasses}\n          onClose={() => setShowAddModal(false)}\n          onSave={() => {\n            setShowAddModal(false);\n            fetchProducts(filters);\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\nconst ProductModal = ({ product, categories, taxClasses, onClose, onSave }) => {\n  const [formData, setFormData] = useState({\n    name: product?.name || '',\n    description: product?.description || '',\n    category: product?.category || '',\n    tax_class: product?.tax_class || '',\n    sku: product?.sku || '',\n    price: product?.price || '',\n    cost_price: product?.cost_price || '',\n    stock_quantity: product?.stock_quantity || 0,\n    min_stock_level: product?.min_stock_level || 10,\n    max_stock_level: product?.max_stock_level || 1000,\n    base_unit: product?.base_unit?.id || product?.base_unit || '',\n    is_active: product?.is_active ?? true\n  });\n  const [units, setUnits] = useState([]);\n  const [allUnits, setAllUnits] = useState([]);\n  const [compatibleUnits, setCompatibleUnits] = useState([]);\n  const [showUnitSelector, setShowUnitSelector] = useState(false);\n  const [convertibleUnits, setConvertibleUnits] = useState([]);\n  const [selectedDisplayUnit, setSelectedDisplayUnit] = useState(null);\n  const [unitConversions, setUnitConversions] = useState([]);\n  const [baseValues, setBaseValues] = useState(null); // Store original base unit values\n\n  // Function to get conversion factor between units\n  const getConversionFactor = useCallback((fromUnitId, toUnitId) => {\n    if (fromUnitId === toUnitId) return 1;\n    \n    // Look for direct conversion\n    let conversion = unitConversions.find(conv => \n      (conv.from_unit === fromUnitId && conv.to_unit === toUnitId)\n    );\n    \n    if (conversion) {\n      console.log('Found direct conversion:', conversion);\n      return conversion.conversion_factor;\n    }\n    \n    // Look for reverse conversion\n    conversion = unitConversions.find(conv => \n      (conv.from_unit === toUnitId && conv.to_unit === fromUnitId)\n    );\n    \n    if (conversion) {\n      console.log('Found reverse conversion:', conversion);\n      return 1 / conversion.conversion_factor;\n    }\n    \n    console.log('No conversion found between', fromUnitId, 'and', toUnitId);\n    console.log('Available conversions:', unitConversions.map(c => `${c.from_unit}->${c.to_unit}: ${c.conversion_factor}`));\n    return null;\n  }, [unitConversions]);\n\n  // Function to convert quantity from base unit to display unit\n  const convertQuantity = useCallback((baseQuantity, baseUnitId, displayUnitId) => {\n    const factor = getConversionFactor(baseUnitId, displayUnitId);\n    return factor ? baseQuantity / factor : baseQuantity;\n  }, [getConversionFactor]);\n\n  // Function to convert price from base unit to display unit\n  const convertPrice = useCallback((basePrice, baseUnitId, displayUnitId) => {\n    const factor = getConversionFactor(baseUnitId, displayUnitId);\n    return factor ? basePrice * factor : basePrice;\n  }, [getConversionFactor]);\n\n  // Load base units when component mounts (for product creation/editing)\n  useEffect(() => {\n    const fetchUnits = async () => {\n      try {\n        console.log('=== FETCHING UNITS ===');\n        \n        // Fetch base units\n        const baseUnitsResponse = await api.get('/products/base-units/');\n        console.log('Base units response:', baseUnitsResponse.data);\n        const baseUnits = baseUnitsResponse.data.results || baseUnitsResponse.data;\n        setUnits(baseUnits);\n        console.log('Setting base units:', baseUnits);\n        \n        // Fetch ALL units with pagination\n        let allUnitsData = [];\n        let nextUrl = '/products/units/';\n        while (nextUrl) {\n          const response = await api.get(nextUrl);\n          const data = response.data;\n          allUnitsData = allUnitsData.concat(data.results || data);\n          nextUrl = data.next;\n          console.log('Fetched page, total units so far:', allUnitsData.length);\n        }\n        \n        console.log('All units fetched:', allUnitsData);\n        setAllUnits(allUnitsData);\n        \n        // Handle pagination for conversions\n        let allConversions = [];\n        nextUrl = '/products/unit-conversions/';\n        while (nextUrl) {\n          const response = await api.get(nextUrl);\n          const data = response.data;\n          allConversions = allConversions.concat(data.results || data);\n          nextUrl = data.next;\n        }\n        console.log('Setting unit conversions:', allConversions);\n        setUnitConversions(allConversions);\n        console.log('=== UNITS LOADED ===');\n      } catch (err) {\n        console.error('Failed to load units:', err);\n      }\n    };\n    fetchUnits();\n  }, []);\n\n  // Load compatible units when editing a product\n  useEffect(() => {\n    if (product && product.compatible_units) {\n      setCompatibleUnits(product.compatible_units);\n      \n      // Store the original base values\n      setBaseValues({\n        price: parseFloat(product.price || 0),\n        cost_price: parseFloat(product.cost_price || 0),\n        stock_quantity: parseFloat(product.stock_quantity || 0),\n        min_stock_level: parseFloat(product.min_stock_level || 0),\n        max_stock_level: parseFloat(product.max_stock_level || 0)\n      });\n    } else {\n      setCompatibleUnits([]);\n      setBaseValues(null);\n    }\n  }, [product]);\n\n  // Set default display unit when base unit changes or product loads\n  useEffect(() => {\n    if (formData.base_unit && allUnits.length > 0 && compatibleUnits.length > 0) {\n      // Find the default compatible unit\n      const defaultCompatibleUnit = compatibleUnits.find(cu => cu.is_default);\n      let displayUnit;\n      \n      if (defaultCompatibleUnit) {\n        // Use the default compatible unit\n        displayUnit = allUnits.find(unit => unit.id === defaultCompatibleUnit.unit);\n        console.log('Setting display unit to default compatible unit:', displayUnit);\n      } else {\n        // Fallback to base unit\n        displayUnit = allUnits.find(unit => unit.id === parseInt(formData.base_unit));\n        console.log('Setting display unit to base unit:', displayUnit);\n      }\n      \n      if (displayUnit) {\n        setSelectedDisplayUnit(displayUnit);\n        \n        // Convert values if not using base unit\n        if (baseValues && displayUnit.id !== parseInt(formData.base_unit)) {\n          const baseUnitId = parseInt(formData.base_unit);\n          const displayUnitId = displayUnit.id;\n          \n          // Convert quantities and prices from base values\n          const convertedStock = convertQuantity(\n            baseValues.stock_quantity, \n            baseUnitId, \n            displayUnitId\n          );\n          const convertedMinStock = convertQuantity(\n            baseValues.min_stock_level, \n            baseUnitId, \n            displayUnitId\n          );\n          const convertedMaxStock = convertQuantity(\n            baseValues.max_stock_level, \n            baseUnitId, \n            displayUnitId\n          );\n          \n          const convertedPrice = convertPrice(\n            baseValues.price, \n            baseUnitId, \n            displayUnitId\n          );\n          const convertedCostPrice = convertPrice(\n            baseValues.cost_price, \n            baseUnitId, \n            displayUnitId\n          );\n          \n          // Update form data with converted values\n          setFormData(prev => ({\n            ...prev,\n            stock_quantity: convertedStock.toFixed(2),\n            min_stock_level: convertedMinStock.toFixed(2),\n            max_stock_level: convertedMaxStock.toFixed(2),\n            price: convertedPrice.toFixed(2),\n            cost_price: convertedCostPrice.toFixed(2)\n          }));\n        }\n      }\n    }\n  }, [formData.base_unit, allUnits, compatibleUnits, baseValues, convertPrice, convertQuantity]);\n\n  // Debug: Monitor formData changes\n  useEffect(() => {\n    console.log('FormData changed:', formData);\n  }, [formData]);\n\n  // Debug: Monitor allUnits changes\n  useEffect(() => {\n    console.log('AllUnits changed:', allUnits);\n  }, [allUnits]);\n\n  // Debug: Monitor units changes\n  useEffect(() => {\n    console.log('Units changed:', units);\n  }, [units]);\n\n  // Fetch convertible units when base unit changes\n  useEffect(() => {\n    const fetchConvertibleUnits = async () => {\n      if (formData.base_unit) {\n        try {\n          // Use a unified approach for both new and existing products\n          // Get all unit conversions and find units that can be converted to/from the base unit\n          // Handle pagination to get all conversions\n          let allConversions = [];\n          let nextUrl = '/products/unit-conversions/';\n          \n          while (nextUrl) {\n            const response = await api.get(nextUrl);\n            const data = response.data;\n            allConversions = allConversions.concat(data.results || data);\n            nextUrl = data.next; // Next page URL\n          }\n          \n          const conversions = allConversions;\n          \n          const baseUnitId = parseInt(formData.base_unit);\n          const convertible = [];\n          \n          // Find units that have conversions with the base unit\n          conversions.forEach(conversion => {\n            if (conversion.from_unit === baseUnitId && !convertible.find(u => u.id === conversion.to_unit)) {\n              // Find the unit details\n              const unit = allUnits.find(u => u.id === conversion.to_unit);\n              if (unit) {\n                convertible.push({\n                  id: unit.id,\n                  name: unit.name,\n                  symbol: unit.symbol,\n                  is_base_unit: unit.is_base_unit\n                });\n              }\n            } else if (conversion.to_unit === baseUnitId && !convertible.find(u => u.id === conversion.from_unit)) {\n              // Find the unit details\n              const unit = allUnits.find(u => u.id === conversion.from_unit);\n              if (unit) {\n                convertible.push({\n                  id: unit.id,\n                  name: unit.name,\n                  symbol: unit.symbol,\n                  is_base_unit: unit.is_base_unit\n                });\n              }\n            }\n          });\n          \n          setConvertibleUnits(convertible);\n        } catch (err) {\n          console.error('Failed to fetch convertible units:', err);\n          setConvertibleUnits([]);\n        }\n      } else {\n        setConvertibleUnits([]);\n      }\n    };\n\n    fetchConvertibleUnits();\n  }, [formData.base_unit, allUnits]);\n\n  // Update form data when product changes (for editing)\n  useEffect(() => {\n    if (product) {\n      setFormData({\n        name: product.name || '',\n        description: product.description || '',\n        category: product.category || '',\n        tax_class: product.tax_class || '',\n        sku: product.sku || '',\n        price: product.price || '',\n        cost_price: product.cost_price || '',\n        stock_quantity: product.stock_quantity || 0,\n        min_stock_level: product.min_stock_level || 10,\n        max_stock_level: product.max_stock_level || 1000,\n        base_unit: product.base_unit?.id || product.base_unit || '',\n        is_active: product.is_active ?? true\n      });\n    }\n  }, [product]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n\n  // Function to convert values back to base unit for saving\n  const convertToBaseUnit = (displayValue, displayUnitId, baseUnitId) => {\n    const factor = getConversionFactor(displayUnitId, baseUnitId);\n    return factor ? displayValue / factor : displayValue;\n  };\n\n  // Function to get available units for display (base unit + compatible units)\n  const getAvailableDisplayUnits = () => {\n    if (!formData.base_unit || allUnits.length === 0) {\n      console.log('No base unit or allUnits empty', {\n        hasBaseUnit: !!formData.base_unit,\n        baseUnit: formData.base_unit,\n        allUnitsLength: allUnits.length,\n        allUnits: allUnits\n      });\n      return [];\n    }\n    \n    const baseUnit = allUnits.find(unit => unit.id === parseInt(formData.base_unit));\n    if (!baseUnit) {\n      console.log('Base unit not found:', formData.base_unit);\n      return [];\n    }\n    \n    console.log('Base unit found:', baseUnit);\n    console.log('Compatible units:', compatibleUnits);\n    console.log('Unit conversions:', unitConversions.length);\n    \n    const availableUnits = [baseUnit]; // Base unit is always first\n    \n    // Add compatible units that have conversions\n    compatibleUnits.forEach(cu => {\n      const unit = allUnits.find(u => u.id === cu.unit);\n      if (unit && unit.id !== baseUnit.id) { // Don't add base unit again\n        // Check if there's a conversion between base unit and this unit\n        const hasConversion = unitConversions.some(conv => \n          (conv.from_unit === baseUnit.id && conv.to_unit === unit.id) ||\n          (conv.to_unit === baseUnit.id && conv.from_unit === unit.id)\n        );\n        if (hasConversion) {\n          availableUnits.push(unit);\n          console.log('Added compatible unit:', unit);\n        } else {\n          console.log('No conversion found for unit:', unit);\n        }\n      }\n    });\n    \n    console.log('Available display units:', availableUnits);\n    return availableUnits;\n  };\n\n  const handleChange = (e) => {\n    const { name, value, type, checked } = e.target;\n    setFormData({\n      ...formData,\n      [name]: type === 'checkbox' ? checked : value\n    });\n  };\n\n  const handleDisplayUnitChange = (unitId) => {\n    const unit = allUnits.find(u => u.id === parseInt(unitId));\n    setSelectedDisplayUnit(unit);\n    \n    console.log('=== DISPLAY UNIT CHANGE ===');\n    console.log('Selected unit:', unit);\n    console.log('Current formData:', formData);\n    \n    // Update form data to show converted values\n    if (unit && formData.base_unit && baseValues) {\n      const baseUnitId = parseInt(formData.base_unit);\n      const displayUnitId = unit.id;\n      \n      console.log('Converting from base unit', baseUnitId, 'to display unit', displayUnitId);\n      console.log('Base values:', baseValues);\n      \n      // Convert quantities from base values\n      const convertedStock = convertQuantity(\n        baseValues.stock_quantity, \n        baseUnitId, \n        displayUnitId\n      );\n      const convertedMinStock = convertQuantity(\n        baseValues.min_stock_level, \n        baseUnitId, \n        displayUnitId\n      );\n      const convertedMaxStock = convertQuantity(\n        baseValues.max_stock_level, \n        baseUnitId, \n        displayUnitId\n      );\n      \n      // Convert prices from base values\n      const convertedPrice = convertPrice(\n        baseValues.price, \n        baseUnitId, \n        displayUnitId\n      );\n      const convertedCostPrice = convertPrice(\n        baseValues.cost_price, \n        baseUnitId, \n        displayUnitId\n      );\n      \n      console.log('Converted values:', {\n        stock: convertedStock,\n        price: convertedPrice,\n        minStock: convertedMinStock,\n        maxStock: convertedMaxStock\n      });\n      \n      // Update form data with converted values\n      const newFormData = {\n        ...formData,\n        stock_quantity: convertedStock.toFixed(2),\n        min_stock_level: convertedMinStock.toFixed(2),\n        max_stock_level: convertedMaxStock.toFixed(2),\n        price: convertedPrice.toFixed(2),\n        cost_price: convertedCostPrice.toFixed(2)\n      };\n      \n      console.log('New formData:', newFormData);\n      setFormData(newFormData);\n      console.log('=== END DISPLAY UNIT CHANGE ===');\n    }\n  };\n\n  const addCompatibleUnit = async (unitId) => {\n    if (!product) return;\n    \n    // Check if the unit is already the base unit\n    if (parseInt(unitId) === parseInt(formData.base_unit)) {\n      alert('Cannot add the base unit as a compatible unit.');\n      return;\n    }\n    \n    // Check if the unit is already added\n    const alreadyAdded = compatibleUnits.some(cu => cu.unit === parseInt(unitId));\n    if (alreadyAdded) {\n      alert('This unit is already added as a compatible unit.');\n      return;\n    }\n    \n    try {\n      const response = await api.post(`/products/${product.id}/units/`, {\n        unit: parseInt(unitId),\n        is_default: false,\n        is_active: true\n      });\n      \n      setCompatibleUnits([...compatibleUnits, response.data]);\n      setShowUnitSelector(false);\n    } catch (err) {\n      console.error('Failed to add compatible unit:', err);\n      alert(`Failed to add compatible unit: ${err.response?.data?.detail || err.message}`);\n    }\n  };\n\n  const removeCompatibleUnit = async (productUnitId) => {\n    if (!product) return;\n    \n    try {\n      await api.delete(`/products/${product.id}/units/${productUnitId}/`);\n      setCompatibleUnits(compatibleUnits.filter(cu => cu.id !== productUnitId));\n    } catch (err) {\n      console.error('Failed to remove compatible unit:', err);\n    }\n  };\n\n  const setDefaultUnit = async (productUnitId) => {\n    if (!product) return;\n    \n    try {\n      // First, set all units to non-default\n      for (const cu of compatibleUnits) {\n        if (cu.is_default) {\n          await api.put(`/products/${product.id}/units/${cu.id}/`, {\n            ...cu,\n            is_default: false\n          });\n        }\n      }\n      \n      // Then set the selected unit as default\n      const unitToUpdate = compatibleUnits.find(cu => cu.id === productUnitId);\n      if (unitToUpdate) {\n        await api.put(`/products/${product.id}/units/${productUnitId}/`, {\n          ...unitToUpdate,\n          is_default: true\n        });\n        \n        // Update local state\n        setCompatibleUnits(compatibleUnits.map(cu => ({\n          ...cu,\n          is_default: cu.id === productUnitId\n        })));\n        \n        // Auto-change display unit to the new default unit\n        const newDefaultUnit = compatibleUnits.find(cu => cu.id === productUnitId);\n        if (newDefaultUnit && allUnits.length > 0) {\n          const displayUnit = allUnits.find(u => u.id === newDefaultUnit.unit);\n          if (displayUnit) {\n            console.log('Auto-changing display unit to new default:', displayUnit);\n            setSelectedDisplayUnit(displayUnit);\n            \n            // Also update the form data to show converted values\n            const baseUnitId = parseInt(formData.base_unit);\n            const displayUnitId = displayUnit.id;\n            \n            // Use base values instead of current form values to avoid accumulation\n            if (baseValues) {\n              // Convert quantities and prices from base values\n              const convertedStock = convertQuantity(\n                baseValues.stock_quantity, \n                baseUnitId, \n                displayUnitId\n              );\n              const convertedMinStock = convertQuantity(\n                baseValues.min_stock_level, \n                baseUnitId, \n                displayUnitId\n              );\n              const convertedMaxStock = convertQuantity(\n                baseValues.max_stock_level, \n                baseUnitId, \n                displayUnitId\n              );\n              \n              const convertedPrice = convertPrice(\n                baseValues.price, \n                baseUnitId, \n                displayUnitId\n              );\n              const convertedCostPrice = convertPrice(\n                baseValues.cost_price, \n                baseUnitId, \n                displayUnitId\n              );\n            \n              // Update form data with converted values\n              setFormData(prev => ({\n                ...prev,\n                stock_quantity: convertedStock.toFixed(2),\n                min_stock_level: convertedMinStock.toFixed(2),\n                max_stock_level: convertedMaxStock.toFixed(2),\n                price: convertedPrice.toFixed(2),\n                cost_price: convertedCostPrice.toFixed(2)\n              }));\n            }\n          }\n        }\n      }\n    } catch (err) {\n      console.error('Failed to set default unit:', err);\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n\n    try {\n      // Convert values back to base unit if a display unit is selected\n      let finalFormData = { ...formData };\n      \n      if (selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit)) {\n        const baseUnitId = parseInt(formData.base_unit);\n        const displayUnitId = selectedDisplayUnit.id;\n        \n        // Convert back to base unit\n        finalFormData = {\n          ...formData,\n          stock_quantity: convertToBaseUnit(\n            parseFloat(formData.stock_quantity || 0), \n            displayUnitId, \n            baseUnitId\n          ).toString(),\n          min_stock_level: convertToBaseUnit(\n            parseFloat(formData.min_stock_level || 0), \n            displayUnitId, \n            baseUnitId\n          ).toString(),\n          max_stock_level: convertToBaseUnit(\n            parseFloat(formData.max_stock_level || 0), \n            displayUnitId, \n            baseUnitId\n          ).toString(),\n          price: convertToBaseUnit(\n            parseFloat(formData.price || 0), \n            displayUnitId, \n            baseUnitId\n          ).toString(),\n          cost_price: convertToBaseUnit(\n            parseFloat(formData.cost_price || 0), \n            displayUnitId, \n            baseUnitId\n          ).toString()\n        };\n      }\n\n      // Prepare data for submission\n      const submitData = {\n        ...finalFormData,\n        base_unit: finalFormData.base_unit ? parseInt(finalFormData.base_unit) : null\n      };\n\n      if (product) {\n        await api.put(`/products/${product.id}/`, submitData);\n      } else {\n        await api.post('/products/', submitData);\n      }\n      onSave();\n    } catch (err) {\n      setError(err.response?.data?.detail || 'Failed to save product');\n      console.error('Save error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal\">\n        <div className=\"modal-header\">\n          <h2>{product ? 'Edit Product' : 'Add Product'}</h2>\n          <button className=\"modal-close\" onClick={onClose}></button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"modal-form\">\n          {error && (\n            <div className=\"error-message\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Product Name *</label>\n              <input\n                type=\"text\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                required\n              />\n            </div>\n            <div className=\"form-group\">\n              <label>SKU *</label>\n              <input\n                type=\"text\"\n                name=\"sku\"\n                value={formData.sku}\n                onChange={handleChange}\n                required\n              />\n            </div>\n          </div>\n\n          <div className=\"form-group\">\n            <label>Description</label>\n            <textarea\n              name=\"description\"\n              value={formData.description}\n              onChange={handleChange}\n              rows=\"3\"\n            />\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Category *</label>\n              <select\n                name=\"category\"\n                value={formData.category}\n                onChange={handleChange}\n                required\n              >\n                <option value=\"\">Select Category</option>\n                {categories.map(category => (\n                  <option key={category.id} value={category.id}>\n                    {category.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n            <div className=\"form-group\">\n              <label>Tax Class</label>\n              <select\n                name=\"tax_class\"\n                value={formData.tax_class}\n                onChange={handleChange}\n              >\n                <option value=\"\">No Tax Class</option>\n                {taxClasses.map(taxClass => (\n                  <option key={taxClass.id} value={taxClass.id}>\n                    {taxClass.name} ({taxClass.tax_rate}%)\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Base Unit</label>\n              <select\n                name=\"base_unit\"\n                value={formData.base_unit}\n                onChange={handleChange}\n                required\n              >\n                <option value=\"\">Select Base Unit</option>\n                {units.map(unit => (\n                  <option key={unit.id} value={unit.id}>\n                    {unit.name} ({unit.symbol})\n                  </option>\n                ))}\n              </select>\n            </div>\n            \n            {/* Display Unit Selector - TEMPORARILY ALWAYS SHOW FOR DEBUGGING */}\n            {formData.base_unit && (\n              <div className=\"form-group\">\n                <label>Display Unit</label>\n                <select\n                  value={selectedDisplayUnit?.id || ''}\n                  onChange={(e) => handleDisplayUnitChange(e.target.value)}\n                >\n                  {getAvailableDisplayUnits().map(unit => (\n                    <option key={unit.id} value={unit.id}>\n                      {unit.name} ({unit.symbol})\n                    </option>\n                  ))}\n                </select>\n                <small className=\"form-help\">\n                  Select a unit to view quantities and prices in that unit\n                </small>\n              </div>\n            )}\n          </div>\n\n          {/* Compatible Units Section - Only show when editing existing product */}\n          {product && (\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Compatible Units</label>\n                <p className=\"compatible-units-note\">\n                  Only units that can be converted to/from the base unit can be added as compatible units.\n                </p>\n                <div className=\"compatible-units-section\">\n                  {compatibleUnits.length > 0 ? (\n                    <div className=\"compatible-units-list\">\n                      {compatibleUnits.map(compatibleUnit => (\n                        <div key={compatibleUnit.id} className=\"compatible-unit-item\">\n                          <div className=\"unit-info\">\n                            <span className=\"unit-name\">\n                              {compatibleUnit.unit_name} ({compatibleUnit.unit_symbol})\n                            </span>\n                            {compatibleUnit.is_default && (\n                              <span className=\"default-badge\">Default</span>\n                            )}\n                          </div>\n                          <div className=\"unit-actions\">\n                            {!compatibleUnit.is_default && (\n                              <Button\n                                size=\"small\"\n                                variant=\"outline\"\n                                onClick={() => setDefaultUnit(compatibleUnit.id)}\n                              >\n                                Set Default\n                              </Button>\n                            )}\n                            <Button\n                              size=\"small\"\n                              variant=\"danger\"\n                              onClick={() => removeCompatibleUnit(compatibleUnit.id)}\n                            >\n                              Remove\n                            </Button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"no-units-message\">No compatible units added yet.</p>\n                  )}\n                  \n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => setShowUnitSelector(true)}\n                    className=\"add-unit-button\"\n                    disabled={!formData.base_unit || convertibleUnits.filter(unit => {\n                      const isAlreadyAdded = compatibleUnits.some(cu => cu.unit === unit.id);\n                      const isBaseUnit = unit.id === parseInt(formData.base_unit);\n                      return !isAlreadyAdded && !isBaseUnit;\n                    }).length === 0}\n                  >\n                    + Add Compatible Unit\n                    {!formData.base_unit && \" (Select base unit first)\"}\n                    {formData.base_unit && convertibleUnits.filter(unit => {\n                      const isAlreadyAdded = compatibleUnits.some(cu => cu.unit === unit.id);\n                      const isBaseUnit = unit.id === parseInt(formData.base_unit);\n                      return !isAlreadyAdded && !isBaseUnit;\n                    }).length === 0 && \" (No convertible units)\"}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Price * {selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(per ${selectedDisplayUnit.name})`}</label>\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                name=\"price\"\n                value={formData.price}\n                onChange={handleChange}\n                required\n              />\n            </div>\n            <div className=\"form-group\">\n              <label>Cost Price {selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(per ${selectedDisplayUnit.name})`}</label>\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                name=\"cost_price\"\n                value={formData.cost_price}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Stock Quantity {selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(${selectedDisplayUnit.name})`}</label>\n              <input\n                type=\"number\"\n                name=\"stock_quantity\"\n                value={formData.stock_quantity}\n                onChange={handleChange}\n              />\n            </div>\n            <div className=\"form-group\">\n              <label>Min Stock Level {selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(${selectedDisplayUnit.name})`}</label>\n              <input\n                type=\"number\"\n                name=\"min_stock_level\"\n                value={formData.min_stock_level}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n\n          <div className=\"form-group\">\n            <label>Max Stock Level {selectedDisplayUnit && selectedDisplayUnit.id !== parseInt(formData.base_unit) && `(${selectedDisplayUnit.name})`}</label>\n            <input\n              type=\"number\"\n              name=\"max_stock_level\"\n              value={formData.max_stock_level}\n              onChange={handleChange}\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label>\n              <input\n                type=\"checkbox\"\n                name=\"is_active\"\n                checked={formData.is_active}\n                onChange={handleChange}\n              />\n              Active\n            </label>\n          </div>\n\n          <div className=\"modal-actions\">\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n            <Button type=\"submit\" loading={loading}>\n              {product ? 'Update' : 'Create'}\n            </Button>\n          </div>\n        </form>\n      </div>\n\n      {/* Unit Selector Modal */}\n      {showUnitSelector && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal-content unit-selector-modal\">\n            <div className=\"modal-header\">\n              <h3>Add Compatible Unit</h3>\n              <button \n                className=\"modal-close\" \n                onClick={() => setShowUnitSelector(false)}\n              >\n                \n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <p>Select a unit to add as compatible for this product:</p>\n              <p className=\"unit-selector-note\">\n                Only units that can be converted to/from the base unit are shown.\n              </p>\n              <div className=\"unit-selector-list\">\n                {convertibleUnits\n                  .filter(unit => {\n                    const isAlreadyAdded = compatibleUnits.some(cu => cu.unit === unit.id);\n                    const isBaseUnit = unit.id === parseInt(formData.base_unit);\n                    return !isAlreadyAdded && !isBaseUnit;\n                  })\n                  .map(unit => (\n                    <div \n                      key={unit.id} \n                      className=\"unit-selector-item\"\n                      onClick={() => addCompatibleUnit(unit.id)}\n                    >\n                      <div className=\"unit-info\">\n                        <span className=\"unit-name\">{unit.name}</span>\n                        <span className=\"unit-symbol\">({unit.symbol})</span>\n                        {unit.is_base_unit && (\n                          <span className=\"base-unit-badge\">Base Unit</span>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                }\n                {convertibleUnits.filter(unit => \n                  !compatibleUnits.some(cu => cu.unit === unit.id) && unit.id !== parseInt(formData.base_unit)\n                ).length === 0 && (\n                  <p className=\"no-units-available\">\n                    {formData.base_unit \n                      ? \"No convertible units available for the selected base unit.\" \n                      : \"Please select a base unit first.\"\n                    }\n                  </p>\n                )}\n              </div>\n            </div>\n            <div className=\"modal-actions\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => setShowUnitSelector(false)}\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Inventory;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}