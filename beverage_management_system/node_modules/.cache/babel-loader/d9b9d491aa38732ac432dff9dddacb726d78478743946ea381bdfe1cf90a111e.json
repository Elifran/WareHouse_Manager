{"ast":null,"code":"import _objectSpread from\"/home/el-ifran/WareHouse_Manager/beverage_management_system/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import api from'../services/api';import Button from'../components/Button';import'./PendingSales.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PendingSales=()=>{var _selectedSale$payment,_selectedSale$items,_stockValidationStatu3,_stockValidationStatu4;const[pendingSales,setPendingSales]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[selectedSale,setSelectedSale]=useState(null);const[showSaleModal,setShowSaleModal]=useState(false);const[completingSale,setCompletingSale]=useState(null);const[stockValidationStatus,setStockValidationStatus]=useState({});useEffect(()=>{fetchPendingSales();},[]);// Validate stock for all pending sales when the list changes\nuseEffect(()=>{if(pendingSales.length>0){validateStockForAllSales();}},[pendingSales]);const fetchPendingSales=async()=>{try{setLoading(true);setError('');const response=await api.get('/sales/?status=pending');setPendingSales(response.data.results||response.data);}catch(err){setError('Failed to fetch pending sales');console.error('Pending sales fetch error:',err);}finally{setLoading(false);}};const validateStockForAllSales=async()=>{const validationStatus={};for(const sale of pendingSales){let hasInsufficientStock=false;const stockIssues=[];for(const item of sale.items||[]){try{const stockResponse=await api.get(\"/products/\".concat(item.product,\"/stock-availability/\"));const stockData=stockResponse.data;const unitStockInfo=stockData.available_units.find(unit=>unit.id===item.unit);if(unitStockInfo){const availableQuantity=parseFloat(unitStockInfo.available_quantity||0);const requiredQuantity=parseFloat(item.quantity||0);if(availableQuantity<requiredQuantity){hasInsufficientStock=true;stockIssues.push(\"\".concat(item.product_name,\": \").concat(requiredQuantity,\" \").concat(item.unit_name,\" required, \").concat(availableQuantity,\" available\"));}}}catch(err){console.error(\"Error validating stock for sale \".concat(sale.id,\":\"),err);}}validationStatus[sale.id]={hasInsufficientStock,stockIssues};}setStockValidationStatus(validationStatus);};const completeSale=async saleId=>{try{setCompletingSale(saleId);setError('');// Find the sale to validate\nconst sale=pendingSales.find(s=>s.id===saleId);if(!sale){setError('Sale not found');return;}// Check stock availability for each item\nconst stockValidationErrors=[];for(const item of sale.items||[]){try{// Get current stock availability for this product\nconst stockResponse=await api.get(\"/products/\".concat(item.product,\"/stock-availability/\"));const stockData=stockResponse.data;// Find the stock info for the unit used in this sale item\nconst unitStockInfo=stockData.available_units.find(unit=>unit.id===item.unit);if(!unitStockInfo){stockValidationErrors.push(\"\".concat(item.product_name,\": Unit not found in stock data\"));continue;}// Check if there's enough stock\nconst availableQuantity=parseFloat(unitStockInfo.available_quantity||0);const requiredQuantity=parseFloat(item.quantity||0);if(availableQuantity<requiredQuantity){stockValidationErrors.push(\"\".concat(item.product_name,\": Insufficient stock. Required: \").concat(requiredQuantity,\" \").concat(item.unit_name,\", Available: \").concat(availableQuantity,\" \").concat(item.unit_name));}}catch(stockErr){console.error(\"Error checking stock for product \".concat(item.product,\":\"),stockErr);stockValidationErrors.push(\"\".concat(item.product_name,\": Unable to check stock availability\"));}}// If there are stock validation errors, show them and prevent completion\nif(stockValidationErrors.length>0){setError(\"Cannot complete sale due to insufficient stock:\\n\\n\".concat(stockValidationErrors.join('\\n')));return;}// If stock validation passes, proceed with completion\nawait api.post(\"/sales/\".concat(saleId,\"/complete/\"));// Print receipt for the completed sale\nprintPendingSale(_objectSpread(_objectSpread({},sale),{},{status:'completed'}));// Remove the completed sale from the list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));// Close modal if it was open for this sale\nif(selectedSale&&selectedSale.id===saleId){setShowSaleModal(false);setSelectedSale(null);}alert('Sale completed successfully!');}catch(err){var _err$response,_err$response$data;setError(\"Failed to complete sale: \".concat(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message));console.error('Complete sale error:',err);}finally{setCompletingSale(null);}};const cancelSale=async saleId=>{if(!window.confirm('Are you sure you want to cancel this sale?')){return;}try{setError('');await api.patch(\"/sales/\".concat(saleId,\"/\"),{status:'cancelled'});// Remove the cancelled sale from the list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));// Close modal if it was open for this sale\nif(selectedSale&&selectedSale.id===saleId){setShowSaleModal(false);setSelectedSale(null);}alert('Sale cancelled successfully!');}catch(err){var _err$response2,_err$response2$data;setError(\"Failed to cancel sale: \".concat(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||err.message));console.error('Cancel sale error:',err);}};const viewSaleDetails=async sale=>{try{setSelectedSale(sale);setShowSaleModal(true);}catch(err){setError('Failed to load sale details');console.error('Sale details error:',err);}};const printPendingSale=sale=>{// Create print data for the pending sale\nconst printData={sale_number:sale.sale_number,customer_name:sale.customer_name||'Walk-in Customer',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',user_name:sale.user_name||'Unknown User',user_id:sale.user_id||'unknown',created_at:sale.created_at,print_timestamp:new Date().toISOString(),print_id:\"PRINT-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9)),status:'pending',total_amount:sale.total_amount,items:sale.items.map(item=>({product_name:item.product_name,product_sku:item.product_sku||'',quantity:item.quantity_display||item.quantity,unit_name:item.unit_name,unit_price:item.unit_price,total_price:item.total_price||parseFloat(item.quantity_display||item.quantity)*parseFloat(item.unit_price)}))};// Create print content\nconst printContent=\"\\n      <!DOCTYPE html>\\n      <html>\\n      <head>\\n        <title>Sale Receipt - \".concat(sale.sale_number,\"</title>\\n        <style>\\n          body { font-family: Arial, sans-serif; margin: 20px; }\\n          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }\\n          .sale-info { margin-bottom: 20px; }\\n          .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\\n          .items-table th, .items-table td { border: 1px solid #000; padding: 8px; text-align: left; }\\n          .items-table th { background-color: #f0f0f0; }\\n          .total { text-align: right; font-weight: bold; font-size: 1.2em; }\\n          .status { text-align: center; margin-top: 20px; padding: 10px; background-color: #fff3cd; border: 1px solid #ffeaa7; }\\n        </style>\\n      </head>\\n      <body>\\n        <div class=\\\"header\\\">\\n          <h1>Sale Receipt</h1>\\n          <h2>\").concat(printData.sale_number,\"</h2>\\n        </div>\\n        \\n        <div class=\\\"sale-info\\\">\\n          <p><strong>Customer:</strong> \").concat(printData.customer_name,\"</p>\\n          \").concat(printData.customer_phone?\"<p><strong>Phone:</strong> \".concat(printData.customer_phone,\"</p>\"):'',\"\\n          \").concat(printData.customer_email?\"<p><strong>Email:</strong> \".concat(printData.customer_email,\"</p>\"):'',\"\\n          <p><strong>Date:</strong> \").concat(new Date(printData.created_at).toLocaleString(),\"</p>\\n          <p><strong>Cashier:</strong> \").concat(printData.user_name,\"</p>\\n        </div>\\n        \\n        <table class=\\\"items-table\\\">\\n          <thead>\\n            <tr>\\n              <th>Product</th>\\n              <th>Unit</th>\\n              <th>Qty</th>\\n              <th>Unit Price</th>\\n              <th>Total</th>\\n            </tr>\\n          </thead>\\n          <tbody>\\n            \").concat(printData.items.map(item=>\"\\n              <tr>\\n                <td>\".concat(item.product_name,\"</td>\\n                <td>\").concat(item.unit_name,\"</td>\\n                <td>\").concat(item.quantity,\"</td>\\n                <td>\").concat(parseFloat(item.unit_price).toFixed(2),\" MGA</td>\\n                <td>\").concat(parseFloat(item.total_price).toFixed(2),\" MGA</td>\\n              </tr>\\n            \")).join(''),\"\\n          </tbody>\\n        </table>\\n        \\n        <div class=\\\"total\\\">\\n          <p><strong>Total Amount: \").concat(parseFloat(printData.total_amount).toFixed(2),\" MGA</strong></p>\\n        </div>\\n        \\n        <div class=\\\"status\\\">\\n          <p><strong>Status: \").concat(printData.status.toUpperCase(),\"</strong></p>\\n          <p>\").concat(printData.status==='pending'?'This sale is pending':'This sale has been completed',\"</p>\\n        </div>\\n        \\n        <div style=\\\"text-align: center; margin-top: 20px; font-size: 0.8em; color: #666;\\\">\\n          <p>Printed on: \").concat(new Date(printData.print_timestamp).toLocaleString(),\"</p>\\n          <p>Print ID: \").concat(printData.print_id,\"</p>\\n        </div>\\n      </body>\\n      </html>\\n    \");// Open print window\nconst printWindow=window.open('','_blank','width=800,height=600');printWindow.document.write(printContent);printWindow.document.close();// Wait for content to load then print\nprintWindow.onload=()=>{printWindow.focus();printWindow.print();// Close the window after a short delay\nsetTimeout(()=>{printWindow.close();},1000);};};const formatDate=dateString=>{return new Date(dateString).toLocaleString();};const formatCurrency=amount=>{return parseFloat(amount).toFixed(2);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Loading pending sales...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Pending Sales Validation\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Review and complete pending sales\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header-actions\",children:/*#__PURE__*/_jsx(Button,{onClick:fetchPendingSales,variant:\"outline\",children:\"Refresh\"})})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:pendingSales.length}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Pending Sales\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:formatCurrency(pendingSales.reduce((total,sale)=>total+parseFloat(sale.total_amount),0))}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total Value (MGA)\"})]})]}),pendingSales.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-pending-sales\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"no-sales-icon\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Pending Sales\"}),/*#__PURE__*/_jsx(\"p\",{children:\"All sales have been processed. Great job!\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales-list\",children:pendingSales.map(sale=>{var _sale$items,_sale$payment_method,_stockValidationStatu,_stockValidationStatu2;return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sale-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sale-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sale-number\",children:sale.sale_number}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Customer:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:sale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:formatDate(sale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Items:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[((_sale$items=sale.items)===null||_sale$items===void 0?void 0:_sale$items.length)||0,\" items\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value total-amount\",children:[formatCurrency(sale.total_amount),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Payment:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:(_sale$payment_method=sale.payment_method)===null||_sale$payment_method===void 0?void 0:_sale$payment_method.replace('_',' ').toUpperCase()})]}),stockValidationStatus[sale.id]&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-row stock-status\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Stock Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value \".concat(stockValidationStatus[sale.id].hasInsufficientStock?'stock-insufficient':'stock-sufficient'),children:stockValidationStatus[sale.id].hasInsufficientStock?'‚ö†Ô∏è Insufficient Stock':'‚úÖ Stock Available'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-actions\",children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>viewSaleDetails(sale),children:\"View Details\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>printPendingSale(sale),children:\"\\uD83D\\uDDA8\\uFE0F Print\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"primary\",onClick:()=>completeSale(sale.id),loading:completingSale===sale.id,disabled:completingSale===sale.id||((_stockValidationStatu=stockValidationStatus[sale.id])===null||_stockValidationStatu===void 0?void 0:_stockValidationStatu.hasInsufficientStock),children:(_stockValidationStatu2=stockValidationStatus[sale.id])!==null&&_stockValidationStatu2!==void 0&&_stockValidationStatu2.hasInsufficientStock?'Insufficient Stock':'Complete Sale'}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>cancelSale(sale.id),children:\"Cancel Sale\"})]})]},sale.id);})}),showSaleModal&&selectedSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal sale-details-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Sale Details - \",selectedSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sale-details-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedSale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedSale.customer_phone||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedSale.customer_email||'N/A'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sale Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:formatDate(selectedSale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Payment Method:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:(_selectedSale$payment=selectedSale.payment_method)===null||_selectedSale$payment===void 0?void 0:_selectedSale$payment.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"items-list\",children:(_selectedSale$items=selectedSale.items)===null||_selectedSale$items===void 0?void 0:_selectedSale$items.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[item.quantity,\" \",item.unit_name,\" \\xD7 \",formatCurrency(item.unit_price),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-total\",children:[formatCurrency(item.total_price),\" MGA\"]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency(selectedSale.subtotal),\" MGA\"]})]}),selectedSale.discount_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Discount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[\"-\",formatCurrency(selectedSale.discount_amount),\" MGA\"]})]}),selectedSale.tax_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Tax:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency(selectedSale.tax_amount),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-row total\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency(selectedSale.total_amount),\" MGA\"]})]})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>printPendingSale(selectedSale),children:\"\\uD83D\\uDDA8\\uFE0F Print Receipt\"}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:()=>cancelSale(selectedSale.id),children:\"Cancel Sale\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:()=>completeSale(selectedSale.id),loading:completingSale===selectedSale.id,disabled:completingSale===selectedSale.id||((_stockValidationStatu3=stockValidationStatus[selectedSale.id])===null||_stockValidationStatu3===void 0?void 0:_stockValidationStatu3.hasInsufficientStock),children:(_stockValidationStatu4=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu4!==void 0&&_stockValidationStatu4.hasInsufficientStock?'Insufficient Stock':'Complete Sale'})]})]})})]});};export default PendingSales;","map":{"version":3,"names":["React","useState","useEffect","api","Button","jsx","_jsx","jsxs","_jsxs","PendingSales","_selectedSale$payment","_selectedSale$items","_stockValidationStatu3","_stockValidationStatu4","pendingSales","setPendingSales","loading","setLoading","error","setError","selectedSale","setSelectedSale","showSaleModal","setShowSaleModal","completingSale","setCompletingSale","stockValidationStatus","setStockValidationStatus","fetchPendingSales","length","validateStockForAllSales","response","get","data","results","err","console","validationStatus","sale","hasInsufficientStock","stockIssues","item","items","stockResponse","concat","product","stockData","unitStockInfo","available_units","find","unit","id","availableQuantity","parseFloat","available_quantity","requiredQuantity","quantity","push","product_name","unit_name","completeSale","saleId","s","stockValidationErrors","stockErr","join","post","printPendingSale","_objectSpread","status","prev","filter","alert","_err$response","_err$response$data","message","cancelSale","window","confirm","patch","_err$response2","_err$response2$data","viewSaleDetails","printData","sale_number","customer_name","customer_phone","customer_email","user_name","user_id","created_at","print_timestamp","Date","toISOString","print_id","now","Math","random","toString","substr","total_amount","map","product_sku","quantity_display","unit_price","total_price","printContent","toLocaleString","toFixed","toUpperCase","printWindow","open","document","write","close","onload","focus","print","setTimeout","formatDate","dateString","formatCurrency","amount","className","children","onClick","variant","reduce","total","_sale$items","_sale$payment_method","_stockValidationStatu","_stockValidationStatu2","payment_method","replace","size","disabled","index","subtotal","discount_amount","tax_amount"],"sources":["/home/el-ifran/WareHouse_Manager/beverage_management_system/src/pages/PendingSales.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport api from '../services/api';\nimport Button from '../components/Button';\nimport './PendingSales.css';\n\nconst PendingSales = () => {\n  const [pendingSales, setPendingSales] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [selectedSale, setSelectedSale] = useState(null);\n  const [showSaleModal, setShowSaleModal] = useState(false);\n  const [completingSale, setCompletingSale] = useState(null);\n  const [stockValidationStatus, setStockValidationStatus] = useState({});\n\n  useEffect(() => {\n    fetchPendingSales();\n  }, []);\n\n  // Validate stock for all pending sales when the list changes\n  useEffect(() => {\n    if (pendingSales.length > 0) {\n      validateStockForAllSales();\n    }\n  }, [pendingSales]);\n\n  const fetchPendingSales = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      const response = await api.get('/sales/?status=pending');\n      setPendingSales(response.data.results || response.data);\n    } catch (err) {\n      setError('Failed to fetch pending sales');\n      console.error('Pending sales fetch error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateStockForAllSales = async () => {\n    const validationStatus = {};\n    \n    for (const sale of pendingSales) {\n      let hasInsufficientStock = false;\n      const stockIssues = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          const stockResponse = await api.get(`/products/${item.product}/stock-availability/`);\n          const stockData = stockResponse.data;\n          \n          const unitStockInfo = stockData.available_units.find(unit => unit.id === item.unit);\n          if (unitStockInfo) {\n            const availableQuantity = parseFloat(unitStockInfo.available_quantity || 0);\n            const requiredQuantity = parseFloat(item.quantity || 0);\n            \n            if (availableQuantity < requiredQuantity) {\n              hasInsufficientStock = true;\n              stockIssues.push(`${item.product_name}: ${requiredQuantity} ${item.unit_name} required, ${availableQuantity} available`);\n            }\n          }\n        } catch (err) {\n          console.error(`Error validating stock for sale ${sale.id}:`, err);\n        }\n      }\n      \n      validationStatus[sale.id] = {\n        hasInsufficientStock,\n        stockIssues\n      };\n    }\n    \n    setStockValidationStatus(validationStatus);\n  };\n\n  const completeSale = async (saleId) => {\n    try {\n      setCompletingSale(saleId);\n      setError('');\n      \n      // Find the sale to validate\n      const sale = pendingSales.find(s => s.id === saleId);\n      if (!sale) {\n        setError('Sale not found');\n        return;\n      }\n\n      // Check stock availability for each item\n      const stockValidationErrors = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          // Get current stock availability for this product\n          const stockResponse = await api.get(`/products/${item.product}/stock-availability/`);\n          const stockData = stockResponse.data;\n          \n          // Find the stock info for the unit used in this sale item\n          const unitStockInfo = stockData.available_units.find(unit => unit.id === item.unit);\n          if (!unitStockInfo) {\n            stockValidationErrors.push(`${item.product_name}: Unit not found in stock data`);\n            continue;\n          }\n          \n          // Check if there's enough stock\n          const availableQuantity = parseFloat(unitStockInfo.available_quantity || 0);\n          const requiredQuantity = parseFloat(item.quantity || 0);\n          \n          if (availableQuantity < requiredQuantity) {\n            stockValidationErrors.push(\n              `${item.product_name}: Insufficient stock. Required: ${requiredQuantity} ${item.unit_name}, Available: ${availableQuantity} ${item.unit_name}`\n            );\n          }\n        } catch (stockErr) {\n          console.error(`Error checking stock for product ${item.product}:`, stockErr);\n          stockValidationErrors.push(`${item.product_name}: Unable to check stock availability`);\n        }\n      }\n      \n      // If there are stock validation errors, show them and prevent completion\n      if (stockValidationErrors.length > 0) {\n        setError(`Cannot complete sale due to insufficient stock:\\n\\n${stockValidationErrors.join('\\n')}`);\n        return;\n      }\n      \n      // If stock validation passes, proceed with completion\n      await api.post(`/sales/${saleId}/complete/`);\n      \n      // Print receipt for the completed sale\n      printPendingSale({ ...sale, status: 'completed' });\n      \n      // Remove the completed sale from the list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      \n      // Close modal if it was open for this sale\n      if (selectedSale && selectedSale.id === saleId) {\n        setShowSaleModal(false);\n        setSelectedSale(null);\n      }\n      \n      alert('Sale completed successfully!');\n    } catch (err) {\n      setError(`Failed to complete sale: ${err.response?.data?.error || err.message}`);\n      console.error('Complete sale error:', err);\n    } finally {\n      setCompletingSale(null);\n    }\n  };\n\n  const cancelSale = async (saleId) => {\n    if (!window.confirm('Are you sure you want to cancel this sale?')) {\n      return;\n    }\n\n    try {\n      setError('');\n      await api.patch(`/sales/${saleId}/`, { status: 'cancelled' });\n      \n      // Remove the cancelled sale from the list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      \n      // Close modal if it was open for this sale\n      if (selectedSale && selectedSale.id === saleId) {\n        setShowSaleModal(false);\n        setSelectedSale(null);\n      }\n      \n      alert('Sale cancelled successfully!');\n    } catch (err) {\n      setError(`Failed to cancel sale: ${err.response?.data?.error || err.message}`);\n      console.error('Cancel sale error:', err);\n    }\n  };\n\n  const viewSaleDetails = async (sale) => {\n    try {\n      setSelectedSale(sale);\n      setShowSaleModal(true);\n    } catch (err) {\n      setError('Failed to load sale details');\n      console.error('Sale details error:', err);\n    }\n  };\n\n  const printPendingSale = (sale) => {\n    // Create print data for the pending sale\n    const printData = {\n      sale_number: sale.sale_number,\n      customer_name: sale.customer_name || 'Walk-in Customer',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      user_name: sale.user_name || 'Unknown User',\n      user_id: sale.user_id || 'unknown',\n      created_at: sale.created_at,\n      print_timestamp: new Date().toISOString(),\n      print_id: `PRINT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      status: 'pending',\n      total_amount: sale.total_amount,\n      items: sale.items.map(item => ({\n        product_name: item.product_name,\n        product_sku: item.product_sku || '',\n        quantity: item.quantity_display || item.quantity,\n        unit_name: item.unit_name,\n        unit_price: item.unit_price,\n        total_price: item.total_price || (parseFloat(item.quantity_display || item.quantity) * parseFloat(item.unit_price))\n      }))\n    };\n\n    // Create print content\n    const printContent = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Sale Receipt - ${sale.sale_number}</title>\n        <style>\n          body { font-family: Arial, sans-serif; margin: 20px; }\n          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }\n          .sale-info { margin-bottom: 20px; }\n          .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n          .items-table th, .items-table td { border: 1px solid #000; padding: 8px; text-align: left; }\n          .items-table th { background-color: #f0f0f0; }\n          .total { text-align: right; font-weight: bold; font-size: 1.2em; }\n          .status { text-align: center; margin-top: 20px; padding: 10px; background-color: #fff3cd; border: 1px solid #ffeaa7; }\n        </style>\n      </head>\n      <body>\n        <div class=\"header\">\n          <h1>Sale Receipt</h1>\n          <h2>${printData.sale_number}</h2>\n        </div>\n        \n        <div class=\"sale-info\">\n          <p><strong>Customer:</strong> ${printData.customer_name}</p>\n          ${printData.customer_phone ? `<p><strong>Phone:</strong> ${printData.customer_phone}</p>` : ''}\n          ${printData.customer_email ? `<p><strong>Email:</strong> ${printData.customer_email}</p>` : ''}\n          <p><strong>Date:</strong> ${new Date(printData.created_at).toLocaleString()}</p>\n          <p><strong>Cashier:</strong> ${printData.user_name}</p>\n        </div>\n        \n        <table class=\"items-table\">\n          <thead>\n            <tr>\n              <th>Product</th>\n              <th>Unit</th>\n              <th>Qty</th>\n              <th>Unit Price</th>\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${printData.items.map(item => `\n              <tr>\n                <td>${item.product_name}</td>\n                <td>${item.unit_name}</td>\n                <td>${item.quantity}</td>\n                <td>${parseFloat(item.unit_price).toFixed(2)} MGA</td>\n                <td>${parseFloat(item.total_price).toFixed(2)} MGA</td>\n              </tr>\n            `).join('')}\n          </tbody>\n        </table>\n        \n        <div class=\"total\">\n          <p><strong>Total Amount: ${parseFloat(printData.total_amount).toFixed(2)} MGA</strong></p>\n        </div>\n        \n        <div class=\"status\">\n          <p><strong>Status: ${printData.status.toUpperCase()}</strong></p>\n          <p>${printData.status === 'pending' ? 'This sale is pending' : 'This sale has been completed'}</p>\n        </div>\n        \n        <div style=\"text-align: center; margin-top: 20px; font-size: 0.8em; color: #666;\">\n          <p>Printed on: ${new Date(printData.print_timestamp).toLocaleString()}</p>\n          <p>Print ID: ${printData.print_id}</p>\n        </div>\n      </body>\n      </html>\n    `;\n\n    // Open print window\n    const printWindow = window.open('', '_blank', 'width=800,height=600');\n    printWindow.document.write(printContent);\n    printWindow.document.close();\n    \n    // Wait for content to load then print\n    printWindow.onload = () => {\n      printWindow.focus();\n      printWindow.print();\n      // Close the window after a short delay\n      setTimeout(() => {\n        printWindow.close();\n      }, 1000);\n    };\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleString();\n  };\n\n  const formatCurrency = (amount) => {\n    return parseFloat(amount).toFixed(2);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"pending-sales\">\n        <div className=\"loading-container\">\n          <div className=\"spinner\"></div>\n          <span>Loading pending sales...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"pending-sales\">\n      <div className=\"page-header\">\n        <h1>Pending Sales Validation</h1>\n        <p>Review and complete pending sales</p>\n        <div className=\"header-actions\">\n          <Button onClick={fetchPendingSales} variant=\"outline\">\n            Refresh\n          </Button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"error-message\">\n          {error}\n        </div>\n      )}\n\n      <div className=\"pending-sales-stats\">\n        <div className=\"stat-card\">\n          <div className=\"stat-number\">{pendingSales.length}</div>\n          <div className=\"stat-label\">Pending Sales</div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-number\">\n            {formatCurrency(pendingSales.reduce((total, sale) => total + parseFloat(sale.total_amount), 0))}\n          </div>\n          <div className=\"stat-label\">Total Value (MGA)</div>\n        </div>\n      </div>\n\n      {pendingSales.length === 0 ? (\n        <div className=\"no-pending-sales\">\n          <div className=\"no-sales-icon\">üìã</div>\n          <h3>No Pending Sales</h3>\n          <p>All sales have been processed. Great job!</p>\n        </div>\n      ) : (\n        <div className=\"pending-sales-list\">\n          {pendingSales.map(sale => (\n            <div key={sale.id} className=\"pending-sale-card\">\n              <div className=\"sale-header\">\n                <div className=\"sale-number\">{sale.sale_number}</div>\n                <div className=\"sale-status\">\n                  <span className=\"status-badge pending\">Pending</span>\n                </div>\n              </div>\n              \n              <div className=\"sale-info\">\n                <div className=\"info-row\">\n                  <span className=\"label\">Customer:</span>\n                  <span className=\"value\">{sale.customer_name || 'Walk-in Customer'}</span>\n                </div>\n                <div className=\"info-row\">\n                  <span className=\"label\">Date:</span>\n                  <span className=\"value\">{formatDate(sale.created_at)}</span>\n                </div>\n                <div className=\"info-row\">\n                  <span className=\"label\">Items:</span>\n                  <span className=\"value\">{sale.items?.length || 0} items</span>\n                </div>\n                <div className=\"info-row\">\n                  <span className=\"label\">Total:</span>\n                  <span className=\"value total-amount\">{formatCurrency(sale.total_amount)} MGA</span>\n                </div>\n                <div className=\"info-row\">\n                  <span className=\"label\">Payment:</span>\n                  <span className=\"value\">{sale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                </div>\n                \n                {/* Stock Status */}\n                {stockValidationStatus[sale.id] && (\n                  <div className=\"info-row stock-status\">\n                    <span className=\"label\">Stock Status:</span>\n                    <span className={`value ${stockValidationStatus[sale.id].hasInsufficientStock ? 'stock-insufficient' : 'stock-sufficient'}`}>\n                      {stockValidationStatus[sale.id].hasInsufficientStock ? '‚ö†Ô∏è Insufficient Stock' : '‚úÖ Stock Available'}\n                    </span>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"sale-actions\">\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => viewSaleDetails(sale)}\n                >\n                  View Details\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => printPendingSale(sale)}\n                >\n                  üñ®Ô∏è Print\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"primary\"\n                  onClick={() => completeSale(sale.id)}\n                  loading={completingSale === sale.id}\n                  disabled={completingSale === sale.id || (stockValidationStatus[sale.id]?.hasInsufficientStock)}\n                >\n                  {stockValidationStatus[sale.id]?.hasInsufficientStock ? 'Insufficient Stock' : 'Complete Sale'}\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"danger\"\n                  onClick={() => cancelSale(sale.id)}\n                >\n                  Cancel Sale\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Sale Details Modal */}\n      {showSaleModal && selectedSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal sale-details-modal\">\n            <div className=\"modal-header\">\n              <h2>Sale Details - {selectedSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                √ó\n              </button>\n            </div>\n\n            <div className=\"modal-content\">\n              <div className=\"sale-details-info\">\n                <div className=\"detail-section\">\n                  <h3>Customer Information</h3>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Name:</span>\n                    <span className=\"value\">{selectedSale.customer_name || 'Walk-in Customer'}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Phone:</span>\n                    <span className=\"value\">{selectedSale.customer_phone || 'N/A'}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Email:</span>\n                    <span className=\"value\">{selectedSale.customer_email || 'N/A'}</span>\n                  </div>\n                </div>\n\n                <div className=\"detail-section\">\n                  <h3>Sale Information</h3>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Date:</span>\n                    <span className=\"value\">{formatDate(selectedSale.created_at)}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Payment Method:</span>\n                    <span className=\"value\">{selectedSale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Status:</span>\n                    <span className=\"status-badge pending\">Pending</span>\n                  </div>\n                </div>\n\n                <div className=\"detail-section\">\n                  <h3>Items</h3>\n                  <div className=\"items-list\">\n                    {selectedSale.items?.map((item, index) => (\n                      <div key={index} className=\"item-row\">\n                        <div className=\"item-info\">\n                          <div className=\"item-name\">{item.product_name}</div>\n                          <div className=\"item-details\">\n                            {item.quantity} {item.unit_name} √ó {formatCurrency(item.unit_price)} MGA\n                          </div>\n                        </div>\n                        <div className=\"item-total\">\n                          {formatCurrency(item.total_price)} MGA\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"detail-section\">\n                  <h3>Totals</h3>\n                  <div className=\"totals\">\n                    <div className=\"total-row\">\n                      <span className=\"label\">Subtotal:</span>\n                      <span className=\"value\">{formatCurrency(selectedSale.subtotal)} MGA</span>\n                    </div>\n                    {selectedSale.discount_amount > 0 && (\n                      <div className=\"total-row\">\n                        <span className=\"label\">Discount:</span>\n                        <span className=\"value\">-{formatCurrency(selectedSale.discount_amount)} MGA</span>\n                      </div>\n                    )}\n                    {selectedSale.tax_amount > 0 && (\n                      <div className=\"total-row\">\n                        <span className=\"label\">Tax:</span>\n                        <span className=\"value\">{formatCurrency(selectedSale.tax_amount)} MGA</span>\n                      </div>\n                    )}\n                    <div className=\"total-row total\">\n                      <span className=\"label\">Total:</span>\n                      <span className=\"value\">{formatCurrency(selectedSale.total_amount)} MGA</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-actions\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                Close\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => printPendingSale(selectedSale)}\n              >\n                üñ®Ô∏è Print Receipt\n              </Button>\n              <Button\n                variant=\"danger\"\n                onClick={() => cancelSale(selectedSale.id)}\n              >\n                Cancel Sale\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={() => completeSale(selectedSale.id)}\n                loading={completingSale === selectedSale.id}\n                disabled={completingSale === selectedSale.id || (stockValidationStatus[selectedSale.id]?.hasInsufficientStock)}\n              >\n                {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? 'Insufficient Stock' : 'Complete Sale'}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PendingSales;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}