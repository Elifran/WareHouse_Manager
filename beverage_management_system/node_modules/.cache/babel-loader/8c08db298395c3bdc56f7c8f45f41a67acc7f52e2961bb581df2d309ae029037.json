{"ast":null,"code":"import _objectSpread from\"/home/el-ifran/WareHouse_Manager/beverage_management_system/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useAuth}from'../contexts/AuthContext';import api from'../services/api';import Table from'../components/Table';import Button from'../components/Button';import PrintButton from'../components/PrintButton';import'./Inventory.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Inventory=()=>{const{user}=useAuth();const[products,setProducts]=useState([]);const[categories,setCategories]=useState([]);const[taxClasses,setTaxClasses]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[showAddModal,setShowAddModal]=useState(false);const[editingProduct,setEditingProduct]=useState(null);const[filters,setFilters]=useState({category:'',stockStatus:'',search:''});useEffect(()=>{fetchProducts();fetchCategories();fetchTaxClasses();},[]);const fetchProducts=async function(){let filterParams=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};try{setLoading(true);const params=new URLSearchParams();// Add filters to params\nif(filterParams.category)params.append('category',filterParams.category);if(filterParams.search)params.append('search',filterParams.search);if(filterParams.is_active!==undefined)params.append('is_active',filterParams.is_active);if(filterParams.stock_quantity!==undefined)params.append('stock_quantity',filterParams.stock_quantity);const url=\"/products/\".concat(params.toString()?'?'+params.toString():'');const response=await api.get(url);let products=response.data.results||response.data;// Handle low stock filter on frontend since it's a calculated field\nif(filterParams.stockStatus==='low'){products=products.filter(product=>product.is_low_stock);}setProducts(products);}catch(err){setError('Failed to load products');console.error('Products error:',err);}finally{setLoading(false);}};const fetchCategories=async()=>{try{const response=await api.get('/products/categories/');setCategories(response.data.results||response.data);}catch(err){console.error('Categories error:',err);}};const fetchTaxClasses=async()=>{try{const response=await api.get('/products/tax-classes/');setTaxClasses(response.data.results||response.data);}catch(err){console.error('Tax classes error:',err);}};const handleAddProduct=()=>{setEditingProduct(null);setShowAddModal(true);};const handleEditProduct=async product=>{try{// Fetch full product details including cost_price and category ID\nconst response=await api.get(\"/products/\".concat(product.id,\"/\"));setEditingProduct(response.data);setShowAddModal(true);}catch(err){setError('Failed to load product details');console.error('Product details error:',err);}};const handleDeleteProduct=async product=>{if(window.confirm(\"Are you sure you want to delete \".concat(product.name,\"?\"))){try{await api.delete(\"/products/\".concat(product.id,\"/\"));fetchProducts(filters);}catch(err){setError('Failed to delete product');console.error('Delete error:',err);}}};const handleFilterChange=(filterType,value)=>{const newFilters=_objectSpread(_objectSpread({},filters),{},{[filterType]:value});setFilters(newFilters);// Convert stock status filter to API parameters\nconst apiParams=_objectSpread({},newFilters);if(newFilters.stockStatus==='out'){// For out of stock, filter by stock_quantity = 0\napiParams.stock_quantity=0;}fetchProducts(apiParams);};const clearFilters=()=>{const clearedFilters={category:'',stockStatus:'',search:''};setFilters(clearedFilters);fetchProducts(clearedFilters);};const columns=[{key:'name',header:'Product Name',render:(value,row)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"product-name\",children:value}),/*#__PURE__*/_jsx(\"div\",{className:\"product-sku\",children:row.sku})]})},{key:'category_name',header:'Category'},{key:'stock_quantity',header:'Stock',render:(value,row)=>/*#__PURE__*/_jsxs(\"div\",{className:\"stock-quantity \".concat(row.is_low_stock?'low-stock':'',\" \").concat(row.is_out_of_stock?'out-of-stock':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"base-stock\",children:[value,\" \",row.unit,row.is_low_stock&&/*#__PURE__*/_jsx(\"span\",{className:\"stock-warning\",children:\"Low\"}),row.is_out_of_stock&&/*#__PURE__*/_jsx(\"span\",{className:\"stock-warning\",children:\"Out\"})]}),row.stock_in_units&&row.stock_in_units.length>1&&/*#__PURE__*/_jsx(\"div\",{className:\"stock-in-units\",children:row.stock_in_units.filter(stockUnit=>!stockUnit.is_base_unit).map(stockUnit=>/*#__PURE__*/_jsxs(\"div\",{className:\"unit-stock\",children:[stockUnit.quantity,\" \",stockUnit.unit_symbol]},stockUnit.unit_id))})]})},{key:'price',header:'Price',render:value=>\"$\".concat(parseFloat(value).toFixed(2))},{key:'actions',header:'Actions',render:(value,row)=>/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>handleEditProduct(row),children:\"Edit\"}),(user===null||user===void 0?void 0:user.role)==='admin'&&/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>handleDeleteProduct(row),children:\"Delete\"})]})}];return/*#__PURE__*/_jsxs(\"div\",{className:\"inventory\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inventory-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Inventory Management\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-actions\",children:[/*#__PURE__*/_jsx(PrintButton,{data:filteredProducts,title:\"Inventory Report\",type:\"inventory\",printText:\"Print Inventory\",className:\"print-inventory-btn\"}),/*#__PURE__*/_jsx(Button,{onClick:handleAddProduct,children:\"Add Product\"})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"inventory-filters\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Category:\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.category,onChange:e=>handleFilterChange('category',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Categories\"}),categories.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category.id,children:category.name},category.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Stock Status:\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.stockStatus,onChange:e=>handleFilterChange('stockStatus',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All\"}),/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low Stock\"}),/*#__PURE__*/_jsx(\"option\",{value:\"out\",children:\"Out of Stock\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Search:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search products...\",value:filters.search,onChange:e=>handleFilterChange('search',e.target.value)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-group\",children:/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"small\",onClick:clearFilters,children:\"Clear Filters\"})})]}),/*#__PURE__*/_jsx(Table,{data:products,columns:columns,loading:loading,emptyMessage:\"No products found\"}),showAddModal&&/*#__PURE__*/_jsx(ProductModal,{product:editingProduct,categories:categories,taxClasses:taxClasses,onClose:()=>setShowAddModal(false),onSave:()=>{setShowAddModal(false);fetchProducts(filters);}})]});};const ProductModal=_ref=>{var _product$base_unit,_product$is_active;let{product,categories,taxClasses,onClose,onSave}=_ref;const[formData,setFormData]=useState({name:(product===null||product===void 0?void 0:product.name)||'',description:(product===null||product===void 0?void 0:product.description)||'',category:(product===null||product===void 0?void 0:product.category)||'',tax_class:(product===null||product===void 0?void 0:product.tax_class)||'',sku:(product===null||product===void 0?void 0:product.sku)||'',price:(product===null||product===void 0?void 0:product.price)||'',cost_price:(product===null||product===void 0?void 0:product.cost_price)||'',stock_quantity:(product===null||product===void 0?void 0:product.stock_quantity)||0,min_stock_level:(product===null||product===void 0?void 0:product.min_stock_level)||10,max_stock_level:(product===null||product===void 0?void 0:product.max_stock_level)||1000,base_unit:(product===null||product===void 0?void 0:(_product$base_unit=product.base_unit)===null||_product$base_unit===void 0?void 0:_product$base_unit.id)||(product===null||product===void 0?void 0:product.base_unit)||'',is_active:(_product$is_active=product===null||product===void 0?void 0:product.is_active)!==null&&_product$is_active!==void 0?_product$is_active:true});const[units,setUnits]=useState([]);const[allUnits,setAllUnits]=useState([]);const[compatibleUnits,setCompatibleUnits]=useState([]);const[showUnitSelector,setShowUnitSelector]=useState(false);const[convertibleUnits,setConvertibleUnits]=useState([]);// Load base units when component mounts (for product creation/editing)\nuseEffect(()=>{const fetchUnits=async()=>{try{const[baseUnitsResponse,allUnitsResponse]=await Promise.all([api.get('/products/base-units/'),api.get('/products/units/')]);setUnits(baseUnitsResponse.data.results||baseUnitsResponse.data);setAllUnits(allUnitsResponse.data.results||allUnitsResponse.data);}catch(err){console.error('Failed to load units:',err);}};fetchUnits();},[]);// Load compatible units when editing a product\nuseEffect(()=>{if(product&&product.compatible_units){setCompatibleUnits(product.compatible_units);}else{setCompatibleUnits([]);}},[product]);// Fetch convertible units when base unit changes\nuseEffect(()=>{const fetchConvertibleUnits=async()=>{if(formData.base_unit){try{// Get the product's available units which includes conversion information\nif(product){const response=await api.get(\"/products/\".concat(product.id,\"/\"));const productData=response.data;if(productData.available_units){// Extract units that can be converted to/from the base unit\nconst convertible=productData.available_units.filter(unit=>unit.id!==parseInt(formData.base_unit)).map(unit=>({id:unit.id,name:unit.name,symbol:unit.symbol,is_base_unit:unit.is_base_unit}));setConvertibleUnits(convertible);}}else{// For new products, we need to check which units have conversions with the selected base unit\n// We'll use a different approach - get all unit conversions and filter\nconst response=await api.get('/products/unit-conversions/');const conversions=response.data.results||response.data;const baseUnitId=parseInt(formData.base_unit);const convertible=[];// Find units that have conversions with the base unit\nconversions.forEach(conversion=>{if(conversion.from_unit===baseUnitId&&!convertible.find(u=>u.id===conversion.to_unit)){// Find the unit details\nconst unit=allUnits.find(u=>u.id===conversion.to_unit);if(unit){convertible.push({id:unit.id,name:unit.name,symbol:unit.symbol,is_base_unit:unit.is_base_unit});}}else if(conversion.to_unit===baseUnitId&&!convertible.find(u=>u.id===conversion.from_unit)){// Find the unit details\nconst unit=allUnits.find(u=>u.id===conversion.from_unit);if(unit){convertible.push({id:unit.id,name:unit.name,symbol:unit.symbol,is_base_unit:unit.is_base_unit});}}});setConvertibleUnits(convertible);}}catch(err){console.error('Failed to fetch convertible units:',err);setConvertibleUnits([]);}}else{setConvertibleUnits([]);}};fetchConvertibleUnits();},[formData.base_unit,product,allUnits]);// Update form data when product changes (for editing)\nuseEffect(()=>{if(product){var _product$base_unit2,_product$is_active2;setFormData({name:product.name||'',description:product.description||'',category:product.category||'',tax_class:product.tax_class||'',sku:product.sku||'',price:product.price||'',cost_price:product.cost_price||'',stock_quantity:product.stock_quantity||0,min_stock_level:product.min_stock_level||10,max_stock_level:product.max_stock_level||1000,base_unit:((_product$base_unit2=product.base_unit)===null||_product$base_unit2===void 0?void 0:_product$base_unit2.id)||product.base_unit||'',is_active:(_product$is_active2=product.is_active)!==null&&_product$is_active2!==void 0?_product$is_active2:true});}},[product]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const handleChange=e=>{const{name,value,type,checked}=e.target;setFormData(_objectSpread(_objectSpread({},formData),{},{[name]:type==='checkbox'?checked:value}));};const addCompatibleUnit=async unitId=>{if(!product)return;try{const response=await api.post(\"/products/\".concat(product.id,\"/units/\"),{unit:unitId,is_default:false,is_active:true});setCompatibleUnits([...compatibleUnits,response.data]);setShowUnitSelector(false);}catch(err){console.error('Failed to add compatible unit:',err);}};const removeCompatibleUnit=async productUnitId=>{if(!product)return;try{await api.delete(\"/products/\".concat(product.id,\"/units/\").concat(productUnitId,\"/\"));setCompatibleUnits(compatibleUnits.filter(cu=>cu.id!==productUnitId));}catch(err){console.error('Failed to remove compatible unit:',err);}};const setDefaultUnit=async productUnitId=>{if(!product)return;try{// First, set all units to non-default\nfor(const cu of compatibleUnits){if(cu.is_default){await api.put(\"/products/\".concat(product.id,\"/units/\").concat(cu.id,\"/\"),_objectSpread(_objectSpread({},cu),{},{is_default:false}));}}// Then set the selected unit as default\nconst unitToUpdate=compatibleUnits.find(cu=>cu.id===productUnitId);if(unitToUpdate){await api.put(\"/products/\".concat(product.id,\"/units/\").concat(productUnitId,\"/\"),_objectSpread(_objectSpread({},unitToUpdate),{},{is_default:true}));// Update local state\nsetCompatibleUnits(compatibleUnits.map(cu=>_objectSpread(_objectSpread({},cu),{},{is_default:cu.id===productUnitId})));}}catch(err){console.error('Failed to set default unit:',err);}};const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError('');try{// Prepare data for submission\nconst submitData=_objectSpread(_objectSpread({},formData),{},{base_unit:formData.base_unit?parseInt(formData.base_unit):null});if(product){await api.put(\"/products/\".concat(product.id,\"/\"),submitData);}else{await api.post('/products/',submitData);}onSave();}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||'Failed to save product');console.error('Save error:',err);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"modal-overlay\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:product?'Edit Product':'Add Product'}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"modal-form\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Product Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:formData.name,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"SKU *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"sku\",value:formData.sku,onChange:handleChange,required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"description\",value:formData.description,onChange:handleChange,rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Category *\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"category\",value:formData.category,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Category\"}),categories.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category.id,children:category.name},category.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Tax Class\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"tax_class\",value:formData.tax_class,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"No Tax Class\"}),taxClasses.map(taxClass=>/*#__PURE__*/_jsxs(\"option\",{value:taxClass.id,children:[taxClass.name,\" (\",taxClass.tax_rate,\"%)\"]},taxClass.id))]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Base Unit\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"base_unit\",value:formData.base_unit,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Base Unit\"}),units.map(unit=>/*#__PURE__*/_jsxs(\"option\",{value:unit.id,children:[unit.name,\" (\",unit.symbol,\")\"]},unit.id))]})]})}),product&&/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Compatible Units\"}),/*#__PURE__*/_jsx(\"p\",{className:\"compatible-units-note\",children:\"Only units that can be converted to/from the base unit can be added as compatible units.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"compatible-units-section\",children:[compatibleUnits.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"compatible-units-list\",children:compatibleUnits.map(compatibleUnit=>/*#__PURE__*/_jsxs(\"div\",{className:\"compatible-unit-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"unit-info\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"unit-name\",children:[compatibleUnit.unit_name,\" (\",compatibleUnit.unit_symbol,\")\"]}),compatibleUnit.is_default&&/*#__PURE__*/_jsx(\"span\",{className:\"default-badge\",children:\"Default\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"unit-actions\",children:[!compatibleUnit.is_default&&/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>setDefaultUnit(compatibleUnit.id),children:\"Set Default\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>removeCompatibleUnit(compatibleUnit.id),children:\"Remove\"})]})]},compatibleUnit.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"no-units-message\",children:\"No compatible units added yet.\"}),/*#__PURE__*/_jsxs(Button,{type:\"button\",variant:\"outline\",onClick:()=>setShowUnitSelector(true),className:\"add-unit-button\",disabled:!formData.base_unit||convertibleUnits.length===0,children:[\"+ Add Compatible Unit\",!formData.base_unit&&\" (Select base unit first)\",formData.base_unit&&convertibleUnits.length===0&&\" (No convertible units)\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",name:\"price\",value:formData.price,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cost Price\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",name:\"cost_price\",value:formData.cost_price,onChange:handleChange})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Stock Quantity\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"stock_quantity\",value:formData.stock_quantity,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Min Stock Level\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"min_stock_level\",value:formData.min_stock_level,onChange:handleChange})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Max Stock Level\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"max_stock_level\",value:formData.max_stock_level,onChange:handleChange})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"is_active\",checked:formData.is_active,onChange:handleChange}),\"Active\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",onClick:onClose,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",loading:loading,children:product?'Update':'Create'})]})]})]}),showUnitSelector&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content unit-selector-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Add Compatible Unit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowUnitSelector(false),children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Select a unit to add as compatible for this product:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"unit-selector-note\",children:\"Only units that can be converted to/from the base unit are shown.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"unit-selector-list\",children:[convertibleUnits.filter(unit=>!compatibleUnits.some(cu=>cu.unit===unit.id)).map(unit=>/*#__PURE__*/_jsx(\"div\",{className:\"unit-selector-item\",onClick:()=>addCompatibleUnit(unit.id),children:/*#__PURE__*/_jsxs(\"div\",{className:\"unit-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"unit-name\",children:unit.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"unit-symbol\",children:[\"(\",unit.symbol,\")\"]}),unit.is_base_unit&&/*#__PURE__*/_jsx(\"span\",{className:\"base-unit-badge\",children:\"Base Unit\"})]})},unit.id)),convertibleUnits.filter(unit=>!compatibleUnits.some(cu=>cu.unit===unit.id)).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"no-units-available\",children:formData.base_unit?\"No convertible units available for the selected base unit.\":\"Please select a base unit first.\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-actions\",children:/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",onClick:()=>setShowUnitSelector(false),children:\"Cancel\"})})]})})]});};export default Inventory;","map":{"version":3,"names":["React","useState","useEffect","useAuth","api","Table","Button","PrintButton","jsx","_jsx","jsxs","_jsxs","Inventory","user","products","setProducts","categories","setCategories","taxClasses","setTaxClasses","loading","setLoading","error","setError","showAddModal","setShowAddModal","editingProduct","setEditingProduct","filters","setFilters","category","stockStatus","search","fetchProducts","fetchCategories","fetchTaxClasses","filterParams","arguments","length","undefined","params","URLSearchParams","append","is_active","stock_quantity","url","concat","toString","response","get","data","results","filter","product","is_low_stock","err","console","handleAddProduct","handleEditProduct","id","handleDeleteProduct","window","confirm","name","delete","handleFilterChange","filterType","value","newFilters","_objectSpread","apiParams","clearFilters","clearedFilters","columns","key","header","render","row","children","className","sku","is_out_of_stock","unit","stock_in_units","stockUnit","is_base_unit","map","quantity","unit_symbol","unit_id","parseFloat","toFixed","size","variant","onClick","role","filteredProducts","title","type","printText","onChange","e","target","placeholder","emptyMessage","ProductModal","onClose","onSave","_ref","_product$base_unit","_product$is_active","formData","setFormData","description","tax_class","price","cost_price","min_stock_level","max_stock_level","base_unit","units","setUnits","allUnits","setAllUnits","compatibleUnits","setCompatibleUnits","showUnitSelector","setShowUnitSelector","convertibleUnits","setConvertibleUnits","fetchUnits","baseUnitsResponse","allUnitsResponse","Promise","all","compatible_units","fetchConvertibleUnits","productData","available_units","convertible","parseInt","symbol","conversions","baseUnitId","forEach","conversion","from_unit","find","u","to_unit","push","_product$base_unit2","_product$is_active2","handleChange","checked","addCompatibleUnit","unitId","post","is_default","removeCompatibleUnit","productUnitId","cu","setDefaultUnit","put","unitToUpdate","handleSubmit","preventDefault","submitData","_err$response","_err$response$data","detail","onSubmit","required","rows","taxClass","tax_rate","compatibleUnit","unit_name","disabled","step","some"],"sources":["/home/el-ifran/WareHouse_Manager/beverage_management_system/src/pages/Inventory.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport api from '../services/api';\nimport Table from '../components/Table';\nimport Button from '../components/Button';\nimport PrintButton from '../components/PrintButton';\nimport './Inventory.css';\n\nconst Inventory = () => {\n  const { user } = useAuth();\n  const [products, setProducts] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [taxClasses, setTaxClasses] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [editingProduct, setEditingProduct] = useState(null);\n  const [filters, setFilters] = useState({\n    category: '',\n    stockStatus: '',\n    search: ''\n  });\n\n  useEffect(() => {\n    fetchProducts();\n    fetchCategories();\n    fetchTaxClasses();\n  }, []);\n\n  const fetchProducts = async (filterParams = {}) => {\n    try {\n      setLoading(true);\n      const params = new URLSearchParams();\n      \n      // Add filters to params\n      if (filterParams.category) params.append('category', filterParams.category);\n      if (filterParams.search) params.append('search', filterParams.search);\n      if (filterParams.is_active !== undefined) params.append('is_active', filterParams.is_active);\n      if (filterParams.stock_quantity !== undefined) params.append('stock_quantity', filterParams.stock_quantity);\n      \n      const url = `/products/${params.toString() ? '?' + params.toString() : ''}`;\n      const response = await api.get(url);\n      let products = response.data.results || response.data;\n      \n      // Handle low stock filter on frontend since it's a calculated field\n      if (filterParams.stockStatus === 'low') {\n        products = products.filter(product => product.is_low_stock);\n      }\n      \n      setProducts(products);\n    } catch (err) {\n      setError('Failed to load products');\n      console.error('Products error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchCategories = async () => {\n    try {\n      const response = await api.get('/products/categories/');\n      setCategories(response.data.results || response.data);\n    } catch (err) {\n      console.error('Categories error:', err);\n    }\n  };\n\n  const fetchTaxClasses = async () => {\n    try {\n      const response = await api.get('/products/tax-classes/');\n      setTaxClasses(response.data.results || response.data);\n    } catch (err) {\n      console.error('Tax classes error:', err);\n    }\n  };\n\n  const handleAddProduct = () => {\n    setEditingProduct(null);\n    setShowAddModal(true);\n  };\n\n  const handleEditProduct = async (product) => {\n    try {\n      // Fetch full product details including cost_price and category ID\n      const response = await api.get(`/products/${product.id}/`);\n      setEditingProduct(response.data);\n      setShowAddModal(true);\n    } catch (err) {\n      setError('Failed to load product details');\n      console.error('Product details error:', err);\n    }\n  };\n\n  const handleDeleteProduct = async (product) => {\n    if (window.confirm(`Are you sure you want to delete ${product.name}?`)) {\n      try {\n        await api.delete(`/products/${product.id}/`);\n        fetchProducts(filters);\n      } catch (err) {\n        setError('Failed to delete product');\n        console.error('Delete error:', err);\n      }\n    }\n  };\n\n  const handleFilterChange = (filterType, value) => {\n    const newFilters = { ...filters, [filterType]: value };\n    setFilters(newFilters);\n    \n    // Convert stock status filter to API parameters\n    const apiParams = { ...newFilters };\n    if (newFilters.stockStatus === 'out') {\n      // For out of stock, filter by stock_quantity = 0\n      apiParams.stock_quantity = 0;\n    }\n    \n    fetchProducts(apiParams);\n  };\n\n  const clearFilters = () => {\n    const clearedFilters = { category: '', stockStatus: '', search: '' };\n    setFilters(clearedFilters);\n    fetchProducts(clearedFilters);\n  };\n\n  const columns = [\n    {\n      key: 'name',\n      header: 'Product Name',\n      render: (value, row) => (\n        <div>\n          <div className=\"product-name\">{value}</div>\n          <div className=\"product-sku\">{row.sku}</div>\n        </div>\n      )\n    },\n    {\n      key: 'category_name',\n      header: 'Category'\n    },\n    {\n      key: 'stock_quantity',\n      header: 'Stock',\n      render: (value, row) => (\n        <div className={`stock-quantity ${row.is_low_stock ? 'low-stock' : ''} ${row.is_out_of_stock ? 'out-of-stock' : ''}`}>\n          {/* Base unit stock */}\n          <div className=\"base-stock\">\n            {value} {row.unit}\n            {row.is_low_stock && <span className=\"stock-warning\">Low</span>}\n            {row.is_out_of_stock && <span className=\"stock-warning\">Out</span>}\n          </div>\n          \n          {/* Stock in other units */}\n          {row.stock_in_units && row.stock_in_units.length > 1 && (\n            <div className=\"stock-in-units\">\n              {row.stock_in_units\n                .filter(stockUnit => !stockUnit.is_base_unit)\n                .map(stockUnit => (\n                  <div key={stockUnit.unit_id} className=\"unit-stock\">\n                    {stockUnit.quantity} {stockUnit.unit_symbol}\n                  </div>\n                ))\n              }\n            </div>\n          )}\n        </div>\n      )\n    },\n    {\n      key: 'price',\n      header: 'Price',\n      render: (value) => `$${parseFloat(value).toFixed(2)}`\n    },\n    {\n      key: 'actions',\n      header: 'Actions',\n      render: (value, row) => (\n        <div className=\"action-buttons\">\n          <Button\n            size=\"small\"\n            variant=\"outline\"\n            onClick={() => handleEditProduct(row)}\n          >\n            Edit\n          </Button>\n          {user?.role === 'admin' && (\n            <Button\n              size=\"small\"\n              variant=\"danger\"\n              onClick={() => handleDeleteProduct(row)}\n            >\n              Delete\n            </Button>\n          )}\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <div className=\"inventory\">\n      <div className=\"inventory-header\">\n        <h1>Inventory Management</h1>\n        <div className=\"header-actions\">\n          <PrintButton\n            data={filteredProducts}\n            title=\"Inventory Report\"\n            type=\"inventory\"\n            printText=\"Print Inventory\"\n            className=\"print-inventory-btn\"\n          />\n          <Button onClick={handleAddProduct}>\n            Add Product\n          </Button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"error-message\">\n          {error}\n        </div>\n      )}\n\n      <div className=\"inventory-filters\">\n        <div className=\"filter-group\">\n          <label>Category:</label>\n          <select \n            value={filters.category} \n            onChange={(e) => handleFilterChange('category', e.target.value)}\n          >\n            <option value=\"\">All Categories</option>\n            {categories.map(category => (\n              <option key={category.id} value={category.id}>\n                {category.name}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div className=\"filter-group\">\n          <label>Stock Status:</label>\n          <select \n            value={filters.stockStatus} \n            onChange={(e) => handleFilterChange('stockStatus', e.target.value)}\n          >\n            <option value=\"\">All</option>\n            <option value=\"low\">Low Stock</option>\n            <option value=\"out\">Out of Stock</option>\n          </select>\n        </div>\n        <div className=\"filter-group\">\n          <label>Search:</label>\n          <input\n            type=\"text\"\n            placeholder=\"Search products...\"\n            value={filters.search}\n            onChange={(e) => handleFilterChange('search', e.target.value)}\n          />\n        </div>\n        <div className=\"filter-group\">\n          <Button variant=\"outline\" size=\"small\" onClick={clearFilters}>\n            Clear Filters\n          </Button>\n        </div>\n      </div>\n\n      <Table\n        data={products}\n        columns={columns}\n        loading={loading}\n        emptyMessage=\"No products found\"\n      />\n\n      {showAddModal && (\n        <ProductModal\n          product={editingProduct}\n          categories={categories}\n          taxClasses={taxClasses}\n          onClose={() => setShowAddModal(false)}\n          onSave={() => {\n            setShowAddModal(false);\n            fetchProducts(filters);\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\nconst ProductModal = ({ product, categories, taxClasses, onClose, onSave }) => {\n  const [formData, setFormData] = useState({\n    name: product?.name || '',\n    description: product?.description || '',\n    category: product?.category || '',\n    tax_class: product?.tax_class || '',\n    sku: product?.sku || '',\n    price: product?.price || '',\n    cost_price: product?.cost_price || '',\n    stock_quantity: product?.stock_quantity || 0,\n    min_stock_level: product?.min_stock_level || 10,\n    max_stock_level: product?.max_stock_level || 1000,\n    base_unit: product?.base_unit?.id || product?.base_unit || '',\n    is_active: product?.is_active ?? true\n  });\n  const [units, setUnits] = useState([]);\n  const [allUnits, setAllUnits] = useState([]);\n  const [compatibleUnits, setCompatibleUnits] = useState([]);\n  const [showUnitSelector, setShowUnitSelector] = useState(false);\n  const [convertibleUnits, setConvertibleUnits] = useState([]);\n\n  // Load base units when component mounts (for product creation/editing)\n  useEffect(() => {\n    const fetchUnits = async () => {\n      try {\n        const [baseUnitsResponse, allUnitsResponse] = await Promise.all([\n          api.get('/products/base-units/'),\n          api.get('/products/units/')\n        ]);\n        setUnits(baseUnitsResponse.data.results || baseUnitsResponse.data);\n        setAllUnits(allUnitsResponse.data.results || allUnitsResponse.data);\n      } catch (err) {\n        console.error('Failed to load units:', err);\n      }\n    };\n    fetchUnits();\n  }, []);\n\n  // Load compatible units when editing a product\n  useEffect(() => {\n    if (product && product.compatible_units) {\n      setCompatibleUnits(product.compatible_units);\n    } else {\n      setCompatibleUnits([]);\n    }\n  }, [product]);\n\n  // Fetch convertible units when base unit changes\n  useEffect(() => {\n    const fetchConvertibleUnits = async () => {\n      if (formData.base_unit) {\n        try {\n          // Get the product's available units which includes conversion information\n          if (product) {\n            const response = await api.get(`/products/${product.id}/`);\n            const productData = response.data;\n            if (productData.available_units) {\n              // Extract units that can be converted to/from the base unit\n              const convertible = productData.available_units\n                .filter(unit => unit.id !== parseInt(formData.base_unit))\n                .map(unit => ({\n                  id: unit.id,\n                  name: unit.name,\n                  symbol: unit.symbol,\n                  is_base_unit: unit.is_base_unit\n                }));\n              setConvertibleUnits(convertible);\n            }\n          } else {\n            // For new products, we need to check which units have conversions with the selected base unit\n            // We'll use a different approach - get all unit conversions and filter\n            const response = await api.get('/products/unit-conversions/');\n            const conversions = response.data.results || response.data;\n            \n            const baseUnitId = parseInt(formData.base_unit);\n            const convertible = [];\n            \n            // Find units that have conversions with the base unit\n            conversions.forEach(conversion => {\n              if (conversion.from_unit === baseUnitId && !convertible.find(u => u.id === conversion.to_unit)) {\n                // Find the unit details\n                const unit = allUnits.find(u => u.id === conversion.to_unit);\n                if (unit) {\n                  convertible.push({\n                    id: unit.id,\n                    name: unit.name,\n                    symbol: unit.symbol,\n                    is_base_unit: unit.is_base_unit\n                  });\n                }\n              } else if (conversion.to_unit === baseUnitId && !convertible.find(u => u.id === conversion.from_unit)) {\n                // Find the unit details\n                const unit = allUnits.find(u => u.id === conversion.from_unit);\n                if (unit) {\n                  convertible.push({\n                    id: unit.id,\n                    name: unit.name,\n                    symbol: unit.symbol,\n                    is_base_unit: unit.is_base_unit\n                  });\n                }\n              }\n            });\n            \n            setConvertibleUnits(convertible);\n          }\n        } catch (err) {\n          console.error('Failed to fetch convertible units:', err);\n          setConvertibleUnits([]);\n        }\n      } else {\n        setConvertibleUnits([]);\n      }\n    };\n\n    fetchConvertibleUnits();\n  }, [formData.base_unit, product, allUnits]);\n\n  // Update form data when product changes (for editing)\n  useEffect(() => {\n    if (product) {\n      setFormData({\n        name: product.name || '',\n        description: product.description || '',\n        category: product.category || '',\n        tax_class: product.tax_class || '',\n        sku: product.sku || '',\n        price: product.price || '',\n        cost_price: product.cost_price || '',\n        stock_quantity: product.stock_quantity || 0,\n        min_stock_level: product.min_stock_level || 10,\n        max_stock_level: product.max_stock_level || 1000,\n        base_unit: product.base_unit?.id || product.base_unit || '',\n        is_active: product.is_active ?? true\n      });\n    }\n  }, [product]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleChange = (e) => {\n    const { name, value, type, checked } = e.target;\n    setFormData({\n      ...formData,\n      [name]: type === 'checkbox' ? checked : value\n    });\n  };\n\n  const addCompatibleUnit = async (unitId) => {\n    if (!product) return;\n    \n    try {\n      const response = await api.post(`/products/${product.id}/units/`, {\n        unit: unitId,\n        is_default: false,\n        is_active: true\n      });\n      \n      setCompatibleUnits([...compatibleUnits, response.data]);\n      setShowUnitSelector(false);\n    } catch (err) {\n      console.error('Failed to add compatible unit:', err);\n    }\n  };\n\n  const removeCompatibleUnit = async (productUnitId) => {\n    if (!product) return;\n    \n    try {\n      await api.delete(`/products/${product.id}/units/${productUnitId}/`);\n      setCompatibleUnits(compatibleUnits.filter(cu => cu.id !== productUnitId));\n    } catch (err) {\n      console.error('Failed to remove compatible unit:', err);\n    }\n  };\n\n  const setDefaultUnit = async (productUnitId) => {\n    if (!product) return;\n    \n    try {\n      // First, set all units to non-default\n      for (const cu of compatibleUnits) {\n        if (cu.is_default) {\n          await api.put(`/products/${product.id}/units/${cu.id}/`, {\n            ...cu,\n            is_default: false\n          });\n        }\n      }\n      \n      // Then set the selected unit as default\n      const unitToUpdate = compatibleUnits.find(cu => cu.id === productUnitId);\n      if (unitToUpdate) {\n        await api.put(`/products/${product.id}/units/${productUnitId}/`, {\n          ...unitToUpdate,\n          is_default: true\n        });\n        \n        // Update local state\n        setCompatibleUnits(compatibleUnits.map(cu => ({\n          ...cu,\n          is_default: cu.id === productUnitId\n        })));\n      }\n    } catch (err) {\n      console.error('Failed to set default unit:', err);\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n\n    try {\n      // Prepare data for submission\n      const submitData = {\n        ...formData,\n        base_unit: formData.base_unit ? parseInt(formData.base_unit) : null\n      };\n\n      if (product) {\n        await api.put(`/products/${product.id}/`, submitData);\n      } else {\n        await api.post('/products/', submitData);\n      }\n      onSave();\n    } catch (err) {\n      setError(err.response?.data?.detail || 'Failed to save product');\n      console.error('Save error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal\">\n        <div className=\"modal-header\">\n          <h2>{product ? 'Edit Product' : 'Add Product'}</h2>\n          <button className=\"modal-close\" onClick={onClose}>×</button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"modal-form\">\n          {error && (\n            <div className=\"error-message\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Product Name *</label>\n              <input\n                type=\"text\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                required\n              />\n            </div>\n            <div className=\"form-group\">\n              <label>SKU *</label>\n              <input\n                type=\"text\"\n                name=\"sku\"\n                value={formData.sku}\n                onChange={handleChange}\n                required\n              />\n            </div>\n          </div>\n\n          <div className=\"form-group\">\n            <label>Description</label>\n            <textarea\n              name=\"description\"\n              value={formData.description}\n              onChange={handleChange}\n              rows=\"3\"\n            />\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Category *</label>\n              <select\n                name=\"category\"\n                value={formData.category}\n                onChange={handleChange}\n                required\n              >\n                <option value=\"\">Select Category</option>\n                {categories.map(category => (\n                  <option key={category.id} value={category.id}>\n                    {category.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n            <div className=\"form-group\">\n              <label>Tax Class</label>\n              <select\n                name=\"tax_class\"\n                value={formData.tax_class}\n                onChange={handleChange}\n              >\n                <option value=\"\">No Tax Class</option>\n                {taxClasses.map(taxClass => (\n                  <option key={taxClass.id} value={taxClass.id}>\n                    {taxClass.name} ({taxClass.tax_rate}%)\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Base Unit</label>\n              <select\n                name=\"base_unit\"\n                value={formData.base_unit}\n                onChange={handleChange}\n                required\n              >\n                <option value=\"\">Select Base Unit</option>\n                {units.map(unit => (\n                  <option key={unit.id} value={unit.id}>\n                    {unit.name} ({unit.symbol})\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          {/* Compatible Units Section - Only show when editing existing product */}\n          {product && (\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Compatible Units</label>\n                <p className=\"compatible-units-note\">\n                  Only units that can be converted to/from the base unit can be added as compatible units.\n                </p>\n                <div className=\"compatible-units-section\">\n                  {compatibleUnits.length > 0 ? (\n                    <div className=\"compatible-units-list\">\n                      {compatibleUnits.map(compatibleUnit => (\n                        <div key={compatibleUnit.id} className=\"compatible-unit-item\">\n                          <div className=\"unit-info\">\n                            <span className=\"unit-name\">\n                              {compatibleUnit.unit_name} ({compatibleUnit.unit_symbol})\n                            </span>\n                            {compatibleUnit.is_default && (\n                              <span className=\"default-badge\">Default</span>\n                            )}\n                          </div>\n                          <div className=\"unit-actions\">\n                            {!compatibleUnit.is_default && (\n                              <Button\n                                size=\"small\"\n                                variant=\"outline\"\n                                onClick={() => setDefaultUnit(compatibleUnit.id)}\n                              >\n                                Set Default\n                              </Button>\n                            )}\n                            <Button\n                              size=\"small\"\n                              variant=\"danger\"\n                              onClick={() => removeCompatibleUnit(compatibleUnit.id)}\n                            >\n                              Remove\n                            </Button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"no-units-message\">No compatible units added yet.</p>\n                  )}\n                  \n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => setShowUnitSelector(true)}\n                    className=\"add-unit-button\"\n                    disabled={!formData.base_unit || convertibleUnits.length === 0}\n                  >\n                    + Add Compatible Unit\n                    {!formData.base_unit && \" (Select base unit first)\"}\n                    {formData.base_unit && convertibleUnits.length === 0 && \" (No convertible units)\"}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Price *</label>\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                name=\"price\"\n                value={formData.price}\n                onChange={handleChange}\n                required\n              />\n            </div>\n            <div className=\"form-group\">\n              <label>Cost Price</label>\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                name=\"cost_price\"\n                value={formData.cost_price}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label>Stock Quantity</label>\n              <input\n                type=\"number\"\n                name=\"stock_quantity\"\n                value={formData.stock_quantity}\n                onChange={handleChange}\n              />\n            </div>\n            <div className=\"form-group\">\n              <label>Min Stock Level</label>\n              <input\n                type=\"number\"\n                name=\"min_stock_level\"\n                value={formData.min_stock_level}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n\n          <div className=\"form-group\">\n            <label>Max Stock Level</label>\n            <input\n              type=\"number\"\n              name=\"max_stock_level\"\n              value={formData.max_stock_level}\n              onChange={handleChange}\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label>\n              <input\n                type=\"checkbox\"\n                name=\"is_active\"\n                checked={formData.is_active}\n                onChange={handleChange}\n              />\n              Active\n            </label>\n          </div>\n\n          <div className=\"modal-actions\">\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n            <Button type=\"submit\" loading={loading}>\n              {product ? 'Update' : 'Create'}\n            </Button>\n          </div>\n        </form>\n      </div>\n\n      {/* Unit Selector Modal */}\n      {showUnitSelector && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal-content unit-selector-modal\">\n            <div className=\"modal-header\">\n              <h3>Add Compatible Unit</h3>\n              <button \n                className=\"modal-close\" \n                onClick={() => setShowUnitSelector(false)}\n              >\n                ×\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <p>Select a unit to add as compatible for this product:</p>\n              <p className=\"unit-selector-note\">\n                Only units that can be converted to/from the base unit are shown.\n              </p>\n              <div className=\"unit-selector-list\">\n                {convertibleUnits\n                  .filter(unit => \n                    !compatibleUnits.some(cu => cu.unit === unit.id)\n                  )\n                  .map(unit => (\n                    <div \n                      key={unit.id} \n                      className=\"unit-selector-item\"\n                      onClick={() => addCompatibleUnit(unit.id)}\n                    >\n                      <div className=\"unit-info\">\n                        <span className=\"unit-name\">{unit.name}</span>\n                        <span className=\"unit-symbol\">({unit.symbol})</span>\n                        {unit.is_base_unit && (\n                          <span className=\"base-unit-badge\">Base Unit</span>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                }\n                {convertibleUnits.filter(unit => \n                  !compatibleUnits.some(cu => cu.unit === unit.id)\n                ).length === 0 && (\n                  <p className=\"no-units-available\">\n                    {formData.base_unit \n                      ? \"No convertible units available for the selected base unit.\" \n                      : \"Please select a base unit first.\"\n                    }\n                  </p>\n                )}\n              </div>\n            </div>\n            <div className=\"modal-actions\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => setShowUnitSelector(false)}\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Inventory;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}