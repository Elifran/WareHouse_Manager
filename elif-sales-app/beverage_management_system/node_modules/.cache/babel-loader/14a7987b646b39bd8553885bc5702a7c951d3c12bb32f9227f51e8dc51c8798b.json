{"ast":null,"code":"import _objectSpread from\"/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo,useCallback}from'react';import{useTranslation}from'react-i18next';import api from'../services/api';import{usePendingSales}from'../hooks/useSales';import Button from'../components/Button';import PrintButton from'../components/PrintButton';import{formatCurrency,formatDate}from'../utils/helpers';import{useAuth}from'../contexts/AuthContext';import PackagingValidation from'./PackagingValidation';import'./PendingSales.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PendingSales=()=>{var _selectedSale$payment,_selectedSale$items,_selectedSale$items2,_selectedSale$items3,_stockValidationStatu6,_stockValidationStatu7,_stockValidationStatu8,_editFormData$items2,_editFormData$items3;const{t}=useTranslation();const{user,loading:authLoading}=useAuth();const[pendingSales,setPendingSales]=useState([]);const[loading,setLoading]=useState(true);const[showSaleModal,setShowSaleModal]=useState(false);const[selectedSale,setSelectedSale]=useState(null);const[showEditModal,setShowEditModal]=useState(false);const[editingSale,setEditingSale]=useState(null);const[editFormData,setEditFormData]=useState({});const[editTotals,setEditTotals]=useState({subtotal:0,total_amount:0});const[completingSale,setCompletingSale]=useState(null);const[stockValidationStatus,setStockValidationStatus]=useState({});const[paymentType,setPaymentType]=useState('full');const[paidAmount,setPaidAmount]=useState(0);const[showPackagingValidation,setShowPackagingValidation]=useState(false);const[packagingValidationSaleId,setPackagingValidationSaleId]=useState(null);// React Query hook for pending sales with caching\nconst{data:pendingSalesData=[],isLoading:pendingSalesLoading,error:pendingSalesError,refetch:refetchPendingSales}=usePendingSales();// Update state from query data\nuseEffect(()=>{if(pendingSalesData){setPendingSales(pendingSalesData);}},[pendingSalesData]);useEffect(()=>{setLoading(pendingSalesLoading);},[pendingSalesLoading]);useEffect(()=>{if(pendingSalesError){var _pendingSalesError$re;if(((_pendingSalesError$re=pendingSalesError.response)===null||_pendingSalesError$re===void 0?void 0:_pendingSalesError$re.status)===401){alert('Authentication required. Please log in again.');window.location.href='/login';}else{var _pendingSalesError$re2,_pendingSalesError$re3;alert('Error fetching pending sales: '+(((_pendingSalesError$re2=pendingSalesError.response)===null||_pendingSalesError$re2===void 0?void 0:(_pendingSalesError$re3=_pendingSalesError$re2.data)===null||_pendingSalesError$re3===void 0?void 0:_pendingSalesError$re3.detail)||pendingSalesError.message));}}},[pendingSalesError]);useEffect(()=>{setLoading(pendingSalesLoading);},[pendingSalesLoading]);useEffect(()=>{if(pendingSalesError){var _pendingSalesError$re4;if(((_pendingSalesError$re4=pendingSalesError.response)===null||_pendingSalesError$re4===void 0?void 0:_pendingSalesError$re4.status)===401){alert('Authentication required. Please log in again.');window.location.href='/login';}else{var _pendingSalesError$re5,_pendingSalesError$re6;alert('Error fetching pending sales: '+(((_pendingSalesError$re5=pendingSalesError.response)===null||_pendingSalesError$re5===void 0?void 0:(_pendingSalesError$re6=_pendingSalesError$re5.data)===null||_pendingSalesError$re6===void 0?void 0:_pendingSalesError$re6.detail)||pendingSalesError.message));}}},[pendingSalesError]);// Fix N+1 query problem: Use bulk endpoint instead of individual calls\nconst validateStockForAllSales=useCallback(async()=>{try{// Collect all unique product IDs from all sales\nconst productIds=new Set();pendingSales.forEach(sale=>{var _sale$items;(_sale$items=sale.items)===null||_sale$items===void 0?void 0:_sale$items.forEach(item=>{if(item.product){productIds.add(item.product);}});});if(productIds.size===0){setStockValidationStatus({});return;}// Single API call to get stock for all products\nconst response=await api.post('/api/products/bulk-stock-availability/',{product_ids:Array.from(productIds)});const stockData=response.data||{};const validationStatus={};// Validate each sale using the bulk stock data\nfor(const sale of pendingSales){let hasInsufficientStock=false;const itemStatuses={};for(let i=0;i<(sale.items||[]).length;i++){const item=sale.items[i];// Backend returns data keyed by product ID (as number or string)\nconst productId=item.product;const productStock=stockData[productId]||stockData[String(productId)]||stockData[Number(productId)];let availableQty=null;if(productStock&&productStock.available_units){const unitData=productStock.available_units.find(unit=>unit.id===item.unit);if(unitData){availableQty=unitData.available_quantity;if(availableQty<(item.quantity_display||item.quantity||0)){hasInsufficientStock=true;}}}// Save per-item status keyed by item index (stable within this sale render)\nitemStatuses[i]={sufficient:availableQty===null?null:availableQty>=(item.quantity_display||item.quantity||0),required:item.quantity_display||item.quantity||0,available:availableQty};}validationStatus[sale.id]={hasInsufficientStock,itemStatuses};}setStockValidationStatus(validationStatus);}catch(error){console.error('Error validating stock:',error);// Fallback: mark all as having insufficient stock if validation fails\nconst validationStatus={};pendingSales.forEach(sale=>{validationStatus[sale.id]={hasInsufficientStock:true};});setStockValidationStatus(validationStatus);}},[pendingSales]);useEffect(()=>{if(pendingSales.length>0){validateStockForAllSales();}},[pendingSales,validateStockForAllSales]);const completeSale=async saleId=>{try{var _sale$items2;setCompletingSale(saleId);// Check if sale has items with packaging that need validation\nconst sale=pendingSales.find(s=>s.id===saleId);const hasPackagingItems=(_sale$items2=sale.items)===null||_sale$items2===void 0?void 0:_sale$items2.some(item=>item.product_has_packaging);if(hasPackagingItems){// Show packaging validation page\nsetPackagingValidationSaleId(saleId);setShowPackagingValidation(true);setCompletingSale(null);return;}// Proceed with normal completion if no packaging items\nawait performSaleCompletion(saleId);}catch(error){var _error$response,_error$response$data;console.error('Error completing sale:',error);alert('Error completing sale: '+(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||error.message));setCompletingSale(null);}};const performSaleCompletion=async saleId=>{try{// Check stock before completing\nconst sale=pendingSales.find(s=>s.id===saleId);const stockValidationErrors=[];for(const item of sale.items||[]){try{const response=await api.get(\"/api/products/\".concat(item.product,\"/stock-availability/\"));const stockData=response.data;if(stockData.available_units){const unitData=stockData.available_units.find(unit=>unit.id===item.unit);if(unitData&&unitData.available_quantity<item.quantity_display){stockValidationErrors.push(\"\".concat(item.product_name,\": Required \").concat(item.quantity_display,\" \").concat(item.unit_name,\", but only \").concat(unitData.available_quantity,\" available\"));}}}catch(error){console.error(\"Error checking stock for product \".concat(item.product,\":\"),error);stockValidationErrors.push(\"\".concat(item.product_name,\": Unable to check stock availability\"));}}if(stockValidationErrors.length>0){alert('Cannot complete sale due to insufficient stock:\\n'+stockValidationErrors.join('\\n'));return;}await api.post(\"/api/sales/\".concat(saleId,\"/complete/\"));// Print receipt after successful completion using PrintButton logic\nconst completedSale=_objectSpread(_objectSpread({},sale),{},{status:'completed'});// Remove from pending sales list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale completed successfully!');}catch(error){var _error$response2,_error$response2$data;console.error('Error completing sale:',error);alert('Error completing sale: '+(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||error.message));}finally{setCompletingSale(null);}};const handlePackagingValidationComplete=async()=>{try{await performSaleCompletion(packagingValidationSaleId);setShowPackagingValidation(false);setPackagingValidationSaleId(null);}catch(error){console.error('Error completing sale after packaging validation:',error);}};const handlePackagingValidationCancel=()=>{setShowPackagingValidation(false);setPackagingValidationSaleId(null);setCompletingSale(null);};const cancelSale=async saleId=>{if(window.confirm('Are you sure you want to cancel this sale?')){try{await api.delete(\"/api/sales/\".concat(saleId,\"/\"));setPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale cancelled successfully!');}catch(error){var _error$response3,_error$response3$data;console.error('Error cancelling sale:',error);alert('Error cancelling sale: '+(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.detail)||error.message));}}};// Prepare print data for PrintButton component (consistent with POS logic)\nconst preparePrintData=sale=>{var _sale$items3;return{sale_number:sale.sale_number,customer_name:sale.customer_name||'Walk-in Customer',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',user_name:(user===null||user===void 0?void 0:user.username)||t('app.unknown_user'),user_id:(user===null||user===void 0?void 0:user.id)||'unknown',created_at:sale.created_at,print_timestamp:new Date().toISOString(),print_id:\"PRINT-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9)),status:sale.status==='completed'?'completed':'pending',payment_status:sale.payment_status||'pending',payment_method:sale.payment_method||'cash',total_amount:sale.total_amount||sale.subtotal,paid_amount:sale.paid_amount||0,remaining_amount:sale.remaining_amount||parseFloat(sale.total_amount||sale.subtotal)-parseFloat(sale.paid_amount||0),due_date:sale.due_date||null,subtotal:sale.subtotal,discount_amount:sale.discount_amount||0,tax_amount:sale.tax_amount||0,created_by_name:sale.created_by_name,items:((_sale$items3=sale.items)===null||_sale$items3===void 0?void 0:_sale$items3.map(item=>({product_name:item.product_name,product_sku:item.product_sku,quantity:item.quantity,quantity_display:item.quantity_display,unit_name:item.unit_name,unit_price:item.unit_price,total_price:item.total_price})))||[]};};const editSale=sale=>{var _sale$items4;setEditingSale(sale);// Initialize items with proper quantities and calculate totals\nconst items=((_sale$items4=sale.items)===null||_sale$items4===void 0?void 0:_sale$items4.map(item=>{const quantity=parseFloat(item.quantity_display||item.quantity)||0;const unitPrice=parseFloat(item.unit_price)||0;const calculatedTotalPrice=quantity*unitPrice;return _objectSpread(_objectSpread({},item),{},{quantity:quantity,unit_price:unitPrice,total_price:calculatedTotalPrice});}))||[];// Calculate initial totals based on current item data\nconst calculatedSubtotal=items.reduce((sum,item)=>sum+item.total_price,0);// If no tax_amount is provided, assume 0% tax (common for many sales)\nconst taxAmount=parseFloat(sale.tax_amount||0)||0;const discountAmount=parseFloat(sale.discount_amount||0)||0;const calculatedTotal=calculatedSubtotal+taxAmount-discountAmount;// Always use calculated totals to ensure accuracy\nconst subtotal=calculatedSubtotal;const total_amount=calculatedTotal;const formData={customer_name:sale.customer_name||'',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',payment_method:sale.payment_method||'cash',items:items,subtotal:subtotal,total_amount:total_amount,tax_amount:sale.tax_amount||0,discount_amount:sale.discount_amount||0};setEditFormData(formData);setEditTotals({subtotal:subtotal,total_amount:total_amount});// Initialize payment options\nconst currentPaidAmount=parseFloat(sale.paid_amount)||0;const calculatedTotalAmount=total_amount;// Use the calculated total from form data\nif(currentPaidAmount>=calculatedTotalAmount){setPaymentType('full');setPaidAmount(calculatedTotalAmount);}else if(currentPaidAmount>0){setPaymentType('partial');setPaidAmount(currentPaidAmount);}else{setPaymentType('full');setPaidAmount(calculatedTotalAmount);}setShowEditModal(true);setShowSaleModal(false);};const handleEditItemQuantity=(itemIndex,newQuantity)=>{if(!editFormData.items||!Array.isArray(editFormData.items)){console.error('editFormData.items is not properly initialized:',editFormData);return;}const updatedItems=[...editFormData.items];updatedItems[itemIndex].quantity=parseFloat(newQuantity)||0;updatedItems[itemIndex].total_price=updatedItems[itemIndex].quantity*parseFloat(updatedItems[itemIndex].unit_price)||0;const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal}));// Fallback to original sale values if editFormData doesn't have them\nconst taxAmount=parseFloat(editFormData.tax_amount!==undefined?editFormData.tax_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.tax_amount)||0)||0;const discountAmount=parseFloat(editFormData.discount_amount!==undefined?editFormData.discount_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.discount_amount)||0)||0;const newTotalAmount=subtotal+taxAmount-discountAmount;setEditTotals({subtotal:subtotal,taxAmount:taxAmount,discountAmount:discountAmount,newTotalAmount:newTotalAmount,editFormDataTax:editFormData.tax_amount,editFormDataDiscount:editFormData.discount_amount});const newEditFormData=_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:newTotalAmount});setEditFormData(newEditFormData);setEditTotals({subtotal:subtotal,total_amount:newTotalAmount});// Force a re-render by logging the state after setting it\nsetTimeout(()=>{},100);};const removeEditItem=itemIndex=>{const updatedItems=editFormData.items.filter((_,index)=>index!==itemIndex);const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);// Fallback to original sale values if editFormData doesn't have them\nconst taxAmount=parseFloat(editFormData.tax_amount!==undefined?editFormData.tax_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.tax_amount)||0)||0;const discountAmount=parseFloat(editFormData.discount_amount!==undefined?editFormData.discount_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.discount_amount)||0)||0;const newTotalAmount=subtotal+taxAmount-discountAmount;setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:newTotalAmount}));setEditTotals({subtotal:subtotal,total_amount:newTotalAmount});};const calculateEditTotal=()=>{var _editFormData$items;return((_editFormData$items=editFormData.items)===null||_editFormData$items===void 0?void 0:_editFormData$items.reduce((total,item)=>{return total+parseFloat(item.total_price||0);},0))||0;};// Update paid amount when payment type changes or subtotal changes\nuseEffect(()=>{if(paymentType==='full'){setPaidAmount(editTotals.subtotal||0);}},[paymentType,editTotals.subtotal]);const saveEditedSale=async()=>{try{const updateData={customer_name:editFormData.customer_name,customer_phone:editFormData.customer_phone,customer_email:editFormData.customer_email,payment_method:editFormData.payment_method,paid_amount:paidAmount,items:editFormData.items.map(item=>({id:item.id,product:item.product,unit:item.unit,quantity:item.quantity,unit_price:item.unit_price,price_mode:item.price_mode}))};console.log('Saving edited sale:',{saleId:editingSale.id,updateData:updateData,editFormData:editFormData});const response=await api.put(\"/api/sales/\".concat(editingSale.id,\"/edit/\"),updateData);setShowEditModal(false);setEditingSale(null);setEditFormData({});// Refresh the pending sales list\nrefetchPendingSales();alert('Sale updated successfully!');}catch(error){var _error$response4,_error$response4$data;console.error('Error updating sale:',error);alert('Error updating sale: '+(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.detail)||error.message));}};if(authLoading||loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')})}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"Loading pending sales...\"})]});}if(!user){return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')})}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"Please log in to view pending sales.\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage and validate pending sales before completion\"})]}),pendingSales.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-pending-sales\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"no-sales-icon\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{children:t('titles.no_pending_sales')}),/*#__PURE__*/_jsx(\"p\",{children:\"All sales have been completed or there are no pending sales at the moment.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales-grid\",children:pendingSales.map(sale=>{var _sale$items5,_sale$items6,_sale$items7,_stockValidationStatu,_stockValidationStatu2,_stockValidationStatu3;return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sale-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sale-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sale-number\",children:sale.sale_number}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-date\",children:formatDate(sale.created_at)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-customer\",children:/*#__PURE__*/_jsx(\"strong\",{children:sale.customer_name||'Walk-in Customer'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-items\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"items-count\",children:[((_sale$items5=sale.items)===null||_sale$items5===void 0?void 0:_sale$items5.length)||0,\" items\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-preview\",children:[(_sale$items6=sale.items)===null||_sale$items6===void 0?void 0:_sale$items6.slice(0,3).map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-preview\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-quantity\",children:[item.quantity_display||item.quantity,\" \",item.unit_name]}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]},index)),((_sale$items7=sale.items)===null||_sale$items7===void 0?void 0:_sale$items7.length)>3&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-items\",children:[\"+\",sale.items.length-3,\" more items\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-total\",children:/*#__PURE__*/_jsx(\"strong\",{children:formatCurrency(sale.total_amount)})}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu=stockValidationStatus[sale.id])!==null&&_stockValidationStatu!==void 0&&_stockValidationStatu.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-actions\",children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:async()=>{try{// Fetch complete sale data including items\nconst response=await api.get(\"/api/sales/\".concat(sale.id,\"/\"));setSelectedSale(response.data);setShowSaleModal(true);}catch(error){console.error('Error fetching sale details:',error);// Fallback to using the sale data from the list\nsetSelectedSale(sale);setShowSaleModal(true);}},children:\"View Details\"}),/*#__PURE__*/_jsx(PrintButton,{data:preparePrintData(sale),title:t('titles.sale_receipt'),type:\"sale\",printText:\"\\uD83D\\uDDA8\\uFE0F Print\",className:\"print-sale-btn\",variant:\"outline\",size:\"small\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>editSale(sale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"primary\",disabled:(_stockValidationStatu2=stockValidationStatus[sale.id])===null||_stockValidationStatu2===void 0?void 0:_stockValidationStatu2.hasInsufficientStock,onClick:()=>completeSale(sale.id),loading:completingSale===sale.id,children:(_stockValidationStatu3=stockValidationStatus[sale.id])!==null&&_stockValidationStatu3!==void 0&&_stockValidationStatu3.hasInsufficientStock?t('buttons.insufficient_stock'):t('buttons.complete_sale')})]})]},sale.id);})}),showSaleModal&&selectedSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal sale-details-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Sale Details - \",selectedSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_phone||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_email||'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sale Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:formatDate(selectedSale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Payment Method:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:(_selectedSale$payment=selectedSale.payment_method)===null||_selectedSale$payment===void 0?void 0:_selectedSale$payment.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_selectedSale$items=selectedSale.items)===null||_selectedSale$items===void 0?void 0:_selectedSale$items.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-container\",style:{minHeight:\"\".concat(Math.max(200,(((_selectedSale$items2=selectedSale.items)===null||_selectedSale$items2===void 0?void 0:_selectedSale$items2.length)||0)*120),\"px\"),maxHeight:'500px'},children:(_selectedSale$items3=selectedSale.items)===null||_selectedSale$items3===void 0?void 0:_selectedSale$items3.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-card\",style:{marginBottom:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-quantity\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"quantity\",children:item.quantity_display||item.quantity||'N/A'}),/*#__PURE__*/_jsx(\"span\",{className:\"unit\",children:item.unit_name||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"unit-price\",children:[item.unit_price?formatCurrency(item.unit_price):'N/A',\" each\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"total-price\",children:item.total_price?formatCurrency(item.total_price):'N/A'})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-stock-status\",children:((_stockValidationStatu4,_stockValidationStatu5,_status$available)=>{const status=(_stockValidationStatu4=stockValidationStatus[selectedSale.id])===null||_stockValidationStatu4===void 0?void 0:(_stockValidationStatu5=_stockValidationStatu4.itemStatuses)===null||_stockValidationStatu5===void 0?void 0:_stockValidationStatu5[index];if(!status){return/*#__PURE__*/_jsx(\"div\",{className:\"stock-unknown\",children:\"\\u2139\\uFE0F Availability unknown\"});}if(status.sufficient===null){return/*#__PURE__*/_jsx(\"div\",{className:\"stock-unknown\",children:\"\\u2139\\uFE0F Availability unknown\"});}if(status.sufficient){return/*#__PURE__*/_jsxs(\"div\",{className:\"stock-sufficient\",children:[\"\\u2705 (\",status.available,\")\"]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"stock-insufficient\",children:[\"\\u26A0\\uFE0F (rq \",status.required,\", av \",(_status$available=status.available)!==null&&_status$available!==void 0?_status$available:0,\")\"]});})()})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.subtotal)})]}),selectedSale.discount_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Discount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[\"-\",formatCurrency(selectedSale.discount_amount)]})]}),selectedSale.tax_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Tax:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.tax_amount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.total_amount)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stock-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Stock Status\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu6=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu6!==void 0&&_stockValidationStatu6.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"Close\"}),/*#__PURE__*/_jsx(PrintButton,{data:preparePrintData(selectedSale),title:t('titles.sale_receipt'),type:\"sale\",printText:\"\\uD83D\\uDDA8\\uFE0F Print Receipt\",className:\"print-sale-btn\",variant:\"secondary\"}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>editSale(selectedSale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",disabled:(_stockValidationStatu7=stockValidationStatus[selectedSale.id])===null||_stockValidationStatu7===void 0?void 0:_stockValidationStatu7.hasInsufficientStock,onClick:()=>completeSale(selectedSale.id),children:(_stockValidationStatu8=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu8!==void 0&&_stockValidationStatu8.hasInsufficientStock?t('buttons.insufficient_stock'):t('buttons.complete_sale')})]})]})}),showEditModal&&editingSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal edit-sale-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Edit Sale - \",editingSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_name||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_name:e.target.value})),placeholder:t('forms.customer_name')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_phone||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_phone:e.target.value})),placeholder:t('forms.phone_number')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:editFormData.customer_email||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_email:e.target.value})),placeholder:t('forms.email_address')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:editFormData.payment_method||'cash',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{payment_method:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"card\",children:\"Card\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mobile_money\",children:\"Mobile Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_transfer\",children:\"Bank Transfer\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Payment Type\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-types\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"payment-type\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"paymentType\",value:\"full\",checked:paymentType==='full',onChange:e=>setPaymentType(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"Full Payment (100%)\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"payment-type\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"paymentType\",value:\"partial\",checked:paymentType==='partial',onChange:e=>setPaymentType(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"Partial Payment (0-99.99%)\"})]})]}),paymentType==='partial'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount to Pay\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",min:\"0\",max:editTotals.subtotal||0,value:paidAmount||0,onChange:e=>{const value=parseFloat(e.target.value)||0;setPaidAmount(value);},placeholder:t('forms.enter_amount_to_pay')}),/*#__PURE__*/_jsxs(\"small\",{children:[\"Total: \",formatCurrency(editTotals.subtotal||0),\" | Remaining: \",formatCurrency((editTotals.subtotal||0)-(paidAmount||0))]})]}),paymentType==='full'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount to Pay\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:editTotals.subtotal||0,readOnly:true,className:\"form-control\"}),/*#__PURE__*/_jsx(\"small\",{children:\"Full payment for the total amount.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_editFormData$items2=editFormData.items)===null||_editFormData$items2===void 0?void 0:_editFormData$items2.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-edit-container\",children:(_editFormData$items3=editFormData.items)===null||_editFormData$items3===void 0?void 0:_editFormData$items3.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"edit-item-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-unit\",children:item.unit_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[formatCurrency(item.unit_price),\" each\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Quantity:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.01\",value:item.quantity,onChange:e=>handleEditItemQuantity(index,e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price Mode:\"}),/*#__PURE__*/_jsxs(\"select\",{value:item.price_mode,disabled:true,style:{backgroundColor:'#f5f5f5',color:'#666'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"standard\",children:\"Standard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"wholesale\",children:\"Wholesale\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-total\",children:formatCurrency(item.total_price)}),/*#__PURE__*/_jsx(\"div\",{className:\"item-actions\",children:/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>removeEditItem(index),children:\"Remove\"})})]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(editTotals.subtotal||0)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(editTotals.total_amount||0)})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:saveEditedSale,children:\"Save Changes\"})]})]})}),showPackagingValidation&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-content packaging-validation-modal\",children:/*#__PURE__*/_jsx(PackagingValidation,{saleId:packagingValidationSaleId,onComplete:handlePackagingValidationComplete,onCancel:handlePackagingValidationCancel})})})]});};export default PendingSales;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","useTranslation","api","usePendingSales","Button","PrintButton","formatCurrency","formatDate","useAuth","PackagingValidation","jsx","_jsx","jsxs","_jsxs","PendingSales","_selectedSale$payment","_selectedSale$items","_selectedSale$items2","_selectedSale$items3","_stockValidationStatu6","_stockValidationStatu7","_stockValidationStatu8","_editFormData$items2","_editFormData$items3","t","user","loading","authLoading","pendingSales","setPendingSales","setLoading","showSaleModal","setShowSaleModal","selectedSale","setSelectedSale","showEditModal","setShowEditModal","editingSale","setEditingSale","editFormData","setEditFormData","editTotals","setEditTotals","subtotal","total_amount","completingSale","setCompletingSale","stockValidationStatus","setStockValidationStatus","paymentType","setPaymentType","paidAmount","setPaidAmount","showPackagingValidation","setShowPackagingValidation","packagingValidationSaleId","setPackagingValidationSaleId","data","pendingSalesData","isLoading","pendingSalesLoading","error","pendingSalesError","refetch","refetchPendingSales","_pendingSalesError$re","response","status","alert","window","location","href","_pendingSalesError$re2","_pendingSalesError$re3","detail","message","_pendingSalesError$re4","_pendingSalesError$re5","_pendingSalesError$re6","validateStockForAllSales","productIds","Set","forEach","sale","_sale$items","items","item","product","add","size","post","product_ids","Array","from","stockData","validationStatus","hasInsufficientStock","itemStatuses","i","length","productId","productStock","String","Number","availableQty","available_units","unitData","find","unit","id","available_quantity","quantity_display","quantity","sufficient","required","available","console","completeSale","saleId","_sale$items2","s","hasPackagingItems","some","product_has_packaging","performSaleCompletion","_error$response","_error$response$data","stockValidationErrors","get","concat","push","product_name","unit_name","join","completedSale","_objectSpread","prev","filter","_error$response2","_error$response2$data","handlePackagingValidationComplete","handlePackagingValidationCancel","cancelSale","confirm","delete","_error$response3","_error$response3$data","preparePrintData","_sale$items3","sale_number","customer_name","customer_phone","customer_email","user_name","username","user_id","created_at","print_timestamp","Date","toISOString","print_id","now","Math","random","toString","substr","payment_status","payment_method","paid_amount","remaining_amount","parseFloat","due_date","discount_amount","tax_amount","created_by_name","map","product_sku","unit_price","total_price","editSale","_sale$items4","unitPrice","calculatedTotalPrice","calculatedSubtotal","reduce","sum","taxAmount","discountAmount","calculatedTotal","formData","currentPaidAmount","calculatedTotalAmount","handleEditItemQuantity","itemIndex","newQuantity","isArray","updatedItems","undefined","newTotalAmount","editFormDataTax","editFormDataDiscount","newEditFormData","setTimeout","removeEditItem","_","index","calculateEditTotal","_editFormData$items","total","saveEditedSale","updateData","price_mode","log","put","_error$response4","_error$response4$data","className","children","_sale$items5","_sale$items6","_sale$items7","_stockValidationStatu","_stockValidationStatu2","_stockValidationStatu3","slice","variant","onClick","title","type","printText","disabled","replace","toUpperCase","style","minHeight","max","maxHeight","marginBottom","_stockValidationStatu4","_stockValidationStatu5","_status$available","value","onChange","e","target","placeholder","name","checked","step","min","readOnly","backgroundColor","color","onComplete","onCancel"],"sources":["/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/src/pages/PendingSales.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport api from '../services/api';\nimport { usePendingSales } from '../hooks/useSales';\nimport Button from '../components/Button';\nimport PrintButton from '../components/PrintButton';\nimport { formatCurrency, formatDate } from '../utils/helpers';\nimport { useAuth } from '../contexts/AuthContext';\nimport PackagingValidation from './PackagingValidation';\nimport './PendingSales.css';\n\nconst PendingSales = () => {\n  const { t } = useTranslation();\n  const { user, loading: authLoading } = useAuth();\n  const [pendingSales, setPendingSales] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showSaleModal, setShowSaleModal] = useState(false);\n  const [selectedSale, setSelectedSale] = useState(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editingSale, setEditingSale] = useState(null);\n  const [editFormData, setEditFormData] = useState({});\n  const [editTotals, setEditTotals] = useState({ subtotal: 0, total_amount: 0 });\n  const [completingSale, setCompletingSale] = useState(null);\n  const [stockValidationStatus, setStockValidationStatus] = useState({});\n  const [paymentType, setPaymentType] = useState('full');\n  const [paidAmount, setPaidAmount] = useState(0);\n  const [showPackagingValidation, setShowPackagingValidation] = useState(false);\n  const [packagingValidationSaleId, setPackagingValidationSaleId] = useState(null);\n\n  // React Query hook for pending sales with caching\n  const { data: pendingSalesData = [], isLoading: pendingSalesLoading, error: pendingSalesError, refetch: refetchPendingSales } = usePendingSales();\n\n  // Update state from query data\n  useEffect(() => {\n    if (pendingSalesData) {\n      setPendingSales(pendingSalesData);\n    }\n  }, [pendingSalesData]);\n\n  useEffect(() => {\n    setLoading(pendingSalesLoading);\n  }, [pendingSalesLoading]);\n\n  useEffect(() => {\n    if (pendingSalesError) {\n      if (pendingSalesError.response?.status === 401) {\n        alert('Authentication required. Please log in again.');\n        window.location.href = '/login';\n      } else {\n        alert('Error fetching pending sales: ' + (pendingSalesError.response?.data?.detail || pendingSalesError.message));\n      }\n    }\n  }, [pendingSalesError]);\n\n  useEffect(() => {\n    setLoading(pendingSalesLoading);\n  }, [pendingSalesLoading]);\n\n  useEffect(() => {\n    if (pendingSalesError) {\n      if (pendingSalesError.response?.status === 401) {\n        alert('Authentication required. Please log in again.');\n        window.location.href = '/login';\n      } else {\n        alert('Error fetching pending sales: ' + (pendingSalesError.response?.data?.detail || pendingSalesError.message));\n      }\n    }\n  }, [pendingSalesError]);\n\n  // Fix N+1 query problem: Use bulk endpoint instead of individual calls\n  const validateStockForAllSales = useCallback(async () => {\n    try {\n      // Collect all unique product IDs from all sales\n      const productIds = new Set();\n      pendingSales.forEach(sale => {\n        sale.items?.forEach(item => {\n          if (item.product) {\n            productIds.add(item.product);\n          }\n        });\n      });\n\n      if (productIds.size === 0) {\n        setStockValidationStatus({});\n        return;\n      }\n\n      // Single API call to get stock for all products\n      const response = await api.post('/api/products/bulk-stock-availability/', {\n        product_ids: Array.from(productIds)\n      });\n\n      const stockData = response.data || {};\n      const validationStatus = {};\n\n      // Validate each sale using the bulk stock data\n      for (const sale of pendingSales) {\n        let hasInsufficientStock = false;\n        const itemStatuses = {};\n\n        for (let i = 0; i < (sale.items || []).length; i++) {\n          const item = sale.items[i];\n          // Backend returns data keyed by product ID (as number or string)\n          const productId = item.product;\n          const productStock = stockData[productId] || stockData[String(productId)] || stockData[Number(productId)];\n          let availableQty = null;\n\n          if (productStock && productStock.available_units) {\n            const unitData = productStock.available_units.find(unit => unit.id === item.unit);\n            if (unitData) {\n              availableQty = unitData.available_quantity;\n              if (availableQty < (item.quantity_display || item.quantity || 0)) {\n                hasInsufficientStock = true;\n              }\n            }\n          }\n\n          // Save per-item status keyed by item index (stable within this sale render)\n          itemStatuses[i] = {\n            sufficient: availableQty === null ? null : (availableQty >= (item.quantity_display || item.quantity || 0)),\n            required: item.quantity_display || item.quantity || 0,\n            available: availableQty\n          };\n        }\n\n        validationStatus[sale.id] = { hasInsufficientStock, itemStatuses };\n      }\n\n      setStockValidationStatus(validationStatus);\n    } catch (error) {\n      console.error('Error validating stock:', error);\n      // Fallback: mark all as having insufficient stock if validation fails\n      const validationStatus = {};\n      pendingSales.forEach(sale => {\n        validationStatus[sale.id] = { hasInsufficientStock: true };\n      });\n      setStockValidationStatus(validationStatus);\n    }\n  }, [pendingSales]);\n\n  useEffect(() => {\n    if (pendingSales.length > 0) {\n      validateStockForAllSales();\n    }\n  }, [pendingSales, validateStockForAllSales]);\n\n  const completeSale = async (saleId) => {\n    try {\n      setCompletingSale(saleId);\n      \n      // Check if sale has items with packaging that need validation\n      const sale = pendingSales.find(s => s.id === saleId);\n      const hasPackagingItems = sale.items?.some(item => item.product_has_packaging);\n      \n      if (hasPackagingItems) {\n        // Show packaging validation page\n        setPackagingValidationSaleId(saleId);\n        setShowPackagingValidation(true);\n        setCompletingSale(null);\n        return;\n      }\n      \n      // Proceed with normal completion if no packaging items\n      await performSaleCompletion(saleId);\n    } catch (error) {\n      console.error('Error completing sale:', error);\n      alert('Error completing sale: ' + (error.response?.data?.detail || error.message));\n      setCompletingSale(null);\n    }\n  };\n\n  const performSaleCompletion = async (saleId) => {\n    try {\n      // Check stock before completing\n      const sale = pendingSales.find(s => s.id === saleId);\n      const stockValidationErrors = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          const response = await api.get(`/api/products/${item.product}/stock-availability/`);\n          const stockData = response.data;\n          \n          if (stockData.available_units) {\n            const unitData = stockData.available_units.find(unit => unit.id === item.unit);\n            if (unitData && unitData.available_quantity < item.quantity_display) {\n              stockValidationErrors.push(`${item.product_name}: Required ${item.quantity_display} ${item.unit_name}, but only ${unitData.available_quantity} available`);\n            }\n          }\n        } catch (error) {\n          console.error(`Error checking stock for product ${item.product}:`, error);\n          stockValidationErrors.push(`${item.product_name}: Unable to check stock availability`);\n        }\n      }\n      \n      if (stockValidationErrors.length > 0) {\n        alert('Cannot complete sale due to insufficient stock:\\n' + stockValidationErrors.join('\\n'));\n        return;\n      }\n      \n      await api.post(`/api/sales/${saleId}/complete/`);\n      \n      // Print receipt after successful completion using PrintButton logic\n      const completedSale = { ...sale, status: 'completed' };\n      \n      // Remove from pending sales list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      setShowSaleModal(false);\n      setSelectedSale(null);\n      \n      alert('Sale completed successfully!');\n    } catch (error) {\n      console.error('Error completing sale:', error);\n      alert('Error completing sale: ' + (error.response?.data?.detail || error.message));\n    } finally {\n      setCompletingSale(null);\n    }\n  };\n\n  const handlePackagingValidationComplete = async () => {\n    try {\n      await performSaleCompletion(packagingValidationSaleId);\n      setShowPackagingValidation(false);\n      setPackagingValidationSaleId(null);\n    } catch (error) {\n      console.error('Error completing sale after packaging validation:', error);\n    }\n  };\n\n  const handlePackagingValidationCancel = () => {\n    setShowPackagingValidation(false);\n    setPackagingValidationSaleId(null);\n    setCompletingSale(null);\n  };\n\n  const cancelSale = async (saleId) => {\n    if (window.confirm('Are you sure you want to cancel this sale?')) {\n      try {\n        await api.delete(`/api/sales/${saleId}/`);\n        setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n        setShowSaleModal(false);\n        setSelectedSale(null);\n        alert('Sale cancelled successfully!');\n      } catch (error) {\n        console.error('Error cancelling sale:', error);\n        alert('Error cancelling sale: ' + (error.response?.data?.detail || error.message));\n      }\n    }\n  };\n\n  // Prepare print data for PrintButton component (consistent with POS logic)\n  const preparePrintData = (sale) => {\n    return {\n      sale_number: sale.sale_number,\n      customer_name: sale.customer_name || 'Walk-in Customer',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      user_name: user?.username || t('app.unknown_user'),\n      user_id: user?.id || 'unknown',\n      created_at: sale.created_at,\n      print_timestamp: new Date().toISOString(),\n      print_id: `PRINT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      status: sale.status === 'completed' ? 'completed' : 'pending',\n      payment_status: sale.payment_status || 'pending',\n      payment_method: sale.payment_method || 'cash',\n      total_amount: sale.total_amount || sale.subtotal,\n      paid_amount: sale.paid_amount || 0,\n      remaining_amount: sale.remaining_amount || (parseFloat(sale.total_amount || sale.subtotal) - parseFloat(sale.paid_amount || 0)),\n      due_date: sale.due_date || null,\n      subtotal: sale.subtotal,\n      discount_amount: sale.discount_amount || 0,\n      tax_amount: sale.tax_amount || 0,\n      created_by_name: sale.created_by_name,\n      items: sale.items?.map(item => ({\n        product_name: item.product_name,\n        product_sku: item.product_sku,\n        quantity: item.quantity,\n        quantity_display: item.quantity_display,\n        unit_name: item.unit_name,\n        unit_price: item.unit_price,\n        total_price: item.total_price\n      })) || []\n    };\n  };\n\n  const editSale = (sale) => {\n    setEditingSale(sale);\n    \n    // Initialize items with proper quantities and calculate totals\n    const items = sale.items?.map(item => {\n      const quantity = parseFloat(item.quantity_display || item.quantity) || 0;\n      const unitPrice = parseFloat(item.unit_price) || 0;\n      const calculatedTotalPrice = quantity * unitPrice;\n      \n      return {\n        ...item,\n        quantity: quantity,\n        unit_price: unitPrice,\n        total_price: calculatedTotalPrice\n      };\n    }) || [];\n    \n    // Calculate initial totals based on current item data\n    const calculatedSubtotal = items.reduce((sum, item) => sum + item.total_price, 0);\n    \n    // If no tax_amount is provided, assume 0% tax (common for many sales)\n    const taxAmount = parseFloat(sale.tax_amount || 0) || 0;\n    const discountAmount = parseFloat(sale.discount_amount || 0) || 0;\n    const calculatedTotal = calculatedSubtotal + taxAmount - discountAmount;\n    \n    // Always use calculated totals to ensure accuracy\n    const subtotal = calculatedSubtotal;\n    const total_amount = calculatedTotal;\n    \n    const formData = {\n      customer_name: sale.customer_name || '',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      payment_method: sale.payment_method || 'cash',\n      items: items,\n      subtotal: subtotal,\n      total_amount: total_amount,\n      tax_amount: sale.tax_amount || 0,\n      discount_amount: sale.discount_amount || 0\n    };\n    \n    \n    setEditFormData(formData);\n    setEditTotals({ subtotal: subtotal, total_amount: total_amount });\n    \n    // Initialize payment options\n    const currentPaidAmount = parseFloat(sale.paid_amount) || 0;\n    const calculatedTotalAmount = total_amount; // Use the calculated total from form data\n    \n    if (currentPaidAmount >= calculatedTotalAmount) {\n      setPaymentType('full');\n      setPaidAmount(calculatedTotalAmount);\n    } else if (currentPaidAmount > 0) {\n      setPaymentType('partial');\n      setPaidAmount(currentPaidAmount);\n    } else {\n      setPaymentType('full');\n      setPaidAmount(calculatedTotalAmount);\n    }\n    \n    setShowEditModal(true);\n    setShowSaleModal(false);\n  };\n\n  const handleEditItemQuantity = (itemIndex, newQuantity) => {\n    \n    if (!editFormData.items || !Array.isArray(editFormData.items)) {\n      console.error('editFormData.items is not properly initialized:', editFormData);\n      return;\n    }\n    \n    const updatedItems = [...editFormData.items];\n    updatedItems[itemIndex].quantity = parseFloat(newQuantity) || 0;\n    updatedItems[itemIndex].total_price = updatedItems[itemIndex].quantity * parseFloat(updatedItems[itemIndex].unit_price) || 0;\n    \n    \n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal\n    });\n    \n    // Fallback to original sale values if editFormData doesn't have them\n    const taxAmount = parseFloat(editFormData.tax_amount !== undefined ? editFormData.tax_amount : (editingSale?.tax_amount || 0)) || 0;\n    const discountAmount = parseFloat(editFormData.discount_amount !== undefined ? editFormData.discount_amount : (editingSale?.discount_amount || 0)) || 0;\n    const newTotalAmount = subtotal + taxAmount - discountAmount;\n    \n    setEditTotals({\n      subtotal: subtotal,\n      taxAmount: taxAmount,\n      discountAmount: discountAmount,\n      newTotalAmount: newTotalAmount,\n      editFormDataTax: editFormData.tax_amount,\n      editFormDataDiscount: editFormData.discount_amount\n    });\n    \n    const newEditFormData = {\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: newTotalAmount\n    };\n    \n    \n    setEditFormData(newEditFormData);\n    setEditTotals({ subtotal: subtotal, total_amount: newTotalAmount });\n    \n    // Force a re-render by logging the state after setting it\n    setTimeout(() => {\n    }, 100);\n  };\n\n  const removeEditItem = (itemIndex) => {\n    const updatedItems = editFormData.items.filter((_, index) => index !== itemIndex);\n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    // Fallback to original sale values if editFormData doesn't have them\n    const taxAmount = parseFloat(editFormData.tax_amount !== undefined ? editFormData.tax_amount : (editingSale?.tax_amount || 0)) || 0;\n    const discountAmount = parseFloat(editFormData.discount_amount !== undefined ? editFormData.discount_amount : (editingSale?.discount_amount || 0)) || 0;\n    const newTotalAmount = subtotal + taxAmount - discountAmount;\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: newTotalAmount\n    });\n    setEditTotals({ subtotal: subtotal, total_amount: newTotalAmount });\n  };\n\n  const calculateEditTotal = () => {\n    return editFormData.items?.reduce((total, item) => {\n      return total + (parseFloat(item.total_price || 0));\n    }, 0) || 0;\n  };\n\n  // Update paid amount when payment type changes or subtotal changes\n  useEffect(() => {\n    if (paymentType === 'full') {\n      setPaidAmount(editTotals.subtotal || 0);\n    }\n  }, [paymentType, editTotals.subtotal]);\n\n\n  const saveEditedSale = async () => {\n    try {\n      const updateData = {\n        customer_name: editFormData.customer_name,\n        customer_phone: editFormData.customer_phone,\n        customer_email: editFormData.customer_email,\n        payment_method: editFormData.payment_method,\n        paid_amount: paidAmount,\n        items: editFormData.items.map(item => ({\n          id: item.id,\n          product: item.product,\n          unit: item.unit,\n          quantity: item.quantity,\n          unit_price: item.unit_price,\n          price_mode: item.price_mode\n        }))\n      };\n      \n      console.log('Saving edited sale:', {\n        saleId: editingSale.id,\n        updateData: updateData,\n        editFormData: editFormData\n      });\n      \n      const response = await api.put(`/api/sales/${editingSale.id}/edit/`, updateData);\n      \n      setShowEditModal(false);\n      setEditingSale(null);\n      setEditFormData({});\n      \n      // Refresh the pending sales list\n      refetchPendingSales();\n      \n      alert('Sale updated successfully!');\n    } catch (error) {\n      console.error('Error updating sale:', error);\n      alert('Error updating sale: ' + (error.response?.data?.detail || error.message));\n    }\n  };\n\n  if (authLoading || loading) {\n    return (\n      <div className=\"pending-sales-page\">\n        <div className=\"page-header\">\n          <h1>{t('titles.pending_sales')}</h1>\n        </div>\n        <div className=\"loading-message\">Loading pending sales...</div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"pending-sales-page\">\n        <div className=\"page-header\">\n          <h1>{t('titles.pending_sales')}</h1>\n        </div>\n        <div className=\"loading-message\">Please log in to view pending sales.</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"pending-sales-page\">\n      <div className=\"page-header\">\n        <h1>{t('titles.pending_sales')}</h1>\n        <p>Manage and validate pending sales before completion</p>\n      </div>\n\n      {pendingSales.length === 0 ? (\n        <div className=\"no-pending-sales\">\n          <div className=\"no-sales-icon\"></div>\n          <h3>{t('titles.no_pending_sales')}</h3>\n          <p>All sales have been completed or there are no pending sales at the moment.</p>\n        </div>\n      ) : (\n        <div className=\"pending-sales-grid\">\n          {pendingSales.map((sale) => (\n            <div key={sale.id} className=\"pending-sale-card\">\n              <div className=\"sale-header\">\n                <div className=\"sale-number\">{sale.sale_number}</div>\n                <div className=\"sale-date\">{formatDate(sale.created_at)}</div>\n              </div>\n              \n              <div className=\"sale-customer\">\n                <strong>{sale.customer_name || 'Walk-in Customer'}</strong>\n              </div>\n              \n              <div className=\"sale-items\">\n                <div className=\"items-count\">{sale.items?.length || 0} items</div>\n                <div className=\"items-preview\">\n                  {sale.items?.slice(0, 3).map((item, index) => (\n                    <div key={index} className=\"item-preview\">\n                      <span className=\"item-name\">{item.product_name}</span>\n                      <span className=\"item-quantity\">{item.quantity_display || item.quantity} {item.unit_name}</span>\n                      <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                        {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                      </span>\n                    </div>\n                  ))}\n                  {sale.items?.length > 3 && (\n                    <div className=\"more-items\">+{sale.items.length - 3} more items</div>\n                  )}\n                </div>\n              </div>\n              \n              <div className=\"sale-total\">\n                <strong>{formatCurrency(sale.total_amount)}</strong>\n              </div>\n              \n              <div className=\"stock-status\">\n                {stockValidationStatus[sale.id]?.hasInsufficientStock ? (\n                  <div className=\"stock-insufficient\"> Insufficient Stock</div>\n                ) : (\n                  <div className=\"stock-sufficient\"> Stock Available</div>\n                )}\n              </div>\n              \n              <div className=\"sale-actions\">\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={async () => {\n                    try {\n                      // Fetch complete sale data including items\n                      const response = await api.get(`/api/sales/${sale.id}/`);\n                      setSelectedSale(response.data);\n                      setShowSaleModal(true);\n                    } catch (error) {\n                      console.error('Error fetching sale details:', error);\n                      // Fallback to using the sale data from the list\n                      setSelectedSale(sale);\n                      setShowSaleModal(true);\n                    }\n                  }}\n                >\n                  View Details\n                </Button>\n                \n                {/* Use PrintButton component instead of custom print function */}\n                <PrintButton\n                  data={preparePrintData(sale)}\n                  title={t('titles.sale_receipt')}\n                  type=\"sale\"\n                  printText=\" Print\"\n                  className=\"print-sale-btn\"\n                  variant=\"outline\"\n                  size=\"small\"\n                />\n                \n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => editSale(sale)}\n                >\n                   Edit\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"primary\"\n                  disabled={stockValidationStatus[sale.id]?.hasInsufficientStock}\n                  onClick={() => completeSale(sale.id)}\n                  loading={completingSale === sale.id}\n                >\n                  {stockValidationStatus[sale.id]?.hasInsufficientStock ? t('buttons.insufficient_stock') : t('buttons.complete_sale')}\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Sale Details Modal */}\n      {showSaleModal && selectedSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal sale-details-modal\">\n            <div className=\"modal-header\">\n              <h2>Sale Details - {selectedSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                \n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"info-section\">\n                <h3>Customer Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Name:</span>\n                    <span className=\"info-value\">{selectedSale.customer_name || 'Walk-in Customer'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Phone:</span>\n                    <span className=\"info-value\">{selectedSale.customer_phone || 'N/A'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Email:</span>\n                    <span className=\"info-value\">{selectedSale.customer_email || 'N/A'}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Sale Information */}\n              <div className=\"info-section\">\n                <h3>Sale Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Date:</span>\n                    <span className=\"info-value\">{formatDate(selectedSale.created_at)}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Payment Method:</span>\n                    <span className=\"info-value\">{selectedSale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Status:</span>\n                    <span className=\"status-badge pending\">Pending</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Items List */}\n              <div className=\"items-section\">\n                <h3>Items ({selectedSale.items?.length || 0})</h3>\n                <div \n                  className=\"items-container\"\n                  style={{\n                    minHeight: `${Math.max(200, (selectedSale.items?.length || 0) * 120)}px`,\n                    maxHeight: '500px'\n                  }}\n                >\n                  {selectedSale.items?.map((item, index) => (\n                    <div key={index} className=\"item-card\" style={{marginBottom: '12px'}}>\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-quantity\">\n                          <span className=\"quantity\">{item.quantity_display || item.quantity || 'N/A'}</span>\n                          <span className=\"unit\">{item.unit_name || 'N/A'}</span>\n                        </div>\n                        <div className=\"item-price\">\n                          <span className=\"unit-price\">{item.unit_price ? formatCurrency(item.unit_price) : 'N/A'} each</span>\n                          <span className=\"total-price\">{item.total_price ? formatCurrency(item.total_price) : 'N/A'}</span>\n                        </div>\n                      </div>\n\n                      {/* Per-item stock status (added) */}\n                      <div className=\"item-stock-status\">\n                        {(() => {\n                          const status = stockValidationStatus[selectedSale.id]?.itemStatuses?.[index];\n                          if (!status) {\n                            return <div className=\"stock-unknown\"> Availability unknown</div>;\n                          }\n\n                          if (status.sufficient === null) {\n                            return <div className=\"stock-unknown\"> Availability unknown</div>;\n                          }\n\n                          if (status.sufficient) {\n                            return <div className=\"stock-sufficient\"> ({status.available})</div>;\n                          }\n\n                          return (\n                            <div className=\"stock-insufficient\"> (rq {status.required}, av {status.available ?? 0})</div>\n                          );\n                        })()}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.subtotal)}</span>\n                  </div>\n                  {selectedSale.discount_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Discount:</span>\n                      <span className=\"total-value\">-{formatCurrency(selectedSale.discount_amount)}</span>\n                    </div>\n                  )}\n                  {selectedSale.tax_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Tax:</span>\n                      <span className=\"total-value\">{formatCurrency(selectedSale.tax_amount)}</span>\n                    </div>\n                  )}\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.total_amount)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Stock Status */}\n              <div className=\"stock-section\">\n                <h3>Stock Status</h3>\n                <div className=\"stock-status\">\n                  {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? (\n                    <div className=\"stock-insufficient\">\n                       Insufficient Stock\n                    </div>\n                  ) : (\n                    <div className=\"stock-sufficient\">\n                       Stock Available\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                Close\n              </Button>\n              \n              {/* Use PrintButton component in modal footer */}\n              <PrintButton\n                data={preparePrintData(selectedSale)}\n                title={t('titles.sale_receipt')}\n                type=\"sale\"\n                printText=\" Print Receipt\"\n                className=\"print-sale-btn\"\n                variant=\"secondary\"\n              />\n              \n              <Button\n                variant=\"secondary\"\n                onClick={() => editSale(selectedSale)}\n              >\n                 Edit\n              </Button>\n              <Button\n                variant=\"success\"\n                disabled={stockValidationStatus[selectedSale.id]?.hasInsufficientStock}\n                onClick={() => completeSale(selectedSale.id)}\n              >\n                {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? t('buttons.insufficient_stock') : t('buttons.complete_sale')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Sale Modal */}\n      {showEditModal && editingSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal edit-sale-modal\">\n            <div className=\"modal-header\">\n              <h2>Edit Sale - {editingSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                \n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"form-section\">\n                <h3>Customer Information</h3>\n                <div className=\"form-grid\">\n                  <div className=\"form-group\">\n                    <label>Customer Name</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_name || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_name: e.target.value})}\n                      placeholder={t('forms.customer_name')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Phone</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_phone || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_phone: e.target.value})}\n                      placeholder={t('forms.phone_number')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Email</label>\n                    <input\n                      type=\"email\"\n                      value={editFormData.customer_email || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_email: e.target.value})}\n                      placeholder={t('forms.email_address')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Payment Method</label>\n                    <select\n                      value={editFormData.payment_method || 'cash'}\n                      onChange={(e) => setEditFormData({...editFormData, payment_method: e.target.value})}\n                    >\n                      <option value=\"cash\">Cash</option>\n                      <option value=\"card\">Card</option>\n                      <option value=\"mobile_money\">Mobile Money</option>\n                      <option value=\"bank_transfer\">Bank Transfer</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n\n              {/* Payment Options */}\n              <div className=\"form-section\">\n                <h3>Payment Type</h3>\n                <div className=\"payment-types\">\n                  <label className=\"payment-type\">\n                    <input\n                      type=\"radio\"\n                      name=\"paymentType\"\n                      value=\"full\"\n                      checked={paymentType === 'full'}\n                      onChange={(e) => setPaymentType(e.target.value)}\n                    />\n                    <span>Full Payment (100%)</span>\n                  </label>\n                  <label className=\"payment-type\">\n                    <input\n                      type=\"radio\"\n                      name=\"paymentType\"\n                      value=\"partial\"\n                      checked={paymentType === 'partial'}\n                      onChange={(e) => setPaymentType(e.target.value)}\n                    />\n                    <span>Partial Payment (0-99.99%)</span>\n                  </label>\n                </div>\n                \n                {paymentType === 'partial' && (\n                  <div className=\"form-group\">\n                    <label>Amount to Pay</label>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      max={editTotals.subtotal || 0}\n                      value={paidAmount || 0}\n                      onChange={(e) => {\n                        const value = parseFloat(e.target.value) || 0;\n                        setPaidAmount(value);\n                      }}\n                      placeholder={t('forms.enter_amount_to_pay')}\n                    />\n                    <small>\n                      Total: {formatCurrency(editTotals.subtotal || 0)} | \n                      Remaining: {formatCurrency((editTotals.subtotal || 0) - (paidAmount || 0))}\n                    </small>\n                  </div>\n                )}\n                \n                {paymentType === 'full' && (\n                  <div className=\"form-group\">\n                    <label>Amount to Pay</label>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      value={editTotals.subtotal || 0}\n                      readOnly\n                      className=\"form-control\"\n                    />\n                    <small>Full payment for the total amount.</small>\n                  </div>\n                )}\n              </div>\n\n              {/* Items */}\n              <div className=\"form-section\">\n                <h3>Items ({editFormData.items?.length || 0})</h3>\n                <div className=\"items-edit-container\">\n                  {editFormData.items?.map((item, index) => (\n                    <div key={index} className=\"edit-item-card\">\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-unit\">{item.unit_name}</div>\n                        <div className=\"item-price\">{formatCurrency(item.unit_price)} each</div>\n                      </div>\n                      <div className=\"item-controls\">\n                        <div className=\"control-group\">\n                          <label>Quantity:</label>\n                          <input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            value={item.quantity}\n                            onChange={(e) => handleEditItemQuantity(index, e.target.value)}\n                          />\n                        </div>\n                        <div className=\"control-group\">\n                          <label>Price Mode:</label>\n                          <select\n                            value={item.price_mode}\n                            disabled\n                            style={{ backgroundColor: '#f5f5f5', color: '#666' }}\n                          >\n                            <option value=\"standard\">Standard</option>\n                            <option value=\"wholesale\">Wholesale</option>\n                          </select>\n                        </div>\n                        <div className=\"item-total\">\n                          {formatCurrency(item.total_price)}\n                        </div>\n                        <div className=\"item-actions\">\n                          <Button\n                            size=\"small\"\n                            variant=\"danger\"\n                            onClick={() => removeEditItem(index)}\n                          >\n                            Remove\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(editTotals.subtotal || 0)}</span>\n                  </div>\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(editTotals.total_amount || 0)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={saveEditedSale}\n              >\n                Save Changes\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Packaging Validation Modal */}\n      {showPackagingValidation && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal-content packaging-validation-modal\">\n            <PackagingValidation\n              saleId={packagingValidationSaleId}\n              onComplete={handlePackagingValidationComplete}\n              onCancel={handlePackagingValidationCancel}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PendingSales;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}