{"ast":null,"code":"import{useQuery,useQueryClient}from'react-query';import api from'../services/api';/**\n * Fetch all products with pagination\n * @param {Object} filters - Filter parameters (category, is_active, etc.)\n * @returns {Object} Query result with products data\n */export const useProducts=function(){let filters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return useQuery(['products',filters],async()=>{const params=new URLSearchParams();// Always filter for active products\nif(filters.is_active!==false){params.append('is_active','true');}// Add category filter if provided\nif(filters.category){params.append('category',filters.category);}const baseUrl=\"/api/products/\".concat(params.toString()?'?'+params.toString():'');let response=await api.get(baseUrl);let aggregatedProducts=Array.isArray(response.data.results)?response.data.results:Array.isArray(response.data)?response.data:[];// Follow pagination to get all products (DRF-style \"next\" links)\nlet nextUrl=response.data.next;while(nextUrl){response=await api.get(nextUrl);const pageItems=Array.isArray(response.data.results)?response.data.results:Array.isArray(response.data)?response.data:[];aggregatedProducts=aggregatedProducts.concat(pageItems);nextUrl=response.data.next;}return aggregatedProducts;},{staleTime:5*60*1000,// 5 minutes - products don't change often\ncacheTime:10*60*1000,// 10 minutes\nrefetchOnWindowFocus:false});};/**\n * Fetch a single product by ID\n */export const useProduct=productId=>{return useQuery(['product',productId],()=>api.get(\"/api/products/\".concat(productId,\"/\")).then(res=>res.data),{enabled:!!productId,staleTime:5*60*1000,cacheTime:10*60*1000});};/**\n * Fetch stock availability for a product\n */export const useProductStock=productId=>{return useQuery(['product-stock',productId],()=>api.get(\"/api/products/\".concat(productId,\"/stock-availability/\")).then(res=>res.data),{enabled:!!productId,staleTime:1*60*1000,// 1 minute - stock changes more frequently\ncacheTime:5*60*1000,refetchOnWindowFocus:false});};/**\n * Invalidate products cache (useful after mutations)\n */export const useInvalidateProducts=()=>{const queryClient=useQueryClient();return()=>{queryClient.invalidateQueries(['products']);};};","map":{"version":3,"names":["useQuery","useQueryClient","api","useProducts","filters","arguments","length","undefined","params","URLSearchParams","is_active","append","category","baseUrl","concat","toString","response","get","aggregatedProducts","Array","isArray","data","results","nextUrl","next","pageItems","staleTime","cacheTime","refetchOnWindowFocus","useProduct","productId","then","res","enabled","useProductStock","useInvalidateProducts","queryClient","invalidateQueries"],"sources":["/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/src/hooks/useProducts.js"],"sourcesContent":["import { useQuery, useQueryClient } from 'react-query';\nimport api from '../services/api';\n\n/**\n * Fetch all products with pagination\n * @param {Object} filters - Filter parameters (category, is_active, etc.)\n * @returns {Object} Query result with products data\n */\nexport const useProducts = (filters = {}) => {\n  return useQuery(\n    ['products', filters],\n    async () => {\n      const params = new URLSearchParams();\n      \n      // Always filter for active products\n      if (filters.is_active !== false) {\n        params.append('is_active', 'true');\n      }\n      \n      // Add category filter if provided\n      if (filters.category) {\n        params.append('category', filters.category);\n      }\n      \n      const baseUrl = `/api/products/${params.toString() ? '?' + params.toString() : ''}`;\n      let response = await api.get(baseUrl);\n      let aggregatedProducts = Array.isArray(response.data.results) \n        ? response.data.results \n        : (Array.isArray(response.data) ? response.data : []);\n      \n      // Follow pagination to get all products (DRF-style \"next\" links)\n      let nextUrl = response.data.next;\n      while (nextUrl) {\n        response = await api.get(nextUrl);\n        const pageItems = Array.isArray(response.data.results) \n          ? response.data.results \n          : (Array.isArray(response.data) ? response.data : []);\n        aggregatedProducts = aggregatedProducts.concat(pageItems);\n        nextUrl = response.data.next;\n      }\n      \n      return aggregatedProducts;\n    },\n    {\n      staleTime: 5 * 60 * 1000, // 5 minutes - products don't change often\n      cacheTime: 10 * 60 * 1000, // 10 minutes\n      refetchOnWindowFocus: false,\n    }\n  );\n};\n\n/**\n * Fetch a single product by ID\n */\nexport const useProduct = (productId) => {\n  return useQuery(\n    ['product', productId],\n    () => api.get(`/api/products/${productId}/`).then(res => res.data),\n    {\n      enabled: !!productId,\n      staleTime: 5 * 60 * 1000,\n      cacheTime: 10 * 60 * 1000,\n    }\n  );\n};\n\n/**\n * Fetch stock availability for a product\n */\nexport const useProductStock = (productId) => {\n  return useQuery(\n    ['product-stock', productId],\n    () => api.get(`/api/products/${productId}/stock-availability/`).then(res => res.data),\n    {\n      enabled: !!productId,\n      staleTime: 1 * 60 * 1000, // 1 minute - stock changes more frequently\n      cacheTime: 5 * 60 * 1000,\n      refetchOnWindowFocus: false,\n    }\n  );\n};\n\n/**\n * Invalidate products cache (useful after mutations)\n */\nexport const useInvalidateProducts = () => {\n  const queryClient = useQueryClient();\n  \n  return () => {\n    queryClient.invalidateQueries(['products']);\n  };\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}