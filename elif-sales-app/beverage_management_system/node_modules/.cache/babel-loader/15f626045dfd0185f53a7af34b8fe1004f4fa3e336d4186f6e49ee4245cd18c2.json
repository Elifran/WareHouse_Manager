{"ast":null,"code":"import _objectSpread from\"/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useTranslation}from'react-i18next';import api from'../services/api';import Button from'../components/Button';import{formatCurrency,formatDate}from'../utils/helpers';import{useAuth}from'../contexts/AuthContext';import{generatePrintContent}from'../components/PrintButton';import PackagingValidation from'./PackagingValidation';import'./PendingSales.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PendingSales=()=>{var _selectedSale$payment,_selectedSale$items,_selectedSale$items2,_selectedSale$items3,_stockValidationStatu4,_stockValidationStatu5,_stockValidationStatu6,_editFormData$items2,_editFormData$items3;const{t}=useTranslation();const{user,loading:authLoading}=useAuth();const[pendingSales,setPendingSales]=useState([]);const[loading,setLoading]=useState(true);const[showSaleModal,setShowSaleModal]=useState(false);const[selectedSale,setSelectedSale]=useState(null);const[showEditModal,setShowEditModal]=useState(false);const[editingSale,setEditingSale]=useState(null);const[editFormData,setEditFormData]=useState({});const[editTotals,setEditTotals]=useState({subtotal:0,total_amount:0});const[completingSale,setCompletingSale]=useState(null);const[stockValidationStatus,setStockValidationStatus]=useState({});const[paymentType,setPaymentType]=useState('full');const[paidAmount,setPaidAmount]=useState(0);const[showPackagingValidation,setShowPackagingValidation]=useState(false);const[packagingValidationSaleId,setPackagingValidationSaleId]=useState(null);useEffect(()=>{if(!authLoading&&user){fetchPendingSales();}},[authLoading,user]);useEffect(()=>{if(pendingSales.length>0){validateStockForAllSales();}},[pendingSales]);const fetchPendingSales=async()=>{try{setLoading(true);// Check if user is authenticated\nconst token=localStorage.getItem('accessToken');const response=await api.get('/api/sales/pending/');setPendingSales(response.data);}catch(error){var _error$response,_error$response2,_error$response3,_error$response4;console.error('Error fetching pending sales:',error);console.error('Error details:',{message:error.message,response:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data,status:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status,statusText:(_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.statusText});// More specific error handling\nif(((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.status)===401){alert('Authentication required. Please log in again.');// Redirect to login or refresh token\nwindow.location.href='/login';}else{var _error$response5,_error$response5$data;alert('Error fetching pending sales: '+(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.detail)||error.message));}}finally{setLoading(false);}};const validateStockForAllSales=async()=>{const validationStatus={};for(const sale of pendingSales){let hasInsufficientStock=false;for(const item of sale.items||[]){try{const response=await api.get(\"/api/products/\".concat(item.product,\"/stock-availability/\"));const stockData=response.data;if(stockData.available_units){const unitData=stockData.available_units.find(unit=>unit.id===item.unit);if(unitData&&unitData.available_quantity<item.quantity_display){hasInsufficientStock=true;break;}}}catch(error){console.error(\"Error checking stock for product \".concat(item.product,\":\"),error);}}validationStatus[sale.id]={hasInsufficientStock};}setStockValidationStatus(validationStatus);};const completeSale=async saleId=>{try{var _sale$items;setCompletingSale(saleId);// Check if sale has items with packaging that need validation\nconst sale=pendingSales.find(s=>s.id===saleId);const hasPackagingItems=(_sale$items=sale.items)===null||_sale$items===void 0?void 0:_sale$items.some(item=>item.product_has_packaging);if(hasPackagingItems){// Show packaging validation page\nsetPackagingValidationSaleId(saleId);setShowPackagingValidation(true);setCompletingSale(null);return;}// Proceed with normal completion if no packaging items\nawait performSaleCompletion(saleId);}catch(error){var _error$response6,_error$response6$data;console.error('Error completing sale:',error);alert('Error completing sale: '+(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.detail)||error.message));setCompletingSale(null);}};const performSaleCompletion=async saleId=>{try{// Check stock before completing\nconst sale=pendingSales.find(s=>s.id===saleId);const stockValidationErrors=[];for(const item of sale.items||[]){try{const response=await api.get(\"/api/products/\".concat(item.product,\"/stock-availability/\"));const stockData=response.data;if(stockData.available_units){const unitData=stockData.available_units.find(unit=>unit.id===item.unit);if(unitData&&unitData.available_quantity<item.quantity_display){stockValidationErrors.push(\"\".concat(item.product_name,\": Required \").concat(item.quantity_display,\" \").concat(item.unit_name,\", but only \").concat(unitData.available_quantity,\" available\"));}}}catch(error){console.error(\"Error checking stock for product \".concat(item.product,\":\"),error);stockValidationErrors.push(\"\".concat(item.product_name,\": Unable to check stock availability\"));}}if(stockValidationErrors.length>0){alert('Cannot complete sale due to insufficient stock:\\n'+stockValidationErrors.join('\\n'));return;}await api.post(\"/api/sales/\".concat(saleId,\"/complete/\"));// Print receipt after successful completion\nconst completedSale=_objectSpread(_objectSpread({},sale),{},{status:'completed'});printPendingSale(completedSale);// Remove from pending sales list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale completed successfully!');}catch(error){var _error$response7,_error$response7$data;console.error('Error completing sale:',error);alert('Error completing sale: '+(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.detail)||error.message));}finally{setCompletingSale(null);}};const handlePackagingValidationComplete=async()=>{try{await performSaleCompletion(packagingValidationSaleId);setShowPackagingValidation(false);setPackagingValidationSaleId(null);}catch(error){console.error('Error completing sale after packaging validation:',error);}};const handlePackagingValidationCancel=()=>{setShowPackagingValidation(false);setPackagingValidationSaleId(null);setCompletingSale(null);};const cancelSale=async saleId=>{if(window.confirm('Are you sure you want to cancel this sale?')){try{await api.delete(\"/api/sales/\".concat(saleId,\"/\"));setPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale cancelled successfully!');}catch(error){var _error$response8,_error$response8$data;console.error('Error cancelling sale:',error);alert('Error cancelling sale: '+(((_error$response8=error.response)===null||_error$response8===void 0?void 0:(_error$response8$data=_error$response8.data)===null||_error$response8$data===void 0?void 0:_error$response8$data.detail)||error.message));}}};const printPendingSale=sale=>{try{var _sale$items2;// Prepare print data in the same format as regular sales\nconst printData={sale_number:sale.sale_number,customer_name:sale.customer_name||'Walk-in Customer',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',user_name:(user===null||user===void 0?void 0:user.username)||t('app.unknown_user'),user_id:(user===null||user===void 0?void 0:user.id)||'unknown',created_at:sale.created_at,print_timestamp:new Date().toISOString(),print_id:\"PRINT-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9)),status:sale.status==='completed'?'completed':'pending',payment_status:sale.payment_status||'pending',payment_method:sale.payment_method||'cash',total_amount:sale.total_amount||sale.subtotal,paid_amount:sale.paid_amount||0,remaining_amount:sale.remaining_amount||parseFloat(sale.total_amount||sale.subtotal)-parseFloat(sale.paid_amount||0),due_date:sale.due_date||null,subtotal:sale.subtotal,discount_amount:sale.discount_amount||0,tax_amount:sale.tax_amount||0,items:((_sale$items2=sale.items)===null||_sale$items2===void 0?void 0:_sale$items2.map(item=>({product_name:item.product_name,product_sku:item.product_sku,quantity:item.quantity,quantity_display:item.quantity_display,unit_name:item.unit_name,unit_price:item.unit_price,total_price:item.total_price})))||[]};// Generate print content using the standardized system\nconst printContent=generatePrintContent(printData,t('titles.sale_receipt'),'sale',t);// Open print window\nconst printWindow=window.open('','_blank','width=800,height=600');if(!printWindow){throw new Error('Failed to open print window. Please check popup blockers.');}printWindow.document.write(printContent);printWindow.document.close();// Wait for content to load then print\nconst printAfterLoad=()=>{printWindow.focus();printWindow.print();// Close the window after a short delay\nsetTimeout(()=>{printWindow.close();},1000);};// Check if window is already loaded\nif(printWindow.document.readyState==='complete'){printAfterLoad();}else{printWindow.onload=printAfterLoad;}}catch(error){console.error('Print error:',error);alert('Failed to print receipt. Please try again. Error: '+error.message);}};const editSale=sale=>{var _sale$items3;setEditingSale(sale);// Initialize items with proper quantities and calculate totals\nconst items=((_sale$items3=sale.items)===null||_sale$items3===void 0?void 0:_sale$items3.map(item=>{const quantity=parseFloat(item.quantity_display||item.quantity)||0;const unitPrice=parseFloat(item.unit_price)||0;const calculatedTotalPrice=quantity*unitPrice;return _objectSpread(_objectSpread({},item),{},{quantity:quantity,unit_price:unitPrice,total_price:calculatedTotalPrice});}))||[];// Calculate initial totals based on current item data\nconst calculatedSubtotal=items.reduce((sum,item)=>sum+item.total_price,0);// If no tax_amount is provided, assume 0% tax (common for many sales)\nconst taxAmount=parseFloat(sale.tax_amount||0)||0;const discountAmount=parseFloat(sale.discount_amount||0)||0;const calculatedTotal=calculatedSubtotal+taxAmount-discountAmount;// Always use calculated totals to ensure accuracy\nconst subtotal=calculatedSubtotal;const total_amount=calculatedTotal;const formData={customer_name:sale.customer_name||'',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',payment_method:sale.payment_method||'cash',items:items,subtotal:subtotal,total_amount:total_amount,tax_amount:sale.tax_amount||0,discount_amount:sale.discount_amount||0};setEditFormData(formData);setEditTotals({subtotal:subtotal,total_amount:total_amount});// Initialize payment options\nconst currentPaidAmount=parseFloat(sale.paid_amount)||0;const calculatedTotalAmount=total_amount;// Use the calculated total from form data\nif(currentPaidAmount>=calculatedTotalAmount){setPaymentType('full');setPaidAmount(calculatedTotalAmount);}else if(currentPaidAmount>0){setPaymentType('partial');setPaidAmount(currentPaidAmount);}else{setPaymentType('full');setPaidAmount(calculatedTotalAmount);}setShowEditModal(true);setShowSaleModal(false);};const handleEditItemQuantity=(itemIndex,newQuantity)=>{if(!editFormData.items||!Array.isArray(editFormData.items)){console.error('editFormData.items is not properly initialized:',editFormData);return;}const updatedItems=[...editFormData.items];updatedItems[itemIndex].quantity=parseFloat(newQuantity)||0;updatedItems[itemIndex].total_price=updatedItems[itemIndex].quantity*parseFloat(updatedItems[itemIndex].unit_price)||0;const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal}));// Fallback to original sale values if editFormData doesn't have them\nconst taxAmount=parseFloat(editFormData.tax_amount!==undefined?editFormData.tax_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.tax_amount)||0)||0;const discountAmount=parseFloat(editFormData.discount_amount!==undefined?editFormData.discount_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.discount_amount)||0)||0;const newTotalAmount=subtotal+taxAmount-discountAmount;setEditTotals({subtotal:subtotal,taxAmount:taxAmount,discountAmount:discountAmount,newTotalAmount:newTotalAmount,editFormDataTax:editFormData.tax_amount,editFormDataDiscount:editFormData.discount_amount});const newEditFormData=_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:newTotalAmount});setEditFormData(newEditFormData);setEditTotals({subtotal:subtotal,total_amount:newTotalAmount});// Force a re-render by logging the state after setting it\nsetTimeout(()=>{},100);};const removeEditItem=itemIndex=>{const updatedItems=editFormData.items.filter((_,index)=>index!==itemIndex);const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);// Fallback to original sale values if editFormData doesn't have them\nconst taxAmount=parseFloat(editFormData.tax_amount!==undefined?editFormData.tax_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.tax_amount)||0)||0;const discountAmount=parseFloat(editFormData.discount_amount!==undefined?editFormData.discount_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.discount_amount)||0)||0;const newTotalAmount=subtotal+taxAmount-discountAmount;setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:newTotalAmount}));setEditTotals({subtotal:subtotal,total_amount:newTotalAmount});};const calculateEditTotal=()=>{var _editFormData$items;return((_editFormData$items=editFormData.items)===null||_editFormData$items===void 0?void 0:_editFormData$items.reduce((total,item)=>{return total+parseFloat(item.total_price||0);},0))||0;};// Update paid amount when payment type changes or subtotal changes\nuseEffect(()=>{if(paymentType==='full'){setPaidAmount(editTotals.subtotal||0);}},[paymentType,editTotals.subtotal]);const saveEditedSale=async()=>{try{const updateData={customer_name:editFormData.customer_name,customer_phone:editFormData.customer_phone,customer_email:editFormData.customer_email,payment_method:editFormData.payment_method,paid_amount:paidAmount,items:editFormData.items.map(item=>({id:item.id,quantity:item.quantity,unit_price:item.unit_price}))};console.log('Saving edited sale:',{saleId:editingSale.id,updateData:updateData,editFormData:editFormData});const response=await api.patch(\"/sales/\".concat(editingSale.id,\"/\"),updateData);setShowEditModal(false);setEditingSale(null);setEditFormData({});// Refresh the pending sales list\nfetchPendingSales();alert('Sale updated successfully!');}catch(error){var _error$response9,_error$response9$data;console.error('Error updating sale:',error);alert('Error updating sale: '+(((_error$response9=error.response)===null||_error$response9===void 0?void 0:(_error$response9$data=_error$response9.data)===null||_error$response9$data===void 0?void 0:_error$response9$data.detail)||error.message));}};if(authLoading||loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')})}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"Loading pending sales...\"})]});}if(!user){return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')})}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"Please log in to view pending sales.\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage and validate pending sales before completion\"})]}),pendingSales.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-pending-sales\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"no-sales-icon\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{children:t('titles.no_pending_sales')}),/*#__PURE__*/_jsx(\"p\",{children:\"All sales have been completed or there are no pending sales at the moment.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales-grid\",children:pendingSales.map(sale=>{var _sale$items4,_sale$items5,_sale$items6,_stockValidationStatu,_stockValidationStatu2,_stockValidationStatu3;return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sale-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sale-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sale-number\",children:sale.sale_number}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-date\",children:formatDate(sale.created_at)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-customer\",children:/*#__PURE__*/_jsx(\"strong\",{children:sale.customer_name||'Walk-in Customer'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-items\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"items-count\",children:[((_sale$items4=sale.items)===null||_sale$items4===void 0?void 0:_sale$items4.length)||0,\" items\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-preview\",children:[(_sale$items5=sale.items)===null||_sale$items5===void 0?void 0:_sale$items5.slice(0,3).map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-preview\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-quantity\",children:[item.quantity_display||item.quantity,\" \",item.unit_name]}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]},index)),((_sale$items6=sale.items)===null||_sale$items6===void 0?void 0:_sale$items6.length)>3&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-items\",children:[\"+\",sale.items.length-3,\" more items\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-total\",children:/*#__PURE__*/_jsx(\"strong\",{children:formatCurrency(sale.total_amount)})}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu=stockValidationStatus[sale.id])!==null&&_stockValidationStatu!==void 0&&_stockValidationStatu.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-actions\",children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:async()=>{try{// Fetch complete sale data including items\nconst response=await api.get(\"/api/sales/\".concat(sale.id,\"/\"));setSelectedSale(response.data);setShowSaleModal(true);}catch(error){console.error('Error fetching sale details:',error);// Fallback to using the sale data from the list\nsetSelectedSale(sale);setShowSaleModal(true);}},children:\"View Details\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>printPendingSale(sale),children:\"\\uD83D\\uDDA8\\uFE0F Print\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>editSale(sale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"primary\",disabled:(_stockValidationStatu2=stockValidationStatus[sale.id])===null||_stockValidationStatu2===void 0?void 0:_stockValidationStatu2.hasInsufficientStock,onClick:()=>completeSale(sale.id),loading:completingSale===sale.id,children:(_stockValidationStatu3=stockValidationStatus[sale.id])!==null&&_stockValidationStatu3!==void 0&&_stockValidationStatu3.hasInsufficientStock?t('buttons.insufficient_stock'):t('buttons.complete_sale')})]})]},sale.id);})}),showSaleModal&&selectedSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal sale-details-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Sale Details - \",selectedSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_phone||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_email||'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sale Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:formatDate(selectedSale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Payment Method:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:(_selectedSale$payment=selectedSale.payment_method)===null||_selectedSale$payment===void 0?void 0:_selectedSale$payment.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_selectedSale$items=selectedSale.items)===null||_selectedSale$items===void 0?void 0:_selectedSale$items.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-container\",style:{minHeight:\"\".concat(Math.max(200,(((_selectedSale$items2=selectedSale.items)===null||_selectedSale$items2===void 0?void 0:_selectedSale$items2.length)||0)*120),\"px\"),maxHeight:'500px'},children:(_selectedSale$items3=selectedSale.items)===null||_selectedSale$items3===void 0?void 0:_selectedSale$items3.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-card\",style:{marginBottom:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-quantity\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"quantity\",children:item.quantity_display||item.quantity||'N/A'}),/*#__PURE__*/_jsx(\"span\",{className:\"unit\",children:item.unit_name||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"unit-price\",children:[item.unit_price?formatCurrency(item.unit_price):'N/A',\" each\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"total-price\",children:item.total_price?formatCurrency(item.total_price):'N/A'})]})]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.subtotal)})]}),selectedSale.discount_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Discount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[\"-\",formatCurrency(selectedSale.discount_amount)]})]}),selectedSale.tax_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Tax:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.tax_amount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.total_amount)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stock-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Stock Status\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu4=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu4!==void 0&&_stockValidationStatu4.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>printPendingSale(selectedSale),children:\"\\uD83D\\uDDA8\\uFE0F Print Receipt\"}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>editSale(selectedSale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",disabled:(_stockValidationStatu5=stockValidationStatus[selectedSale.id])===null||_stockValidationStatu5===void 0?void 0:_stockValidationStatu5.hasInsufficientStock,onClick:()=>completeSale(selectedSale.id),children:(_stockValidationStatu6=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu6!==void 0&&_stockValidationStatu6.hasInsufficientStock?t('buttons.insufficient_stock'):t('buttons.complete_sale')})]})]})}),showEditModal&&editingSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal edit-sale-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Edit Sale - \",editingSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_name||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_name:e.target.value})),placeholder:t('forms.customer_name')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_phone||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_phone:e.target.value})),placeholder:t('forms.phone_number')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:editFormData.customer_email||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_email:e.target.value})),placeholder:t('forms.email_address')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:editFormData.payment_method||'cash',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{payment_method:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"card\",children:\"Card\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mobile_money\",children:\"Mobile Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_transfer\",children:\"Bank Transfer\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Payment Type\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-types\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"payment-type\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"paymentType\",value:\"full\",checked:paymentType==='full',onChange:e=>setPaymentType(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"Full Payment (100%)\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"payment-type\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"paymentType\",value:\"partial\",checked:paymentType==='partial',onChange:e=>setPaymentType(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"Partial Payment (0-99.99%)\"})]})]}),paymentType==='partial'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount to Pay\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",min:\"0\",max:editTotals.subtotal||0,value:paidAmount||0,onChange:e=>{const value=parseFloat(e.target.value)||0;setPaidAmount(value);},placeholder:t('forms.enter_amount_to_pay')}),/*#__PURE__*/_jsxs(\"small\",{children:[\"Total: \",formatCurrency(editTotals.subtotal||0),\" | Remaining: \",formatCurrency((editTotals.subtotal||0)-(paidAmount||0))]})]}),paymentType==='full'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount to Pay\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:editTotals.subtotal||0,readOnly:true,className:\"form-control\"}),/*#__PURE__*/_jsx(\"small\",{children:\"Full payment for the total amount.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_editFormData$items2=editFormData.items)===null||_editFormData$items2===void 0?void 0:_editFormData$items2.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-edit-container\",children:(_editFormData$items3=editFormData.items)===null||_editFormData$items3===void 0?void 0:_editFormData$items3.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"edit-item-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-unit\",children:item.unit_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[formatCurrency(item.unit_price),\" each\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Quantity:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.01\",value:item.quantity,onChange:e=>handleEditItemQuantity(index,e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price Mode:\"}),/*#__PURE__*/_jsxs(\"select\",{value:item.price_mode,disabled:true,style:{backgroundColor:'#f5f5f5',color:'#666'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"standard\",children:\"Standard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"wholesale\",children:\"Wholesale\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-total\",children:formatCurrency(item.total_price)}),/*#__PURE__*/_jsx(\"div\",{className:\"item-actions\",children:/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>removeEditItem(index),children:\"Remove\"})})]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(editTotals.subtotal||0)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(editTotals.total_amount||0)})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:saveEditedSale,children:\"Save Changes\"})]})]})}),showPackagingValidation&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-content packaging-validation-modal\",children:/*#__PURE__*/_jsx(PackagingValidation,{saleId:packagingValidationSaleId,onComplete:handlePackagingValidationComplete,onCancel:handlePackagingValidationCancel})})})]});};export default PendingSales;","map":{"version":3,"names":["React","useState","useEffect","useTranslation","api","Button","formatCurrency","formatDate","useAuth","generatePrintContent","PackagingValidation","jsx","_jsx","jsxs","_jsxs","PendingSales","_selectedSale$payment","_selectedSale$items","_selectedSale$items2","_selectedSale$items3","_stockValidationStatu4","_stockValidationStatu5","_stockValidationStatu6","_editFormData$items2","_editFormData$items3","t","user","loading","authLoading","pendingSales","setPendingSales","setLoading","showSaleModal","setShowSaleModal","selectedSale","setSelectedSale","showEditModal","setShowEditModal","editingSale","setEditingSale","editFormData","setEditFormData","editTotals","setEditTotals","subtotal","total_amount","completingSale","setCompletingSale","stockValidationStatus","setStockValidationStatus","paymentType","setPaymentType","paidAmount","setPaidAmount","showPackagingValidation","setShowPackagingValidation","packagingValidationSaleId","setPackagingValidationSaleId","fetchPendingSales","length","validateStockForAllSales","token","localStorage","getItem","response","get","data","error","_error$response","_error$response2","_error$response3","_error$response4","console","message","status","statusText","alert","window","location","href","_error$response5","_error$response5$data","detail","validationStatus","sale","hasInsufficientStock","item","items","concat","product","stockData","available_units","unitData","find","unit","id","available_quantity","quantity_display","completeSale","saleId","_sale$items","s","hasPackagingItems","some","product_has_packaging","performSaleCompletion","_error$response6","_error$response6$data","stockValidationErrors","push","product_name","unit_name","join","post","completedSale","_objectSpread","printPendingSale","prev","filter","_error$response7","_error$response7$data","handlePackagingValidationComplete","handlePackagingValidationCancel","cancelSale","confirm","delete","_error$response8","_error$response8$data","_sale$items2","printData","sale_number","customer_name","customer_phone","customer_email","user_name","username","user_id","created_at","print_timestamp","Date","toISOString","print_id","now","Math","random","toString","substr","payment_status","payment_method","paid_amount","remaining_amount","parseFloat","due_date","discount_amount","tax_amount","map","product_sku","quantity","unit_price","total_price","printContent","printWindow","open","Error","document","write","close","printAfterLoad","focus","print","setTimeout","readyState","onload","editSale","_sale$items3","unitPrice","calculatedTotalPrice","calculatedSubtotal","reduce","sum","taxAmount","discountAmount","calculatedTotal","formData","currentPaidAmount","calculatedTotalAmount","handleEditItemQuantity","itemIndex","newQuantity","Array","isArray","updatedItems","undefined","newTotalAmount","editFormDataTax","editFormDataDiscount","newEditFormData","removeEditItem","_","index","calculateEditTotal","_editFormData$items","total","saveEditedSale","updateData","log","patch","_error$response9","_error$response9$data","className","children","_sale$items4","_sale$items5","_sale$items6","_stockValidationStatu","_stockValidationStatu2","_stockValidationStatu3","slice","price_mode","size","variant","onClick","disabled","replace","toUpperCase","style","minHeight","max","maxHeight","marginBottom","type","value","onChange","e","target","placeholder","name","checked","step","min","readOnly","backgroundColor","color","onComplete","onCancel"],"sources":["/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/src/pages/PendingSales.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport api from '../services/api';\nimport Button from '../components/Button';\nimport { formatCurrency, formatDate } from '../utils/helpers';\nimport { useAuth } from '../contexts/AuthContext';\nimport { generatePrintContent } from '../components/PrintButton';\nimport PackagingValidation from './PackagingValidation';\nimport './PendingSales.css';\n\nconst PendingSales = () => {\n  const { t } = useTranslation();\n  const { user, loading: authLoading } = useAuth();\n  const [pendingSales, setPendingSales] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showSaleModal, setShowSaleModal] = useState(false);\n  const [selectedSale, setSelectedSale] = useState(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editingSale, setEditingSale] = useState(null);\n  const [editFormData, setEditFormData] = useState({});\n  const [editTotals, setEditTotals] = useState({ subtotal: 0, total_amount: 0 });\n  const [completingSale, setCompletingSale] = useState(null);\n  const [stockValidationStatus, setStockValidationStatus] = useState({});\n  const [paymentType, setPaymentType] = useState('full');\n  const [paidAmount, setPaidAmount] = useState(0);\n  const [showPackagingValidation, setShowPackagingValidation] = useState(false);\n  const [packagingValidationSaleId, setPackagingValidationSaleId] = useState(null);\n\n  useEffect(() => {\n    if (!authLoading && user) {\n      fetchPendingSales();\n    }\n  }, [authLoading, user]);\n\n  useEffect(() => {\n    if (pendingSales.length > 0) {\n      validateStockForAllSales();\n    }\n  }, [pendingSales]);\n\n  const fetchPendingSales = async () => {\n    try {\n      setLoading(true);\n      \n      // Check if user is authenticated\n      const token = localStorage.getItem('accessToken');\n      \n      const response = await api.get('/api/sales/pending/');\n      setPendingSales(response.data);\n    } catch (error) {\n      console.error('Error fetching pending sales:', error);\n      console.error('Error details:', {\n        message: error.message,\n        response: error.response?.data,\n        status: error.response?.status,\n        statusText: error.response?.statusText\n      });\n      \n      // More specific error handling\n      if (error.response?.status === 401) {\n        alert('Authentication required. Please log in again.');\n        // Redirect to login or refresh token\n        window.location.href = '/login';\n      } else {\n        alert('Error fetching pending sales: ' + (error.response?.data?.detail || error.message));\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateStockForAllSales = async () => {\n    const validationStatus = {};\n    \n    for (const sale of pendingSales) {\n      let hasInsufficientStock = false;\n      \n      for (const item of sale.items || []) {\n        try {\n          const response = await api.get(`/api/products/${item.product}/stock-availability/`);\n          const stockData = response.data;\n          \n          if (stockData.available_units) {\n            const unitData = stockData.available_units.find(unit => unit.id === item.unit);\n            if (unitData && unitData.available_quantity < item.quantity_display) {\n              hasInsufficientStock = true;\n              break;\n            }\n          }\n        } catch (error) {\n          console.error(`Error checking stock for product ${item.product}:`, error);\n        }\n      }\n      \n      validationStatus[sale.id] = { hasInsufficientStock };\n    }\n    \n    setStockValidationStatus(validationStatus);\n  };\n\n  const completeSale = async (saleId) => {\n    try {\n      setCompletingSale(saleId);\n      \n      // Check if sale has items with packaging that need validation\n      const sale = pendingSales.find(s => s.id === saleId);\n      const hasPackagingItems = sale.items?.some(item => item.product_has_packaging);\n      \n      if (hasPackagingItems) {\n        // Show packaging validation page\n        setPackagingValidationSaleId(saleId);\n        setShowPackagingValidation(true);\n        setCompletingSale(null);\n        return;\n      }\n      \n      // Proceed with normal completion if no packaging items\n      await performSaleCompletion(saleId);\n    } catch (error) {\n      console.error('Error completing sale:', error);\n      alert('Error completing sale: ' + (error.response?.data?.detail || error.message));\n      setCompletingSale(null);\n    }\n  };\n\n  const performSaleCompletion = async (saleId) => {\n    try {\n      // Check stock before completing\n      const sale = pendingSales.find(s => s.id === saleId);\n      const stockValidationErrors = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          const response = await api.get(`/api/products/${item.product}/stock-availability/`);\n          const stockData = response.data;\n          \n          if (stockData.available_units) {\n            const unitData = stockData.available_units.find(unit => unit.id === item.unit);\n            if (unitData && unitData.available_quantity < item.quantity_display) {\n              stockValidationErrors.push(`${item.product_name}: Required ${item.quantity_display} ${item.unit_name}, but only ${unitData.available_quantity} available`);\n            }\n          }\n        } catch (error) {\n          console.error(`Error checking stock for product ${item.product}:`, error);\n          stockValidationErrors.push(`${item.product_name}: Unable to check stock availability`);\n        }\n      }\n      \n      if (stockValidationErrors.length > 0) {\n        alert('Cannot complete sale due to insufficient stock:\\n' + stockValidationErrors.join('\\n'));\n        return;\n      }\n      \n      await api.post(`/api/sales/${saleId}/complete/`);\n      \n      // Print receipt after successful completion\n      const completedSale = { ...sale, status: 'completed' };\n      printPendingSale(completedSale);\n      \n      // Remove from pending sales list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      setShowSaleModal(false);\n      setSelectedSale(null);\n      \n      alert('Sale completed successfully!');\n    } catch (error) {\n      console.error('Error completing sale:', error);\n      alert('Error completing sale: ' + (error.response?.data?.detail || error.message));\n    } finally {\n      setCompletingSale(null);\n    }\n  };\n\n  const handlePackagingValidationComplete = async () => {\n    try {\n      await performSaleCompletion(packagingValidationSaleId);\n      setShowPackagingValidation(false);\n      setPackagingValidationSaleId(null);\n    } catch (error) {\n      console.error('Error completing sale after packaging validation:', error);\n    }\n  };\n\n  const handlePackagingValidationCancel = () => {\n    setShowPackagingValidation(false);\n    setPackagingValidationSaleId(null);\n    setCompletingSale(null);\n  };\n\n  const cancelSale = async (saleId) => {\n    if (window.confirm('Are you sure you want to cancel this sale?')) {\n      try {\n        await api.delete(`/api/sales/${saleId}/`);\n        setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n        setShowSaleModal(false);\n        setSelectedSale(null);\n        alert('Sale cancelled successfully!');\n      } catch (error) {\n        console.error('Error cancelling sale:', error);\n        alert('Error cancelling sale: ' + (error.response?.data?.detail || error.message));\n      }\n    }\n  };\n\n  const printPendingSale = (sale) => {\n    try {\n      // Prepare print data in the same format as regular sales\n      const printData = {\n        sale_number: sale.sale_number,\n        customer_name: sale.customer_name || 'Walk-in Customer',\n        customer_phone: sale.customer_phone || '',\n        customer_email: sale.customer_email || '',\n        user_name: user?.username || t('app.unknown_user'),\n        user_id: user?.id || 'unknown',\n        created_at: sale.created_at,\n        print_timestamp: new Date().toISOString(),\n        print_id: `PRINT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        status: sale.status === 'completed' ? 'completed' : 'pending',\n        payment_status: sale.payment_status || 'pending',\n        payment_method: sale.payment_method || 'cash',\n        total_amount: sale.total_amount || sale.subtotal,\n        paid_amount: sale.paid_amount || 0,\n        remaining_amount: sale.remaining_amount || (parseFloat(sale.total_amount || sale.subtotal) - parseFloat(sale.paid_amount || 0)),\n        due_date: sale.due_date || null,\n        subtotal: sale.subtotal,\n        discount_amount: sale.discount_amount || 0,\n        tax_amount: sale.tax_amount || 0,\n        items: sale.items?.map(item => ({\n          product_name: item.product_name,\n          product_sku: item.product_sku,\n          quantity: item.quantity,\n          quantity_display: item.quantity_display,\n          unit_name: item.unit_name,\n          unit_price: item.unit_price,\n          total_price: item.total_price\n        })) || []\n      };\n\n      // Generate print content using the standardized system\n      const printContent = generatePrintContent(printData, t('titles.sale_receipt'), 'sale', t);\n      \n      // Open print window\n      const printWindow = window.open('', '_blank', 'width=800,height=600');\n      \n      if (!printWindow) {\n        throw new Error('Failed to open print window. Please check popup blockers.');\n      }\n      \n      printWindow.document.write(printContent);\n      printWindow.document.close();\n      \n      // Wait for content to load then print\n      const printAfterLoad = () => {\n        printWindow.focus();\n        printWindow.print();\n        // Close the window after a short delay\n        setTimeout(() => {\n          printWindow.close();\n        }, 1000);\n      };\n      \n      // Check if window is already loaded\n      if (printWindow.document.readyState === 'complete') {\n        printAfterLoad();\n      } else {\n        printWindow.onload = printAfterLoad;\n      }\n      \n    } catch (error) {\n      console.error('Print error:', error);\n      alert('Failed to print receipt. Please try again. Error: ' + error.message);\n    }\n  };\n\n  const editSale = (sale) => {\n    setEditingSale(sale);\n    \n    // Initialize items with proper quantities and calculate totals\n    const items = sale.items?.map(item => {\n      const quantity = parseFloat(item.quantity_display || item.quantity) || 0;\n      const unitPrice = parseFloat(item.unit_price) || 0;\n      const calculatedTotalPrice = quantity * unitPrice;\n      \n      return {\n        ...item,\n        quantity: quantity,\n        unit_price: unitPrice,\n        total_price: calculatedTotalPrice\n      };\n    }) || [];\n    \n    // Calculate initial totals based on current item data\n    const calculatedSubtotal = items.reduce((sum, item) => sum + item.total_price, 0);\n    \n    // If no tax_amount is provided, assume 0% tax (common for many sales)\n    const taxAmount = parseFloat(sale.tax_amount || 0) || 0;\n    const discountAmount = parseFloat(sale.discount_amount || 0) || 0;\n    const calculatedTotal = calculatedSubtotal + taxAmount - discountAmount;\n    \n    // Always use calculated totals to ensure accuracy\n    const subtotal = calculatedSubtotal;\n    const total_amount = calculatedTotal;\n    \n    const formData = {\n      customer_name: sale.customer_name || '',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      payment_method: sale.payment_method || 'cash',\n      items: items,\n      subtotal: subtotal,\n      total_amount: total_amount,\n      tax_amount: sale.tax_amount || 0,\n      discount_amount: sale.discount_amount || 0\n    };\n    \n    \n    setEditFormData(formData);\n    setEditTotals({ subtotal: subtotal, total_amount: total_amount });\n    \n    // Initialize payment options\n    const currentPaidAmount = parseFloat(sale.paid_amount) || 0;\n    const calculatedTotalAmount = total_amount; // Use the calculated total from form data\n    \n    if (currentPaidAmount >= calculatedTotalAmount) {\n      setPaymentType('full');\n      setPaidAmount(calculatedTotalAmount);\n    } else if (currentPaidAmount > 0) {\n      setPaymentType('partial');\n      setPaidAmount(currentPaidAmount);\n    } else {\n      setPaymentType('full');\n      setPaidAmount(calculatedTotalAmount);\n    }\n    \n    setShowEditModal(true);\n    setShowSaleModal(false);\n  };\n\n  const handleEditItemQuantity = (itemIndex, newQuantity) => {\n    \n    if (!editFormData.items || !Array.isArray(editFormData.items)) {\n      console.error('editFormData.items is not properly initialized:', editFormData);\n      return;\n    }\n    \n    const updatedItems = [...editFormData.items];\n    updatedItems[itemIndex].quantity = parseFloat(newQuantity) || 0;\n    updatedItems[itemIndex].total_price = updatedItems[itemIndex].quantity * parseFloat(updatedItems[itemIndex].unit_price) || 0;\n    \n    \n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal\n    });\n    \n    // Fallback to original sale values if editFormData doesn't have them\n    const taxAmount = parseFloat(editFormData.tax_amount !== undefined ? editFormData.tax_amount : (editingSale?.tax_amount || 0)) || 0;\n    const discountAmount = parseFloat(editFormData.discount_amount !== undefined ? editFormData.discount_amount : (editingSale?.discount_amount || 0)) || 0;\n    const newTotalAmount = subtotal + taxAmount - discountAmount;\n    \n    setEditTotals({\n      subtotal: subtotal,\n      taxAmount: taxAmount,\n      discountAmount: discountAmount,\n      newTotalAmount: newTotalAmount,\n      editFormDataTax: editFormData.tax_amount,\n      editFormDataDiscount: editFormData.discount_amount\n    });\n    \n    const newEditFormData = {\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: newTotalAmount\n    };\n    \n    \n    setEditFormData(newEditFormData);\n    setEditTotals({ subtotal: subtotal, total_amount: newTotalAmount });\n    \n    // Force a re-render by logging the state after setting it\n    setTimeout(() => {\n    }, 100);\n  };\n\n  const removeEditItem = (itemIndex) => {\n    const updatedItems = editFormData.items.filter((_, index) => index !== itemIndex);\n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    // Fallback to original sale values if editFormData doesn't have them\n    const taxAmount = parseFloat(editFormData.tax_amount !== undefined ? editFormData.tax_amount : (editingSale?.tax_amount || 0)) || 0;\n    const discountAmount = parseFloat(editFormData.discount_amount !== undefined ? editFormData.discount_amount : (editingSale?.discount_amount || 0)) || 0;\n    const newTotalAmount = subtotal + taxAmount - discountAmount;\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: newTotalAmount\n    });\n    setEditTotals({ subtotal: subtotal, total_amount: newTotalAmount });\n  };\n\n  const calculateEditTotal = () => {\n    return editFormData.items?.reduce((total, item) => {\n      return total + (parseFloat(item.total_price || 0));\n    }, 0) || 0;\n  };\n\n  // Update paid amount when payment type changes or subtotal changes\n  useEffect(() => {\n    if (paymentType === 'full') {\n      setPaidAmount(editTotals.subtotal || 0);\n    }\n  }, [paymentType, editTotals.subtotal]);\n\n\n  const saveEditedSale = async () => {\n    try {\n      const updateData = {\n        customer_name: editFormData.customer_name,\n        customer_phone: editFormData.customer_phone,\n        customer_email: editFormData.customer_email,\n        payment_method: editFormData.payment_method,\n        paid_amount: paidAmount,\n        items: editFormData.items.map(item => ({\n          id: item.id,\n          quantity: item.quantity,\n          unit_price: item.unit_price\n        }))\n      };\n      \n      console.log('Saving edited sale:', {\n        saleId: editingSale.id,\n        updateData: updateData,\n        editFormData: editFormData\n      });\n      \n      const response = await api.patch(`/sales/${editingSale.id}/`, updateData);\n      \n      setShowEditModal(false);\n      setEditingSale(null);\n      setEditFormData({});\n      \n      // Refresh the pending sales list\n      fetchPendingSales();\n      \n      alert('Sale updated successfully!');\n    } catch (error) {\n      console.error('Error updating sale:', error);\n      alert('Error updating sale: ' + (error.response?.data?.detail || error.message));\n    }\n  };\n\n  if (authLoading || loading) {\n    return (\n      <div className=\"pending-sales-page\">\n        <div className=\"page-header\">\n          <h1>{t('titles.pending_sales')}</h1>\n        </div>\n        <div className=\"loading-message\">Loading pending sales...</div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"pending-sales-page\">\n        <div className=\"page-header\">\n          <h1>{t('titles.pending_sales')}</h1>\n        </div>\n        <div className=\"loading-message\">Please log in to view pending sales.</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"pending-sales-page\">\n      <div className=\"page-header\">\n        <h1>{t('titles.pending_sales')}</h1>\n        <p>Manage and validate pending sales before completion</p>\n      </div>\n\n      {pendingSales.length === 0 ? (\n        <div className=\"no-pending-sales\">\n          <div className=\"no-sales-icon\">📋</div>\n          <h3>{t('titles.no_pending_sales')}</h3>\n          <p>All sales have been completed or there are no pending sales at the moment.</p>\n        </div>\n      ) : (\n        <div className=\"pending-sales-grid\">\n          {pendingSales.map((sale) => (\n            <div key={sale.id} className=\"pending-sale-card\">\n              <div className=\"sale-header\">\n                <div className=\"sale-number\">{sale.sale_number}</div>\n                <div className=\"sale-date\">{formatDate(sale.created_at)}</div>\n              </div>\n              \n              <div className=\"sale-customer\">\n                <strong>{sale.customer_name || 'Walk-in Customer'}</strong>\n              </div>\n              \n              <div className=\"sale-items\">\n                <div className=\"items-count\">{sale.items?.length || 0} items</div>\n                <div className=\"items-preview\">\n                  {sale.items?.slice(0, 3).map((item, index) => (\n                    <div key={index} className=\"item-preview\">\n                      <span className=\"item-name\">{item.product_name}</span>\n                      <span className=\"item-quantity\">{item.quantity_display || item.quantity} {item.unit_name}</span>\n                      <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                        {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                      </span>\n                    </div>\n                  ))}\n                  {sale.items?.length > 3 && (\n                    <div className=\"more-items\">+{sale.items.length - 3} more items</div>\n                  )}\n                </div>\n              </div>\n              \n              <div className=\"sale-total\">\n                <strong>{formatCurrency(sale.total_amount)}</strong>\n              </div>\n              \n              <div className=\"stock-status\">\n                {stockValidationStatus[sale.id]?.hasInsufficientStock ? (\n                  <div className=\"stock-insufficient\">⚠️ Insufficient Stock</div>\n                ) : (\n                  <div className=\"stock-sufficient\">✅ Stock Available</div>\n                )}\n              </div>\n              \n              <div className=\"sale-actions\">\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={async () => {\n                    try {\n                      // Fetch complete sale data including items\n                      const response = await api.get(`/api/sales/${sale.id}/`);\n                      setSelectedSale(response.data);\n                      setShowSaleModal(true);\n                    } catch (error) {\n                      console.error('Error fetching sale details:', error);\n                      // Fallback to using the sale data from the list\n                      setSelectedSale(sale);\n                      setShowSaleModal(true);\n                    }\n                  }}\n                >\n                  View Details\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => printPendingSale(sale)}\n                >\n                  🖨️ Print\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => editSale(sale)}\n                >\n                  ✏️ Edit\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"primary\"\n                  disabled={stockValidationStatus[sale.id]?.hasInsufficientStock}\n                  onClick={() => completeSale(sale.id)}\n                  loading={completingSale === sale.id}\n                >\n                  {stockValidationStatus[sale.id]?.hasInsufficientStock ? t('buttons.insufficient_stock') : t('buttons.complete_sale')}\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Sale Details Modal */}\n      {showSaleModal && selectedSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal sale-details-modal\">\n            <div className=\"modal-header\">\n              <h2>Sale Details - {selectedSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"info-section\">\n                <h3>Customer Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Name:</span>\n                    <span className=\"info-value\">{selectedSale.customer_name || 'Walk-in Customer'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Phone:</span>\n                    <span className=\"info-value\">{selectedSale.customer_phone || 'N/A'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Email:</span>\n                    <span className=\"info-value\">{selectedSale.customer_email || 'N/A'}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Sale Information */}\n              <div className=\"info-section\">\n                <h3>Sale Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Date:</span>\n                    <span className=\"info-value\">{formatDate(selectedSale.created_at)}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Payment Method:</span>\n                    <span className=\"info-value\">{selectedSale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Status:</span>\n                    <span className=\"status-badge pending\">Pending</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Items List */}\n              <div className=\"items-section\">\n                <h3>Items ({selectedSale.items?.length || 0})</h3>\n                <div \n                  className=\"items-container\"\n                  style={{\n                    minHeight: `${Math.max(200, (selectedSale.items?.length || 0) * 120)}px`,\n                    maxHeight: '500px'\n                  }}\n                >\n                  {selectedSale.items?.map((item, index) => (\n                    <div key={index} className=\"item-card\" style={{marginBottom: '12px'}}>\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-quantity\">\n                          <span className=\"quantity\">{item.quantity_display || item.quantity || 'N/A'}</span>\n                          <span className=\"unit\">{item.unit_name || 'N/A'}</span>\n                        </div>\n                        <div className=\"item-price\">\n                          <span className=\"unit-price\">{item.unit_price ? formatCurrency(item.unit_price) : 'N/A'} each</span>\n                          <span className=\"total-price\">{item.total_price ? formatCurrency(item.total_price) : 'N/A'}</span>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.subtotal)}</span>\n                  </div>\n                  {selectedSale.discount_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Discount:</span>\n                      <span className=\"total-value\">-{formatCurrency(selectedSale.discount_amount)}</span>\n                    </div>\n                  )}\n                  {selectedSale.tax_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Tax:</span>\n                      <span className=\"total-value\">{formatCurrency(selectedSale.tax_amount)}</span>\n                    </div>\n                  )}\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.total_amount)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Stock Status */}\n              <div className=\"stock-section\">\n                <h3>Stock Status</h3>\n                <div className=\"stock-status\">\n                  {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? (\n                    <div className=\"stock-insufficient\">\n                      ⚠️ Insufficient Stock\n                    </div>\n                  ) : (\n                    <div className=\"stock-sufficient\">\n                      ✅ Stock Available\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                Close\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={() => printPendingSale(selectedSale)}\n              >\n                🖨️ Print Receipt\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={() => editSale(selectedSale)}\n              >\n                ✏️ Edit\n              </Button>\n              <Button\n                variant=\"success\"\n                disabled={stockValidationStatus[selectedSale.id]?.hasInsufficientStock}\n                onClick={() => completeSale(selectedSale.id)}\n              >\n                {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? t('buttons.insufficient_stock') : t('buttons.complete_sale')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Sale Modal */}\n      {showEditModal && editingSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal edit-sale-modal\">\n            <div className=\"modal-header\">\n              <h2>Edit Sale - {editingSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"form-section\">\n                <h3>Customer Information</h3>\n                <div className=\"form-grid\">\n                  <div className=\"form-group\">\n                    <label>Customer Name</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_name || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_name: e.target.value})}\n                      placeholder={t('forms.customer_name')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Phone</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_phone || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_phone: e.target.value})}\n                      placeholder={t('forms.phone_number')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Email</label>\n                    <input\n                      type=\"email\"\n                      value={editFormData.customer_email || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_email: e.target.value})}\n                      placeholder={t('forms.email_address')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Payment Method</label>\n                    <select\n                      value={editFormData.payment_method || 'cash'}\n                      onChange={(e) => setEditFormData({...editFormData, payment_method: e.target.value})}\n                    >\n                      <option value=\"cash\">Cash</option>\n                      <option value=\"card\">Card</option>\n                      <option value=\"mobile_money\">Mobile Money</option>\n                      <option value=\"bank_transfer\">Bank Transfer</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n\n              {/* Payment Options */}\n              <div className=\"form-section\">\n                <h3>Payment Type</h3>\n                <div className=\"payment-types\">\n                  <label className=\"payment-type\">\n                    <input\n                      type=\"radio\"\n                      name=\"paymentType\"\n                      value=\"full\"\n                      checked={paymentType === 'full'}\n                      onChange={(e) => setPaymentType(e.target.value)}\n                    />\n                    <span>Full Payment (100%)</span>\n                  </label>\n                  <label className=\"payment-type\">\n                    <input\n                      type=\"radio\"\n                      name=\"paymentType\"\n                      value=\"partial\"\n                      checked={paymentType === 'partial'}\n                      onChange={(e) => setPaymentType(e.target.value)}\n                    />\n                    <span>Partial Payment (0-99.99%)</span>\n                  </label>\n                </div>\n                \n                {paymentType === 'partial' && (\n                  <div className=\"form-group\">\n                    <label>Amount to Pay</label>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      max={editTotals.subtotal || 0}\n                      value={paidAmount || 0}\n                      onChange={(e) => {\n                        const value = parseFloat(e.target.value) || 0;\n                        setPaidAmount(value);\n                      }}\n                      placeholder={t('forms.enter_amount_to_pay')}\n                    />\n                    <small>\n                      Total: {formatCurrency(editTotals.subtotal || 0)} | \n                      Remaining: {formatCurrency((editTotals.subtotal || 0) - (paidAmount || 0))}\n                    </small>\n                  </div>\n                )}\n                \n                {paymentType === 'full' && (\n                  <div className=\"form-group\">\n                    <label>Amount to Pay</label>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      value={editTotals.subtotal || 0}\n                      readOnly\n                      className=\"form-control\"\n                    />\n                    <small>Full payment for the total amount.</small>\n                  </div>\n                )}\n              </div>\n\n              {/* Items */}\n              <div className=\"form-section\">\n                <h3>Items ({editFormData.items?.length || 0})</h3>\n                <div className=\"items-edit-container\">\n                  {editFormData.items?.map((item, index) => (\n                    <div key={index} className=\"edit-item-card\">\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-unit\">{item.unit_name}</div>\n                        <div className=\"item-price\">{formatCurrency(item.unit_price)} each</div>\n                      </div>\n                      <div className=\"item-controls\">\n                        <div className=\"control-group\">\n                          <label>Quantity:</label>\n                          <input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            value={item.quantity}\n                            onChange={(e) => handleEditItemQuantity(index, e.target.value)}\n                          />\n                        </div>\n                        <div className=\"control-group\">\n                          <label>Price Mode:</label>\n                          <select\n                            value={item.price_mode}\n                            disabled\n                            style={{ backgroundColor: '#f5f5f5', color: '#666' }}\n                          >\n                            <option value=\"standard\">Standard</option>\n                            <option value=\"wholesale\">Wholesale</option>\n                          </select>\n                        </div>\n                        <div className=\"item-total\">\n                          {formatCurrency(item.total_price)}\n                        </div>\n                        <div className=\"item-actions\">\n                          <Button\n                            size=\"small\"\n                            variant=\"danger\"\n                            onClick={() => removeEditItem(index)}\n                          >\n                            Remove\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(editTotals.subtotal || 0)}</span>\n                  </div>\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(editTotals.total_amount || 0)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={saveEditedSale}\n              >\n                Save Changes\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Packaging Validation Modal */}\n      {showPackagingValidation && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal-content packaging-validation-modal\">\n            <PackagingValidation\n              saleId={packagingValidationSaleId}\n              onComplete={handlePackagingValidationComplete}\n              onCancel={handlePackagingValidationCancel}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PendingSales;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}