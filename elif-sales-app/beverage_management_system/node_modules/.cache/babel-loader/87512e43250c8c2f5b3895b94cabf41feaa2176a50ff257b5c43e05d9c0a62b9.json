{"ast":null,"code":"import _objectSpread from\"/home/el-ifran/WareHouse_Manager/beverage_management_system/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import api from'../services/api';import Button from'../components/Button';import'./PendingSales.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PendingSales=()=>{var _selectedSale$payment,_selectedSale$items,_stockValidationStatu3,_stockValidationStatu4,_editFormData$items,_editFormData$items2,_editFormData$items3;const[pendingSales,setPendingSales]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[selectedSale,setSelectedSale]=useState(null);const[showSaleModal,setShowSaleModal]=useState(false);const[completingSale,setCompletingSale]=useState(null);const[stockValidationStatus,setStockValidationStatus]=useState({});const[editingSale,setEditingSale]=useState(null);const[showEditModal,setShowEditModal]=useState(false);const[editFormData,setEditFormData]=useState({});useEffect(()=>{fetchPendingSales();},[]);// Validate stock for all pending sales when the list changes\nuseEffect(()=>{if(pendingSales.length>0){validateStockForAllSales();}},[pendingSales]);const fetchPendingSales=async()=>{try{setLoading(true);setError('');const response=await api.get('/sales/?status=pending');setPendingSales(response.data.results||response.data);}catch(err){setError('Failed to fetch pending sales');console.error('Pending sales fetch error:',err);}finally{setLoading(false);}};const validateStockForAllSales=async()=>{const validationStatus={};for(const sale of pendingSales){let hasInsufficientStock=false;const stockIssues=[];for(const item of sale.items||[]){try{const stockResponse=await api.get(\"/products/\".concat(item.product,\"/stock-availability/\"));const stockData=stockResponse.data;const unitStockInfo=stockData.available_units.find(unit=>unit.id===item.unit);if(unitStockInfo){const availableQuantity=parseFloat(unitStockInfo.available_quantity||0);const requiredQuantity=parseFloat(item.quantity||0);if(availableQuantity<requiredQuantity){hasInsufficientStock=true;stockIssues.push(\"\".concat(item.product_name,\": \").concat(requiredQuantity,\" \").concat(item.unit_name,\" required, \").concat(availableQuantity,\" available\"));}}}catch(err){console.error(\"Error validating stock for sale \".concat(sale.id,\":\"),err);}}validationStatus[sale.id]={hasInsufficientStock,stockIssues};}setStockValidationStatus(validationStatus);};const completeSale=async saleId=>{try{setCompletingSale(saleId);setError('');// Find the sale to validate\nconst sale=pendingSales.find(s=>s.id===saleId);if(!sale){setError('Sale not found');return;}// Check stock availability for each item\nconst stockValidationErrors=[];for(const item of sale.items||[]){try{// Get current stock availability for this product\nconst stockResponse=await api.get(\"/products/\".concat(item.product,\"/stock-availability/\"));const stockData=stockResponse.data;// Find the stock info for the unit used in this sale item\nconst unitStockInfo=stockData.available_units.find(unit=>unit.id===item.unit);if(!unitStockInfo){stockValidationErrors.push(\"\".concat(item.product_name,\": Unit not found in stock data\"));continue;}// Check if there's enough stock\nconst availableQuantity=parseFloat(unitStockInfo.available_quantity||0);const requiredQuantity=parseFloat(item.quantity||0);if(availableQuantity<requiredQuantity){stockValidationErrors.push(\"\".concat(item.product_name,\": Insufficient stock. Required: \").concat(requiredQuantity,\" \").concat(item.unit_name,\", Available: \").concat(availableQuantity,\" \").concat(item.unit_name));}}catch(stockErr){console.error(\"Error checking stock for product \".concat(item.product,\":\"),stockErr);stockValidationErrors.push(\"\".concat(item.product_name,\": Unable to check stock availability\"));}}// If there are stock validation errors, show them and prevent completion\nif(stockValidationErrors.length>0){setError(\"Cannot complete sale due to insufficient stock:\\n\\n\".concat(stockValidationErrors.join('\\n')));return;}// If stock validation passes, proceed with completion\nawait api.post(\"/sales/\".concat(saleId,\"/complete/\"));// Print receipt for the completed sale\nprintPendingSale(_objectSpread(_objectSpread({},sale),{},{status:'completed'}));// Remove the completed sale from the list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));// Close modal if it was open for this sale\nif(selectedSale&&selectedSale.id===saleId){setShowSaleModal(false);setSelectedSale(null);}alert('Sale completed successfully!');}catch(err){var _err$response,_err$response$data;setError(\"Failed to complete sale: \".concat(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message));console.error('Complete sale error:',err);}finally{setCompletingSale(null);}};const cancelSale=async saleId=>{if(!window.confirm('Are you sure you want to cancel this sale?')){return;}try{setError('');await api.patch(\"/sales/\".concat(saleId,\"/\"),{status:'cancelled'});// Remove the cancelled sale from the list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));// Close modal if it was open for this sale\nif(selectedSale&&selectedSale.id===saleId){setShowSaleModal(false);setSelectedSale(null);}alert('Sale cancelled successfully!');}catch(err){var _err$response2,_err$response2$data;setError(\"Failed to cancel sale: \".concat(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||err.message));console.error('Cancel sale error:',err);}};const viewSaleDetails=async sale=>{try{setSelectedSale(sale);setShowSaleModal(true);}catch(err){setError('Failed to load sale details');console.error('Sale details error:',err);}};const editSale=sale=>{var _sale$items;setEditingSale(sale);setEditFormData({customer_name:sale.customer_name||'',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',payment_method:sale.payment_method||'cash',items:((_sale$items=sale.items)===null||_sale$items===void 0?void 0:_sale$items.map(item=>({id:item.id,product:item.product,product_name:item.product_name,unit:item.unit,unit_name:item.unit_name,quantity:item.quantity_display||item.quantity,unit_price:item.unit_price,total_price:item.total_price,price_mode:item.price_mode||'standard'})))||[]});setShowEditModal(true);};const handleEditItemQuantity=(itemIndex,newQuantity)=>{const updatedItems=[...editFormData.items];updatedItems[itemIndex]=_objectSpread(_objectSpread({},updatedItems[itemIndex]),{},{quantity:parseFloat(newQuantity)||0,total_price:(parseFloat(newQuantity)||0)*parseFloat(updatedItems[itemIndex].unit_price)});setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems}));};const removeEditItem=itemIndex=>{const updatedItems=editFormData.items.filter((_,index)=>index!==itemIndex);setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems}));};const handleEditItemPriceMode=async(itemIndex,newPriceMode)=>{const updatedItems=[...editFormData.items];const item=updatedItems[itemIndex];try{var _product$compatible_u;// Get the product's current prices for the selected unit\nconst productResponse=await api.get(\"/products/\".concat(item.product,\"/\"));const product=productResponse.data;// Find the compatible unit to get the correct price\nconst compatibleUnit=(_product$compatible_u=product.compatible_units)===null||_product$compatible_u===void 0?void 0:_product$compatible_u.find(cu=>{var _cu$unit;return(((_cu$unit=cu.unit)===null||_cu$unit===void 0?void 0:_cu$unit.id)||cu.unit)===item.unit;});if(compatibleUnit){let newUnitPrice;if(newPriceMode==='wholesale'){newUnitPrice=compatibleUnit.wholesale_price||compatibleUnit.price;}else{newUnitPrice=compatibleUnit.price;}updatedItems[itemIndex]=_objectSpread(_objectSpread({},item),{},{price_mode:newPriceMode,unit_price:newUnitPrice,total_price:parseFloat(item.quantity)*parseFloat(newUnitPrice)});setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems}));}}catch(err){console.error('Error fetching product prices:',err);// Fallback: just update the price mode without changing the price\nupdatedItems[itemIndex]=_objectSpread(_objectSpread({},item),{},{price_mode:newPriceMode});setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems}));}};const saveEditedSale=async()=>{try{setError('');// Prepare the data for the API\nconst updateData={customer_name:editFormData.customer_name,customer_phone:editFormData.customer_phone,customer_email:editFormData.customer_email,payment_method:editFormData.payment_method,items:editFormData.items.map(item=>({id:item.id,quantity:item.quantity,unit_price:item.unit_price,price_mode:item.price_mode}))};await api.patch(\"/sales/\".concat(editingSale.id,\"/\"),updateData);// Refresh the pending sales list\nawait fetchPendingSales();// Close the edit modal\nsetShowEditModal(false);setEditingSale(null);setEditFormData({});alert('Sale updated successfully!');}catch(err){var _err$response3,_err$response3$data;setError(\"Failed to update sale: \".concat(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||err.message));console.error('Update sale error:',err);}};const printPendingSale=sale=>{// Create print data for the pending sale\nconst printData={sale_number:sale.sale_number,customer_name:sale.customer_name||'Walk-in Customer',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',user_name:sale.user_name||'Unknown User',user_id:sale.user_id||'unknown',created_at:sale.created_at,print_timestamp:new Date().toISOString(),print_id:\"PRINT-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9)),status:'pending',total_amount:sale.total_amount,items:sale.items.map(item=>({product_name:item.product_name,product_sku:item.product_sku||'',quantity:item.quantity_display||item.quantity,unit_name:item.unit_name,unit_price:item.unit_price,total_price:item.total_price||parseFloat(item.quantity_display||item.quantity)*parseFloat(item.unit_price)}))};// Create print content\nconst printContent=\"\\n      <!DOCTYPE html>\\n      <html>\\n      <head>\\n        <title>Sale Receipt - \".concat(sale.sale_number,\"</title>\\n        <style>\\n          body { font-family: Arial, sans-serif; margin: 20px; }\\n          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }\\n          .sale-info { margin-bottom: 20px; }\\n          .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\\n          .items-table th, .items-table td { border: 1px solid #000; padding: 8px; text-align: left; }\\n          .items-table th { background-color: #f0f0f0; }\\n          .total { text-align: right; font-weight: bold; font-size: 1.2em; }\\n          .status { text-align: center; margin-top: 20px; padding: 10px; background-color: #fff3cd; border: 1px solid #ffeaa7; }\\n        </style>\\n      </head>\\n      <body>\\n        <div class=\\\"header\\\">\\n          <h1>Sale Receipt</h1>\\n          <h2>\").concat(printData.sale_number,\"</h2>\\n        </div>\\n        \\n        <div class=\\\"sale-info\\\">\\n          <p><strong>Customer:</strong> \").concat(printData.customer_name,\"</p>\\n          \").concat(printData.customer_phone?\"<p><strong>Phone:</strong> \".concat(printData.customer_phone,\"</p>\"):'',\"\\n          \").concat(printData.customer_email?\"<p><strong>Email:</strong> \".concat(printData.customer_email,\"</p>\"):'',\"\\n          <p><strong>Date:</strong> \").concat(new Date(printData.created_at).toLocaleString(),\"</p>\\n          <p><strong>Cashier:</strong> \").concat(printData.user_name,\"</p>\\n        </div>\\n        \\n        <table class=\\\"items-table\\\">\\n          <thead>\\n            <tr>\\n              <th>Product</th>\\n              <th>Unit</th>\\n              <th>Qty</th>\\n              <th>Unit Price</th>\\n              <th>Total</th>\\n            </tr>\\n          </thead>\\n          <tbody>\\n            \").concat(printData.items.map(item=>\"\\n              <tr>\\n                <td>\".concat(item.product_name,\"</td>\\n                <td>\").concat(item.unit_name,\"</td>\\n                <td>\").concat(item.quantity,\"</td>\\n                <td>\").concat(parseFloat(item.unit_price).toFixed(2),\" MGA</td>\\n                <td>\").concat(parseFloat(item.total_price).toFixed(2),\" MGA</td>\\n              </tr>\\n            \")).join(''),\"\\n          </tbody>\\n        </table>\\n        \\n        <div class=\\\"total\\\">\\n          <p><strong>Total Amount: \").concat(parseFloat(printData.total_amount).toFixed(2),\" MGA</strong></p>\\n        </div>\\n        \\n        <div class=\\\"status\\\">\\n          <p><strong>Status: \").concat(printData.status.toUpperCase(),\"</strong></p>\\n          <p>\").concat(printData.status==='pending'?'This sale is pending':'This sale has been completed',\"</p>\\n        </div>\\n        \\n        <div style=\\\"text-align: center; margin-top: 20px; font-size: 0.8em; color: #666;\\\">\\n          <p>Printed on: \").concat(new Date(printData.print_timestamp).toLocaleString(),\"</p>\\n          <p>Print ID: \").concat(printData.print_id,\"</p>\\n        </div>\\n      </body>\\n      </html>\\n    \");// Open print window\nconst printWindow=window.open('','_blank','width=800,height=600');printWindow.document.write(printContent);printWindow.document.close();// Wait for content to load then print\nprintWindow.onload=()=>{printWindow.focus();printWindow.print();// Close the window after a short delay\nsetTimeout(()=>{printWindow.close();},1000);};};const formatDate=dateString=>{return new Date(dateString).toLocaleString();};const formatCurrency=amount=>{return parseFloat(amount).toFixed(2);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Loading pending sales...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Pending Sales Validation\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Review and complete pending sales\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header-actions\",children:/*#__PURE__*/_jsx(Button,{onClick:fetchPendingSales,variant:\"outline\",children:\"Refresh\"})})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:pendingSales.length}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Pending Sales\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:formatCurrency(pendingSales.reduce((total,sale)=>total+parseFloat(sale.total_amount),0))}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total Value (MGA)\"})]})]}),pendingSales.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-pending-sales\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"no-sales-icon\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Pending Sales\"}),/*#__PURE__*/_jsx(\"p\",{children:\"All sales have been processed. Great job!\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales-list\",children:pendingSales.map(sale=>{var _sale$items2,_sale$payment_method,_stockValidationStatu,_stockValidationStatu2;return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sale-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sale-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sale-number\",children:sale.sale_number}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Customer:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:sale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:formatDate(sale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Items:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[((_sale$items2=sale.items)===null||_sale$items2===void 0?void 0:_sale$items2.length)||0,\" items\"]})]}),sale.items&&sale.items.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"items-preview\",children:[sale.items.slice(0,3).map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-preview\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-quantity\",children:[item.quantity_display||item.quantity,\" \",item.unit_name]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-pricing\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-price\",children:[formatCurrency(item.total_price),\" MGA\"]})]})]},index)),sale.items.length>3&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-items\",children:[\"+\",sale.items.length-3,\" more items\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value total-amount\",children:[formatCurrency(sale.total_amount),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Payment:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:(_sale$payment_method=sale.payment_method)===null||_sale$payment_method===void 0?void 0:_sale$payment_method.replace('_',' ').toUpperCase()})]}),stockValidationStatus[sale.id]&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-row stock-status\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Stock Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value \".concat(stockValidationStatus[sale.id].hasInsufficientStock?'stock-insufficient':'stock-sufficient'),children:stockValidationStatus[sale.id].hasInsufficientStock?'⚠️ Insufficient Stock':'✅ Stock Available'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-actions\",children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>viewSaleDetails(sale),children:\"View Details\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>editSale(sale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>printPendingSale(sale),children:\"\\uD83D\\uDDA8\\uFE0F Print\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"primary\",onClick:()=>completeSale(sale.id),loading:completingSale===sale.id,disabled:completingSale===sale.id||((_stockValidationStatu=stockValidationStatus[sale.id])===null||_stockValidationStatu===void 0?void 0:_stockValidationStatu.hasInsufficientStock),children:(_stockValidationStatu2=stockValidationStatus[sale.id])!==null&&_stockValidationStatu2!==void 0&&_stockValidationStatu2.hasInsufficientStock?'Insufficient Stock':'Complete Sale'}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>cancelSale(sale.id),children:\"Cancel Sale\"})]})]},sale.id);})}),showSaleModal&&selectedSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal sale-details-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Sale Details - \",selectedSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sale-details-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedSale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedSale.customer_phone||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedSale.customer_email||'N/A'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sale Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:formatDate(selectedSale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Payment Method:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:(_selectedSale$payment=selectedSale.payment_method)===null||_selectedSale$payment===void 0?void 0:_selectedSale$payment.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section items-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"items-list\",children:(_selectedSale$items=selectedSale.items)===null||_selectedSale$items===void 0?void 0:_selectedSale$items.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[item.quantity_display||item.quantity,\" \",item.unit_name,\" \\xD7 \",formatCurrency(item.unit_price),\" MGA\",/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-total\",children:[formatCurrency(item.total_price),\" MGA\"]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency(selectedSale.subtotal),\" MGA\"]})]}),selectedSale.discount_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Discount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[\"-\",formatCurrency(selectedSale.discount_amount),\" MGA\"]})]}),selectedSale.tax_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Tax:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency(selectedSale.tax_amount),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-row total\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency(selectedSale.total_amount),\" MGA\"]})]})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);editSale(selectedSale);},children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>printPendingSale(selectedSale),children:\"\\uD83D\\uDDA8\\uFE0F Print Receipt\"}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:()=>cancelSale(selectedSale.id),children:\"Cancel Sale\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:()=>completeSale(selectedSale.id),loading:completingSale===selectedSale.id,disabled:completingSale===selectedSale.id||((_stockValidationStatu3=stockValidationStatus[selectedSale.id])===null||_stockValidationStatu3===void 0?void 0:_stockValidationStatu3.hasInsufficientStock),children:(_stockValidationStatu4=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu4!==void 0&&_stockValidationStatu4.hasInsufficientStock?'Insufficient Stock':'Complete Sale'})]})]})}),showEditModal&&editingSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal edit-sale-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Edit Sale - \",editingSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"edit-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_name||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_name:e.target.value})),placeholder:\"Customer name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_phone||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_phone:e.target.value})),placeholder:\"Phone number\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:editFormData.customer_email||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_email:e.target.value})),placeholder:\"Email address\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:editFormData.payment_method||'cash',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{payment_method:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"card\",children:\"Card\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mobile_money\",children:\"Mobile Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_transfer\",children:\"Bank Transfer\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section items-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"items-edit-list\",children:(_editFormData$items=editFormData.items)===null||_editFormData$items===void 0?void 0:_editFormData$items.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"edit-item-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"div\",{className:\"item-unit\",children:item.unit_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[formatCurrency(item.unit_price),\" MGA each\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-quantity\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Quantity:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.01\",value:item.quantity,onChange:e=>handleEditItemQuantity(index,e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price-mode\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price Mode:\"}),/*#__PURE__*/_jsxs(\"select\",{value:item.price_mode,onChange:e=>handleEditItemPriceMode(index,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"standard\",children:\"Standard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"wholesale\",children:\"Wholesale\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-total\",children:[formatCurrency(item.total_price),\" MGA\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-actions\",children:/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>removeEditItem(index),children:\"Remove\"})})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-totals\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency((_editFormData$items2=editFormData.items)===null||_editFormData$items2===void 0?void 0:_editFormData$items2.reduce((sum,item)=>sum+parseFloat(item.total_price||0),0)),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-row total\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[formatCurrency((_editFormData$items3=editFormData.items)===null||_editFormData$items3===void 0?void 0:_editFormData$items3.reduce((sum,item)=>sum+parseFloat(item.total_price||0),0)),\" MGA\"]})]})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:saveEditedSale,disabled:!editFormData.items||editFormData.items.length===0,children:\"Save Changes\"})]})]})})]});};export default PendingSales;","map":{"version":3,"names":["React","useState","useEffect","api","Button","jsx","_jsx","jsxs","_jsxs","PendingSales","_selectedSale$payment","_selectedSale$items","_stockValidationStatu3","_stockValidationStatu4","_editFormData$items","_editFormData$items2","_editFormData$items3","pendingSales","setPendingSales","loading","setLoading","error","setError","selectedSale","setSelectedSale","showSaleModal","setShowSaleModal","completingSale","setCompletingSale","stockValidationStatus","setStockValidationStatus","editingSale","setEditingSale","showEditModal","setShowEditModal","editFormData","setEditFormData","fetchPendingSales","length","validateStockForAllSales","response","get","data","results","err","console","validationStatus","sale","hasInsufficientStock","stockIssues","item","items","stockResponse","concat","product","stockData","unitStockInfo","available_units","find","unit","id","availableQuantity","parseFloat","available_quantity","requiredQuantity","quantity","push","product_name","unit_name","completeSale","saleId","s","stockValidationErrors","stockErr","join","post","printPendingSale","_objectSpread","status","prev","filter","alert","_err$response","_err$response$data","message","cancelSale","window","confirm","patch","_err$response2","_err$response2$data","viewSaleDetails","editSale","_sale$items","customer_name","customer_phone","customer_email","payment_method","map","quantity_display","unit_price","total_price","price_mode","handleEditItemQuantity","itemIndex","newQuantity","updatedItems","removeEditItem","_","index","handleEditItemPriceMode","newPriceMode","_product$compatible_u","productResponse","compatibleUnit","compatible_units","cu","_cu$unit","newUnitPrice","wholesale_price","price","saveEditedSale","updateData","_err$response3","_err$response3$data","printData","sale_number","user_name","user_id","created_at","print_timestamp","Date","toISOString","print_id","now","Math","random","toString","substr","total_amount","product_sku","printContent","toLocaleString","toFixed","toUpperCase","printWindow","open","document","write","close","onload","focus","print","setTimeout","formatDate","dateString","formatCurrency","amount","className","children","onClick","variant","reduce","total","_sale$items2","_sale$payment_method","_stockValidationStatu","_stockValidationStatu2","slice","replace","size","disabled","subtotal","discount_amount","tax_amount","type","value","onChange","e","target","placeholder","min","step","sum"],"sources":["/home/el-ifran/WareHouse_Manager/beverage_management_system/src/pages/PendingSales.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport api from '../services/api';\nimport Button from '../components/Button';\nimport './PendingSales.css';\n\nconst PendingSales = () => {\n  const [pendingSales, setPendingSales] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [selectedSale, setSelectedSale] = useState(null);\n  const [showSaleModal, setShowSaleModal] = useState(false);\n  const [completingSale, setCompletingSale] = useState(null);\n  const [stockValidationStatus, setStockValidationStatus] = useState({});\n  const [editingSale, setEditingSale] = useState(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editFormData, setEditFormData] = useState({});\n\n  useEffect(() => {\n    fetchPendingSales();\n  }, []);\n\n  // Validate stock for all pending sales when the list changes\n  useEffect(() => {\n    if (pendingSales.length > 0) {\n      validateStockForAllSales();\n    }\n  }, [pendingSales]);\n\n  const fetchPendingSales = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      const response = await api.get('/sales/?status=pending');\n      setPendingSales(response.data.results || response.data);\n    } catch (err) {\n      setError('Failed to fetch pending sales');\n      console.error('Pending sales fetch error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateStockForAllSales = async () => {\n    const validationStatus = {};\n    \n    for (const sale of pendingSales) {\n      let hasInsufficientStock = false;\n      const stockIssues = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          const stockResponse = await api.get(`/products/${item.product}/stock-availability/`);\n          const stockData = stockResponse.data;\n          \n          const unitStockInfo = stockData.available_units.find(unit => unit.id === item.unit);\n          if (unitStockInfo) {\n            const availableQuantity = parseFloat(unitStockInfo.available_quantity || 0);\n            const requiredQuantity = parseFloat(item.quantity || 0);\n            \n            if (availableQuantity < requiredQuantity) {\n              hasInsufficientStock = true;\n              stockIssues.push(`${item.product_name}: ${requiredQuantity} ${item.unit_name} required, ${availableQuantity} available`);\n            }\n          }\n        } catch (err) {\n          console.error(`Error validating stock for sale ${sale.id}:`, err);\n        }\n      }\n      \n      validationStatus[sale.id] = {\n        hasInsufficientStock,\n        stockIssues\n      };\n    }\n    \n    setStockValidationStatus(validationStatus);\n  };\n\n  const completeSale = async (saleId) => {\n    try {\n      setCompletingSale(saleId);\n      setError('');\n      \n      // Find the sale to validate\n      const sale = pendingSales.find(s => s.id === saleId);\n      if (!sale) {\n        setError('Sale not found');\n        return;\n      }\n\n      // Check stock availability for each item\n      const stockValidationErrors = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          // Get current stock availability for this product\n          const stockResponse = await api.get(`/products/${item.product}/stock-availability/`);\n          const stockData = stockResponse.data;\n          \n          // Find the stock info for the unit used in this sale item\n          const unitStockInfo = stockData.available_units.find(unit => unit.id === item.unit);\n          if (!unitStockInfo) {\n            stockValidationErrors.push(`${item.product_name}: Unit not found in stock data`);\n            continue;\n          }\n          \n          // Check if there's enough stock\n          const availableQuantity = parseFloat(unitStockInfo.available_quantity || 0);\n          const requiredQuantity = parseFloat(item.quantity || 0);\n          \n          if (availableQuantity < requiredQuantity) {\n            stockValidationErrors.push(\n              `${item.product_name}: Insufficient stock. Required: ${requiredQuantity} ${item.unit_name}, Available: ${availableQuantity} ${item.unit_name}`\n            );\n          }\n        } catch (stockErr) {\n          console.error(`Error checking stock for product ${item.product}:`, stockErr);\n          stockValidationErrors.push(`${item.product_name}: Unable to check stock availability`);\n        }\n      }\n      \n      // If there are stock validation errors, show them and prevent completion\n      if (stockValidationErrors.length > 0) {\n        setError(`Cannot complete sale due to insufficient stock:\\n\\n${stockValidationErrors.join('\\n')}`);\n        return;\n      }\n      \n      // If stock validation passes, proceed with completion\n      await api.post(`/sales/${saleId}/complete/`);\n      \n      // Print receipt for the completed sale\n      printPendingSale({ ...sale, status: 'completed' });\n      \n      // Remove the completed sale from the list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      \n      // Close modal if it was open for this sale\n      if (selectedSale && selectedSale.id === saleId) {\n        setShowSaleModal(false);\n        setSelectedSale(null);\n      }\n      \n      alert('Sale completed successfully!');\n    } catch (err) {\n      setError(`Failed to complete sale: ${err.response?.data?.error || err.message}`);\n      console.error('Complete sale error:', err);\n    } finally {\n      setCompletingSale(null);\n    }\n  };\n\n  const cancelSale = async (saleId) => {\n    if (!window.confirm('Are you sure you want to cancel this sale?')) {\n      return;\n    }\n\n    try {\n      setError('');\n      await api.patch(`/sales/${saleId}/`, { status: 'cancelled' });\n      \n      // Remove the cancelled sale from the list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      \n      // Close modal if it was open for this sale\n      if (selectedSale && selectedSale.id === saleId) {\n        setShowSaleModal(false);\n        setSelectedSale(null);\n      }\n      \n      alert('Sale cancelled successfully!');\n    } catch (err) {\n      setError(`Failed to cancel sale: ${err.response?.data?.error || err.message}`);\n      console.error('Cancel sale error:', err);\n    }\n  };\n\n  const viewSaleDetails = async (sale) => {\n    try {\n      setSelectedSale(sale);\n      setShowSaleModal(true);\n    } catch (err) {\n      setError('Failed to load sale details');\n      console.error('Sale details error:', err);\n    }\n  };\n\n  const editSale = (sale) => {\n    setEditingSale(sale);\n    setEditFormData({\n      customer_name: sale.customer_name || '',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      payment_method: sale.payment_method || 'cash',\n      items: sale.items?.map(item => ({\n        id: item.id,\n        product: item.product,\n        product_name: item.product_name,\n        unit: item.unit,\n        unit_name: item.unit_name,\n        quantity: item.quantity_display || item.quantity,\n        unit_price: item.unit_price,\n        total_price: item.total_price,\n        price_mode: item.price_mode || 'standard'\n      })) || []\n    });\n    setShowEditModal(true);\n  };\n\n  const handleEditItemQuantity = (itemIndex, newQuantity) => {\n    const updatedItems = [...editFormData.items];\n    updatedItems[itemIndex] = {\n      ...updatedItems[itemIndex],\n      quantity: parseFloat(newQuantity) || 0,\n      total_price: (parseFloat(newQuantity) || 0) * parseFloat(updatedItems[itemIndex].unit_price)\n    };\n    setEditFormData({\n      ...editFormData,\n      items: updatedItems\n    });\n  };\n\n  const removeEditItem = (itemIndex) => {\n    const updatedItems = editFormData.items.filter((_, index) => index !== itemIndex);\n    setEditFormData({\n      ...editFormData,\n      items: updatedItems\n    });\n  };\n\n  const handleEditItemPriceMode = async (itemIndex, newPriceMode) => {\n    const updatedItems = [...editFormData.items];\n    const item = updatedItems[itemIndex];\n    \n    try {\n      // Get the product's current prices for the selected unit\n      const productResponse = await api.get(`/products/${item.product}/`);\n      const product = productResponse.data;\n      \n      // Find the compatible unit to get the correct price\n      const compatibleUnit = product.compatible_units?.find(cu => \n        (cu.unit?.id || cu.unit) === item.unit\n      );\n      \n      if (compatibleUnit) {\n        let newUnitPrice;\n        if (newPriceMode === 'wholesale') {\n          newUnitPrice = compatibleUnit.wholesale_price || compatibleUnit.price;\n        } else {\n          newUnitPrice = compatibleUnit.price;\n        }\n        \n        updatedItems[itemIndex] = {\n          ...item,\n          price_mode: newPriceMode,\n          unit_price: newUnitPrice,\n          total_price: parseFloat(item.quantity) * parseFloat(newUnitPrice)\n        };\n        \n        setEditFormData({\n          ...editFormData,\n          items: updatedItems\n        });\n      }\n    } catch (err) {\n      console.error('Error fetching product prices:', err);\n      // Fallback: just update the price mode without changing the price\n      updatedItems[itemIndex] = {\n        ...item,\n        price_mode: newPriceMode\n      };\n      setEditFormData({\n        ...editFormData,\n        items: updatedItems\n      });\n    }\n  };\n\n  const saveEditedSale = async () => {\n    try {\n      setError('');\n      \n      // Prepare the data for the API\n      const updateData = {\n        customer_name: editFormData.customer_name,\n        customer_phone: editFormData.customer_phone,\n        customer_email: editFormData.customer_email,\n        payment_method: editFormData.payment_method,\n        items: editFormData.items.map(item => ({\n          id: item.id,\n          quantity: item.quantity,\n          unit_price: item.unit_price,\n          price_mode: item.price_mode\n        }))\n      };\n\n      await api.patch(`/sales/${editingSale.id}/`, updateData);\n      \n      // Refresh the pending sales list\n      await fetchPendingSales();\n      \n      // Close the edit modal\n      setShowEditModal(false);\n      setEditingSale(null);\n      setEditFormData({});\n      \n      alert('Sale updated successfully!');\n    } catch (err) {\n      setError(`Failed to update sale: ${err.response?.data?.error || err.message}`);\n      console.error('Update sale error:', err);\n    }\n  };\n\n  const printPendingSale = (sale) => {\n    // Create print data for the pending sale\n    const printData = {\n      sale_number: sale.sale_number,\n      customer_name: sale.customer_name || 'Walk-in Customer',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      user_name: sale.user_name || 'Unknown User',\n      user_id: sale.user_id || 'unknown',\n      created_at: sale.created_at,\n      print_timestamp: new Date().toISOString(),\n      print_id: `PRINT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      status: 'pending',\n      total_amount: sale.total_amount,\n      items: sale.items.map(item => ({\n        product_name: item.product_name,\n        product_sku: item.product_sku || '',\n        quantity: item.quantity_display || item.quantity,\n        unit_name: item.unit_name,\n        unit_price: item.unit_price,\n        total_price: item.total_price || (parseFloat(item.quantity_display || item.quantity) * parseFloat(item.unit_price))\n      }))\n    };\n\n    // Create print content\n    const printContent = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Sale Receipt - ${sale.sale_number}</title>\n        <style>\n          body { font-family: Arial, sans-serif; margin: 20px; }\n          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }\n          .sale-info { margin-bottom: 20px; }\n          .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n          .items-table th, .items-table td { border: 1px solid #000; padding: 8px; text-align: left; }\n          .items-table th { background-color: #f0f0f0; }\n          .total { text-align: right; font-weight: bold; font-size: 1.2em; }\n          .status { text-align: center; margin-top: 20px; padding: 10px; background-color: #fff3cd; border: 1px solid #ffeaa7; }\n        </style>\n      </head>\n      <body>\n        <div class=\"header\">\n          <h1>Sale Receipt</h1>\n          <h2>${printData.sale_number}</h2>\n        </div>\n        \n        <div class=\"sale-info\">\n          <p><strong>Customer:</strong> ${printData.customer_name}</p>\n          ${printData.customer_phone ? `<p><strong>Phone:</strong> ${printData.customer_phone}</p>` : ''}\n          ${printData.customer_email ? `<p><strong>Email:</strong> ${printData.customer_email}</p>` : ''}\n          <p><strong>Date:</strong> ${new Date(printData.created_at).toLocaleString()}</p>\n          <p><strong>Cashier:</strong> ${printData.user_name}</p>\n        </div>\n        \n        <table class=\"items-table\">\n          <thead>\n            <tr>\n              <th>Product</th>\n              <th>Unit</th>\n              <th>Qty</th>\n              <th>Unit Price</th>\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${printData.items.map(item => `\n              <tr>\n                <td>${item.product_name}</td>\n                <td>${item.unit_name}</td>\n                <td>${item.quantity}</td>\n                <td>${parseFloat(item.unit_price).toFixed(2)} MGA</td>\n                <td>${parseFloat(item.total_price).toFixed(2)} MGA</td>\n              </tr>\n            `).join('')}\n          </tbody>\n        </table>\n        \n        <div class=\"total\">\n          <p><strong>Total Amount: ${parseFloat(printData.total_amount).toFixed(2)} MGA</strong></p>\n        </div>\n        \n        <div class=\"status\">\n          <p><strong>Status: ${printData.status.toUpperCase()}</strong></p>\n          <p>${printData.status === 'pending' ? 'This sale is pending' : 'This sale has been completed'}</p>\n        </div>\n        \n        <div style=\"text-align: center; margin-top: 20px; font-size: 0.8em; color: #666;\">\n          <p>Printed on: ${new Date(printData.print_timestamp).toLocaleString()}</p>\n          <p>Print ID: ${printData.print_id}</p>\n        </div>\n      </body>\n      </html>\n    `;\n\n    // Open print window\n    const printWindow = window.open('', '_blank', 'width=800,height=600');\n    printWindow.document.write(printContent);\n    printWindow.document.close();\n    \n    // Wait for content to load then print\n    printWindow.onload = () => {\n      printWindow.focus();\n      printWindow.print();\n      // Close the window after a short delay\n      setTimeout(() => {\n        printWindow.close();\n      }, 1000);\n    };\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleString();\n  };\n\n  const formatCurrency = (amount) => {\n    return parseFloat(amount).toFixed(2);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"pending-sales\">\n        <div className=\"loading-container\">\n          <div className=\"spinner\"></div>\n          <span>Loading pending sales...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"pending-sales\">\n      <div className=\"page-header\">\n        <h1>Pending Sales Validation</h1>\n        <p>Review and complete pending sales</p>\n        <div className=\"header-actions\">\n          <Button onClick={fetchPendingSales} variant=\"outline\">\n            Refresh\n          </Button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"error-message\">\n          {error}\n        </div>\n      )}\n\n      <div className=\"pending-sales-stats\">\n        <div className=\"stat-card\">\n          <div className=\"stat-number\">{pendingSales.length}</div>\n          <div className=\"stat-label\">Pending Sales</div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-number\">\n            {formatCurrency(pendingSales.reduce((total, sale) => total + parseFloat(sale.total_amount), 0))}\n          </div>\n          <div className=\"stat-label\">Total Value (MGA)</div>\n        </div>\n      </div>\n\n      {pendingSales.length === 0 ? (\n        <div className=\"no-pending-sales\">\n          <div className=\"no-sales-icon\">📋</div>\n          <h3>No Pending Sales</h3>\n          <p>All sales have been processed. Great job!</p>\n        </div>\n      ) : (\n        <div className=\"pending-sales-list\">\n          {pendingSales.map(sale => (\n            <div key={sale.id} className=\"pending-sale-card\">\n              <div className=\"sale-header\">\n                <div className=\"sale-number\">{sale.sale_number}</div>\n                <div className=\"sale-status\">\n                  <span className=\"status-badge pending\">Pending</span>\n                </div>\n              </div>\n              \n              <div className=\"sale-info\">\n                <div className=\"info-row\">\n                  <span className=\"label\">Customer:</span>\n                  <span className=\"value\">{sale.customer_name || 'Walk-in Customer'}</span>\n                </div>\n                <div className=\"info-row\">\n                  <span className=\"label\">Date:</span>\n                  <span className=\"value\">{formatDate(sale.created_at)}</span>\n                </div>\n                <div className=\"info-row\">\n                  <span className=\"label\">Items:</span>\n                  <span className=\"value\">{sale.items?.length || 0} items</span>\n                </div>\n                \n                {/* Show item details */}\n                {sale.items && sale.items.length > 0 && (\n                  <div className=\"items-preview\">\n                    {sale.items.slice(0, 3).map((item, index) => (\n                      <div key={index} className=\"item-preview\">\n                        <div className=\"item-info\">\n                          <span className=\"item-name\">{item.product_name}</span>\n                          <span className=\"item-quantity\">{item.quantity_display || item.quantity} {item.unit_name}</span>\n                        </div>\n                        <div className=\"item-pricing\">\n                          <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                            {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                          </span>\n                          <span className=\"item-price\">{formatCurrency(item.total_price)} MGA</span>\n                        </div>\n                      </div>\n                    ))}\n                    {sale.items.length > 3 && (\n                      <div className=\"more-items\">\n                        +{sale.items.length - 3} more items\n                      </div>\n                    )}\n                  </div>\n                )}\n                <div className=\"info-row\">\n                  <span className=\"label\">Total:</span>\n                  <span className=\"value total-amount\">{formatCurrency(sale.total_amount)} MGA</span>\n                </div>\n                <div className=\"info-row\">\n                  <span className=\"label\">Payment:</span>\n                  <span className=\"value\">{sale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                </div>\n                \n                {/* Stock Status */}\n                {stockValidationStatus[sale.id] && (\n                  <div className=\"info-row stock-status\">\n                    <span className=\"label\">Stock Status:</span>\n                    <span className={`value ${stockValidationStatus[sale.id].hasInsufficientStock ? 'stock-insufficient' : 'stock-sufficient'}`}>\n                      {stockValidationStatus[sale.id].hasInsufficientStock ? '⚠️ Insufficient Stock' : '✅ Stock Available'}\n                    </span>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"sale-actions\">\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => viewSaleDetails(sale)}\n                >\n                  View Details\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => editSale(sale)}\n                >\n                  ✏️ Edit\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => printPendingSale(sale)}\n                >\n                  🖨️ Print\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"primary\"\n                  onClick={() => completeSale(sale.id)}\n                  loading={completingSale === sale.id}\n                  disabled={completingSale === sale.id || (stockValidationStatus[sale.id]?.hasInsufficientStock)}\n                >\n                  {stockValidationStatus[sale.id]?.hasInsufficientStock ? 'Insufficient Stock' : 'Complete Sale'}\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"danger\"\n                  onClick={() => cancelSale(sale.id)}\n                >\n                  Cancel Sale\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Sale Details Modal */}\n      {showSaleModal && selectedSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal sale-details-modal\">\n            <div className=\"modal-header\">\n              <h2>Sale Details - {selectedSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"modal-content\">\n              <div className=\"sale-details-info\">\n                <div className=\"detail-section\">\n                  <h3>Customer Information</h3>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Name:</span>\n                    <span className=\"value\">{selectedSale.customer_name || 'Walk-in Customer'}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Phone:</span>\n                    <span className=\"value\">{selectedSale.customer_phone || 'N/A'}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Email:</span>\n                    <span className=\"value\">{selectedSale.customer_email || 'N/A'}</span>\n                  </div>\n                </div>\n\n                <div className=\"detail-section\">\n                  <h3>Sale Information</h3>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Date:</span>\n                    <span className=\"value\">{formatDate(selectedSale.created_at)}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Payment Method:</span>\n                    <span className=\"value\">{selectedSale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                  </div>\n                  <div className=\"detail-row\">\n                    <span className=\"label\">Status:</span>\n                    <span className=\"status-badge pending\">Pending</span>\n                  </div>\n                </div>\n\n                <div className=\"detail-section items-section\">\n                  <h3>Items</h3>\n                  <div className=\"items-list\">\n                    {selectedSale.items?.map((item, index) => (\n                      <div key={index} className=\"item-row\">\n                        <div className=\"item-info\">\n                          <div className=\"item-name\">{item.product_name}</div>\n                          <div className=\"item-details\">\n                            {item.quantity_display || item.quantity} {item.unit_name} × {formatCurrency(item.unit_price)} MGA\n                            <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                              {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                            </span>\n                          </div>\n                        </div>\n                        <div className=\"item-total\">\n                          {formatCurrency(item.total_price)} MGA\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"detail-section\">\n                  <h3>Totals</h3>\n                  <div className=\"totals\">\n                    <div className=\"total-row\">\n                      <span className=\"label\">Subtotal:</span>\n                      <span className=\"value\">{formatCurrency(selectedSale.subtotal)} MGA</span>\n                    </div>\n                    {selectedSale.discount_amount > 0 && (\n                      <div className=\"total-row\">\n                        <span className=\"label\">Discount:</span>\n                        <span className=\"value\">-{formatCurrency(selectedSale.discount_amount)} MGA</span>\n                      </div>\n                    )}\n                    {selectedSale.tax_amount > 0 && (\n                      <div className=\"total-row\">\n                        <span className=\"label\">Tax:</span>\n                        <span className=\"value\">{formatCurrency(selectedSale.tax_amount)} MGA</span>\n                      </div>\n                    )}\n                    <div className=\"total-row total\">\n                      <span className=\"label\">Total:</span>\n                      <span className=\"value\">{formatCurrency(selectedSale.total_amount)} MGA</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-actions\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                Close\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                  editSale(selectedSale);\n                }}\n              >\n                ✏️ Edit\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => printPendingSale(selectedSale)}\n              >\n                🖨️ Print Receipt\n              </Button>\n              <Button\n                variant=\"danger\"\n                onClick={() => cancelSale(selectedSale.id)}\n              >\n                Cancel Sale\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={() => completeSale(selectedSale.id)}\n                loading={completingSale === selectedSale.id}\n                disabled={completingSale === selectedSale.id || (stockValidationStatus[selectedSale.id]?.hasInsufficientStock)}\n              >\n                {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? 'Insufficient Stock' : 'Complete Sale'}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Sale Modal */}\n      {showEditModal && editingSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal edit-sale-modal\">\n            <div className=\"modal-header\">\n              <h2>Edit Sale - {editingSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"modal-content\">\n              <div className=\"edit-form\">\n                <div className=\"form-section\">\n                  <h3>Customer Information</h3>\n                  <div className=\"form-row\">\n                    <div className=\"form-group\">\n                      <label>Customer Name</label>\n                      <input\n                        type=\"text\"\n                        value={editFormData.customer_name || ''}\n                        onChange={(e) => setEditFormData({...editFormData, customer_name: e.target.value})}\n                        placeholder=\"Customer name\"\n                      />\n                    </div>\n                    <div className=\"form-group\">\n                      <label>Phone</label>\n                      <input\n                        type=\"text\"\n                        value={editFormData.customer_phone || ''}\n                        onChange={(e) => setEditFormData({...editFormData, customer_phone: e.target.value})}\n                        placeholder=\"Phone number\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"form-row\">\n                    <div className=\"form-group\">\n                      <label>Email</label>\n                      <input\n                        type=\"email\"\n                        value={editFormData.customer_email || ''}\n                        onChange={(e) => setEditFormData({...editFormData, customer_email: e.target.value})}\n                        placeholder=\"Email address\"\n                      />\n                    </div>\n                    <div className=\"form-group\">\n                      <label>Payment Method</label>\n                      <select\n                        value={editFormData.payment_method || 'cash'}\n                        onChange={(e) => setEditFormData({...editFormData, payment_method: e.target.value})}\n                      >\n                        <option value=\"cash\">Cash</option>\n                        <option value=\"card\">Card</option>\n                        <option value=\"mobile_money\">Mobile Money</option>\n                        <option value=\"bank_transfer\">Bank Transfer</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"form-section items-section\">\n                  <h3>Items</h3>\n                  <div className=\"items-edit-list\">\n                    {editFormData.items?.map((item, index) => (\n                      <div key={index} className=\"edit-item-row\">\n                        <div className=\"item-info\">\n                          <div className=\"item-name\">{item.product_name}</div>\n                          <div className=\"item-unit\">{item.unit_name}</div>\n                          <div className=\"item-price\">{formatCurrency(item.unit_price)} MGA each</div>\n                        </div>\n                        <div className=\"item-quantity\">\n                          <label>Quantity:</label>\n                          <input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            value={item.quantity}\n                            onChange={(e) => handleEditItemQuantity(index, e.target.value)}\n                          />\n                        </div>\n                        <div className=\"item-price-mode\">\n                          <label>Price Mode:</label>\n                          <select\n                            value={item.price_mode}\n                            onChange={(e) => handleEditItemPriceMode(index, e.target.value)}\n                          >\n                            <option value=\"standard\">Standard</option>\n                            <option value=\"wholesale\">Wholesale</option>\n                          </select>\n                        </div>\n                        <div className=\"item-total\">\n                          {formatCurrency(item.total_price)} MGA\n                        </div>\n                        <div className=\"item-actions\">\n                          <Button\n                            size=\"small\"\n                            variant=\"danger\"\n                            onClick={() => removeEditItem(index)}\n                          >\n                            Remove\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                  \n                  <div className=\"edit-totals\">\n                    <div className=\"total-row\">\n                      <span className=\"label\">Subtotal:</span>\n                      <span className=\"value\">\n                        {formatCurrency(editFormData.items?.reduce((sum, item) => sum + parseFloat(item.total_price || 0), 0))} MGA\n                      </span>\n                    </div>\n                    <div className=\"total-row total\">\n                      <span className=\"label\">Total:</span>\n                      <span className=\"value\">\n                        {formatCurrency(editFormData.items?.reduce((sum, item) => sum + parseFloat(item.total_price || 0), 0))} MGA\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-actions\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={saveEditedSale}\n                disabled={!editFormData.items || editFormData.items.length === 0}\n              >\n                Save Changes\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PendingSales;\n"],"mappings":"gJAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,GAAG,KAAM,iBAAiB,CACjC,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CACzC,MAAO,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,KAAAC,qBAAA,CAAAC,mBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,mBAAA,CAAAC,oBAAA,CAAAC,oBAAA,CACzB,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGjB,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACkB,OAAO,CAAEC,UAAU,CAAC,CAAGnB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACsB,YAAY,CAAEC,eAAe,CAAC,CAAGvB,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAACwB,aAAa,CAAEC,gBAAgB,CAAC,CAAGzB,QAAQ,CAAC,KAAK,CAAC,CACzD,KAAM,CAAC0B,cAAc,CAAEC,iBAAiB,CAAC,CAAG3B,QAAQ,CAAC,IAAI,CAAC,CAC1D,KAAM,CAAC4B,qBAAqB,CAAEC,wBAAwB,CAAC,CAAG7B,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtE,KAAM,CAAC8B,WAAW,CAAEC,cAAc,CAAC,CAAG/B,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAACgC,aAAa,CAAEC,gBAAgB,CAAC,CAAGjC,QAAQ,CAAC,KAAK,CAAC,CACzD,KAAM,CAACkC,YAAY,CAAEC,eAAe,CAAC,CAAGnC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAEpDC,SAAS,CAAC,IAAM,CACdmC,iBAAiB,CAAC,CAAC,CACrB,CAAC,CAAE,EAAE,CAAC,CAEN;AACAnC,SAAS,CAAC,IAAM,CACd,GAAIe,YAAY,CAACqB,MAAM,CAAG,CAAC,CAAE,CAC3BC,wBAAwB,CAAC,CAAC,CAC5B,CACF,CAAC,CAAE,CAACtB,YAAY,CAAC,CAAC,CAElB,KAAM,CAAAoB,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACFjB,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAkB,QAAQ,CAAG,KAAM,CAAArC,GAAG,CAACsC,GAAG,CAAC,wBAAwB,CAAC,CACxDvB,eAAe,CAACsB,QAAQ,CAACE,IAAI,CAACC,OAAO,EAAIH,QAAQ,CAACE,IAAI,CAAC,CACzD,CAAE,MAAOE,GAAG,CAAE,CACZtB,QAAQ,CAAC,+BAA+B,CAAC,CACzCuB,OAAO,CAACxB,KAAK,CAAC,4BAA4B,CAAEuB,GAAG,CAAC,CAClD,CAAC,OAAS,CACRxB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAmB,wBAAwB,CAAG,KAAAA,CAAA,GAAY,CAC3C,KAAM,CAAAO,gBAAgB,CAAG,CAAC,CAAC,CAE3B,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAA9B,YAAY,CAAE,CAC/B,GAAI,CAAA+B,oBAAoB,CAAG,KAAK,CAChC,KAAM,CAAAC,WAAW,CAAG,EAAE,CAEtB,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAAH,IAAI,CAACI,KAAK,EAAI,EAAE,CAAE,CACnC,GAAI,CACF,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAjD,GAAG,CAACsC,GAAG,cAAAY,MAAA,CAAcH,IAAI,CAACI,OAAO,wBAAsB,CAAC,CACpF,KAAM,CAAAC,SAAS,CAAGH,aAAa,CAACV,IAAI,CAEpC,KAAM,CAAAc,aAAa,CAAGD,SAAS,CAACE,eAAe,CAACC,IAAI,CAACC,IAAI,EAAIA,IAAI,CAACC,EAAE,GAAKV,IAAI,CAACS,IAAI,CAAC,CACnF,GAAIH,aAAa,CAAE,CACjB,KAAM,CAAAK,iBAAiB,CAAGC,UAAU,CAACN,aAAa,CAACO,kBAAkB,EAAI,CAAC,CAAC,CAC3E,KAAM,CAAAC,gBAAgB,CAAGF,UAAU,CAACZ,IAAI,CAACe,QAAQ,EAAI,CAAC,CAAC,CAEvD,GAAIJ,iBAAiB,CAAGG,gBAAgB,CAAE,CACxChB,oBAAoB,CAAG,IAAI,CAC3BC,WAAW,CAACiB,IAAI,IAAAb,MAAA,CAAIH,IAAI,CAACiB,YAAY,OAAAd,MAAA,CAAKW,gBAAgB,MAAAX,MAAA,CAAIH,IAAI,CAACkB,SAAS,gBAAAf,MAAA,CAAcQ,iBAAiB,cAAY,CAAC,CAC1H,CACF,CACF,CAAE,MAAOjB,GAAG,CAAE,CACZC,OAAO,CAACxB,KAAK,oCAAAgC,MAAA,CAAoCN,IAAI,CAACa,EAAE,MAAKhB,GAAG,CAAC,CACnE,CACF,CAEAE,gBAAgB,CAACC,IAAI,CAACa,EAAE,CAAC,CAAG,CAC1BZ,oBAAoB,CACpBC,WACF,CAAC,CACH,CAEAnB,wBAAwB,CAACgB,gBAAgB,CAAC,CAC5C,CAAC,CAED,KAAM,CAAAuB,YAAY,CAAG,KAAO,CAAAC,MAAM,EAAK,CACrC,GAAI,CACF1C,iBAAiB,CAAC0C,MAAM,CAAC,CACzBhD,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,KAAM,CAAAyB,IAAI,CAAG9B,YAAY,CAACyC,IAAI,CAACa,CAAC,EAAIA,CAAC,CAACX,EAAE,GAAKU,MAAM,CAAC,CACpD,GAAI,CAACvB,IAAI,CAAE,CACTzB,QAAQ,CAAC,gBAAgB,CAAC,CAC1B,OACF,CAEA;AACA,KAAM,CAAAkD,qBAAqB,CAAG,EAAE,CAEhC,IAAK,KAAM,CAAAtB,IAAI,GAAI,CAAAH,IAAI,CAACI,KAAK,EAAI,EAAE,CAAE,CACnC,GAAI,CACF;AACA,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAjD,GAAG,CAACsC,GAAG,cAAAY,MAAA,CAAcH,IAAI,CAACI,OAAO,wBAAsB,CAAC,CACpF,KAAM,CAAAC,SAAS,CAAGH,aAAa,CAACV,IAAI,CAEpC;AACA,KAAM,CAAAc,aAAa,CAAGD,SAAS,CAACE,eAAe,CAACC,IAAI,CAACC,IAAI,EAAIA,IAAI,CAACC,EAAE,GAAKV,IAAI,CAACS,IAAI,CAAC,CACnF,GAAI,CAACH,aAAa,CAAE,CAClBgB,qBAAqB,CAACN,IAAI,IAAAb,MAAA,CAAIH,IAAI,CAACiB,YAAY,kCAAgC,CAAC,CAChF,SACF,CAEA;AACA,KAAM,CAAAN,iBAAiB,CAAGC,UAAU,CAACN,aAAa,CAACO,kBAAkB,EAAI,CAAC,CAAC,CAC3E,KAAM,CAAAC,gBAAgB,CAAGF,UAAU,CAACZ,IAAI,CAACe,QAAQ,EAAI,CAAC,CAAC,CAEvD,GAAIJ,iBAAiB,CAAGG,gBAAgB,CAAE,CACxCQ,qBAAqB,CAACN,IAAI,IAAAb,MAAA,CACrBH,IAAI,CAACiB,YAAY,qCAAAd,MAAA,CAAmCW,gBAAgB,MAAAX,MAAA,CAAIH,IAAI,CAACkB,SAAS,kBAAAf,MAAA,CAAgBQ,iBAAiB,MAAAR,MAAA,CAAIH,IAAI,CAACkB,SAAS,CAC9I,CAAC,CACH,CACF,CAAE,MAAOK,QAAQ,CAAE,CACjB5B,OAAO,CAACxB,KAAK,qCAAAgC,MAAA,CAAqCH,IAAI,CAACI,OAAO,MAAKmB,QAAQ,CAAC,CAC5ED,qBAAqB,CAACN,IAAI,IAAAb,MAAA,CAAIH,IAAI,CAACiB,YAAY,wCAAsC,CAAC,CACxF,CACF,CAEA;AACA,GAAIK,qBAAqB,CAAClC,MAAM,CAAG,CAAC,CAAE,CACpChB,QAAQ,uDAAA+B,MAAA,CAAuDmB,qBAAqB,CAACE,IAAI,CAAC,IAAI,CAAC,CAAE,CAAC,CAClG,OACF,CAEA;AACA,KAAM,CAAAvE,GAAG,CAACwE,IAAI,WAAAtB,MAAA,CAAWiB,MAAM,cAAY,CAAC,CAE5C;AACAM,gBAAgB,CAAAC,aAAA,CAAAA,aAAA,IAAM9B,IAAI,MAAE+B,MAAM,CAAE,WAAW,EAAE,CAAC,CAElD;AACA5D,eAAe,CAAC6D,IAAI,EAAIA,IAAI,CAACC,MAAM,CAACjC,IAAI,EAAIA,IAAI,CAACa,EAAE,GAAKU,MAAM,CAAC,CAAC,CAEhE;AACA,GAAI/C,YAAY,EAAIA,YAAY,CAACqC,EAAE,GAAKU,MAAM,CAAE,CAC9C5C,gBAAgB,CAAC,KAAK,CAAC,CACvBF,eAAe,CAAC,IAAI,CAAC,CACvB,CAEAyD,KAAK,CAAC,8BAA8B,CAAC,CACvC,CAAE,MAAOrC,GAAG,CAAE,KAAAsC,aAAA,CAAAC,kBAAA,CACZ7D,QAAQ,6BAAA+B,MAAA,CAA6B,EAAA6B,aAAA,CAAAtC,GAAG,CAACJ,QAAQ,UAAA0C,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcxC,IAAI,UAAAyC,kBAAA,iBAAlBA,kBAAA,CAAoB9D,KAAK,GAAIuB,GAAG,CAACwC,OAAO,CAAE,CAAC,CAChFvC,OAAO,CAACxB,KAAK,CAAC,sBAAsB,CAAEuB,GAAG,CAAC,CAC5C,CAAC,OAAS,CACRhB,iBAAiB,CAAC,IAAI,CAAC,CACzB,CACF,CAAC,CAED,KAAM,CAAAyD,UAAU,CAAG,KAAO,CAAAf,MAAM,EAAK,CACnC,GAAI,CAACgB,MAAM,CAACC,OAAO,CAAC,4CAA4C,CAAC,CAAE,CACjE,OACF,CAEA,GAAI,CACFjE,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAnB,GAAG,CAACqF,KAAK,WAAAnC,MAAA,CAAWiB,MAAM,MAAK,CAAEQ,MAAM,CAAE,WAAY,CAAC,CAAC,CAE7D;AACA5D,eAAe,CAAC6D,IAAI,EAAIA,IAAI,CAACC,MAAM,CAACjC,IAAI,EAAIA,IAAI,CAACa,EAAE,GAAKU,MAAM,CAAC,CAAC,CAEhE;AACA,GAAI/C,YAAY,EAAIA,YAAY,CAACqC,EAAE,GAAKU,MAAM,CAAE,CAC9C5C,gBAAgB,CAAC,KAAK,CAAC,CACvBF,eAAe,CAAC,IAAI,CAAC,CACvB,CAEAyD,KAAK,CAAC,8BAA8B,CAAC,CACvC,CAAE,MAAOrC,GAAG,CAAE,KAAA6C,cAAA,CAAAC,mBAAA,CACZpE,QAAQ,2BAAA+B,MAAA,CAA2B,EAAAoC,cAAA,CAAA7C,GAAG,CAACJ,QAAQ,UAAAiD,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc/C,IAAI,UAAAgD,mBAAA,iBAAlBA,mBAAA,CAAoBrE,KAAK,GAAIuB,GAAG,CAACwC,OAAO,CAAE,CAAC,CAC9EvC,OAAO,CAACxB,KAAK,CAAC,oBAAoB,CAAEuB,GAAG,CAAC,CAC1C,CACF,CAAC,CAED,KAAM,CAAA+C,eAAe,CAAG,KAAO,CAAA5C,IAAI,EAAK,CACtC,GAAI,CACFvB,eAAe,CAACuB,IAAI,CAAC,CACrBrB,gBAAgB,CAAC,IAAI,CAAC,CACxB,CAAE,MAAOkB,GAAG,CAAE,CACZtB,QAAQ,CAAC,6BAA6B,CAAC,CACvCuB,OAAO,CAACxB,KAAK,CAAC,qBAAqB,CAAEuB,GAAG,CAAC,CAC3C,CACF,CAAC,CAED,KAAM,CAAAgD,QAAQ,CAAI7C,IAAI,EAAK,KAAA8C,WAAA,CACzB7D,cAAc,CAACe,IAAI,CAAC,CACpBX,eAAe,CAAC,CACd0D,aAAa,CAAE/C,IAAI,CAAC+C,aAAa,EAAI,EAAE,CACvCC,cAAc,CAAEhD,IAAI,CAACgD,cAAc,EAAI,EAAE,CACzCC,cAAc,CAAEjD,IAAI,CAACiD,cAAc,EAAI,EAAE,CACzCC,cAAc,CAAElD,IAAI,CAACkD,cAAc,EAAI,MAAM,CAC7C9C,KAAK,CAAE,EAAA0C,WAAA,CAAA9C,IAAI,CAACI,KAAK,UAAA0C,WAAA,iBAAVA,WAAA,CAAYK,GAAG,CAAChD,IAAI,GAAK,CAC9BU,EAAE,CAAEV,IAAI,CAACU,EAAE,CACXN,OAAO,CAAEJ,IAAI,CAACI,OAAO,CACrBa,YAAY,CAAEjB,IAAI,CAACiB,YAAY,CAC/BR,IAAI,CAAET,IAAI,CAACS,IAAI,CACfS,SAAS,CAAElB,IAAI,CAACkB,SAAS,CACzBH,QAAQ,CAAEf,IAAI,CAACiD,gBAAgB,EAAIjD,IAAI,CAACe,QAAQ,CAChDmC,UAAU,CAAElD,IAAI,CAACkD,UAAU,CAC3BC,WAAW,CAAEnD,IAAI,CAACmD,WAAW,CAC7BC,UAAU,CAAEpD,IAAI,CAACoD,UAAU,EAAI,UACjC,CAAC,CAAC,CAAC,GAAI,EACT,CAAC,CAAC,CACFpE,gBAAgB,CAAC,IAAI,CAAC,CACxB,CAAC,CAED,KAAM,CAAAqE,sBAAsB,CAAGA,CAACC,SAAS,CAAEC,WAAW,GAAK,CACzD,KAAM,CAAAC,YAAY,CAAG,CAAC,GAAGvE,YAAY,CAACgB,KAAK,CAAC,CAC5CuD,YAAY,CAACF,SAAS,CAAC,CAAA3B,aAAA,CAAAA,aAAA,IAClB6B,YAAY,CAACF,SAAS,CAAC,MAC1BvC,QAAQ,CAAEH,UAAU,CAAC2C,WAAW,CAAC,EAAI,CAAC,CACtCJ,WAAW,CAAE,CAACvC,UAAU,CAAC2C,WAAW,CAAC,EAAI,CAAC,EAAI3C,UAAU,CAAC4C,YAAY,CAACF,SAAS,CAAC,CAACJ,UAAU,CAAC,EAC7F,CACDhE,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IACV1C,YAAY,MACfgB,KAAK,CAAEuD,YAAY,EACpB,CAAC,CACJ,CAAC,CAED,KAAM,CAAAC,cAAc,CAAIH,SAAS,EAAK,CACpC,KAAM,CAAAE,YAAY,CAAGvE,YAAY,CAACgB,KAAK,CAAC6B,MAAM,CAAC,CAAC4B,CAAC,CAAEC,KAAK,GAAKA,KAAK,GAAKL,SAAS,CAAC,CACjFpE,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IACV1C,YAAY,MACfgB,KAAK,CAAEuD,YAAY,EACpB,CAAC,CACJ,CAAC,CAED,KAAM,CAAAI,uBAAuB,CAAG,KAAAA,CAAON,SAAS,CAAEO,YAAY,GAAK,CACjE,KAAM,CAAAL,YAAY,CAAG,CAAC,GAAGvE,YAAY,CAACgB,KAAK,CAAC,CAC5C,KAAM,CAAAD,IAAI,CAAGwD,YAAY,CAACF,SAAS,CAAC,CAEpC,GAAI,KAAAQ,qBAAA,CACF;AACA,KAAM,CAAAC,eAAe,CAAG,KAAM,CAAA9G,GAAG,CAACsC,GAAG,cAAAY,MAAA,CAAcH,IAAI,CAACI,OAAO,KAAG,CAAC,CACnE,KAAM,CAAAA,OAAO,CAAG2D,eAAe,CAACvE,IAAI,CAEpC;AACA,KAAM,CAAAwE,cAAc,EAAAF,qBAAA,CAAG1D,OAAO,CAAC6D,gBAAgB,UAAAH,qBAAA,iBAAxBA,qBAAA,CAA0BtD,IAAI,CAAC0D,EAAE,OAAAC,QAAA,OACtD,CAAC,EAAAA,QAAA,CAAAD,EAAE,CAACzD,IAAI,UAAA0D,QAAA,iBAAPA,QAAA,CAASzD,EAAE,GAAIwD,EAAE,CAACzD,IAAI,IAAMT,IAAI,CAACS,IAAI,EACxC,CAAC,CAED,GAAIuD,cAAc,CAAE,CAClB,GAAI,CAAAI,YAAY,CAChB,GAAIP,YAAY,GAAK,WAAW,CAAE,CAChCO,YAAY,CAAGJ,cAAc,CAACK,eAAe,EAAIL,cAAc,CAACM,KAAK,CACvE,CAAC,IAAM,CACLF,YAAY,CAAGJ,cAAc,CAACM,KAAK,CACrC,CAEAd,YAAY,CAACF,SAAS,CAAC,CAAA3B,aAAA,CAAAA,aAAA,IAClB3B,IAAI,MACPoD,UAAU,CAAES,YAAY,CACxBX,UAAU,CAAEkB,YAAY,CACxBjB,WAAW,CAAEvC,UAAU,CAACZ,IAAI,CAACe,QAAQ,CAAC,CAAGH,UAAU,CAACwD,YAAY,CAAC,EAClE,CAEDlF,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IACV1C,YAAY,MACfgB,KAAK,CAAEuD,YAAY,EACpB,CAAC,CACJ,CACF,CAAE,MAAO9D,GAAG,CAAE,CACZC,OAAO,CAACxB,KAAK,CAAC,gCAAgC,CAAEuB,GAAG,CAAC,CACpD;AACA8D,YAAY,CAACF,SAAS,CAAC,CAAA3B,aAAA,CAAAA,aAAA,IAClB3B,IAAI,MACPoD,UAAU,CAAES,YAAY,EACzB,CACD3E,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IACV1C,YAAY,MACfgB,KAAK,CAAEuD,YAAY,EACpB,CAAC,CACJ,CACF,CAAC,CAED,KAAM,CAAAe,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CACFnG,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,KAAM,CAAAoG,UAAU,CAAG,CACjB5B,aAAa,CAAE3D,YAAY,CAAC2D,aAAa,CACzCC,cAAc,CAAE5D,YAAY,CAAC4D,cAAc,CAC3CC,cAAc,CAAE7D,YAAY,CAAC6D,cAAc,CAC3CC,cAAc,CAAE9D,YAAY,CAAC8D,cAAc,CAC3C9C,KAAK,CAAEhB,YAAY,CAACgB,KAAK,CAAC+C,GAAG,CAAChD,IAAI,GAAK,CACrCU,EAAE,CAAEV,IAAI,CAACU,EAAE,CACXK,QAAQ,CAAEf,IAAI,CAACe,QAAQ,CACvBmC,UAAU,CAAElD,IAAI,CAACkD,UAAU,CAC3BE,UAAU,CAAEpD,IAAI,CAACoD,UACnB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAnG,GAAG,CAACqF,KAAK,WAAAnC,MAAA,CAAWtB,WAAW,CAAC6B,EAAE,MAAK8D,UAAU,CAAC,CAExD;AACA,KAAM,CAAArF,iBAAiB,CAAC,CAAC,CAEzB;AACAH,gBAAgB,CAAC,KAAK,CAAC,CACvBF,cAAc,CAAC,IAAI,CAAC,CACpBI,eAAe,CAAC,CAAC,CAAC,CAAC,CAEnB6C,KAAK,CAAC,4BAA4B,CAAC,CACrC,CAAE,MAAOrC,GAAG,CAAE,KAAA+E,cAAA,CAAAC,mBAAA,CACZtG,QAAQ,2BAAA+B,MAAA,CAA2B,EAAAsE,cAAA,CAAA/E,GAAG,CAACJ,QAAQ,UAAAmF,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcjF,IAAI,UAAAkF,mBAAA,iBAAlBA,mBAAA,CAAoBvG,KAAK,GAAIuB,GAAG,CAACwC,OAAO,CAAE,CAAC,CAC9EvC,OAAO,CAACxB,KAAK,CAAC,oBAAoB,CAAEuB,GAAG,CAAC,CAC1C,CACF,CAAC,CAED,KAAM,CAAAgC,gBAAgB,CAAI7B,IAAI,EAAK,CACjC;AACA,KAAM,CAAA8E,SAAS,CAAG,CAChBC,WAAW,CAAE/E,IAAI,CAAC+E,WAAW,CAC7BhC,aAAa,CAAE/C,IAAI,CAAC+C,aAAa,EAAI,kBAAkB,CACvDC,cAAc,CAAEhD,IAAI,CAACgD,cAAc,EAAI,EAAE,CACzCC,cAAc,CAAEjD,IAAI,CAACiD,cAAc,EAAI,EAAE,CACzC+B,SAAS,CAAEhF,IAAI,CAACgF,SAAS,EAAI,cAAc,CAC3CC,OAAO,CAAEjF,IAAI,CAACiF,OAAO,EAAI,SAAS,CAClCC,UAAU,CAAElF,IAAI,CAACkF,UAAU,CAC3BC,eAAe,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACzCC,QAAQ,UAAAhF,MAAA,CAAW8E,IAAI,CAACG,GAAG,CAAC,CAAC,MAAAjF,MAAA,CAAIkF,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE,CAC1E5D,MAAM,CAAE,SAAS,CACjB6D,YAAY,CAAE5F,IAAI,CAAC4F,YAAY,CAC/BxF,KAAK,CAAEJ,IAAI,CAACI,KAAK,CAAC+C,GAAG,CAAChD,IAAI,GAAK,CAC7BiB,YAAY,CAAEjB,IAAI,CAACiB,YAAY,CAC/ByE,WAAW,CAAE1F,IAAI,CAAC0F,WAAW,EAAI,EAAE,CACnC3E,QAAQ,CAAEf,IAAI,CAACiD,gBAAgB,EAAIjD,IAAI,CAACe,QAAQ,CAChDG,SAAS,CAAElB,IAAI,CAACkB,SAAS,CACzBgC,UAAU,CAAElD,IAAI,CAACkD,UAAU,CAC3BC,WAAW,CAAEnD,IAAI,CAACmD,WAAW,EAAKvC,UAAU,CAACZ,IAAI,CAACiD,gBAAgB,EAAIjD,IAAI,CAACe,QAAQ,CAAC,CAAGH,UAAU,CAACZ,IAAI,CAACkD,UAAU,CACnH,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAyC,YAAY,uFAAAxF,MAAA,CAIUN,IAAI,CAAC+E,WAAW,+0BAAAzE,MAAA,CAehCwE,SAAS,CAACC,WAAW,iHAAAzE,MAAA,CAIKwE,SAAS,CAAC/B,aAAa,qBAAAzC,MAAA,CACrDwE,SAAS,CAAC9B,cAAc,+BAAA1C,MAAA,CAAiCwE,SAAS,CAAC9B,cAAc,SAAS,EAAE,iBAAA1C,MAAA,CAC5FwE,SAAS,CAAC7B,cAAc,+BAAA3C,MAAA,CAAiCwE,SAAS,CAAC7B,cAAc,SAAS,EAAE,2CAAA3C,MAAA,CAClE,GAAI,CAAA8E,IAAI,CAACN,SAAS,CAACI,UAAU,CAAC,CAACa,cAAc,CAAC,CAAC,kDAAAzF,MAAA,CAC5CwE,SAAS,CAACE,SAAS,iVAAA1E,MAAA,CAc9CwE,SAAS,CAAC1E,KAAK,CAAC+C,GAAG,CAAChD,IAAI,+CAAAG,MAAA,CAEhBH,IAAI,CAACiB,YAAY,gCAAAd,MAAA,CACjBH,IAAI,CAACkB,SAAS,gCAAAf,MAAA,CACdH,IAAI,CAACe,QAAQ,gCAAAZ,MAAA,CACbS,UAAU,CAACZ,IAAI,CAACkD,UAAU,CAAC,CAAC2C,OAAO,CAAC,CAAC,CAAC,oCAAA1F,MAAA,CACtCS,UAAU,CAACZ,IAAI,CAACmD,WAAW,CAAC,CAAC0C,OAAO,CAAC,CAAC,CAAC,gDAEhD,CAAC,CAACrE,IAAI,CAAC,EAAE,CAAC,yHAAArB,MAAA,CAKcS,UAAU,CAAC+D,SAAS,CAACc,YAAY,CAAC,CAACI,OAAO,CAAC,CAAC,CAAC,+GAAA1F,MAAA,CAInDwE,SAAS,CAAC/C,MAAM,CAACkE,WAAW,CAAC,CAAC,iCAAA3F,MAAA,CAC9CwE,SAAS,CAAC/C,MAAM,GAAK,SAAS,CAAG,sBAAsB,CAAG,8BAA8B,4JAAAzB,MAAA,CAI5E,GAAI,CAAA8E,IAAI,CAACN,SAAS,CAACK,eAAe,CAAC,CAACY,cAAc,CAAC,CAAC,kCAAAzF,MAAA,CACtDwE,SAAS,CAACQ,QAAQ,4DAItC,CAED;AACA,KAAM,CAAAY,WAAW,CAAG3D,MAAM,CAAC4D,IAAI,CAAC,EAAE,CAAE,QAAQ,CAAE,sBAAsB,CAAC,CACrED,WAAW,CAACE,QAAQ,CAACC,KAAK,CAACP,YAAY,CAAC,CACxCI,WAAW,CAACE,QAAQ,CAACE,KAAK,CAAC,CAAC,CAE5B;AACAJ,WAAW,CAACK,MAAM,CAAG,IAAM,CACzBL,WAAW,CAACM,KAAK,CAAC,CAAC,CACnBN,WAAW,CAACO,KAAK,CAAC,CAAC,CACnB;AACAC,UAAU,CAAC,IAAM,CACfR,WAAW,CAACI,KAAK,CAAC,CAAC,CACrB,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CACH,CAAC,CAED,KAAM,CAAAK,UAAU,CAAIC,UAAU,EAAK,CACjC,MAAO,IAAI,CAAAxB,IAAI,CAACwB,UAAU,CAAC,CAACb,cAAc,CAAC,CAAC,CAC9C,CAAC,CAED,KAAM,CAAAc,cAAc,CAAIC,MAAM,EAAK,CACjC,MAAO,CAAA/F,UAAU,CAAC+F,MAAM,CAAC,CAACd,OAAO,CAAC,CAAC,CAAC,CACtC,CAAC,CAED,GAAI5H,OAAO,CAAE,CACX,mBACEb,IAAA,QAAKwJ,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BvJ,KAAA,QAAKsJ,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCzJ,IAAA,QAAKwJ,SAAS,CAAC,SAAS,CAAM,CAAC,cAC/BxJ,IAAA,SAAAyJ,QAAA,CAAM,0BAAwB,CAAM,CAAC,EAClC,CAAC,CACH,CAAC,CAEV,CAEA,mBACEvJ,KAAA,QAAKsJ,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BvJ,KAAA,QAAKsJ,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BzJ,IAAA,OAAAyJ,QAAA,CAAI,0BAAwB,CAAI,CAAC,cACjCzJ,IAAA,MAAAyJ,QAAA,CAAG,mCAAiC,CAAG,CAAC,cACxCzJ,IAAA,QAAKwJ,SAAS,CAAC,gBAAgB,CAAAC,QAAA,cAC7BzJ,IAAA,CAACF,MAAM,EAAC4J,OAAO,CAAE3H,iBAAkB,CAAC4H,OAAO,CAAC,SAAS,CAAAF,QAAA,CAAC,SAEtD,CAAQ,CAAC,CACN,CAAC,EACH,CAAC,CAEL1I,KAAK,eACJf,IAAA,QAAKwJ,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC3B1I,KAAK,CACH,CACN,cAEDb,KAAA,QAAKsJ,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClCvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,QAAKwJ,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAE9I,YAAY,CAACqB,MAAM,CAAM,CAAC,cACxDhC,IAAA,QAAKwJ,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,eAAa,CAAK,CAAC,EAC5C,CAAC,cACNvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,QAAKwJ,SAAS,CAAC,aAAa,CAAAC,QAAA,CACzBH,cAAc,CAAC3I,YAAY,CAACiJ,MAAM,CAAC,CAACC,KAAK,CAAEpH,IAAI,GAAKoH,KAAK,CAAGrG,UAAU,CAACf,IAAI,CAAC4F,YAAY,CAAC,CAAE,CAAC,CAAC,CAAC,CAC5F,CAAC,cACNrI,IAAA,QAAKwJ,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,mBAAiB,CAAK,CAAC,EAChD,CAAC,EACH,CAAC,CAEL9I,YAAY,CAACqB,MAAM,GAAK,CAAC,cACxB9B,KAAA,QAAKsJ,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BzJ,IAAA,QAAKwJ,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,cAAE,CAAK,CAAC,cACvCzJ,IAAA,OAAAyJ,QAAA,CAAI,kBAAgB,CAAI,CAAC,cACzBzJ,IAAA,MAAAyJ,QAAA,CAAG,2CAAyC,CAAG,CAAC,EAC7C,CAAC,cAENzJ,IAAA,QAAKwJ,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAChC9I,YAAY,CAACiF,GAAG,CAACnD,IAAI,OAAAqH,YAAA,CAAAC,oBAAA,CAAAC,qBAAA,CAAAC,sBAAA,oBACpB/J,KAAA,QAAmBsJ,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAC9CvJ,KAAA,QAAKsJ,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BzJ,IAAA,QAAKwJ,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAEhH,IAAI,CAAC+E,WAAW,CAAM,CAAC,cACrDxH,IAAA,QAAKwJ,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC1BzJ,IAAA,SAAMwJ,SAAS,CAAC,sBAAsB,CAAAC,QAAA,CAAC,SAAO,CAAM,CAAC,CAClD,CAAC,EACH,CAAC,cAENvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBvJ,KAAA,QAAKsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,WAAS,CAAM,CAAC,cACxCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAEhH,IAAI,CAAC+C,aAAa,EAAI,kBAAkB,CAAO,CAAC,EACtE,CAAC,cACNtF,KAAA,QAAKsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,OAAK,CAAM,CAAC,cACpCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAEL,UAAU,CAAC3G,IAAI,CAACkF,UAAU,CAAC,CAAO,CAAC,EACzD,CAAC,cACNzH,KAAA,QAAKsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,cACrCvJ,KAAA,SAAMsJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAE,EAAAK,YAAA,CAAArH,IAAI,CAACI,KAAK,UAAAiH,YAAA,iBAAVA,YAAA,CAAY9H,MAAM,GAAI,CAAC,CAAC,QAAM,EAAM,CAAC,EAC3D,CAAC,CAGLS,IAAI,CAACI,KAAK,EAAIJ,IAAI,CAACI,KAAK,CAACb,MAAM,CAAG,CAAC,eAClC9B,KAAA,QAAKsJ,SAAS,CAAC,eAAe,CAAAC,QAAA,EAC3BhH,IAAI,CAACI,KAAK,CAACqH,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAACtE,GAAG,CAAC,CAAChD,IAAI,CAAE2D,KAAK,gBACtCrG,KAAA,QAAiBsJ,SAAS,CAAC,cAAc,CAAAC,QAAA,eACvCvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,SAAMwJ,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE7G,IAAI,CAACiB,YAAY,CAAO,CAAC,cACtD3D,KAAA,SAAMsJ,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAE7G,IAAI,CAACiD,gBAAgB,EAAIjD,IAAI,CAACe,QAAQ,CAAC,GAAC,CAACf,IAAI,CAACkB,SAAS,EAAO,CAAC,EAC7F,CAAC,cACN5D,KAAA,QAAKsJ,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BzJ,IAAA,SAAMwJ,SAAS,qBAAAzG,MAAA,CAAsBH,IAAI,CAACoD,UAAU,GAAK,WAAW,CAAG,WAAW,CAAG,EAAE,CAAG,CAAAyD,QAAA,CACvF7G,IAAI,CAACoD,UAAU,GAAK,WAAW,CAAG,IAAI,CAAG,KAAK,CAC3C,CAAC,cACP9F,KAAA,SAAMsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,EAAEH,cAAc,CAAC1G,IAAI,CAACmD,WAAW,CAAC,CAAC,MAAI,EAAM,CAAC,EACvE,CAAC,GAVEQ,KAWL,CACN,CAAC,CACD9D,IAAI,CAACI,KAAK,CAACb,MAAM,CAAG,CAAC,eACpB9B,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,EAAC,GACzB,CAAChH,IAAI,CAACI,KAAK,CAACb,MAAM,CAAG,CAAC,CAAC,aAC1B,EAAK,CACN,EACE,CACN,cACD9B,KAAA,QAAKsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,cACrCvJ,KAAA,SAAMsJ,SAAS,CAAC,oBAAoB,CAAAC,QAAA,EAAEH,cAAc,CAAC7G,IAAI,CAAC4F,YAAY,CAAC,CAAC,MAAI,EAAM,CAAC,EAChF,CAAC,cACNnI,KAAA,QAAKsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,UAAQ,CAAM,CAAC,cACvCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAAM,oBAAA,CAAEtH,IAAI,CAACkD,cAAc,UAAAoE,oBAAA,iBAAnBA,oBAAA,CAAqBI,OAAO,CAAC,GAAG,CAAE,GAAG,CAAC,CAACzB,WAAW,CAAC,CAAC,CAAO,CAAC,EAClF,CAAC,CAGLnH,qBAAqB,CAACkB,IAAI,CAACa,EAAE,CAAC,eAC7BpD,KAAA,QAAKsJ,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,eAAa,CAAM,CAAC,cAC5CzJ,IAAA,SAAMwJ,SAAS,UAAAzG,MAAA,CAAWxB,qBAAqB,CAACkB,IAAI,CAACa,EAAE,CAAC,CAACZ,oBAAoB,CAAG,oBAAoB,CAAG,kBAAkB,CAAG,CAAA+G,QAAA,CACzHlI,qBAAqB,CAACkB,IAAI,CAACa,EAAE,CAAC,CAACZ,oBAAoB,CAAG,uBAAuB,CAAG,mBAAmB,CAChG,CAAC,EACJ,CACN,EACE,CAAC,cAENxC,KAAA,QAAKsJ,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BzJ,IAAA,CAACF,MAAM,EACLsK,IAAI,CAAC,OAAO,CACZT,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAMrE,eAAe,CAAC5C,IAAI,CAAE,CAAAgH,QAAA,CACtC,cAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACLsK,IAAI,CAAC,OAAO,CACZT,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAMpE,QAAQ,CAAC7C,IAAI,CAAE,CAAAgH,QAAA,CAC/B,mBAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACLsK,IAAI,CAAC,OAAO,CACZT,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAMpF,gBAAgB,CAAC7B,IAAI,CAAE,CAAAgH,QAAA,CACvC,0BAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACLsK,IAAI,CAAC,OAAO,CACZT,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAM3F,YAAY,CAACtB,IAAI,CAACa,EAAE,CAAE,CACrCzC,OAAO,CAAEQ,cAAc,GAAKoB,IAAI,CAACa,EAAG,CACpC+G,QAAQ,CAAEhJ,cAAc,GAAKoB,IAAI,CAACa,EAAE,IAAA0G,qBAAA,CAAKzI,qBAAqB,CAACkB,IAAI,CAACa,EAAE,CAAC,UAAA0G,qBAAA,iBAA9BA,qBAAA,CAAgCtH,oBAAoB,CAAE,CAAA+G,QAAA,CAE9F,CAAAQ,sBAAA,CAAA1I,qBAAqB,CAACkB,IAAI,CAACa,EAAE,CAAC,UAAA2G,sBAAA,WAA9BA,sBAAA,CAAgCvH,oBAAoB,CAAG,oBAAoB,CAAG,eAAe,CACxF,CAAC,cACT1C,IAAA,CAACF,MAAM,EACLsK,IAAI,CAAC,OAAO,CACZT,OAAO,CAAC,QAAQ,CAChBD,OAAO,CAAEA,CAAA,GAAM3E,UAAU,CAACtC,IAAI,CAACa,EAAE,CAAE,CAAAmG,QAAA,CACpC,aAED,CAAQ,CAAC,EACN,CAAC,GAxGEhH,IAAI,CAACa,EAyGV,CAAC,EACP,CAAC,CACC,CACN,CAGAnC,aAAa,EAAIF,YAAY,eAC5BjB,IAAA,QAAKwJ,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BvJ,KAAA,QAAKsJ,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvCvJ,KAAA,QAAKsJ,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BvJ,KAAA,OAAAuJ,QAAA,EAAI,iBAAe,CAACxI,YAAY,CAACuG,WAAW,EAAK,CAAC,cAClDxH,IAAA,WACEwJ,SAAS,CAAC,aAAa,CACvBE,OAAO,CAAEA,CAAA,GAAM,CACbtI,gBAAgB,CAAC,KAAK,CAAC,CACvBF,eAAe,CAAC,IAAI,CAAC,CACvB,CAAE,CAAAuI,QAAA,CACH,MAED,CAAQ,CAAC,EACN,CAAC,cAENzJ,IAAA,QAAKwJ,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BvJ,KAAA,QAAKsJ,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCvJ,KAAA,QAAKsJ,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BzJ,IAAA,OAAAyJ,QAAA,CAAI,sBAAoB,CAAI,CAAC,cAC7BvJ,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,OAAK,CAAM,CAAC,cACpCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAExI,YAAY,CAACuE,aAAa,EAAI,kBAAkB,CAAO,CAAC,EAC9E,CAAC,cACNtF,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,cACrCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAExI,YAAY,CAACwE,cAAc,EAAI,KAAK,CAAO,CAAC,EAClE,CAAC,cACNvF,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,cACrCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAExI,YAAY,CAACyE,cAAc,EAAI,KAAK,CAAO,CAAC,EAClE,CAAC,EACH,CAAC,cAENxF,KAAA,QAAKsJ,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BzJ,IAAA,OAAAyJ,QAAA,CAAI,kBAAgB,CAAI,CAAC,cACzBvJ,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,OAAK,CAAM,CAAC,cACpCzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAEL,UAAU,CAACnI,YAAY,CAAC0G,UAAU,CAAC,CAAO,CAAC,EACjE,CAAC,cACNzH,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,iBAAe,CAAM,CAAC,cAC9CzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAArJ,qBAAA,CAAEa,YAAY,CAAC0E,cAAc,UAAAvF,qBAAA,iBAA3BA,qBAAA,CAA6B+J,OAAO,CAAC,GAAG,CAAE,GAAG,CAAC,CAACzB,WAAW,CAAC,CAAC,CAAO,CAAC,EAC1F,CAAC,cACNxI,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,SAAO,CAAM,CAAC,cACtCzJ,IAAA,SAAMwJ,SAAS,CAAC,sBAAsB,CAAAC,QAAA,CAAC,SAAO,CAAM,CAAC,EAClD,CAAC,EACH,CAAC,cAENvJ,KAAA,QAAKsJ,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3CzJ,IAAA,OAAAyJ,QAAA,CAAI,OAAK,CAAI,CAAC,cACdzJ,IAAA,QAAKwJ,SAAS,CAAC,YAAY,CAAAC,QAAA,EAAApJ,mBAAA,CACxBY,YAAY,CAAC4B,KAAK,UAAAxC,mBAAA,iBAAlBA,mBAAA,CAAoBuF,GAAG,CAAC,CAAChD,IAAI,CAAE2D,KAAK,gBACnCrG,KAAA,QAAiBsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACnCvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,QAAKwJ,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE7G,IAAI,CAACiB,YAAY,CAAM,CAAC,cACpD3D,KAAA,QAAKsJ,SAAS,CAAC,cAAc,CAAAC,QAAA,EAC1B7G,IAAI,CAACiD,gBAAgB,EAAIjD,IAAI,CAACe,QAAQ,CAAC,GAAC,CAACf,IAAI,CAACkB,SAAS,CAAC,QAAG,CAACwF,cAAc,CAAC1G,IAAI,CAACkD,UAAU,CAAC,CAAC,MAC7F,cAAA9F,IAAA,SAAMwJ,SAAS,qBAAAzG,MAAA,CAAsBH,IAAI,CAACoD,UAAU,GAAK,WAAW,CAAG,WAAW,CAAG,EAAE,CAAG,CAAAyD,QAAA,CACvF7G,IAAI,CAACoD,UAAU,GAAK,WAAW,CAAG,IAAI,CAAG,KAAK,CAC3C,CAAC,EACJ,CAAC,EACH,CAAC,cACN9F,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,EACxBH,cAAc,CAAC1G,IAAI,CAACmD,WAAW,CAAC,CAAC,MACpC,EAAK,CAAC,GAZEQ,KAaL,CACN,CAAC,CACC,CAAC,EACH,CAAC,cAENrG,KAAA,QAAKsJ,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BzJ,IAAA,OAAAyJ,QAAA,CAAI,QAAM,CAAI,CAAC,cACfvJ,KAAA,QAAKsJ,SAAS,CAAC,QAAQ,CAAAC,QAAA,eACrBvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,WAAS,CAAM,CAAC,cACxCvJ,KAAA,SAAMsJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAEH,cAAc,CAACrI,YAAY,CAACqJ,QAAQ,CAAC,CAAC,MAAI,EAAM,CAAC,EACvE,CAAC,CACLrJ,YAAY,CAACsJ,eAAe,CAAG,CAAC,eAC/BrK,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,WAAS,CAAM,CAAC,cACxCvJ,KAAA,SAAMsJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAC,GAAC,CAACH,cAAc,CAACrI,YAAY,CAACsJ,eAAe,CAAC,CAAC,MAAI,EAAM,CAAC,EAC/E,CACN,CACAtJ,YAAY,CAACuJ,UAAU,CAAG,CAAC,eAC1BtK,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,MAAI,CAAM,CAAC,cACnCvJ,KAAA,SAAMsJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAEH,cAAc,CAACrI,YAAY,CAACuJ,UAAU,CAAC,CAAC,MAAI,EAAM,CAAC,EACzE,CACN,cACDtK,KAAA,QAAKsJ,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,cACrCvJ,KAAA,SAAMsJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAEH,cAAc,CAACrI,YAAY,CAACoH,YAAY,CAAC,CAAC,MAAI,EAAM,CAAC,EAC3E,CAAC,EACH,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,cAENnI,KAAA,QAAKsJ,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BzJ,IAAA,CAACF,MAAM,EACL6J,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAM,CACbtI,gBAAgB,CAAC,KAAK,CAAC,CACvBF,eAAe,CAAC,IAAI,CAAC,CACvB,CAAE,CAAAuI,QAAA,CACH,OAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACL6J,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAM,CACbtI,gBAAgB,CAAC,KAAK,CAAC,CACvBF,eAAe,CAAC,IAAI,CAAC,CACrBoE,QAAQ,CAACrE,YAAY,CAAC,CACxB,CAAE,CAAAwI,QAAA,CACH,mBAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACL6J,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAMpF,gBAAgB,CAACrD,YAAY,CAAE,CAAAwI,QAAA,CAC/C,kCAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACL6J,OAAO,CAAC,QAAQ,CAChBD,OAAO,CAAEA,CAAA,GAAM3E,UAAU,CAAC9D,YAAY,CAACqC,EAAE,CAAE,CAAAmG,QAAA,CAC5C,aAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACL6J,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAM3F,YAAY,CAAC9C,YAAY,CAACqC,EAAE,CAAE,CAC7CzC,OAAO,CAAEQ,cAAc,GAAKJ,YAAY,CAACqC,EAAG,CAC5C+G,QAAQ,CAAEhJ,cAAc,GAAKJ,YAAY,CAACqC,EAAE,IAAAhD,sBAAA,CAAKiB,qBAAqB,CAACN,YAAY,CAACqC,EAAE,CAAC,UAAAhD,sBAAA,iBAAtCA,sBAAA,CAAwCoC,oBAAoB,CAAE,CAAA+G,QAAA,CAE9G,CAAAlJ,sBAAA,CAAAgB,qBAAqB,CAACN,YAAY,CAACqC,EAAE,CAAC,UAAA/C,sBAAA,WAAtCA,sBAAA,CAAwCmC,oBAAoB,CAAG,oBAAoB,CAAG,eAAe,CAChG,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAGAf,aAAa,EAAIF,WAAW,eAC3BzB,IAAA,QAAKwJ,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BvJ,KAAA,QAAKsJ,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpCvJ,KAAA,QAAKsJ,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BvJ,KAAA,OAAAuJ,QAAA,EAAI,cAAY,CAAChI,WAAW,CAAC+F,WAAW,EAAK,CAAC,cAC9CxH,IAAA,WACEwJ,SAAS,CAAC,aAAa,CACvBE,OAAO,CAAEA,CAAA,GAAM,CACb9H,gBAAgB,CAAC,KAAK,CAAC,CACvBF,cAAc,CAAC,IAAI,CAAC,CACpBI,eAAe,CAAC,CAAC,CAAC,CAAC,CACrB,CAAE,CAAA2H,QAAA,CACH,MAED,CAAQ,CAAC,EACN,CAAC,cAENzJ,IAAA,QAAKwJ,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBvJ,KAAA,QAAKsJ,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BzJ,IAAA,OAAAyJ,QAAA,CAAI,sBAAoB,CAAI,CAAC,cAC7BvJ,KAAA,QAAKsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBvJ,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,UAAAyJ,QAAA,CAAO,eAAa,CAAO,CAAC,cAC5BzJ,IAAA,UACEyK,IAAI,CAAC,MAAM,CACXC,KAAK,CAAE7I,YAAY,CAAC2D,aAAa,EAAI,EAAG,CACxCmF,QAAQ,CAAGC,CAAC,EAAK9I,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IAAK1C,YAAY,MAAE2D,aAAa,CAAEoF,CAAC,CAACC,MAAM,CAACH,KAAK,EAAC,CAAE,CACnFI,WAAW,CAAC,eAAe,CAC5B,CAAC,EACC,CAAC,cACN5K,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,UAAAyJ,QAAA,CAAO,OAAK,CAAO,CAAC,cACpBzJ,IAAA,UACEyK,IAAI,CAAC,MAAM,CACXC,KAAK,CAAE7I,YAAY,CAAC4D,cAAc,EAAI,EAAG,CACzCkF,QAAQ,CAAGC,CAAC,EAAK9I,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IAAK1C,YAAY,MAAE4D,cAAc,CAAEmF,CAAC,CAACC,MAAM,CAACH,KAAK,EAAC,CAAE,CACpFI,WAAW,CAAC,cAAc,CAC3B,CAAC,EACC,CAAC,EACH,CAAC,cACN5K,KAAA,QAAKsJ,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBvJ,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,UAAAyJ,QAAA,CAAO,OAAK,CAAO,CAAC,cACpBzJ,IAAA,UACEyK,IAAI,CAAC,OAAO,CACZC,KAAK,CAAE7I,YAAY,CAAC6D,cAAc,EAAI,EAAG,CACzCiF,QAAQ,CAAGC,CAAC,EAAK9I,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IAAK1C,YAAY,MAAE6D,cAAc,CAAEkF,CAAC,CAACC,MAAM,CAACH,KAAK,EAAC,CAAE,CACpFI,WAAW,CAAC,eAAe,CAC5B,CAAC,EACC,CAAC,cACN5K,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzJ,IAAA,UAAAyJ,QAAA,CAAO,gBAAc,CAAO,CAAC,cAC7BvJ,KAAA,WACEwK,KAAK,CAAE7I,YAAY,CAAC8D,cAAc,EAAI,MAAO,CAC7CgF,QAAQ,CAAGC,CAAC,EAAK9I,eAAe,CAAAyC,aAAA,CAAAA,aAAA,IAAK1C,YAAY,MAAE8D,cAAc,CAAEiF,CAAC,CAACC,MAAM,CAACH,KAAK,EAAC,CAAE,CAAAjB,QAAA,eAEpFzJ,IAAA,WAAQ0K,KAAK,CAAC,MAAM,CAAAjB,QAAA,CAAC,MAAI,CAAQ,CAAC,cAClCzJ,IAAA,WAAQ0K,KAAK,CAAC,MAAM,CAAAjB,QAAA,CAAC,MAAI,CAAQ,CAAC,cAClCzJ,IAAA,WAAQ0K,KAAK,CAAC,cAAc,CAAAjB,QAAA,CAAC,cAAY,CAAQ,CAAC,cAClDzJ,IAAA,WAAQ0K,KAAK,CAAC,eAAe,CAAAjB,QAAA,CAAC,eAAa,CAAQ,CAAC,EAC9C,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,cAENvJ,KAAA,QAAKsJ,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eACzCzJ,IAAA,OAAAyJ,QAAA,CAAI,OAAK,CAAI,CAAC,cACdzJ,IAAA,QAAKwJ,SAAS,CAAC,iBAAiB,CAAAC,QAAA,EAAAjJ,mBAAA,CAC7BqB,YAAY,CAACgB,KAAK,UAAArC,mBAAA,iBAAlBA,mBAAA,CAAoBoF,GAAG,CAAC,CAAChD,IAAI,CAAE2D,KAAK,gBACnCrG,KAAA,QAAiBsJ,SAAS,CAAC,eAAe,CAAAC,QAAA,eACxCvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,QAAKwJ,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE7G,IAAI,CAACiB,YAAY,CAAM,CAAC,cACpD7D,IAAA,QAAKwJ,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE7G,IAAI,CAACkB,SAAS,CAAM,CAAC,cACjD5D,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,EAAEH,cAAc,CAAC1G,IAAI,CAACkD,UAAU,CAAC,CAAC,WAAS,EAAK,CAAC,EACzE,CAAC,cACN5F,KAAA,QAAKsJ,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BzJ,IAAA,UAAAyJ,QAAA,CAAO,WAAS,CAAO,CAAC,cACxBzJ,IAAA,UACEyK,IAAI,CAAC,QAAQ,CACbM,GAAG,CAAC,GAAG,CACPC,IAAI,CAAC,MAAM,CACXN,KAAK,CAAE9H,IAAI,CAACe,QAAS,CACrBgH,QAAQ,CAAGC,CAAC,EAAK3E,sBAAsB,CAACM,KAAK,CAAEqE,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAChE,CAAC,EACC,CAAC,cACNxK,KAAA,QAAKsJ,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BzJ,IAAA,UAAAyJ,QAAA,CAAO,aAAW,CAAO,CAAC,cAC1BvJ,KAAA,WACEwK,KAAK,CAAE9H,IAAI,CAACoD,UAAW,CACvB2E,QAAQ,CAAGC,CAAC,EAAKpE,uBAAuB,CAACD,KAAK,CAAEqE,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAAAjB,QAAA,eAEhEzJ,IAAA,WAAQ0K,KAAK,CAAC,UAAU,CAAAjB,QAAA,CAAC,UAAQ,CAAQ,CAAC,cAC1CzJ,IAAA,WAAQ0K,KAAK,CAAC,WAAW,CAAAjB,QAAA,CAAC,WAAS,CAAQ,CAAC,EACtC,CAAC,EACN,CAAC,cACNvJ,KAAA,QAAKsJ,SAAS,CAAC,YAAY,CAAAC,QAAA,EACxBH,cAAc,CAAC1G,IAAI,CAACmD,WAAW,CAAC,CAAC,MACpC,EAAK,CAAC,cACN/F,IAAA,QAAKwJ,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BzJ,IAAA,CAACF,MAAM,EACLsK,IAAI,CAAC,OAAO,CACZT,OAAO,CAAC,QAAQ,CAChBD,OAAO,CAAEA,CAAA,GAAMrD,cAAc,CAACE,KAAK,CAAE,CAAAkD,QAAA,CACtC,QAED,CAAQ,CAAC,CACN,CAAC,GArCElD,KAsCL,CACN,CAAC,CACC,CAAC,cAENrG,KAAA,QAAKsJ,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BvJ,KAAA,QAAKsJ,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,WAAS,CAAM,CAAC,cACxCvJ,KAAA,SAAMsJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EACpBH,cAAc,EAAA7I,oBAAA,CAACoB,YAAY,CAACgB,KAAK,UAAApC,oBAAA,iBAAlBA,oBAAA,CAAoBmJ,MAAM,CAAC,CAACqB,GAAG,CAAErI,IAAI,GAAKqI,GAAG,CAAGzH,UAAU,CAACZ,IAAI,CAACmD,WAAW,EAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAAC,MACzG,EAAM,CAAC,EACJ,CAAC,cACN7F,KAAA,QAAKsJ,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BzJ,IAAA,SAAMwJ,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,cACrCvJ,KAAA,SAAMsJ,SAAS,CAAC,OAAO,CAAAC,QAAA,EACpBH,cAAc,EAAA5I,oBAAA,CAACmB,YAAY,CAACgB,KAAK,UAAAnC,oBAAA,iBAAlBA,oBAAA,CAAoBkJ,MAAM,CAAC,CAACqB,GAAG,CAAErI,IAAI,GAAKqI,GAAG,CAAGzH,UAAU,CAACZ,IAAI,CAACmD,WAAW,EAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAAC,MACzG,EAAM,CAAC,EACJ,CAAC,EACH,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,cAEN7F,KAAA,QAAKsJ,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BzJ,IAAA,CAACF,MAAM,EACL6J,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEA,CAAA,GAAM,CACb9H,gBAAgB,CAAC,KAAK,CAAC,CACvBF,cAAc,CAAC,IAAI,CAAC,CACpBI,eAAe,CAAC,CAAC,CAAC,CAAC,CACrB,CAAE,CAAA2H,QAAA,CACH,QAED,CAAQ,CAAC,cACTzJ,IAAA,CAACF,MAAM,EACL6J,OAAO,CAAC,SAAS,CACjBD,OAAO,CAAEvC,cAAe,CACxBkD,QAAQ,CAAE,CAACxI,YAAY,CAACgB,KAAK,EAAIhB,YAAY,CAACgB,KAAK,CAACb,MAAM,GAAK,CAAE,CAAAyH,QAAA,CAClE,cAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAtJ,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}