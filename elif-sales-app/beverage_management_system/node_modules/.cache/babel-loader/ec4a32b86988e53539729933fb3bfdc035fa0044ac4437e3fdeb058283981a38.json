{"ast":null,"code":"/**\n * Print utilities for thermal receipt printer compatibility\n * Supports 80mm and 58mm thermal printers with ESC/POS commands\n */// ESC/POS Commands for thermal printers (Xprinter 80mm compatible)\nexport const ESC_POS_COMMANDS={INITIALIZE:'\\x1B\\x40',// Initialize printer\nCENTER:'\\x1B\\x61\\x01',// Center text\nLEFT_ALIGN:'\\x1B\\x61\\x00',// Left align text\nRIGHT_ALIGN:'\\x1B\\x61\\x02',// Right align text\nBOLD_ON:'\\x1B\\x45\\x01',// Bold on\nBOLD_OFF:'\\x1B\\x45\\x00',// Bold off\nDOUBLE_HEIGHT:'\\x1B\\x21\\x10',// Double height\nNORMAL_SIZE:'\\x1B\\x21\\x00',// Normal size\nCUT_PAPER:'\\x1D\\x56\\x00',// Cut paper\nFEED_LINE:'\\x0A',// Feed line\nFEED_LINES:n=>\"\\x1Bd\".concat(String.fromCharCode(n)),// Feed n lines\nUNDERLINE_ON:'\\x1B\\x2D\\x01',// Underline on\nUNDERLINE_OFF:'\\x1B\\x2D\\x00',// Underline off\nREVERSE_ON:'\\x1D\\x42\\x01',// Reverse on\nREVERSE_OFF:'\\x1D\\x42\\x00',// Reverse off\n// Xprinter specific commands\nXPRINTER_INIT:'\\x1B\\x40',// Xprinter initialization\nXPRINTER_CUT:'\\x1D\\x56\\x42\\x00',// Xprinter cut paper\nXPRINTER_FEED:'\\x1B\\x64\\x03',// Xprinter feed 3 lines\nXPRINTER_BEEP:'\\x1B\\x42\\x01\\x01'// Xprinter beep\n};// Printer configurations\nexport const PRINTER_CONFIGS={THERMAL_80MM:{width:'80mm',maxChars:32,fontSize:12,lineHeight:1.2,margins:'5mm'},THERMAL_58MM:{width:'58mm',maxChars:24,fontSize:10,lineHeight:1.1,margins:'3mm'},STANDARD_A4:{width:'210mm',maxChars:80,fontSize:14,lineHeight:1.4,margins:'20mm'}};/**\n * Generate CSS for thermal printer compatibility\n * @param {string} printerType - Type of printer (THERMAL_80MM, THERMAL_58MM, STANDARD_A4)\n * @returns {string} CSS styles\n */export const generateThermalPrinterCSS=function(){let printerType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'THERMAL_80MM';const config=PRINTER_CONFIGS[printerType];return\"\\n    @media print {\\n      @page {\\n        size: \".concat(config.width,\" auto;\\n        margin: \").concat(config.margins,\";\\n      }\\n      \\n      body { \\n        margin: 0; \\n        font-size: \").concat(config.fontSize,\"px;\\n        line-height: \").concat(config.lineHeight,\";\\n        font-family: 'Courier New', monospace;\\n        max-width: \").concat(config.width,\";\\n      }\\n      \\n      .header h1 { \\n        font-size: \").concat(config.fontSize+6,\"px; \\n        margin-bottom: 5px;\\n        text-align: center;\\n      }\\n      \\n      .header .date, .header .print-info { \\n        font-size: \").concat(config.fontSize-2,\"px; \\n        text-align: center;\\n      }\\n      \\n      .info-section { \\n        padding: 8px; \\n        margin-bottom: 10px; \\n        border: 1px solid #000;\\n      }\\n      \\n      .info-section h3 { \\n        font-size: \").concat(config.fontSize+2,\"px; \\n        margin-bottom: 5px;\\n        text-align: center;\\n        font-weight: bold;\\n      }\\n      \\n      .info-row { \\n        margin-bottom: 3px; \\n        font-size: \").concat(config.fontSize-1,\"px;\\n        display: flex;\\n        justify-content: space-between;\\n      }\\n      \\n      table { \\n        width: 100%;\\n        font-size: \").concat(config.fontSize-2,\"px; \\n        border-collapse: collapse;\\n      }\\n      \\n      th, td { \\n        padding: 2px; \\n        font-size: \").concat(config.fontSize-2,\"px;\\n        border: 1px solid #000;\\n        text-align: left;\\n      }\\n      \\n      th { \\n        background-color: #f0f0f0;\\n        font-weight: bold;\\n        text-align: center;\\n      }\\n      \\n      .total-row { \\n        font-weight: bold; \\n        background-color: #e0e0e0; \\n      }\\n      \\n      .footer { \\n        font-size: \").concat(config.fontSize-3,\"px; \\n        margin-top: 15px; \\n        text-align: center;\\n        border-top: 1px solid #000;\\n        padding-top: 5px;\\n      }\\n      \\n      .thermal-printer-commands {\\n        display: block;\\n        font-family: monospace;\\n        font-size: 8px;\\n        color: #666;\\n        margin-top: 5px;\\n        text-align: center;\\n      }\\n      \\n      /* Hide elements not suitable for thermal printing */\\n      .no-print, .print-button, .button, .btn {\\n        display: none !important;\\n      }\\n    }\\n  \");};/**\n * Generate ESC/POS commands for thermal printer\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */export const generateESCPOSCommands=(data,title)=>{let commands='';// Initialize printer\ncommands+=ESC_POS_COMMANDS.INITIALIZE;// Center and bold title\ncommands+=ESC_POS_COMMANDS.CENTER;commands+=ESC_POS_COMMANDS.BOLD_ON;commands+=ESC_POS_COMMANDS.DOUBLE_HEIGHT;commands+=title+'\\n';commands+=ESC_POS_COMMANDS.NORMAL_SIZE;commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+=ESC_POS_COMMANDS.FEED_LINE;// Add separator line\ncommands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.FEED_LINE;// Add document info\ncommands+=ESC_POS_COMMANDS.LEFT_ALIGN;commands+=\"Date: \".concat(new Date().toLocaleDateString(),\"\\n\");commands+=\"Time: \".concat(new Date().toLocaleTimeString(),\"\\n\");// commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\ncommands+=ESC_POS_COMMANDS.FEED_LINE;// Add content based on type\nif(data.sale_number){commands+=\"Sale: \".concat(data.sale_number,\"\\n\");}if(data.customer_name){commands+=\"Customer: \".concat(data.customer_name,\"\\n\");}if(data.customer_phone){commands+=\"Phone: \".concat(data.customer_phone,\"\\n\");}commands+=ESC_POS_COMMANDS.FEED_LINE;commands+='-'.repeat(32)+'\\n';// Add items if present\nif(data.items&&Array.isArray(data.items)){commands+=ESC_POS_COMMANDS.BOLD_ON;commands+='ITEMS:\\n';commands+=ESC_POS_COMMANDS.BOLD_OFF;data.items.forEach(item=>{commands+=\"\".concat(item.product_name||'N/A',\"\\n\");commands+=\"  Qty: \".concat(item.quantity||0,\" \").concat(item.unit_name||'pcs',\"\\n\");commands+=\"  Price: \".concat(parseFloat(item.unit_price||0).toFixed(2),\" MGA\\n\");commands+=\"  Total: \".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\\n\");commands+='\\n';});}// Add packaging items if present\nif(data.packaging_items&&Array.isArray(data.packaging_items)){commands+=ESC_POS_COMMANDS.BOLD_ON;commands+='PACKAGING:\\n';commands+=ESC_POS_COMMANDS.BOLD_OFF;data.packaging_items.forEach(item=>{commands+=\"\".concat(item.product_name||'N/A',\"\\n\");commands+=\"  Qty: \".concat(item.quantity||0,\" \").concat(item.unit_name||'pcs',\"\\n\");commands+=\"  Price: \".concat(parseFloat(item.unit_price||0).toFixed(2),\" MGA\\n\");commands+=\"  Total: \".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\\n\");commands+=\"  Status: \".concat(item.status||'N/A',\"\\n\");commands+='\\n';});}// Add totals\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.BOLD_ON;if(data.total_amount){commands+=\"TOTAL: \".concat(parseFloat(data.total_amount).toFixed(2),\" MGA\\n\");}if(data.packaging_total){commands+=\"PACKAGING: \".concat(parseFloat(data.packaging_total).toFixed(2),\" MGA\\n\");}if(data.paid_amount){commands+=\"PAID: \".concat(parseFloat(data.paid_amount).toFixed(2),\" MGA\\n\");}if(data.remaining_amount){commands+=\"REMAINING: \".concat(parseFloat(data.remaining_amount).toFixed(2),\" MGA\\n\");}commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+='='.repeat(32)+'\\n';// Add footer\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='Generated by ______ANTATSIMO______ System\\n';commands+=\"User: \".concat(data.user_name||'System',\"\\n\");// commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n// Feed lines and cut paper\ncommands+=ESC_POS_COMMANDS.FEED_LINES(3);commands+=ESC_POS_COMMANDS.CUT_PAPER;return commands;};/**\n * Detect printer type based on user agent or settings\n * @returns {string} Printer type\n */export const detectPrinterType=()=>{// Check if running in a thermal printer environment\nif(typeof window!=='undefined'){const userAgent=window.navigator.userAgent.toLowerCase();// Check for Xprinter specific indicators\nif(userAgent.includes('xprinter')||userAgent.includes('thermal')||userAgent.includes('receipt')){return'THERMAL_80MM';// Xprinter 80mm\n}// Enhanced mobile detection\nconst isMobile=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent)||window.innerWidth<=768||'ontouchstart'in window||navigator.maxTouchPoints>0;// For mobile devices, still use 80mm for Xprinter compatibility\nif(isMobile){return'THERMAL_80MM';// Force 80mm for Xprinter compatibility\n}}// Default to 80mm thermal printer (Xprinter standard)\nreturn'THERMAL_80MM';};/**\n * Check if device supports modern printing APIs\n * @returns {boolean} True if modern printing is supported\n */export const supportsModernPrinting=()=>{if(typeof window==='undefined')return false;// Check for modern printing APIs\nreturn!!(window.navigator&&(window.navigator.share||window.print||window.matchMedia&&window.matchMedia('print')));};/**\n * Check if device is mobile\n * @returns {boolean} True if mobile device\n */export const isMobileDevice=()=>{if(typeof window==='undefined')return false;const userAgent=window.navigator.userAgent.toLowerCase();return /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent)||window.innerWidth<=768||'ontouchstart'in window||navigator.maxTouchPoints>0;};/**\n * Format text for thermal printer (truncate if too long)\n * @param {string} text - Text to format\n * @param {number} maxLength - Maximum length\n * @returns {string} Formatted text\n */export const formatForThermalPrinter=function(text){let maxLength=arguments.length>1&&arguments[1]!==undefined?arguments[1]:32;if(!text)return'';// Remove HTML tags\nconst cleanText=text.replace(/<[^>]*>/g,'');// Truncate if too long\nif(cleanText.length>maxLength){return cleanText.substring(0,maxLength-3)+'...';}return cleanText;};/**\n * Create a print-ready document with thermal printer compatibility\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @param {string} printerType - Printer type\n * @returns {string} HTML content\n */export const createThermalPrintDocument=function(data,title,type,t){let printerType=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;const detectedType=printerType||detectPrinterType();const css=generateThermalPrinterCSS(detectedType);const escPosCommands=generateESCPOSCommands(data,title);return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"utf-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1\\\">\\n      <style>\\n        \").concat(css,\"\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"header\\\">\\n        <h1>\").concat(formatForThermalPrinter(title,32),\"</h1>\\n        <div class=\\\"date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n      </div>\\n      \\n      <div class=\\\"thermal-printer-commands\\\">\\n        <pre>\").concat(escPosCommands,\"</pre>\\n      </div>\\n      \\n      <div class=\\\"footer\\\">\\n        <p>______ANTATSIMO______ System</p>\\n      </div>\\n    </body>\\n    </html>\\n  \");};/**\n * Generate ESC/POS commands for direct printer communication\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */export const generateESCPOSForReceiptApp=(data,title)=>{try{// Validate inputs\nif(!data||!title){console.error('Invalid data or title provided to generateESCPOSForReceiptApp');return'';}let commands='';// Initialize printer\ncommands+=ESC_POS_COMMANDS.XPRINTER_INIT;// Center and bold title\ncommands+=ESC_POS_COMMANDS.CENTER;commands+=ESC_POS_COMMANDS.BOLD_ON;commands+=ESC_POS_COMMANDS.DOUBLE_HEIGHT;commands+=title+'\\n';commands+=ESC_POS_COMMANDS.NORMAL_SIZE;commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+=ESC_POS_COMMANDS.FEED_LINE;// Add separator line\ncommands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.FEED_LINE;// Add document info\ncommands+=ESC_POS_COMMANDS.LEFT_ALIGN;commands+=\"Date: \".concat(new Date().toLocaleDateString(),\"\\n\");commands+=\"Time: \".concat(new Date().toLocaleTimeString(),\"\\n\");// commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\ncommands+=ESC_POS_COMMANDS.FEED_LINE;// Add sale info\nif(data.sale_number){commands+=\"Sale: \".concat(data.sale_number,\"\\n\");}if(data.customer_name){commands+=\"Customer: \".concat(data.customer_name,\"\\n\");}if(data.customer_phone){commands+=\"Phone: \".concat(data.customer_phone,\"\\n\");}commands+=ESC_POS_COMMANDS.FEED_LINE;commands+='-'.repeat(32)+'\\n';// Add items\nif(data.items&&Array.isArray(data.items)){commands+=ESC_POS_COMMANDS.BOLD_ON;commands+='ITEMS:\\n';commands+=ESC_POS_COMMANDS.BOLD_OFF;data.items.forEach(item=>{commands+=\"\".concat((item.product_name||'N/A').substring(0,25),\"\\n\");commands+=\"  Qty: \".concat(item.quantity_display||item.quantity||0,\" x \").concat(parseFloat(item.unit_price||0).toFixed(2),\"\\n\");commands+=\"  Total: \".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\\n\");commands+='\\n';});}// Add totals\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.BOLD_ON;if(data.total_amount){commands+=\"TOTAL: \".concat(parseFloat(data.total_amount).toFixed(2),\" MGA\\n\");}if(data.paid_amount){commands+=\"PAID: \".concat(parseFloat(data.paid_amount).toFixed(2),\" MGA\\n\");}if(data.remaining_amount&&data.remaining_amount>0){commands+=\"DUE: \".concat(parseFloat(data.remaining_amount).toFixed(2),\" MGA\\n\");}commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+='='.repeat(32)+'\\n';// Add footer\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='Thank you for your business!\\n';commands+='______ANTATSIMO______ System\\n';// commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n// Feed lines and cut paper\ncommands+=ESC_POS_COMMANDS.XPRINTER_FEED;commands+=ESC_POS_COMMANDS.XPRINTER_CUT;return commands;}catch(error){console.error('Error generating ESC/POS commands:',error);return'';}};/**\n * Create downloadable file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} File content for download\n */export const createReceiptAppFile=(data,title)=>{const escPosCommands=generateESCPOSForReceiptApp(data,title);// Create a simple translation function for the HTML content\nconst simpleT=(key,fallback)=>fallback||key;const htmlContent=generateXprinterPrintContent(data,title,'sale',simpleT);// Create a combined file that works with receipt printer apps\nreturn\"# Receipt Printer App File\\n# Generated: \".concat(new Date().toISOString(),\"\\n# Title: \").concat(title,\"\\n\\n# ESC/POS Commands (for direct printer communication)\\n\").concat(escPosCommands,\"\\n\\n# HTML Content (for preview and fallback printing)\\n\").concat(htmlContent,\"\\n\\n# End of file\");};/**\n * Generate PDF content for receipt\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} PDF-ready HTML content\n */export const generatePDFContent=(data,title)=>{const isMobile=isMobileDevice();const width='80mm';// Standard for Xprinter\nconst fontSize='12px';const maxChars=32;return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n      <style>\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: \").concat(fontSize,\";\\n          line-height: 1.2;\\n          color: #000;\\n          width: \").concat(width,\";\\n          max-width: \").concat(width,\";\\n          margin: 0 auto;\\n          padding: 2mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: 14px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: 13px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: 11px;\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: 11px;\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 1px 3px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-size: 11px;\\n        }\\n        \\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n          max-width: 22ch;\\n        }\\n        \\n        .item-details {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: 10px;\\n          color: #555;\\n        }\\n        \\n        .receipt-totals {\\n          margin: 6px 0;\\n          padding-top: 4px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-weight: bold;\\n          font-size: 11px;\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 8px;\\n          padding-top: 4px;\\n          border-top: 1px dashed #000;\\n          font-size: 10px;\\n          color: #666;\\n        }\\n        \\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 1mm;\\n            width: \").concat(width,\";\\n          }\\n          \\n          @page {\\n            size: \").concat(width,\" auto;\\n            margin: 0;\\n          }\\n        }\\n        \\n        @media screen {\\n          body {\\n            border: 1px solid #ccc;\\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\\n          }\\n        }\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\">______ANTATSIMO______</div>\\n        <div class=\\\"document-title\\\">\").concat(title.toUpperCase(),\"</div>\\n        <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n      </div>\\n      \\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">SALE INFO</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale No:</span>\\n          <span>\").concat(data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Status:</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Customer:</span>\\n          <span>\").concat((data.customer_name||'Walk-in Customer').substring(0,22),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Phone:</span>\\n            <span>\".concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Peyment Status:</span>\\n          <span>\").concat(data.payment_status,\"</span>\\n        </div>\\n      </div>\\n      \\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">ITEMS</div>\\n        \").concat(data.items&&Array.isArray(data.items)?data.items.map(item=>\"\\n          <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,22),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity_display||item.quantity||0,\" x \").concat(parseFloat(item.unit_price||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat(item.total_price||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n      </div>\\n      \\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"total-row\\\">\\n          <span>Total:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"total-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"total-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n      </div>\\n      \\n      <div class=\\\"receipt-footer\\\">\\n        <div>Thank you for your business!</div>\\n        <div>Created by: \").concat(data.created_by_name||data.sold_by_name||'N/A',\"</div>\\n      </div>\\n    </body>\\n    </html>\\n  \");};/**\n * Download PDF file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */export const downloadReceiptFile=(data,title)=>{try{// Validate inputs\nif(!data||!title){console.error('Invalid data or title provided to downloadReceiptFile');return false;}const pdfContent=generatePDFContent(data,title);if(!pdfContent){console.error('Failed to create PDF content');return false;}// Create a blob with HTML content that can be saved as PDF\nconst blob=new Blob([pdfContent],{type:'text/html'});const url=URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download=\"receipt_\".concat(data.sale_number||Date.now(),\".html\");link.style.display='none';document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(url);return true;}catch(error){console.error('Failed to download receipt file:',error);return false;}};/**\n * Mobile-friendly print function with fallbacks\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */export const mobilePrint=async function(printContent){let title=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Document';try{// Method 1: Try Web Share API with file (modern mobile browsers)\nif(navigator.share&&isMobileDevice()){try{// Create a blob with the content\nconst blob=new Blob([printContent],{type:'text/html'});const file=new File([blob],\"\".concat(title,\".html\"),{type:'text/html'});await navigator.share({title:title,text:'Print this receipt',files:[file]});return true;}catch(shareError){console.log('Web Share API with file failed, trying other methods:',shareError);}}// Method 2: Try direct window.print() on current page\nif(window.print&&!isMobileDevice()){// Create a temporary element with the content\nconst tempDiv=document.createElement('div');tempDiv.innerHTML=printContent;tempDiv.style.position='absolute';tempDiv.style.left='-9999px';tempDiv.style.top='-9999px';document.body.appendChild(tempDiv);// Replace body content temporarily\nconst originalBody=document.body.innerHTML;document.body.innerHTML=printContent;// Print\nwindow.print();// Restore original content\ndocument.body.innerHTML=originalBody;document.body.removeChild(tempDiv);return true;}// Method 3: Try popup window (with better error handling)\nreturn await openPrintWindow(printContent,title);}catch(error){console.error('All print methods failed:',error);return false;}};/**\n * Open print window with enhanced error handling\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */export const openPrintWindow=function(printContent){let title=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Document';return new Promise(resolve=>{try{// Enhanced window.open parameters for better mobile compatibility\nconst windowFeatures=isMobileDevice()?'width=400,height=600,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no':'width=900,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no';const printWindow=window.open('','_blank',windowFeatures);if(!printWindow){throw new Error('Popup blocked or window.open failed');}// Set window title\nprintWindow.document.title=title;// Write content to window\nprintWindow.document.write(printContent);printWindow.document.close();// Make sure window is visible and focused\nprintWindow.focus();// Wait for content to load and show the window\nconst showAndPrint=()=>{try{// Ensure window is visible\nprintWindow.focus();// Add a small delay to ensure content is rendered\nsetTimeout(()=>{try{// Show print dialog\nprintWindow.print();// Keep window open longer for user interaction\nsetTimeout(()=>{if(!printWindow.closed){// Ask user if they want to close the window\nif(window.confirm('Close the print preview window?')){printWindow.close();}}},5000);resolve(true);}catch(printError){console.error('Print failed:',printError);// Don't close window immediately, let user see the content\nresolve(false);}},500);}catch(error){console.error('Error in showAndPrint:',error);resolve(false);}};// Check if content is loaded\nif(printWindow.document.readyState==='complete'){showAndPrint();}else{printWindow.onload=showAndPrint;}// Fallback timeout - don't auto-close\nsetTimeout(()=>{if(!printWindow.closed){console.log('Print window timeout - window remains open for user interaction');}},30000);}catch(error){console.error('Failed to open print window:',error);resolve(false);}});};/**\n * Print directly without preview or dialogs\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */export const openPrintWindow_=function(printContent){let title=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Document';return new Promise(resolve=>{try{// Create a hidden iframe for printing\nconst iframe=document.createElement('iframe');iframe.style.position='fixed';iframe.style.right='0';iframe.style.bottom='0';iframe.style.width='0';iframe.style.height='0';iframe.style.border='none';iframe.style.opacity='0';iframe.style.pointerEvents='none';document.body.appendChild(iframe);const iframeDoc=iframe.contentDocument||iframe.contentWindow.document;// Write content to iframe\niframeDoc.open();iframeDoc.write(printContent);iframeDoc.close();// Set title\niframeDoc.title=title;// Wait for iframe content to load\niframe.onload=()=>{try{// Get the iframe window\nconst iframeWindow=iframe.contentWindow;// Print directly without dialog\niframeWindow.focus();// Use setTimeout to ensure content is fully rendered\nsetTimeout(()=>{try{// Direct print command\niframeWindow.print();// Resolve immediately after calling print()\nresolve(true);// Clean up iframe after a delay\nsetTimeout(()=>{if(document.body.contains(iframe)){document.body.removeChild(iframe);}},1000);}catch(printError){console.error('Print failed:',printError);// Clean up on error\nif(document.body.contains(iframe)){document.body.removeChild(iframe);}resolve(false);}},100);}catch(error){console.error('Error in iframe print process:',error);if(document.body.contains(iframe)){document.body.removeChild(iframe);}resolve(false);}};// Fallback in case onload doesn't fire\nsetTimeout(()=>{if(iframe.contentDocument&&iframe.contentDocument.readyState==='complete'){iframe.onload();// Manually trigger onload\n}},500);}catch(error){console.error('Failed to setup direct printing:',error);resolve(false);}});};/**\n * Open print preview window (visible, doesn't auto-close)\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */export const openPrintPreview=function(printContent){let title=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Document';try{// Create a larger window for better visibility\nconst windowFeatures=isMobileDevice()?'width=500,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes':'width=1000,height=800,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes';const previewWindow=window.open('','_blank',windowFeatures);if(!previewWindow){throw new Error('Popup blocked or window.open failed');}// Set window title\npreviewWindow.document.title=\"\".concat(title,\" - Print Preview\");// Add print button and styling\nconst enhancedContent=\"\\n      <!DOCTYPE html>\\n      <html>\\n      <head>\\n        <title>\".concat(title,\" - Print Preview</title>\\n        <meta charset=\\\"UTF-8\\\">\\n        <style>\\n          body {\\n            margin: 0;\\n            padding: 20px;\\n            font-family: Arial, sans-serif;\\n            background: #f5f5f5;\\n          }\\n          .print-controls {\\n            position: fixed;\\n            top: 10px;\\n            right: 10px;\\n            background: white;\\n            padding: 10px;\\n            border-radius: 5px;\\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\n            z-index: 1000;\\n          }\\n          .print-controls button {\\n            margin: 5px;\\n            padding: 8px 16px;\\n            border: none;\\n            border-radius: 3px;\\n            cursor: pointer;\\n            font-size: 14px;\\n          }\\n          .print-btn {\\n            background: #007bff;\\n            color: white;\\n          }\\n          .close-btn {\\n            background: #6c757d;\\n            color: white;\\n          }\\n          .print-content {\\n            background: white;\\n            padding: 20px;\\n            border-radius: 5px;\\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\n            max-width: 800px;\\n            margin: 0 auto;\\n          }\\n        </style>\\n      </head>\\n      <body>\\n        <div class=\\\"print-controls\\\">\\n          <button class=\\\"print-btn\\\" onclick=\\\"window.print()\\\">\\uD83D\\uDDA8\\uFE0F Print</button>\\n          <button class=\\\"close-btn\\\" onclick=\\\"window.close()\\\">\\u274C Close</button>\\n        </div>\\n        <div class=\\\"print-content\\\">\\n          \").concat(printContent.replace('<!DOCTYPE html>','').replace('<html>','').replace('<head>','').replace('</head>','').replace('<body>','').replace('</body>','').replace('</html>',''),\"\\n        </div>\\n      </body>\\n      </html>\\n    \");// Write content to window\npreviewWindow.document.write(enhancedContent);previewWindow.document.close();// Focus the window\npreviewWindow.focus();return true;}catch(error){console.error('Failed to open print preview:',error);return false;}};/**\n * Generate Xprinter 80mm optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Xprinter-optimized HTML content\n */export const generateXprinterPrintContent=(data,title,type,t)=>{return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n      <style>\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: 12px;\\n          line-height: 1.2;\\n          color: #000;\\n          width: 80mm;\\n          max-width: 80mm;\\n          margin: 0 auto;\\n          padding: 2mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: 14px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: 13px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: 11px;\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: 11px;\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 1px 3px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-size: 11px;\\n        }\\n        \\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n          max-width: 22ch; /* 80mm = ~32 chars, leave space for price */\\n        }\\n        \\n        .item-details {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: 10px;\\n          color: #555;\\n        }\\n        \\n        .receipt-totals {\\n          margin: 6px 0;\\n          padding-top: 4px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-weight: bold;\\n          font-size: 11px;\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 8px;\\n          padding-top: 4px;\\n          border-top: 1px dashed #000;\\n          font-size: 10px;\\n          color: #666;\\n        }\\n        \\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 1mm;\\n            width: 80mm;\\n          }\\n          \\n          @page {\\n            size: 80mm auto;\\n            margin: 0;\\n          }\\n        }\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">________ANTATSIMO_______</div>\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"document-title\\\" style=\\\"text-align: center;\\\">SALE RECEIPT</div>\\n        <div class=\\\"receipt-date\\\" style=\\\"text-align: center;\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"section-title\\\">SALE INFO</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale No:</span>\\n          <span>\").concat(data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale Status:</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Customer:</span>\\n          <span>\").concat((data.customer_name||'Walk-in Customer').substring(0,25),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Phone:</span>\\n            <span>\".concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Peyment Status:</span>\\n          <span>\").concat(data.payment_status,\"</span>\\n        </div>\\n\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"no-data\\\">==================================================</div>\\n\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">ITEMS SOLD</div>    \\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"item-details\\\">\\n          <span>Info</span>\\n          <span>\\n            Qte\").concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n          </span>\\n        </div>\\n        <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div> \\n        \").concat(data.items&&Array.isArray(data.items)?data.items.map(item=>\"\\n          <div class=\\\"sale-item\\\">\\n            <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n            <div class=\\\"item-details\\\">\\n              <span>\\n                \").concat(\"(\".concat(item.unit_name,\")\").concat(parseFloat(item.unit_price||0).toFixed(2)).padEnd(26,'\\u00A0'),\"\\n                \").concat((item.quantity_display||item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                \").concat(parseFloat(item.total_price||0).toFixed(2).padStart(12,'\\u00A0'),\" MGA\\n              </span>\\n            </div>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n\\n      </div>      \\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"receipt-row\\\">\\n          <span>Subtotal:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-footer\\\">\\n        <div class=\\\"thank-you\\\">Thank you!</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Created by: \").concat(data.created_by_name||data.sold_by_name||'N/A',\"</div>\\n      </div>\\n    </body>\\n    </html>\\n  \");};/**\n * Generate mobile-optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Mobile-optimized HTML content\n */export const generateMobilePrintContent=(data,title,type,t)=>{const isMobile=isMobileDevice();const printerType=detectPrinterType();// Use smaller dimensions for mobile\nconst width=isMobile?'58mm':'80mm';const fontSize=isMobile?'10px':'12px';const maxChars=isMobile?24:32;return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n      <style>\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: \").concat(fontSize,\";\\n          line-height: 1.2;\\n          color: #000;\\n          width: \").concat(width,\";\\n          max-width: \").concat(width,\";\\n          margin: 0 auto;\\n          padding: 2mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'12px':'14px',\";\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'11px':'13px',\";\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 1px 3px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n        }\\n        \\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n          max-width: \").concat(maxChars-10,\"ch;\\n        }\\n        \\n        .item-details {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: \").concat(isMobile?'8px':'10px',\";\\n          color: #555;\\n        }\\n        \\n        .receipt-totals {\\n          margin: 6px 0;\\n          padding-top: 4px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 8px;\\n          padding-top: 4px;\\n          border-top: 1px dashed #000;\\n          font-size: \").concat(isMobile?'8px':'10px',\";\\n          color: #666;\\n        }\\n        \\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 1mm;\\n            width: \").concat(width,\";\\n          }\\n          \\n          @page {\\n            size: \").concat(width,\" auto;\\n            margin: 0;\\n          }\\n        }\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">________ANTATSIMO_______</div>\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"document-title\\\" style=\\\"text-align: center;\\\">SALE RECEIPT</div>\\n        <div class=\\\"receipt-date\\\" style=\\\"text-align: center;\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"section-title\\\">SALE INFO</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale No:</span>\\n          <span>\").concat(data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale Status:</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Customer:</span>\\n          <span>\").concat((data.customer_name||'Walk-in Customer').substring(0,25),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Phone:</span>\\n            <span>\".concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Peyment Status:</span>\\n          <span>\").concat(data.payment_status,\"</span>\\n        </div>\\n\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"no-data\\\">==================================================</div>\\n\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">ITEMS SOLD</div>             \\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"item-details\\\">\\n          <span>Info</span>\\n          <span>\\n            Qte\").concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n          </span>\\n        </div>\\n        <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div> \\n        \").concat(data.items&&Array.isArray(data.items)?data.items.map(item=>\"\\n          <div class=\\\"sale-item\\\">\\n            <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n            <div class=\\\"item-details\\\">\\n              <span>\\n                \").concat(\"(\".concat(item.unit_name,\")\").concat(parseFloat(item.unit_price||0).toFixed(2)).padEnd(26,'\\u00A0'),\"\\n                \").concat((item.quantity_display||item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                \").concat(parseFloat(item.total_price||0).toFixed(2).padStart(12,'\\u00A0'),\" MGA\\n              </span>\\n            </div>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n\\n      </div>        \\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"receipt-row\\\">\\n          <span>Subtotal:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-footer\\\">\\n        <div class=\\\"thank-you\\\">Thank you!</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Created by: \").concat(data.created_by_name||data.sold_by_name||'N/A',\"</div>\\n      </div>\\n    </body>\\n    </html>\\n  \");};// Helper functions for generating print content optimized for 80mm thermal printers\nconst generateInventoryContent=(data,t)=>{// Handle different data structures\nlet products=[];let summary={};let filterType=data.filter_type||'';let reportName=data.report_name||'INVENTORY REPORT';if(Array.isArray(data)){products=data;}else if(data.products&&Array.isArray(data.products)){products=data.products;summary=data.summary||{};}else if(data.results&&Array.isArray(data.results)){products=data.results;}else if(data.data&&Array.isArray(data.data)){products=data.data;}else if(data.items&&Array.isArray(data.items)){products=data.items;}else{const numberedKeys=Object.keys(data).filter(key=>/^\\d+$/.test(key));if(numberedKeys.length>0){products=numberedKeys.map(key=>data[key]).filter(item=>item&&typeof item==='object');}}// Filter products based on filter_type\nif(filterType==='low_stock'){products=products.filter(p=>p.is_low_stock);reportName='LOW STOCK REPORT';}else if(filterType==='out_of_stock'){products=products.filter(p=>p.is_out_of_stock);reportName='OUT OF STOCK REPORT';}const totalValue=summary.total_value||products.reduce((sum,p)=>sum+parseFloat(p.stock_value||0),0);const lowStockCount=summary.low_stock_count||products.filter(p=>p.is_low_stock).length;const outOfStockCount=summary.out_of_stock_count||products.filter(p=>p.is_out_of_stock).length;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">\").concat(reportName,\"</div>\\n      <div class=\\\"receipt-date\\\">\").concat(data.generated_at?new Date(data.generated_at).toLocaleDateString():new Date().toLocaleDateString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">SUMMARY</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Products:</span>\\n        <span>\").concat(products.length,\"</span>\\n      </div>\\n      \").concat(summary.total_value!==undefined?\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Total Value:</span>\\n          <span>\".concat(parseFloat(totalValue).toFixed(2),\" MGA</span>\\n        </div>\\n      \"):'',\"\\n      \").concat(!filterType?\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Low Stock:</span>\\n          <span style=\\\"color: #f59e0b\\\">\".concat(lowStockCount,\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Out of Stock:</span>\\n          <span style=\\\"color: #dc2626\\\">\").concat(outOfStockCount,\"</span>\\n        </div>\\n      \"):'',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">PRODUCTS (\").concat(products.length,\")</div>\\n      \").concat(products.length>0?products.slice(0,30).map((item,index)=>{const stockQty=parseFloat(item.stock_quantity||0);const minLevel=parseFloat(item.min_stock_level||0);const unitSymbol=item.base_unit_symbol||item.base_unit_name||'pcs';const statusColor=item.is_out_of_stock?'#dc2626':item.is_low_stock?'#f59e0b':'#10b981';const statusText=item.is_out_of_stock?'OUT':item.is_low_stock?'LOW':'OK';return\"\\n          <div class=\\\"product-item\\\" style=\\\"margin-bottom: 4px; padding: 2px 0; border-bottom: 1px dotted #ccc;\\\">\\n            <div class=\\\"product-name\\\" style=\\\"font-weight: bold; margin-bottom: 2px;\\\">\\n              \".concat(index+1,\". \").concat((item.name||'N/A').substring(0,22),\"\\n            </div>\\n            <div class=\\\"product-details\\\" style=\\\"font-size: 9px; display: flex; justify-content: space-between; flex-wrap: wrap; margin-bottom: 1px;\\\">\\n              <span>SKU: \").concat((item.sku||'N/A').substring(0,10),\"</span>\\n              <span>Cat: \").concat((item.category||'N/A').substring(0,8),\"</span>\\n              \").concat(item.storage_section?\"<span>Loc: \".concat(item.storage_section,\"</span>\"):'',\"\\n            </div>\\n            <div class=\\\"product-details\\\" style=\\\"font-size: 9px; display: flex; justify-content: space-between; margin-top: 1px;\\\">\\n              <span>Stock: \").concat(stockQty.toFixed(2),\" \").concat(unitSymbol,\"</span>\\n              <span>Min: \").concat(minLevel.toFixed(2),\"</span>\\n              <span style=\\\"color: \").concat(statusColor,\"; font-weight: bold\\\">\").concat(statusText,\"</span>\\n            </div>\\n            <div class=\\\"product-details\\\" style=\\\"font-size: 9px; display: flex; justify-content: space-between; margin-top: 1px;\\\">\\n              <span>Cost: \").concat(parseFloat(item.cost_price||0).toFixed(2),\" MGA</span>\\n              <span>Value: \").concat(parseFloat(item.stock_value||0).toFixed(2),\" MGA</span>\\n            </div>\\n          </div>\\n        \");}).join(''):'<div class=\"no-data\">No products found</div>',\"\\n      \").concat(products.length>30?\"\\n        <div class=\\\"truncated-warning\\\">... and \".concat(products.length-30,\" more products</div>\\n      \"):'',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Report generated by: \").concat(data.user_name||'System',\"</div>\\n      <div class=\\\"footer-text\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n  \");};const generatePurchaseOrderContent=(data,t)=>{var _data$supplier;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">PURCHASE ORDER</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">ORDER INFO</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Order No:</span>\\n        <span>\").concat(data.order_number||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Supplier:</span>\\n        <span>\").concat((((_data$supplier=data.supplier)===null||_data$supplier===void 0?void 0:_data$supplier.name)||'N/A').substring(0,25),\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Date:</span>\\n        <span>\").concat(data.order_date?new Date(data.order_date).toLocaleDateString():'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Status:</span>\\n        <span>\").concat(data.status||'N/A',\"</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">ITEMS</div>\\n      \").concat(data.items?data.items.map(item=>{var _item$product;return\"\\n        <div class=\\\"order-item\\\">\\n          <div class=\\\"item-name\\\">\".concat((((_item$product=item.product)===null||_item$product===void 0?void 0:_item$product.name)||'N/A').substring(0,25),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity_ordered||0,\" x \").concat(parseFloat(item.unit_cost||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat((item.quantity_ordered||0)*(item.unit_cost||0)).toFixed(2),\" MGA</span>\\n          </div>\\n        </div>\\n      \");}).join(''):'<div class=\"no-data\">No items found</div>',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-total\\\">\\n      <div class=\\\"total-row\\\">\\n        <span>TOTAL AMOUNT:</span>\\n        <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">End of Purchase Order</div>\\n    </div>\\n  \");};const generateDeliveryContent=(data,t)=>{var _data$purchase_order;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">DELIVERY RECEIPT</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">DELIVERY INFO</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Delivery No:</span>\\n        <span>\").concat(data.delivery_number||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>PO Number:</span>\\n        <span>\").concat(((_data$purchase_order=data.purchase_order)===null||_data$purchase_order===void 0?void 0:_data$purchase_order.order_number)||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Date:</span>\\n        <span>\").concat(data.delivery_date?new Date(data.delivery_date).toLocaleDateString():'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Status:</span>\\n        <span>\").concat(data.status||'N/A',\"</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">ITEMS RECEIVED</div>\\n      \").concat(data.items?data.items.map(item=>{var _item$product2;return\"\\n        <div class=\\\"delivery-item\\\">\\n          <div class=\\\"item-name\\\">\".concat((item.product_name||((_item$product2=item.product)===null||_item$product2===void 0?void 0:_item$product2.name)||'N/A').substring(0,25),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity_received||item.delivered_quantity||0,\" x \").concat(parseFloat(item.unit_cost||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat((item.quantity_received||item.delivered_quantity||0)*(item.unit_cost||0)).toFixed(2),\" MGA</span>\\n          </div>\\n        </div>\\n      \");}).join(''):'<div class=\"no-data\">No items found</div>',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-total\\\">\\n      <div class=\\\"total-row\\\">\\n        <span>TOTAL AMOUNT:</span>\\n        <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Delivery completed</div>\\n    </div>\\n  \");};const generateSaleContent=(data,t)=>{let items=data.items;if(!items){const numberedKeys=Object.keys(data).filter(key=>/^\\d+$/.test(key));if(numberedKeys.length>0){items=numberedKeys.map(key=>data[key]).filter(item=>item&&typeof item==='object');}}const paymentStatusText=data.payment_status==='paid'?'PAID':data.payment_status==='partial'?'PARTIAL':data.payment_status==='pending'?'PENDING':'UNKNOWN';console.log(data);return\"\\n    <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">________ANTATSIMO_______</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"no-data\\\">\".concat('\\u00A0',\"</div>\\n        <div class=\\\"section-title\\\">\",t('print.sale_information'),\"</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>\").concat(t('print.sale_no'),\":</span>\\n          <span>\").concat(data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>\").concat(t('print.sale_status'),\":</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>\").concat(t('sales.customer_name'),\":</span>\\n          <span>\").concat((data.customer_name||t('customer.walk_in')).substring(0,25),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>\".concat(t('sales.customer_phone'),\":</span>\\n            <span>\").concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>\").concat(t('print.peyment_status'),\":</span>\\n          <span>\").concat(paymentStatusText,\"</span>\\n        </div>\\n\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">\").concat(t('print.item_sold'),\"</div>    \\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"item-details\\\">\\n          <span>Info</span>\\n          <span>\\n            Qte\").concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n          </span>\\n        </div>\\n      \\n        \").concat(items&&Array.isArray(items)?items.map(item=>\"\\n          <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div>         \\n          <div class=\\\"sale-item\\\">\\n            <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n            <div class=\\\"item-details\\\">\\n              <span>\\n                \").concat(\"(\".concat(item.unit_name,\")\").concat(parseFloat(item.unit_price||0).toFixed(2)).padEnd(26,'\\u00A0'),\"\\n                \").concat((item.quantity_display||item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                \").concat(parseFloat(item.total_price||0).toFixed(2).padStart(12,'\\u00A0'),\" MGA\\n              </span>\\n            </div>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n      </div>\\n      \").concat(data.packaging_items&&data.packaging_items.length>0?\"\\n        <div class=\\\"receipt-section\\\">\\n          <div class=\\\"section-title\\\">\".concat(t('print.packagings'),\"</div>    \\n          <div class=\\\"no-data\\\">__________________________________________________</div>\\n          <div class=\\\"item-details\\\">\\n            <span>Info</span>\\n            <span>\\n              Qte\").concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n            </span>\\n          </div>\\n        \\n          \").concat(data.packaging_items.map(item=>{let unitPriceDisplay,totalPriceDisplay;if(item.status==='consignation'){unitPriceDisplay=\"\".concat(parseFloat(item.unit_price||0).toFixed(2));totalPriceDisplay=\"\".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\");}else if(item.status==='exchange'){unitPriceDisplay='0.00';totalPriceDisplay='0.00 MGA';}else if(item.status==='due'){unitPriceDisplay='DUE';totalPriceDisplay='DUE';}else{unitPriceDisplay=\"\".concat(parseFloat(item.unit_price||0).toFixed(2));totalPriceDisplay=\"\".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\");}return\"\\n            <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div>         \\n            <div class=\\\"packaging-item\\\">\\n              <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n              <div class=\\\"item-details\\\">\\n                <span>\\n                  \").concat(unitPriceDisplay.padEnd(26,'\\u00A0'),\"\\n                  \").concat((item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                  \").concat(totalPriceDisplay.padStart(12,'\\u00A0'),\"\\n                </span>\\n              </div>\\n            </div>\\n          \");}).join(''),\"\\n\\n          <div class=\\\"no-data\\\">__________________________________________________</div>\\n        </div>\\n      \"):'',\"\\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"receipt-row\\\">\\n          <span>Subtotal:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.packaging_total&&data.packaging_total>0?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Packagings:</span>\\n            <span>\".concat(parseFloat(data.packaging_total||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Total:</span>\\n          <span>\").concat(parseFloat(data.grand_total||data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-footer\\\">\\n        <div class=\\\"thank-you\\\">\").concat(t('print.thankings'),\"</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">\").concat(t('common.created_by'),\": \").concat(data.created_by_name||data.sold_by_name||data.user_name||'N/A',\" -- \").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n        <div class=\\\"terms\\\">\").concat(t('messages.terms_of_sales'),\"</div>\\n      </div>\\n  \");};const generateSalesHistoryContent=(data,t)=>{let sales=data;if(!Array.isArray(data)){if(data.results&&Array.isArray(data.results)){sales=data.results;}else if(data.data&&Array.isArray(data.data)){sales=data.data;}else if(data.items&&Array.isArray(data.items)){sales=data.items;}else{const numberedKeys=Object.keys(data).filter(key=>/^\\d+$/.test(key));if(numberedKeys.length>0){sales=numberedKeys.map(key=>data[key]).filter(item=>item&&typeof item==='object');}else{sales=[];}}}const totalRevenue=Array.isArray(sales)?sales.reduce((sum,sale)=>sum+parseFloat(sale.total_amount||0),0):0;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">SALES REPORT</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">SUMMARY</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Sales:</span>\\n        <span>\").concat(Array.isArray(sales)?sales.length:0,\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Revenue:</span>\\n        <span>\").concat(totalRevenue.toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">RECENT SALES</div>\\n      \").concat(Array.isArray(sales)?sales.map(sale=>\"\\n        <div class=\\\"sale-summary\\\">\\n          <div class=\\\"sale-info\\\">\\n            <span>\".concat(sale.sale_number||'N/A',\"</span>\\n            <span>\").concat(parseFloat(sale.total_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n          <div class=\\\"sale-details\\\">\\n            <span>\").concat((sale.customer_name||t('customer.walk_in','Walk-in')).substring(0,15),\"</span>\\n            <span>\").concat(sale.created_at?new Date(sale.created_at).toLocaleDateString():'N/A',\"</span>\\n          </div>\\n        </div>\\n      \")).join(''):'<div class=\"no-data\">No sales data</div>',\"\\n      \").concat(Array.isArray(sales)&&sales.length>20?\"\\n        <div class=\\\"truncated-warning\\\">... and \".concat(sales.length-20,\" more sales</div>\\n      \"):'',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Sales report generated</div>\\n    </div>\\n  \");};const generateSalesReportContent=(data,t)=>{const summary=data.summary||{};const chartData=data.chart_data||[];const details=data.details||[];const topProducts=data.top_products||[];const dateRange=data.date_range||{};const totalRevenue=parseFloat(summary.total_sales||0);const totalCost=parseFloat(summary.total_cost||0);const profit=parseFloat(summary.profit||0);const profitMargin=parseFloat(summary.profit_margin||0);const totalTransactions=summary.total_count||0;const totalItems=summary.total_items||0;const avgSale=totalTransactions>0?totalRevenue/totalTransactions:0;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">SALES REPORT</div>\\n      <div class=\\\"receipt-date\\\">\").concat(data.generated_at?new Date(data.generated_at).toLocaleDateString():new Date().toLocaleDateString(),\"</div>\\n      \").concat(dateRange.start_date&&dateRange.end_date?\"\\n        <div class=\\\"receipt-date\\\" style=\\\"font-size: 10px; margin-top: 2px;\\\">\\n          \".concat(new Date(dateRange.start_date).toLocaleDateString(),\" - \").concat(new Date(dateRange.end_date).toLocaleDateString(),\"\\n        </div>\\n      \"):'',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">FINANCIAL SUMMARY</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Revenue:</span>\\n        <span>\").concat(totalRevenue.toFixed(2),\" MGA</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Cost:</span>\\n        <span>\").concat(totalCost.toFixed(2),\" MGA</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\" style=\\\"font-weight: bold; border-top: 1px solid #000; padding-top: 3px; margin-top: 3px;\\\">\\n        <span>Profit:</span>\\n        <span style=\\\"color: \").concat(profit>=0?'#090':'#d00',\"\\\">\").concat(profit.toFixed(2),\" MGA</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Profit Margin:</span>\\n        <span style=\\\"color: \").concat(profitMargin>=0?'#090':'#d00',\"\\\">\").concat(profitMargin.toFixed(2),\"%</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">SALES SUMMARY</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Transactions:</span>\\n        <span>\").concat(totalTransactions,\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Items Sold:</span>\\n        <span>\").concat(totalItems,\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Average Sale:</span>\\n        <span>\").concat(avgSale.toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    \").concat(chartData.length>0?\"\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">DAILY BREAKDOWN</div>\\n        \".concat(chartData.slice(0,10).map(day=>{const dayProfit=(day.total||0)-(day.cost||0);return\"\\n            <div class=\\\"sale-summary\\\" style=\\\"margin-bottom: 4px; padding: 2px 0; border-bottom: 1px dotted #ccc;\\\">\\n              <div class=\\\"sale-info\\\" style=\\\"font-weight: bold; margin-bottom: 2px;\\\">\\n                <span>\".concat(day.date,\"</span>\\n              </div>\\n              <div class=\\\"sale-details\\\" style=\\\"font-size: 9px; display: flex; justify-content: space-between;\\\">\\n                <span>Rev: \").concat(parseFloat(day.total||0).toFixed(2),\" MGA</span>\\n                <span>Cost: \").concat(parseFloat(day.cost||0).toFixed(2),\" MGA</span>\\n                <span style=\\\"color: \").concat(dayProfit>=0?'#090':'#d00',\"\\\">Profit: \").concat(dayProfit.toFixed(2),\" MGA</span>\\n              </div>\\n            </div>\\n          \");}).join(''),\"\\n        \").concat(chartData.length>10?\"\\n          <div class=\\\"truncated-warning\\\">... and \".concat(chartData.length-10,\" more days</div>\\n        \"):'',\"\\n      </div>\\n    \"):'',\"\\n    \\n    \").concat(topProducts.length>0?\"\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">TOP PRODUCTS (\".concat(topProducts.length,\")</div>\\n        \").concat(topProducts.map((product,index)=>{const productProfit=parseFloat(product.profit||0);return\"\\n            <div class=\\\"sale-summary\\\" style=\\\"margin-bottom: 4px; padding: 2px 0; border-bottom: 1px dotted #ccc;\\\">\\n              <div class=\\\"sale-info\\\" style=\\\"font-weight: bold; margin-bottom: 2px;\\\">\\n                <span>\".concat(index+1,\". \").concat((product.product__name||'N/A').substring(0,20),\"</span>\\n              </div>\\n              <div class=\\\"sale-details\\\" style=\\\"font-size: 9px; display: flex; justify-content: space-between; flex-wrap: wrap;\\\">\\n                <span>SKU: \").concat(product.product__sku||'N/A',\"</span>\\n                <span>Qty: \").concat(product.total_sold||0,\" \").concat(product.unit_symbol||'pcs',\"</span>\\n              </div>\\n              <div class=\\\"sale-details\\\" style=\\\"font-size: 9px; display: flex; justify-content: space-between; margin-top: 1px;\\\">\\n                <span>Rev: \").concat(parseFloat(product.total_revenue||0).toFixed(2),\" MGA</span>\\n                <span>Cost: \").concat(parseFloat(product.total_cost||0).toFixed(2),\" MGA</span>\\n                <span style=\\\"color: \").concat(productProfit>=0?'#090':'#d00',\"\\\">Profit: \").concat(productProfit.toFixed(2),\" MGA</span>\\n                <span style=\\\"color: \").concat(productProfit>=0?'#090':'#d00',\"\\\">\").concat(parseFloat(product.profit_margin||0).toFixed(1),\"%</span>\\n              </div>\\n            </div>\\n          \");}).join(''),\"\\n      </div>\\n    \"):'',\"\\n    \\n    \").concat(details.length>0?\"\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">RECENT SALES (\".concat(Math.min(details.length,5),\" of \").concat(details.length,\")</div>\\n        \").concat(details.slice(0,5).map(sale=>\"\\n          <div class=\\\"sale-summary\\\" style=\\\"margin-bottom: 3px; padding: 2px 0;\\\">\\n            <div class=\\\"sale-info\\\">\\n              <span>\".concat(sale.sale_number||'N/A',\"</span>\\n              <span>\").concat(parseFloat(sale.total_amount||0).toFixed(2),\" MGA</span>\\n            </div>\\n            <div class=\\\"sale-details\\\" style=\\\"font-size: 9px;\\\">\\n              <span>\").concat((sale.customer_name||t('customer.walk_in','Walk-in')).substring(0,20),\"</span>\\n              <span>\").concat(sale.created_at?new Date(sale.created_at).toLocaleDateString():'N/A',\"</span>\\n            </div>\\n          </div>\\n        \")).join(''),\"\\n        \").concat(details.length>5?\"\\n          <div class=\\\"truncated-warning\\\">... and \".concat(details.length-5,\" more sales</div>\\n        \"):'',\"\\n      </div>\\n    \"):'',\"\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Report generated by: \").concat(data.user_name||'System',\"</div>\\n      <div class=\\\"footer-text\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n  \");};const generatePackagingValidationContent=(data,t)=>{return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">PACKAGING VALIDATION</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">VALIDATION INFO</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Sale No:</span>\\n        <span>\").concat(data.sale_number||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Status:</span>\\n        <span>\").concat(data.status||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Customer:</span>\\n        <span>\").concat((data.customer_name||t('customer.walk_in','Walk-in Customer')).substring(0,25),\"</span>\\n      </div>\\n      \").concat(data.customer_phone?\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Phone:</span>\\n          <span>\".concat(data.customer_phone,\"</span>\\n        </div>\\n      \"):'',\"\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Items:</span>\\n        <span>\").concat(data.packaging_items?data.packaging_items.length:0,\"</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">PACKAGING ITEMS</div>\\n      \").concat(data.packaging_items&&Array.isArray(data.packaging_items)?data.packaging_items.map(item=>\"\\n        <div class=\\\"packaging-item\\\">\\n          <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity||0,\" x \").concat(parseFloat(item.unit_price||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat(item.total_price||0).toFixed(2),\" MGA</span>\\n            <span class=\\\"status-\").concat(item.status,\"\\\">\").concat(item.status==='consignation'?'PAID':item.status==='exchange'?'EXCH':item.status==='due'?'DUE':item.status,\"</span>\\n          </div>\\n        </div>\\n      \")).join(''):'<div class=\"no-data\">No packaging items</div>',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-total\\\">\\n      <div class=\\\"total-row\\\">\\n        <span>PACKAGING TOTAL:</span>\\n        <span>\").concat(parseFloat(data.packaging_total||0).toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Packaging validation completed</div>\\n    </div>\\n  \");};const generateDefaultContent=(data,t)=>{return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">DOCUMENT</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">CONTENT</div>\\n      <div class=\\\"default-content\\\">\\n        Document generated successfully\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Document printed</div>\\n    </div>\\n  \");};// Export the generatePrintContent function\nexport const generatePrintContent=(data,title,type,t)=>{const currentDate=new Date().toLocaleDateString();const currentTime=new Date().toLocaleTimeString();let content=\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <style>\\n        /* 80mm Thermal Printer Receipt Styles */\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: 12px;\\n          line-height: 1.2;\\n          color: #000;\\n          width: 80mm;\\n          max-width: 80mm;\\n          margin: 0 auto;\\n          padding: 3mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 8px;\\n          padding-bottom: 6px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: 14px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: 13px;\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: 11px;\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 8px;\\n          padding-bottom: 6px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: 11px;\\n          margin-bottom: 4px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 2px 4px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 3px;\\n          font-size: 11px;\\n        }\\n        \\n        .product-item,\\n        .order-item,\\n        .delivery-item,\\n        .sale-item,\\n        .packaging-item,\\n        .sale-summary {\\n          margin-bottom: 4px;\\n          padding: 2px 0;\\n        }\\n        \\n        .product-name,\\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n        }\\n        \\n        .product-details,\\n        .item-details,\\n        .sale-info {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: 10px;\\n          color: #555;\\n        }\\n        \\n        .receipt-totals,\\n        .receipt-total {\\n          margin: 8px 0;\\n          padding-top: 6px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 3px;\\n          font-weight: bold;\\n        }\\n        \\n        .due-amount {\\n          color: #d00;\\n        }\\n        \\n        .no-data {\\n          text-align: center;\\n          color: #888;\\n          font-style: italic;\\n          padding: 8px 0;\\n        }\\n        \\n        .truncated-warning {\\n          text-align: center;\\n          color: #888;\\n          font-size: 10px;\\n          font-style: italic;\\n          margin-top: 4px;\\n        }\\n        \\n        .thank-you {\\n          text-align: center;\\n          font-weight: bold;\\n          margin: 6px 0;\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 10px;\\n          padding-top: 6px;\\n          border-top: 1px dashed #000;\\n          font-size: 10px;\\n          color: #666;\\n        }\\n        \\n        .footer-text {\\n          margin-bottom: 2px;\\n        }\\n        \\n        .status-consignation { color: #090; }\\n        .status-exchange { color: #009; }\\n        .status-due { color: #d00; font-weight: bold; }\\n        \\n        /* Print-specific styles */\\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 2mm;\\n            width: 80mm;\\n          }\\n          \\n          .no-print {\\n            display: none;\\n          }\\n          \\n          /* Ensure proper sizing for thermal paper */\\n          @page {\\n            size: 80mm auto;\\n            margin: 0;\\n          }\\n        }\\n        \\n        /* Force monospace and proper breaking */\\n        * {\\n          font-family: 'Courier New', Courier, monospace !important;\\n        }\\n        \\n        .default-content {\\n          text-align: center;\\n          padding: 10px 0;\\n          color: #666;\\n        }\\n      </style>\\n    </head>\\n    <body>\\n  \");// Add type-specific content\nswitch(type){case'inventory':case'inventory_report':content+=generateInventoryContent(data,t);break;case'purchase_order':content+=generatePurchaseOrderContent(data,t);break;case'delivery':content+=generateDeliveryContent(data,t);break;case'sale':content+=generateSaleContent(data,t);break;case'sales_history':content+=generateSalesHistoryContent(data,t);break;case'sales_report':content+=generateSalesReportContent(data,t);break;case'packaging_validation':content+=generatePackagingValidationContent(data,t);break;default:content+=generateDefaultContent(data,t);}content+=\"\\n    </body>\\n    </html>\\n  \";return content;};","map":{"version":3,"names":["ESC_POS_COMMANDS","INITIALIZE","CENTER","LEFT_ALIGN","RIGHT_ALIGN","BOLD_ON","BOLD_OFF","DOUBLE_HEIGHT","NORMAL_SIZE","CUT_PAPER","FEED_LINE","FEED_LINES","n","concat","String","fromCharCode","UNDERLINE_ON","UNDERLINE_OFF","REVERSE_ON","REVERSE_OFF","XPRINTER_INIT","XPRINTER_CUT","XPRINTER_FEED","XPRINTER_BEEP","PRINTER_CONFIGS","THERMAL_80MM","width","maxChars","fontSize","lineHeight","margins","THERMAL_58MM","STANDARD_A4","generateThermalPrinterCSS","printerType","arguments","length","undefined","config","generateESCPOSCommands","data","title","commands","repeat","Date","toLocaleDateString","toLocaleTimeString","sale_number","customer_name","customer_phone","items","Array","isArray","forEach","item","product_name","quantity","unit_name","parseFloat","unit_price","toFixed","total_price","packaging_items","status","total_amount","packaging_total","paid_amount","remaining_amount","user_name","detectPrinterType","window","userAgent","navigator","toLowerCase","includes","isMobile","test","innerWidth","maxTouchPoints","supportsModernPrinting","share","print","matchMedia","isMobileDevice","formatForThermalPrinter","text","maxLength","cleanText","replace","substring","createThermalPrintDocument","type","t","detectedType","css","escPosCommands","generateESCPOSForReceiptApp","console","error","quantity_display","createReceiptAppFile","simpleT","key","fallback","htmlContent","generateXprinterPrintContent","toISOString","generatePDFContent","toUpperCase","payment_status","map","join","created_by_name","sold_by_name","downloadReceiptFile","pdfContent","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","now","style","display","body","appendChild","click","removeChild","revokeObjectURL","mobilePrint","printContent","file","File","files","shareError","log","tempDiv","innerHTML","position","left","top","originalBody","openPrintWindow","Promise","resolve","windowFeatures","printWindow","open","Error","write","close","focus","showAndPrint","setTimeout","closed","confirm","printError","readyState","onload","openPrintWindow_","iframe","right","bottom","height","border","opacity","pointerEvents","iframeDoc","contentDocument","contentWindow","iframeWindow","contains","openPrintPreview","previewWindow","enhancedContent","padEnd","toString","padStart","generateMobilePrintContent","generateInventoryContent","products","summary","filterType","filter_type","reportName","report_name","results","numberedKeys","Object","keys","filter","p","is_low_stock","is_out_of_stock","totalValue","total_value","reduce","sum","stock_value","lowStockCount","low_stock_count","outOfStockCount","out_of_stock_count","generated_at","slice","index","stockQty","stock_quantity","minLevel","min_stock_level","unitSymbol","base_unit_symbol","base_unit_name","statusColor","statusText","name","sku","category","storage_section","cost_price","generatePurchaseOrderContent","_data$supplier","order_number","supplier","order_date","_item$product","product","quantity_ordered","unit_cost","generateDeliveryContent","_data$purchase_order","delivery_number","purchase_order","delivery_date","_item$product2","quantity_received","delivered_quantity","generateSaleContent","paymentStatusText","unitPriceDisplay","totalPriceDisplay","grand_total","generateSalesHistoryContent","sales","totalRevenue","sale","created_at","generateSalesReportContent","chartData","chart_data","details","topProducts","top_products","dateRange","date_range","total_sales","totalCost","total_cost","profit","profitMargin","profit_margin","totalTransactions","total_count","totalItems","total_items","avgSale","start_date","end_date","day","dayProfit","total","cost","date","productProfit","product__name","product__sku","total_sold","unit_symbol","total_revenue","Math","min","generatePackagingValidationContent","generateDefaultContent","generatePrintContent","currentDate","currentTime","content"],"sources":["/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/src/utils/printUtils.js"],"sourcesContent":["/**\n * Print utilities for thermal receipt printer compatibility\n * Supports 80mm and 58mm thermal printers with ESC/POS commands\n */\n\n// ESC/POS Commands for thermal printers (Xprinter 80mm compatible)\nexport const ESC_POS_COMMANDS = {\n  INITIALIZE: '\\x1B\\x40',           // Initialize printer\n  CENTER: '\\x1B\\x61\\x01',          // Center text\n  LEFT_ALIGN: '\\x1B\\x61\\x00',      // Left align text\n  RIGHT_ALIGN: '\\x1B\\x61\\x02',     // Right align text\n  BOLD_ON: '\\x1B\\x45\\x01',         // Bold on\n  BOLD_OFF: '\\x1B\\x45\\x00',        // Bold off\n  DOUBLE_HEIGHT: '\\x1B\\x21\\x10',   // Double height\n  NORMAL_SIZE: '\\x1B\\x21\\x00',     // Normal size\n  CUT_PAPER: '\\x1D\\x56\\x00',       // Cut paper\n  FEED_LINE: '\\x0A',               // Feed line\n  FEED_LINES: (n) => `\\x1B\\x64${String.fromCharCode(n)}`, // Feed n lines\n  UNDERLINE_ON: '\\x1B\\x2D\\x01',    // Underline on\n  UNDERLINE_OFF: '\\x1B\\x2D\\x00',   // Underline off\n  REVERSE_ON: '\\x1D\\x42\\x01',      // Reverse on\n  REVERSE_OFF: '\\x1D\\x42\\x00',     // Reverse off\n  // Xprinter specific commands\n  XPRINTER_INIT: '\\x1B\\x40',       // Xprinter initialization\n  XPRINTER_CUT: '\\x1D\\x56\\x42\\x00', // Xprinter cut paper\n  XPRINTER_FEED: '\\x1B\\x64\\x03',   // Xprinter feed 3 lines\n  XPRINTER_BEEP: '\\x1B\\x42\\x01\\x01', // Xprinter beep\n};\n\n// Printer configurations\nexport const PRINTER_CONFIGS = {\n  THERMAL_80MM: {\n    width: '80mm',\n    maxChars: 32,\n    fontSize: 12,\n    lineHeight: 1.2,\n    margins: '5mm'\n  },\n  THERMAL_58MM: {\n    width: '58mm',\n    maxChars: 24,\n    fontSize: 10,\n    lineHeight: 1.1,\n    margins: '3mm'\n  },\n  STANDARD_A4: {\n    width: '210mm',\n    maxChars: 80,\n    fontSize: 14,\n    lineHeight: 1.4,\n    margins: '20mm'\n  }\n};\n\n/**\n * Generate CSS for thermal printer compatibility\n * @param {string} printerType - Type of printer (THERMAL_80MM, THERMAL_58MM, STANDARD_A4)\n * @returns {string} CSS styles\n */\nexport const generateThermalPrinterCSS = (printerType = 'THERMAL_80MM') => {\n  const config = PRINTER_CONFIGS[printerType];\n  \n  return `\n    @media print {\n      @page {\n        size: ${config.width} auto;\n        margin: ${config.margins};\n      }\n      \n      body { \n        margin: 0; \n        font-size: ${config.fontSize}px;\n        line-height: ${config.lineHeight};\n        font-family: 'Courier New', monospace;\n        max-width: ${config.width};\n      }\n      \n      .header h1 { \n        font-size: ${config.fontSize + 6}px; \n        margin-bottom: 5px;\n        text-align: center;\n      }\n      \n      .header .date, .header .print-info { \n        font-size: ${config.fontSize - 2}px; \n        text-align: center;\n      }\n      \n      .info-section { \n        padding: 8px; \n        margin-bottom: 10px; \n        border: 1px solid #000;\n      }\n      \n      .info-section h3 { \n        font-size: ${config.fontSize + 2}px; \n        margin-bottom: 5px;\n        text-align: center;\n        font-weight: bold;\n      }\n      \n      .info-row { \n        margin-bottom: 3px; \n        font-size: ${config.fontSize - 1}px;\n        display: flex;\n        justify-content: space-between;\n      }\n      \n      table { \n        width: 100%;\n        font-size: ${config.fontSize - 2}px; \n        border-collapse: collapse;\n      }\n      \n      th, td { \n        padding: 2px; \n        font-size: ${config.fontSize - 2}px;\n        border: 1px solid #000;\n        text-align: left;\n      }\n      \n      th { \n        background-color: #f0f0f0;\n        font-weight: bold;\n        text-align: center;\n      }\n      \n      .total-row { \n        font-weight: bold; \n        background-color: #e0e0e0; \n      }\n      \n      .footer { \n        font-size: ${config.fontSize - 3}px; \n        margin-top: 15px; \n        text-align: center;\n        border-top: 1px solid #000;\n        padding-top: 5px;\n      }\n      \n      .thermal-printer-commands {\n        display: block;\n        font-family: monospace;\n        font-size: 8px;\n        color: #666;\n        margin-top: 5px;\n        text-align: center;\n      }\n      \n      /* Hide elements not suitable for thermal printing */\n      .no-print, .print-button, .button, .btn {\n        display: none !important;\n      }\n    }\n  `;\n};\n\n/**\n * Generate ESC/POS commands for thermal printer\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */\nexport const generateESCPOSCommands = (data, title) => {\n  let commands = '';\n  \n  // Initialize printer\n  commands += ESC_POS_COMMANDS.INITIALIZE;\n  \n  // Center and bold title\n  commands += ESC_POS_COMMANDS.CENTER;\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  commands += ESC_POS_COMMANDS.DOUBLE_HEIGHT;\n  commands += title + '\\n';\n  commands += ESC_POS_COMMANDS.NORMAL_SIZE;\n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add separator line\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add document info\n  commands += ESC_POS_COMMANDS.LEFT_ALIGN;\n  commands += `Date: ${new Date().toLocaleDateString()}\\n`;\n  commands += `Time: ${new Date().toLocaleTimeString()}\\n`;\n  // commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add content based on type\n  if (data.sale_number) {\n    commands += `Sale: ${data.sale_number}\\n`;\n  }\n  if (data.customer_name) {\n    commands += `Customer: ${data.customer_name}\\n`;\n  }\n  if (data.customer_phone) {\n    commands += `Phone: ${data.customer_phone}\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '-'.repeat(32) + '\\n';\n  \n  // Add items if present\n  if (data.items && Array.isArray(data.items)) {\n    commands += ESC_POS_COMMANDS.BOLD_ON;\n    commands += 'ITEMS:\\n';\n    commands += ESC_POS_COMMANDS.BOLD_OFF;\n    \n    data.items.forEach(item => {\n      commands += `${item.product_name || 'N/A'}\\n`;\n      commands += `  Qty: ${item.quantity || 0} ${item.unit_name || 'pcs'}\\n`;\n      commands += `  Price: ${parseFloat(item.unit_price || 0).toFixed(2)} MGA\\n`;\n      commands += `  Total: ${parseFloat(item.total_price || 0).toFixed(2)} MGA\\n`;\n      commands += '\\n';\n    });\n  }\n  \n  // Add packaging items if present\n  if (data.packaging_items && Array.isArray(data.packaging_items)) {\n    commands += ESC_POS_COMMANDS.BOLD_ON;\n    commands += 'PACKAGING:\\n';\n    commands += ESC_POS_COMMANDS.BOLD_OFF;\n    \n    data.packaging_items.forEach(item => {\n      commands += `${item.product_name || 'N/A'}\\n`;\n      commands += `  Qty: ${item.quantity || 0} ${item.unit_name || 'pcs'}\\n`;\n      commands += `  Price: ${parseFloat(item.unit_price || 0).toFixed(2)} MGA\\n`;\n      commands += `  Total: ${parseFloat(item.total_price || 0).toFixed(2)} MGA\\n`;\n      commands += `  Status: ${item.status || 'N/A'}\\n`;\n      commands += '\\n';\n    });\n  }\n  \n  // Add totals\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  \n  if (data.total_amount) {\n    commands += `TOTAL: ${parseFloat(data.total_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.packaging_total) {\n    commands += `PACKAGING: ${parseFloat(data.packaging_total).toFixed(2)} MGA\\n`;\n  }\n  if (data.paid_amount) {\n    commands += `PAID: ${parseFloat(data.paid_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.remaining_amount) {\n    commands += `REMAINING: ${parseFloat(data.remaining_amount).toFixed(2)} MGA\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += '='.repeat(32) + '\\n';\n  \n  // Add footer\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += 'Generated by ______ANTATSIMO______ System\\n';\n  commands += `User: ${data.user_name || 'System'}\\n`;\n  // commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  \n  // Feed lines and cut paper\n  commands += ESC_POS_COMMANDS.FEED_LINES(3);\n  commands += ESC_POS_COMMANDS.CUT_PAPER;\n  \n  return commands;\n};\n\n/**\n * Detect printer type based on user agent or settings\n * @returns {string} Printer type\n */\nexport const detectPrinterType = () => {\n  // Check if running in a thermal printer environment\n  if (typeof window !== 'undefined') {\n    const userAgent = window.navigator.userAgent.toLowerCase();\n    \n    // Check for Xprinter specific indicators\n    if (userAgent.includes('xprinter') || userAgent.includes('thermal') || userAgent.includes('receipt')) {\n      return 'THERMAL_80MM'; // Xprinter 80mm\n    }\n    \n    // Enhanced mobile detection\n    const isMobile = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent) ||\n                     (window.innerWidth <= 768) ||\n                     ('ontouchstart' in window) ||\n                     (navigator.maxTouchPoints > 0);\n    \n    // For mobile devices, still use 80mm for Xprinter compatibility\n    if (isMobile) {\n      return 'THERMAL_80MM'; // Force 80mm for Xprinter compatibility\n    }\n  }\n  \n  // Default to 80mm thermal printer (Xprinter standard)\n  return 'THERMAL_80MM';\n};\n\n/**\n * Check if device supports modern printing APIs\n * @returns {boolean} True if modern printing is supported\n */\nexport const supportsModernPrinting = () => {\n  if (typeof window === 'undefined') return false;\n  \n  // Check for modern printing APIs\n  return !!(window.navigator && (\n    window.navigator.share ||\n    window.print ||\n    (window.matchMedia && window.matchMedia('print'))\n  ));\n};\n\n/**\n * Check if device is mobile\n * @returns {boolean} True if mobile device\n */\nexport const isMobileDevice = () => {\n  if (typeof window === 'undefined') return false;\n  \n  const userAgent = window.navigator.userAgent.toLowerCase();\n  return /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent) ||\n         (window.innerWidth <= 768) ||\n         ('ontouchstart' in window) ||\n         (navigator.maxTouchPoints > 0);\n};\n\n/**\n * Format text for thermal printer (truncate if too long)\n * @param {string} text - Text to format\n * @param {number} maxLength - Maximum length\n * @returns {string} Formatted text\n */\nexport const formatForThermalPrinter = (text, maxLength = 32) => {\n  if (!text) return '';\n  \n  // Remove HTML tags\n  const cleanText = text.replace(/<[^>]*>/g, '');\n  \n  // Truncate if too long\n  if (cleanText.length > maxLength) {\n    return cleanText.substring(0, maxLength - 3) + '...';\n  }\n  \n  return cleanText;\n};\n\n/**\n * Create a print-ready document with thermal printer compatibility\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @param {string} printerType - Printer type\n * @returns {string} HTML content\n */\nexport const createThermalPrintDocument = (data, title, type, t, printerType = null) => {\n  const detectedType = printerType || detectPrinterType();\n  const css = generateThermalPrinterCSS(detectedType);\n  const escPosCommands = generateESCPOSCommands(data, title);\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"utf-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n      <style>\n        ${css}\n      </style>\n    </head>\n    <body>\n      <div class=\"header\">\n        <h1>${formatForThermalPrinter(title, 32)}</h1>\n        <div class=\"date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n      </div>\n      \n      <div class=\"thermal-printer-commands\">\n        <pre>${escPosCommands}</pre>\n      </div>\n      \n      <div class=\"footer\">\n        <p>______ANTATSIMO______ System</p>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n/**\n * Generate ESC/POS commands for direct printer communication\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */\nexport const generateESCPOSForReceiptApp = (data, title) => {\n  try {\n    // Validate inputs\n    if (!data || !title) {\n      console.error('Invalid data or title provided to generateESCPOSForReceiptApp');\n      return '';\n    }\n    \n    let commands = '';\n    \n    // Initialize printer\n    commands += ESC_POS_COMMANDS.XPRINTER_INIT;\n  \n  // Center and bold title\n  commands += ESC_POS_COMMANDS.CENTER;\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  commands += ESC_POS_COMMANDS.DOUBLE_HEIGHT;\n  commands += title + '\\n';\n  commands += ESC_POS_COMMANDS.NORMAL_SIZE;\n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add separator line\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add document info\n  commands += ESC_POS_COMMANDS.LEFT_ALIGN;\n  commands += `Date: ${new Date().toLocaleDateString()}\\n`;\n  commands += `Time: ${new Date().toLocaleTimeString()}\\n`;\n  // commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add sale info\n  if (data.sale_number) {\n    commands += `Sale: ${data.sale_number}\\n`;\n  }\n  if (data.customer_name) {\n    commands += `Customer: ${data.customer_name}\\n`;\n  }\n  if (data.customer_phone) {\n    commands += `Phone: ${data.customer_phone}\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '-'.repeat(32) + '\\n';\n  \n  // Add items\n  if (data.items && Array.isArray(data.items)) {\n    commands += ESC_POS_COMMANDS.BOLD_ON;\n    commands += 'ITEMS:\\n';\n    commands += ESC_POS_COMMANDS.BOLD_OFF;\n    \n    data.items.forEach(item => {\n      commands += `${(item.product_name || 'N/A').substring(0, 25)}\\n`;\n      commands += `  Qty: ${item.quantity_display || item.quantity || 0} x ${parseFloat(item.unit_price || 0).toFixed(2)}\\n`;\n      commands += `  Total: ${parseFloat(item.total_price || 0).toFixed(2)} MGA\\n`;\n      commands += '\\n';\n    });\n  }\n  \n  // Add totals\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  \n  if (data.total_amount) {\n    commands += `TOTAL: ${parseFloat(data.total_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.paid_amount) {\n    commands += `PAID: ${parseFloat(data.paid_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.remaining_amount && data.remaining_amount > 0) {\n    commands += `DUE: ${parseFloat(data.remaining_amount).toFixed(2)} MGA\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += '='.repeat(32) + '\\n';\n  \n  // Add footer\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += 'Thank you for your business!\\n';\n  commands += '______ANTATSIMO______ System\\n';\n  // commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  \n  // Feed lines and cut paper\n  commands += ESC_POS_COMMANDS.XPRINTER_FEED;\n  commands += ESC_POS_COMMANDS.XPRINTER_CUT;\n  \n  return commands;\n  } catch (error) {\n    console.error('Error generating ESC/POS commands:', error);\n    return '';\n  }\n};\n\n/**\n * Create downloadable file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} File content for download\n */\nexport const createReceiptAppFile = (data, title) => {\n  const escPosCommands = generateESCPOSForReceiptApp(data, title);\n  \n  // Create a simple translation function for the HTML content\n  const simpleT = (key, fallback) => fallback || key;\n  const htmlContent = generateXprinterPrintContent(data, title, 'sale', simpleT);\n  \n  // Create a combined file that works with receipt printer apps\n  return `# Receipt Printer App File\n# Generated: ${new Date().toISOString()}\n# Title: ${title}\n\n# ESC/POS Commands (for direct printer communication)\n${escPosCommands}\n\n# HTML Content (for preview and fallback printing)\n${htmlContent}\n\n# End of file`;\n};\n\n/**\n * Generate PDF content for receipt\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} PDF-ready HTML content\n */\nexport const generatePDFContent = (data, title) => {\n  const isMobile = isMobileDevice();\n  const width = '80mm'; // Standard for Xprinter\n  const fontSize = '12px';\n  const maxChars = 32;\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <style>\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: ${fontSize};\n          line-height: 1.2;\n          color: #000;\n          width: ${width};\n          max-width: ${width};\n          margin: 0 auto;\n          padding: 2mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: 14px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: 13px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: 11px;\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: 11px;\n          margin-bottom: 3px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 1px 3px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-size: 11px;\n        }\n        \n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n          max-width: 22ch;\n        }\n        \n        .item-details {\n          display: flex;\n          justify-content: space-between;\n          font-size: 10px;\n          color: #555;\n        }\n        \n        .receipt-totals {\n          margin: 6px 0;\n          padding-top: 4px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-weight: bold;\n          font-size: 11px;\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 8px;\n          padding-top: 4px;\n          border-top: 1px dashed #000;\n          font-size: 10px;\n          color: #666;\n        }\n        \n        @media print {\n          body {\n            margin: 0;\n            padding: 1mm;\n            width: ${width};\n          }\n          \n          @page {\n            size: ${width} auto;\n            margin: 0;\n          }\n        }\n        \n        @media screen {\n          body {\n            border: 1px solid #ccc;\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"receipt-header\">\n        <div class=\"company-name\">______ANTATSIMO______</div>\n        <div class=\"document-title\">${title.toUpperCase()}</div>\n        <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n      </div>\n      \n      <div class=\"receipt-section\">\n        <div class=\"section-title\">SALE INFO</div>\n        <div class=\"receipt-row\">\n          <span>Sale No:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Status:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Customer:</span>\n          <span>${(data.customer_name || 'Walk-in Customer').substring(0, 22)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>Phone:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Peyment Status:</span>\n          <span>${data.payment_status}</span>\n        </div>\n      </div>\n      \n      <div class=\"receipt-section\">\n        <div class=\"section-title\">ITEMS</div>\n        ${data.items && Array.isArray(data.items) ? data.items.map(item => `\n          <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 22)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity_display || item.quantity || 0} x ${parseFloat(item.unit_price || 0).toFixed(2)}</span>\n            <span>${parseFloat(item.total_price || 0).toFixed(2)} MGA</span>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n      </div>\n      \n      <div class=\"receipt-totals\">\n        <div class=\"total-row\">\n          <span>Total:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"total-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"total-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n      </div>\n      \n      <div class=\"receipt-footer\">\n        <div>Thank you for your business!</div>\n        <div>Created by: ${(data.created_by_name || data.sold_by_name || 'N/A')}</div>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n/**\n * Download PDF file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */\nexport const downloadReceiptFile = (data, title) => {\n  try {\n    // Validate inputs\n    if (!data || !title) {\n      console.error('Invalid data or title provided to downloadReceiptFile');\n      return false;\n    }\n    \n    const pdfContent = generatePDFContent(data, title);\n    if (!pdfContent) {\n      console.error('Failed to create PDF content');\n      return false;\n    }\n    \n    // Create a blob with HTML content that can be saved as PDF\n    const blob = new Blob([pdfContent], { type: 'text/html' });\n    const url = URL.createObjectURL(blob);\n    \n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `receipt_${data.sale_number || Date.now()}.html`;\n    link.style.display = 'none';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n    \n    return true;\n  } catch (error) {\n    console.error('Failed to download receipt file:', error);\n    return false;\n  }\n};\n\n/**\n * Mobile-friendly print function with fallbacks\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */\nexport const mobilePrint = async (printContent, title = 'Document') => {\n  try {\n    // Method 1: Try Web Share API with file (modern mobile browsers)\n    if (navigator.share && isMobileDevice()) {\n      try {\n        // Create a blob with the content\n        const blob = new Blob([printContent], { type: 'text/html' });\n        const file = new File([blob], `${title}.html`, { type: 'text/html' });\n        \n        await navigator.share({\n          title: title,\n          text: 'Print this receipt',\n          files: [file]\n        });\n        \n        return true;\n      } catch (shareError) {\n        console.log('Web Share API with file failed, trying other methods:', shareError);\n      }\n    }\n\n    // Method 2: Try direct window.print() on current page\n    if (window.print && !isMobileDevice()) {\n      // Create a temporary element with the content\n      const tempDiv = document.createElement('div');\n      tempDiv.innerHTML = printContent;\n      tempDiv.style.position = 'absolute';\n      tempDiv.style.left = '-9999px';\n      tempDiv.style.top = '-9999px';\n      document.body.appendChild(tempDiv);\n      \n      // Replace body content temporarily\n      const originalBody = document.body.innerHTML;\n      document.body.innerHTML = printContent;\n      \n      // Print\n      window.print();\n      \n      // Restore original content\n      document.body.innerHTML = originalBody;\n      document.body.removeChild(tempDiv);\n      \n      return true;\n    }\n\n    // Method 3: Try popup window (with better error handling)\n    return await openPrintWindow(printContent, title);\n    \n  } catch (error) {\n    console.error('All print methods failed:', error);\n    return false;\n  }\n};\n\n/**\n * Open print window with enhanced error handling\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */\nexport const openPrintWindow = (printContent, title = 'Document') => {\n  return new Promise((resolve) => {\n    try {\n      // Enhanced window.open parameters for better mobile compatibility\n      const windowFeatures = isMobileDevice() \n        ? 'width=400,height=600,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no'\n        : 'width=900,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no';\n      \n      const printWindow = window.open('', '_blank', windowFeatures);\n      \n      if (!printWindow) {\n        throw new Error('Popup blocked or window.open failed');\n      }\n      \n      // Set window title\n      printWindow.document.title = title;\n      \n      // Write content to window\n      printWindow.document.write(printContent);\n      printWindow.document.close();\n      \n      // Make sure window is visible and focused\n      printWindow.focus();\n      \n      // Wait for content to load and show the window\n      const showAndPrint = () => {\n        try {\n          // Ensure window is visible\n          printWindow.focus();\n          \n          // Add a small delay to ensure content is rendered\n          setTimeout(() => {\n            try {\n              // Show print dialog\n              printWindow.print();\n              \n              // Keep window open longer for user interaction\n              setTimeout(() => {\n                if (!printWindow.closed) {\n                  // Ask user if they want to close the window\n                  if (window.confirm('Close the print preview window?')) {\n                    printWindow.close();\n                  }\n                }\n              }, 5000);\n              \n              resolve(true);\n            } catch (printError) {\n              console.error('Print failed:', printError);\n              // Don't close window immediately, let user see the content\n              resolve(false);\n            }\n          }, 500);\n          \n        } catch (error) {\n          console.error('Error in showAndPrint:', error);\n          resolve(false);\n        }\n      };\n      \n      // Check if content is loaded\n      if (printWindow.document.readyState === 'complete') {\n        showAndPrint();\n      } else {\n        printWindow.onload = showAndPrint;\n      }\n      \n      // Fallback timeout - don't auto-close\n      setTimeout(() => {\n        if (!printWindow.closed) {\n          console.log('Print window timeout - window remains open for user interaction');\n        }\n      }, 30000);\n      \n    } catch (error) {\n      console.error('Failed to open print window:', error);\n      resolve(false);\n    }\n  });\n};\n\n/**\n * Print directly without preview or dialogs\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */\nexport const openPrintWindow_ = (printContent, title = 'Document') => {\n  return new Promise((resolve) => {\n    try {\n      // Create a hidden iframe for printing\n      const iframe = document.createElement('iframe');\n      iframe.style.position = 'fixed';\n      iframe.style.right = '0';\n      iframe.style.bottom = '0';\n      iframe.style.width = '0';\n      iframe.style.height = '0';\n      iframe.style.border = 'none';\n      iframe.style.opacity = '0';\n      iframe.style.pointerEvents = 'none';\n      \n      document.body.appendChild(iframe);\n      \n      const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\n      \n      // Write content to iframe\n      iframeDoc.open();\n      iframeDoc.write(printContent);\n      iframeDoc.close();\n      \n      // Set title\n      iframeDoc.title = title;\n      \n      // Wait for iframe content to load\n      iframe.onload = () => {\n        try {\n          // Get the iframe window\n          const iframeWindow = iframe.contentWindow;\n          \n          // Print directly without dialog\n          iframeWindow.focus();\n          \n          // Use setTimeout to ensure content is fully rendered\n          setTimeout(() => {\n            try {\n              // Direct print command\n              iframeWindow.print();\n              \n              // Resolve immediately after calling print()\n              resolve(true);\n              \n              // Clean up iframe after a delay\n              setTimeout(() => {\n                if (document.body.contains(iframe)) {\n                  document.body.removeChild(iframe);\n                }\n              }, 1000);\n              \n            } catch (printError) {\n              console.error('Print failed:', printError);\n              // Clean up on error\n              if (document.body.contains(iframe)) {\n                document.body.removeChild(iframe);\n              }\n              resolve(false);\n            }\n          }, 100);\n          \n        } catch (error) {\n          console.error('Error in iframe print process:', error);\n          if (document.body.contains(iframe)) {\n            document.body.removeChild(iframe);\n          }\n          resolve(false);\n        }\n      };\n      \n      // Fallback in case onload doesn't fire\n      setTimeout(() => {\n        if (iframe.contentDocument && iframe.contentDocument.readyState === 'complete') {\n          iframe.onload(); // Manually trigger onload\n        }\n      }, 500);\n      \n    } catch (error) {\n      console.error('Failed to setup direct printing:', error);\n      resolve(false);\n    }\n  });\n};\n\n/**\n * Open print preview window (visible, doesn't auto-close)\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */\nexport const openPrintPreview = (printContent, title = 'Document') => {\n  try {\n    // Create a larger window for better visibility\n    const windowFeatures = isMobileDevice() \n      ? 'width=500,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes'\n      : 'width=1000,height=800,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes';\n    \n    const previewWindow = window.open('', '_blank', windowFeatures);\n    \n    if (!previewWindow) {\n      throw new Error('Popup blocked or window.open failed');\n    }\n    \n    // Set window title\n    previewWindow.document.title = `${title} - Print Preview`;\n    \n    // Add print button and styling\n    const enhancedContent = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>${title} - Print Preview</title>\n        <meta charset=\"UTF-8\">\n        <style>\n          body {\n            margin: 0;\n            padding: 20px;\n            font-family: Arial, sans-serif;\n            background: #f5f5f5;\n          }\n          .print-controls {\n            position: fixed;\n            top: 10px;\n            right: 10px;\n            background: white;\n            padding: 10px;\n            border-radius: 5px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            z-index: 1000;\n          }\n          .print-controls button {\n            margin: 5px;\n            padding: 8px 16px;\n            border: none;\n            border-radius: 3px;\n            cursor: pointer;\n            font-size: 14px;\n          }\n          .print-btn {\n            background: #007bff;\n            color: white;\n          }\n          .close-btn {\n            background: #6c757d;\n            color: white;\n          }\n          .print-content {\n            background: white;\n            padding: 20px;\n            border-radius: 5px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            max-width: 800px;\n            margin: 0 auto;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"print-controls\">\n          <button class=\"print-btn\" onclick=\"window.print()\"> Print</button>\n          <button class=\"close-btn\" onclick=\"window.close()\"> Close</button>\n        </div>\n        <div class=\"print-content\">\n          ${printContent.replace('<!DOCTYPE html>', '').replace('<html>', '').replace('<head>', '').replace('</head>', '').replace('<body>', '').replace('</body>', '').replace('</html>', '')}\n        </div>\n      </body>\n      </html>\n    `;\n    \n    // Write content to window\n    previewWindow.document.write(enhancedContent);\n    previewWindow.document.close();\n    \n    // Focus the window\n    previewWindow.focus();\n    \n    return true;\n  } catch (error) {\n    console.error('Failed to open print preview:', error);\n    return false;\n  }\n};\n\n/**\n * Generate Xprinter 80mm optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Xprinter-optimized HTML content\n */\nexport const generateXprinterPrintContent = (data, title, type, t) => {\n\n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <style>\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: 12px;\n          line-height: 1.2;\n          color: #000;\n          width: 80mm;\n          max-width: 80mm;\n          margin: 0 auto;\n          padding: 2mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: 14px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: 13px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: 11px;\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: 11px;\n          margin-bottom: 3px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 1px 3px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-size: 11px;\n        }\n        \n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n          max-width: 22ch; /* 80mm = ~32 chars, leave space for price */\n        }\n        \n        .item-details {\n          display: flex;\n          justify-content: space-between;\n          font-size: 10px;\n          color: #555;\n        }\n        \n        .receipt-totals {\n          margin: 6px 0;\n          padding-top: 4px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-weight: bold;\n          font-size: 11px;\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 8px;\n          padding-top: 4px;\n          border-top: 1px dashed #000;\n          font-size: 10px;\n          color: #666;\n        }\n        \n        @media print {\n          body {\n            margin: 0;\n            padding: 1mm;\n            width: 80mm;\n          }\n          \n          @page {\n            size: 80mm auto;\n            margin: 0;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"receipt-header\">\n        <div class=\"company-name\" style=\"text-align: center;\">________ANTATSIMO_______</div>\n        <div class=\"company-name\" style=\"text-align: center;\">${'\\u00A0'}</div>\n        <div class=\"document-title\" style=\"text-align: center;\">SALE RECEIPT</div>\n        <div class=\"receipt-date\" style=\"text-align: center;\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"section-title\">SALE INFO</div>\n        <div class=\"receipt-row\">\n          <span>Sale No:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Sale Status:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Customer:</span>\n          <span>${(data.customer_name || 'Walk-in Customer').substring(0, 25)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>Phone:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Peyment Status:</span>\n          <span>${data.payment_status}</span>\n        </div>\n\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"no-data\">==================================================</div>\n\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">ITEMS SOLD</div>    \n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"item-details\">\n          <span>Info</span>\n          <span>\n            Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n          </span>\n        </div>\n        <div class=\"no-data\"></div> \n        ${data.items && Array.isArray(data.items) ? data.items.map(item => `\n          <div class=\"sale-item\">\n            <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n            <div class=\"item-details\">\n              <span>\n                ${`(${item.unit_name})${parseFloat(item.unit_price || 0).toFixed(2)}`.padEnd(26, '\\u00A0')}\n                ${(item.quantity_display || item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                ${parseFloat(item.total_price || 0).toFixed(2).padStart(12, '\\u00A0')} MGA\n              </span>\n            </div>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n\n      </div>      \n      <div class=\"receipt-totals\">\n        <div class=\"receipt-row\">\n          <span>Subtotal:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"receipt-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-footer\">\n        <div class=\"thank-you\">Thank you!</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Created by: ${(data.created_by_name || data.sold_by_name || 'N/A')}</div>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n/**\n * Generate mobile-optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Mobile-optimized HTML content\n */\nexport const generateMobilePrintContent = (data, title, type, t) => {\n  const isMobile = isMobileDevice();\n  const printerType = detectPrinterType();\n  \n  // Use smaller dimensions for mobile\n  const width = isMobile ? '58mm' : '80mm';\n  const fontSize = isMobile ? '10px' : '12px';\n  const maxChars = isMobile ? 24 : 32;\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <style>\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: ${fontSize};\n          line-height: 1.2;\n          color: #000;\n          width: ${width};\n          max-width: ${width};\n          margin: 0 auto;\n          padding: 2mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: ${isMobile ? '12px' : '14px'};\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: ${isMobile ? '11px' : '13px'};\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: ${isMobile ? '9px' : '11px'};\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: ${isMobile ? '9px' : '11px'};\n          margin-bottom: 3px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 1px 3px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-size: ${isMobile ? '9px' : '11px'};\n        }\n        \n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n          max-width: ${maxChars - 10}ch;\n        }\n        \n        .item-details {\n          display: flex;\n          justify-content: space-between;\n          font-size: ${isMobile ? '8px' : '10px'};\n          color: #555;\n        }\n        \n        .receipt-totals {\n          margin: 6px 0;\n          padding-top: 4px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-weight: bold;\n          font-size: ${isMobile ? '9px' : '11px'};\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 8px;\n          padding-top: 4px;\n          border-top: 1px dashed #000;\n          font-size: ${isMobile ? '8px' : '10px'};\n          color: #666;\n        }\n        \n        @media print {\n          body {\n            margin: 0;\n            padding: 1mm;\n            width: ${width};\n          }\n          \n          @page {\n            size: ${width} auto;\n            margin: 0;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"receipt-header\">\n        <div class=\"company-name\" style=\"text-align: center;\">________ANTATSIMO_______</div>\n        <div class=\"company-name\" style=\"text-align: center;\">${'\\u00A0'}</div>\n        <div class=\"document-title\" style=\"text-align: center;\">SALE RECEIPT</div>\n        <div class=\"receipt-date\" style=\"text-align: center;\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"section-title\">SALE INFO</div>\n        <div class=\"receipt-row\">\n          <span>Sale No:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Sale Status:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Customer:</span>\n          <span>${(data.customer_name || 'Walk-in Customer').substring(0, 25)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>Phone:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Peyment Status:</span>\n          <span>${data.payment_status}</span>\n        </div>\n\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"no-data\">==================================================</div>\n\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">ITEMS SOLD</div>             \n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"item-details\">\n          <span>Info</span>\n          <span>\n            Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n          </span>\n        </div>\n        <div class=\"no-data\"></div> \n        ${data.items && Array.isArray(data.items) ? data.items.map(item => `\n          <div class=\"sale-item\">\n            <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n            <div class=\"item-details\">\n              <span>\n                ${`(${item.unit_name})${parseFloat(item.unit_price || 0).toFixed(2)}`.padEnd(26, '\\u00A0')}\n                ${(item.quantity_display || item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                ${parseFloat(item.total_price || 0).toFixed(2).padStart(12, '\\u00A0')} MGA\n              </span>\n            </div>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n\n      </div>        \n      <div class=\"receipt-totals\">\n        <div class=\"receipt-row\">\n          <span>Subtotal:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"receipt-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-footer\">\n        <div class=\"thank-you\">Thank you!</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Created by: ${(data.created_by_name || data.sold_by_name || 'N/A')}</div>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n// Helper functions for generating print content optimized for 80mm thermal printers\nconst generateInventoryContent = (data, t) => {\n  // Handle different data structures\n  let products = [];\n  let summary = {};\n  let filterType = data.filter_type || '';\n  let reportName = data.report_name || 'INVENTORY REPORT';\n  \n  if (Array.isArray(data)) {\n    products = data;\n  } else if (data.products && Array.isArray(data.products)) {\n    products = data.products;\n    summary = data.summary || {};\n  } else if (data.results && Array.isArray(data.results)) {\n    products = data.results;\n  } else if (data.data && Array.isArray(data.data)) {\n    products = data.data;\n  } else if (data.items && Array.isArray(data.items)) {\n    products = data.items;\n  } else {\n    const numberedKeys = Object.keys(data).filter(key => /^\\d+$/.test(key));\n    if (numberedKeys.length > 0) {\n      products = numberedKeys.map(key => data[key]).filter(item => item && typeof item === 'object');\n    }\n  }\n  \n  // Filter products based on filter_type\n  if (filterType === 'low_stock') {\n    products = products.filter(p => p.is_low_stock);\n    reportName = 'LOW STOCK REPORT';\n  } else if (filterType === 'out_of_stock') {\n    products = products.filter(p => p.is_out_of_stock);\n    reportName = 'OUT OF STOCK REPORT';\n  }\n  \n  const totalValue = summary.total_value || products.reduce((sum, p) => sum + parseFloat(p.stock_value || 0), 0);\n  const lowStockCount = summary.low_stock_count || products.filter(p => p.is_low_stock).length;\n  const outOfStockCount = summary.out_of_stock_count || products.filter(p => p.is_out_of_stock).length;\n\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">${reportName}</div>\n      <div class=\"receipt-date\">${data.generated_at ? new Date(data.generated_at).toLocaleDateString() : new Date().toLocaleDateString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">SUMMARY</div>\n      <div class=\"receipt-row\">\n        <span>Total Products:</span>\n        <span>${products.length}</span>\n      </div>\n      ${summary.total_value !== undefined ? `\n        <div class=\"receipt-row\">\n          <span>Total Value:</span>\n          <span>${parseFloat(totalValue).toFixed(2)} MGA</span>\n        </div>\n      ` : ''}\n      ${!filterType ? `\n        <div class=\"receipt-row\">\n          <span>Low Stock:</span>\n          <span style=\"color: #f59e0b\">${lowStockCount}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Out of Stock:</span>\n          <span style=\"color: #dc2626\">${outOfStockCount}</span>\n        </div>\n      ` : ''}\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">PRODUCTS (${products.length})</div>\n      ${products.length > 0 ? products.slice(0, 30).map((item, index) => {\n        const stockQty = parseFloat(item.stock_quantity || 0);\n        const minLevel = parseFloat(item.min_stock_level || 0);\n        const unitSymbol = item.base_unit_symbol || item.base_unit_name || 'pcs';\n        const statusColor = item.is_out_of_stock ? '#dc2626' : item.is_low_stock ? '#f59e0b' : '#10b981';\n        const statusText = item.is_out_of_stock ? 'OUT' : item.is_low_stock ? 'LOW' : 'OK';\n        \n        return `\n          <div class=\"product-item\" style=\"margin-bottom: 4px; padding: 2px 0; border-bottom: 1px dotted #ccc;\">\n            <div class=\"product-name\" style=\"font-weight: bold; margin-bottom: 2px;\">\n              ${index + 1}. ${(item.name || 'N/A').substring(0, 22)}\n            </div>\n            <div class=\"product-details\" style=\"font-size: 9px; display: flex; justify-content: space-between; flex-wrap: wrap; margin-bottom: 1px;\">\n              <span>SKU: ${(item.sku || 'N/A').substring(0, 10)}</span>\n              <span>Cat: ${(item.category || 'N/A').substring(0, 8)}</span>\n              ${item.storage_section ? `<span>Loc: ${item.storage_section}</span>` : ''}\n            </div>\n            <div class=\"product-details\" style=\"font-size: 9px; display: flex; justify-content: space-between; margin-top: 1px;\">\n              <span>Stock: ${stockQty.toFixed(2)} ${unitSymbol}</span>\n              <span>Min: ${minLevel.toFixed(2)}</span>\n              <span style=\"color: ${statusColor}; font-weight: bold\">${statusText}</span>\n            </div>\n            <div class=\"product-details\" style=\"font-size: 9px; display: flex; justify-content: space-between; margin-top: 1px;\">\n              <span>Cost: ${parseFloat(item.cost_price || 0).toFixed(2)} MGA</span>\n              <span>Value: ${parseFloat(item.stock_value || 0).toFixed(2)} MGA</span>\n            </div>\n          </div>\n        `;\n      }).join('') : '<div class=\"no-data\">No products found</div>'}\n      ${products.length > 30 ? `\n        <div class=\"truncated-warning\">... and ${products.length - 30} more products</div>\n      ` : ''}\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Report generated by: ${data.user_name || 'System'}</div>\n      <div class=\"footer-text\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n  `;\n};\n\nconst generatePurchaseOrderContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">PURCHASE ORDER</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">ORDER INFO</div>\n      <div class=\"receipt-row\">\n        <span>Order No:</span>\n        <span>${data.order_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Supplier:</span>\n        <span>${(data.supplier?.name || 'N/A').substring(0, 25)}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Date:</span>\n        <span>${data.order_date ? new Date(data.order_date).toLocaleDateString() : 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Status:</span>\n        <span>${data.status || 'N/A'}</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">ITEMS</div>\n      ${data.items ? data.items.map(item => `\n        <div class=\"order-item\">\n          <div class=\"item-name\">${(item.product?.name || 'N/A').substring(0, 25)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity_ordered || 0} x ${parseFloat(item.unit_cost || 0).toFixed(2)}</span>\n            <span>${parseFloat((item.quantity_ordered || 0) * (item.unit_cost || 0)).toFixed(2)} MGA</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No items found</div>'}\n    </div>\n    \n    <div class=\"receipt-total\">\n      <div class=\"total-row\">\n        <span>TOTAL AMOUNT:</span>\n        <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">End of Purchase Order</div>\n    </div>\n  `;\n};\n\nconst generateDeliveryContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">DELIVERY RECEIPT</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">DELIVERY INFO</div>\n      <div class=\"receipt-row\">\n        <span>Delivery No:</span>\n        <span>${data.delivery_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>PO Number:</span>\n        <span>${data.purchase_order?.order_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Date:</span>\n        <span>${data.delivery_date ? new Date(data.delivery_date).toLocaleDateString() : 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Status:</span>\n        <span>${data.status || 'N/A'}</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">ITEMS RECEIVED</div>\n      ${data.items ? data.items.map(item => `\n        <div class=\"delivery-item\">\n          <div class=\"item-name\">${(item.product_name || item.product?.name || 'N/A').substring(0, 25)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity_received || item.delivered_quantity || 0} x ${parseFloat(item.unit_cost || 0).toFixed(2)}</span>\n            <span>${parseFloat((item.quantity_received || item.delivered_quantity || 0) * (item.unit_cost || 0)).toFixed(2)} MGA</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No items found</div>'}\n    </div>\n    \n    <div class=\"receipt-total\">\n      <div class=\"total-row\">\n        <span>TOTAL AMOUNT:</span>\n        <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Delivery completed</div>\n    </div>\n  `;\n};\n\nconst generateSaleContent = (data, t) => {\n  let items = data.items;\n  if (!items) {\n    const numberedKeys = Object.keys(data).filter(key => /^\\d+$/.test(key));\n    if (numberedKeys.length > 0) {\n      items = numberedKeys.map(key => data[key]).filter(item => item && typeof item === 'object');\n    }\n  }\n\n  const paymentStatusText = data.payment_status === 'paid' ? 'PAID' : \n                          data.payment_status === 'partial' ? 'PARTIAL' : \n                          data.payment_status === 'pending' ? 'PENDING' : \n                          'UNKNOWN';\n  console.log(data);\n\n  return `\n    <div class=\"receipt-header\">\n        <div class=\"company-name\" style=\"text-align: center;\">________ANTATSIMO_______</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"section-title\">${t('print.sale_information')}</div>\n        <div class=\"receipt-row\">\n          <span>${t('print.sale_no')}:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>${t('print.sale_status')}:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>${t('sales.customer_name')}:</span>\n          <span>${(data.customer_name || t('customer.walk_in')).substring(0, 25)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>${t('sales.customer_phone')}:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>${t('print.peyment_status')}:</span>\n          <span>${paymentStatusText}</span>\n        </div>\n\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">${t('print.item_sold')}</div>    \n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"item-details\">\n          <span>Info</span>\n          <span>\n            Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n          </span>\n        </div>\n      \n        ${items && Array.isArray(items) ? items.map(item => `\n          <div class=\"no-data\"></div>         \n          <div class=\"sale-item\">\n            <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n            <div class=\"item-details\">\n              <span>\n                ${`(${item.unit_name})${parseFloat(item.unit_price || 0).toFixed(2)}`.padEnd(26, '\\u00A0')}\n                ${(item.quantity_display || item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                ${parseFloat(item.total_price || 0).toFixed(2).padStart(12, '\\u00A0')} MGA\n              </span>\n            </div>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n\n        <div class=\"no-data\">__________________________________________________</div>\n      </div>\n      ${data.packaging_items && data.packaging_items.length > 0 ? `\n        <div class=\"receipt-section\">\n          <div class=\"section-title\">${t('print.packagings')}</div>    \n          <div class=\"no-data\">__________________________________________________</div>\n          <div class=\"item-details\">\n            <span>Info</span>\n            <span>\n              Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n            </span>\n          </div>\n        \n          ${data.packaging_items.map(item => {\n            let unitPriceDisplay, totalPriceDisplay;\n            \n            if (item.status === 'consignation') {\n              unitPriceDisplay = `${parseFloat(item.unit_price || 0).toFixed(2)}`;\n              totalPriceDisplay = `${parseFloat(item.total_price || 0).toFixed(2)} MGA`;\n            } else if (item.status === 'exchange') {\n              unitPriceDisplay = '0.00';\n              totalPriceDisplay = '0.00 MGA';\n            } else if (item.status === 'due') {\n              unitPriceDisplay = 'DUE';\n              totalPriceDisplay = 'DUE';\n            } else {\n              unitPriceDisplay = `${parseFloat(item.unit_price || 0).toFixed(2)}`;\n              totalPriceDisplay = `${parseFloat(item.total_price || 0).toFixed(2)} MGA`;\n            }\n            \n            return `\n            <div class=\"no-data\"></div>         \n            <div class=\"packaging-item\">\n              <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n              <div class=\"item-details\">\n                <span>\n                  ${unitPriceDisplay.padEnd(26, '\\u00A0')}\n                  ${(item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                  ${totalPriceDisplay.padStart(12, '\\u00A0')}\n                </span>\n              </div>\n            </div>\n          `;\n          }).join('')}\n\n          <div class=\"no-data\">__________________________________________________</div>\n        </div>\n      ` : ''}\n      <div class=\"receipt-totals\">\n        <div class=\"receipt-row\">\n          <span>Subtotal:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.packaging_total && data.packaging_total > 0 ? `\n          <div class=\"receipt-row\">\n            <span>Packagings:</span>\n            <span>${parseFloat(data.packaging_total || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Total:</span>\n          <span>${parseFloat(data.grand_total || data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"receipt-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-footer\">\n        <div class=\"thank-you\">${t('print.thankings')}</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">${t('common.created_by')}: ${(data.created_by_name || data.sold_by_name || data.user_name || 'N/A')} -- ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n        <div class=\"terms\">${t('messages.terms_of_sales')}</div>\n      </div>\n  `;\n};\n\nconst generateSalesHistoryContent = (data, t) => {\n  let sales = data;\n  if (!Array.isArray(data)) {\n    if (data.results && Array.isArray(data.results)) {\n      sales = data.results;\n    } else if (data.data && Array.isArray(data.data)) {\n      sales = data.data;\n    } else if (data.items && Array.isArray(data.items)) {\n      sales = data.items;\n    } else {\n      const numberedKeys = Object.keys(data).filter(key => /^\\d+$/.test(key));\n      if (numberedKeys.length > 0) {\n        sales = numberedKeys.map(key => data[key]).filter(item => item && typeof item === 'object');\n      } else {\n        sales = [];\n      }\n    }\n  }\n\n  const totalRevenue = Array.isArray(sales) ? sales.reduce((sum, sale) => sum + parseFloat(sale.total_amount || 0), 0) : 0;\n\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">SALES REPORT</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">SUMMARY</div>\n      <div class=\"receipt-row\">\n        <span>Total Sales:</span>\n        <span>${Array.isArray(sales) ? sales.length : 0}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Total Revenue:</span>\n        <span>${totalRevenue.toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">RECENT SALES</div>\n      ${Array.isArray(sales) ? sales.map(sale => `\n        <div class=\"sale-summary\">\n          <div class=\"sale-info\">\n            <span>${sale.sale_number || 'N/A'}</span>\n            <span>${parseFloat(sale.total_amount || 0).toFixed(2)} MGA</span>\n          </div>\n          <div class=\"sale-details\">\n            <span>${(sale.customer_name || t('customer.walk_in', 'Walk-in')).substring(0, 15)}</span>\n            <span>${sale.created_at ? new Date(sale.created_at).toLocaleDateString() : 'N/A'}</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No sales data</div>'}\n      ${Array.isArray(sales) && sales.length > 20 ? `\n        <div class=\"truncated-warning\">... and ${sales.length - 20} more sales</div>\n      ` : ''}\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Sales report generated</div>\n    </div>\n  `;\n};\n\nconst generateSalesReportContent = (data, t) => {\n  const summary = data.summary || {};\n  const chartData = data.chart_data || [];\n  const details = data.details || [];\n  const topProducts = data.top_products || [];\n  const dateRange = data.date_range || {};\n  \n  const totalRevenue = parseFloat(summary.total_sales || 0);\n  const totalCost = parseFloat(summary.total_cost || 0);\n  const profit = parseFloat(summary.profit || 0);\n  const profitMargin = parseFloat(summary.profit_margin || 0);\n  const totalTransactions = summary.total_count || 0;\n  const totalItems = summary.total_items || 0;\n  const avgSale = totalTransactions > 0 ? totalRevenue / totalTransactions : 0;\n\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">SALES REPORT</div>\n      <div class=\"receipt-date\">${data.generated_at ? new Date(data.generated_at).toLocaleDateString() : new Date().toLocaleDateString()}</div>\n      ${dateRange.start_date && dateRange.end_date ? `\n        <div class=\"receipt-date\" style=\"font-size: 10px; margin-top: 2px;\">\n          ${new Date(dateRange.start_date).toLocaleDateString()} - ${new Date(dateRange.end_date).toLocaleDateString()}\n        </div>\n      ` : ''}\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">FINANCIAL SUMMARY</div>\n      <div class=\"receipt-row\">\n        <span>Total Revenue:</span>\n        <span>${totalRevenue.toFixed(2)} MGA</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Total Cost:</span>\n        <span>${totalCost.toFixed(2)} MGA</span>\n      </div>\n      <div class=\"receipt-row\" style=\"font-weight: bold; border-top: 1px solid #000; padding-top: 3px; margin-top: 3px;\">\n        <span>Profit:</span>\n        <span style=\"color: ${profit >= 0 ? '#090' : '#d00'}\">${profit.toFixed(2)} MGA</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Profit Margin:</span>\n        <span style=\"color: ${profitMargin >= 0 ? '#090' : '#d00'}\">${profitMargin.toFixed(2)}%</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">SALES SUMMARY</div>\n      <div class=\"receipt-row\">\n        <span>Total Transactions:</span>\n        <span>${totalTransactions}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Total Items Sold:</span>\n        <span>${totalItems}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Average Sale:</span>\n        <span>${avgSale.toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    ${chartData.length > 0 ? `\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">DAILY BREAKDOWN</div>\n        ${chartData.slice(0, 10).map(day => {\n          const dayProfit = (day.total || 0) - (day.cost || 0);\n          return `\n            <div class=\"sale-summary\" style=\"margin-bottom: 4px; padding: 2px 0; border-bottom: 1px dotted #ccc;\">\n              <div class=\"sale-info\" style=\"font-weight: bold; margin-bottom: 2px;\">\n                <span>${day.date}</span>\n              </div>\n              <div class=\"sale-details\" style=\"font-size: 9px; display: flex; justify-content: space-between;\">\n                <span>Rev: ${parseFloat(day.total || 0).toFixed(2)} MGA</span>\n                <span>Cost: ${parseFloat(day.cost || 0).toFixed(2)} MGA</span>\n                <span style=\"color: ${dayProfit >= 0 ? '#090' : '#d00'}\">Profit: ${dayProfit.toFixed(2)} MGA</span>\n              </div>\n            </div>\n          `;\n        }).join('')}\n        ${chartData.length > 10 ? `\n          <div class=\"truncated-warning\">... and ${chartData.length - 10} more days</div>\n        ` : ''}\n      </div>\n    ` : ''}\n    \n    ${topProducts.length > 0 ? `\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">TOP PRODUCTS (${topProducts.length})</div>\n        ${topProducts.map((product, index) => {\n          const productProfit = parseFloat(product.profit || 0);\n          return `\n            <div class=\"sale-summary\" style=\"margin-bottom: 4px; padding: 2px 0; border-bottom: 1px dotted #ccc;\">\n              <div class=\"sale-info\" style=\"font-weight: bold; margin-bottom: 2px;\">\n                <span>${index + 1}. ${(product.product__name || 'N/A').substring(0, 20)}</span>\n              </div>\n              <div class=\"sale-details\" style=\"font-size: 9px; display: flex; justify-content: space-between; flex-wrap: wrap;\">\n                <span>SKU: ${product.product__sku || 'N/A'}</span>\n                <span>Qty: ${product.total_sold || 0} ${product.unit_symbol || 'pcs'}</span>\n              </div>\n              <div class=\"sale-details\" style=\"font-size: 9px; display: flex; justify-content: space-between; margin-top: 1px;\">\n                <span>Rev: ${parseFloat(product.total_revenue || 0).toFixed(2)} MGA</span>\n                <span>Cost: ${parseFloat(product.total_cost || 0).toFixed(2)} MGA</span>\n                <span style=\"color: ${productProfit >= 0 ? '#090' : '#d00'}\">Profit: ${productProfit.toFixed(2)} MGA</span>\n                <span style=\"color: ${productProfit >= 0 ? '#090' : '#d00'}\">${parseFloat(product.profit_margin || 0).toFixed(1)}%</span>\n              </div>\n            </div>\n          `;\n        }).join('')}\n      </div>\n    ` : ''}\n    \n    ${details.length > 0 ? `\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">RECENT SALES (${Math.min(details.length, 5)} of ${details.length})</div>\n        ${details.slice(0, 5).map(sale => `\n          <div class=\"sale-summary\" style=\"margin-bottom: 3px; padding: 2px 0;\">\n            <div class=\"sale-info\">\n              <span>${sale.sale_number || 'N/A'}</span>\n              <span>${parseFloat(sale.total_amount || 0).toFixed(2)} MGA</span>\n            </div>\n            <div class=\"sale-details\" style=\"font-size: 9px;\">\n              <span>${(sale.customer_name || t('customer.walk_in', 'Walk-in')).substring(0, 20)}</span>\n              <span>${sale.created_at ? new Date(sale.created_at).toLocaleDateString() : 'N/A'}</span>\n            </div>\n          </div>\n        `).join('')}\n        ${details.length > 5 ? `\n          <div class=\"truncated-warning\">... and ${details.length - 5} more sales</div>\n        ` : ''}\n      </div>\n    ` : ''}\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Report generated by: ${data.user_name || 'System'}</div>\n      <div class=\"footer-text\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n  `;\n};\n\nconst generatePackagingValidationContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">PACKAGING VALIDATION</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">VALIDATION INFO</div>\n      <div class=\"receipt-row\">\n        <span>Sale No:</span>\n        <span>${data.sale_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Status:</span>\n        <span>${data.status || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Customer:</span>\n        <span>${(data.customer_name || t('customer.walk_in', 'Walk-in Customer')).substring(0, 25)}</span>\n      </div>\n      ${data.customer_phone ? `\n        <div class=\"receipt-row\">\n          <span>Phone:</span>\n          <span>${data.customer_phone}</span>\n        </div>\n      ` : ''}\n      <div class=\"receipt-row\">\n        <span>Total Items:</span>\n        <span>${data.packaging_items ? data.packaging_items.length : 0}</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">PACKAGING ITEMS</div>\n      ${data.packaging_items && Array.isArray(data.packaging_items) ? data.packaging_items.map(item => `\n        <div class=\"packaging-item\">\n          <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity || 0} x ${parseFloat(item.unit_price || 0).toFixed(2)}</span>\n            <span>${parseFloat(item.total_price || 0).toFixed(2)} MGA</span>\n            <span class=\"status-${item.status}\">${item.status === 'consignation' ? 'PAID' : \n                   item.status === 'exchange' ? 'EXCH' : \n                   item.status === 'due' ? 'DUE' : item.status}</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No packaging items</div>'}\n    </div>\n    \n    <div class=\"receipt-total\">\n      <div class=\"total-row\">\n        <span>PACKAGING TOTAL:</span>\n        <span>${parseFloat(data.packaging_total || 0).toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Packaging validation completed</div>\n    </div>\n  `;\n};\n\nconst generateDefaultContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">DOCUMENT</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">CONTENT</div>\n      <div class=\"default-content\">\n        Document generated successfully\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Document printed</div>\n    </div>\n  `;\n};\n\n// Export the generatePrintContent function\nexport const generatePrintContent = (data, title, type, t) => {\n  const currentDate = new Date().toLocaleDateString();\n  const currentTime = new Date().toLocaleTimeString();\n  \n  let content = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <style>\n        /* 80mm Thermal Printer Receipt Styles */\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: 12px;\n          line-height: 1.2;\n          color: #000;\n          width: 80mm;\n          max-width: 80mm;\n          margin: 0 auto;\n          padding: 3mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 8px;\n          padding-bottom: 6px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: 14px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: 13px;\n          margin-bottom: 3px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: 11px;\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 8px;\n          padding-bottom: 6px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: 11px;\n          margin-bottom: 4px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 2px 4px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 3px;\n          font-size: 11px;\n        }\n        \n        .product-item,\n        .order-item,\n        .delivery-item,\n        .sale-item,\n        .packaging-item,\n        .sale-summary {\n          margin-bottom: 4px;\n          padding: 2px 0;\n        }\n        \n        .product-name,\n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n        }\n        \n        .product-details,\n        .item-details,\n        .sale-info {\n          display: flex;\n          justify-content: space-between;\n          font-size: 10px;\n          color: #555;\n        }\n        \n        .receipt-totals,\n        .receipt-total {\n          margin: 8px 0;\n          padding-top: 6px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 3px;\n          font-weight: bold;\n        }\n        \n        .due-amount {\n          color: #d00;\n        }\n        \n        .no-data {\n          text-align: center;\n          color: #888;\n          font-style: italic;\n          padding: 8px 0;\n        }\n        \n        .truncated-warning {\n          text-align: center;\n          color: #888;\n          font-size: 10px;\n          font-style: italic;\n          margin-top: 4px;\n        }\n        \n        .thank-you {\n          text-align: center;\n          font-weight: bold;\n          margin: 6px 0;\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 10px;\n          padding-top: 6px;\n          border-top: 1px dashed #000;\n          font-size: 10px;\n          color: #666;\n        }\n        \n        .footer-text {\n          margin-bottom: 2px;\n        }\n        \n        .status-consignation { color: #090; }\n        .status-exchange { color: #009; }\n        .status-due { color: #d00; font-weight: bold; }\n        \n        /* Print-specific styles */\n        @media print {\n          body {\n            margin: 0;\n            padding: 2mm;\n            width: 80mm;\n          }\n          \n          .no-print {\n            display: none;\n          }\n          \n          /* Ensure proper sizing for thermal paper */\n          @page {\n            size: 80mm auto;\n            margin: 0;\n          }\n        }\n        \n        /* Force monospace and proper breaking */\n        * {\n          font-family: 'Courier New', Courier, monospace !important;\n        }\n        \n        .default-content {\n          text-align: center;\n          padding: 10px 0;\n          color: #666;\n        }\n      </style>\n    </head>\n    <body>\n  `;\n\n  // Add type-specific content\n  switch (type) {\n    case 'inventory':\n    case 'inventory_report':\n      content += generateInventoryContent(data, t);\n      break;\n    case 'purchase_order':\n      content += generatePurchaseOrderContent(data, t);\n      break;\n    case 'delivery':\n      content += generateDeliveryContent(data, t);\n      break;\n    case 'sale':\n      content += generateSaleContent(data, t);\n      break;\n    case 'sales_history':\n      content += generateSalesHistoryContent(data, t);\n      break;\n    case 'sales_report':\n      content += generateSalesReportContent(data, t);\n      break;\n    case 'packaging_validation':\n      content += generatePackagingValidationContent(data, t);\n      break;\n    default:\n      content += generateDefaultContent(data, t);\n  }\n\n  content += `\n    </body>\n    </html>\n  `;\n\n  return content;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}