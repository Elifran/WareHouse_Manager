{"ast":null,"code":"/**\n * Print utilities for thermal receipt printer compatibility\n * Supports 80mm and 58mm thermal printers with ESC/POS commands\n */// ESC/POS Commands for thermal printers (Xprinter 80mm compatible)\nexport const ESC_POS_COMMANDS={INITIALIZE:'\\x1B\\x40',// Initialize printer\nCENTER:'\\x1B\\x61\\x01',// Center text\nLEFT_ALIGN:'\\x1B\\x61\\x00',// Left align text\nRIGHT_ALIGN:'\\x1B\\x61\\x02',// Right align text\nBOLD_ON:'\\x1B\\x45\\x01',// Bold on\nBOLD_OFF:'\\x1B\\x45\\x00',// Bold off\nDOUBLE_HEIGHT:'\\x1B\\x21\\x10',// Double height\nNORMAL_SIZE:'\\x1B\\x21\\x00',// Normal size\nCUT_PAPER:'\\x1D\\x56\\x00',// Cut paper\nFEED_LINE:'\\x0A',// Feed line\nFEED_LINES:n=>\"\\x1Bd\".concat(String.fromCharCode(n)),// Feed n lines\nUNDERLINE_ON:'\\x1B\\x2D\\x01',// Underline on\nUNDERLINE_OFF:'\\x1B\\x2D\\x00',// Underline off\nREVERSE_ON:'\\x1D\\x42\\x01',// Reverse on\nREVERSE_OFF:'\\x1D\\x42\\x00',// Reverse off\n// Xprinter specific commands\nXPRINTER_INIT:'\\x1B\\x40',// Xprinter initialization\nXPRINTER_CUT:'\\x1D\\x56\\x42\\x00',// Xprinter cut paper\nXPRINTER_FEED:'\\x1B\\x64\\x03',// Xprinter feed 3 lines\nXPRINTER_BEEP:'\\x1B\\x42\\x01\\x01'// Xprinter beep\n};// Printer configurations\nexport const PRINTER_CONFIGS={THERMAL_80MM:{width:'80mm',maxChars:32,fontSize:12,lineHeight:1.2,margins:'5mm'},THERMAL_58MM:{width:'58mm',maxChars:24,fontSize:10,lineHeight:1.1,margins:'3mm'},STANDARD_A4:{width:'210mm',maxChars:80,fontSize:14,lineHeight:1.4,margins:'20mm'}};/**\n * Generate CSS for thermal printer compatibility\n * @param {string} printerType - Type of printer (THERMAL_80MM, THERMAL_58MM, STANDARD_A4)\n * @returns {string} CSS styles\n */export const generateThermalPrinterCSS=function(){let printerType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'THERMAL_80MM';const config=PRINTER_CONFIGS[printerType];return\"\\n    @media print {\\n      @page {\\n        size: \".concat(config.width,\" auto;\\n        margin: \").concat(config.margins,\";\\n      }\\n      \\n      body { \\n        margin: 0; \\n        font-size: \").concat(config.fontSize,\"px;\\n        line-height: \").concat(config.lineHeight,\";\\n        font-family: 'Courier New', monospace;\\n        max-width: \").concat(config.width,\";\\n      }\\n      \\n      .header h1 { \\n        font-size: \").concat(config.fontSize+6,\"px; \\n        margin-bottom: 5px;\\n        text-align: center;\\n      }\\n      \\n      .header .date, .header .print-info { \\n        font-size: \").concat(config.fontSize-2,\"px; \\n        text-align: center;\\n      }\\n      \\n      .info-section { \\n        padding: 8px; \\n        margin-bottom: 10px; \\n        border: 1px solid #000;\\n      }\\n      \\n      .info-section h3 { \\n        font-size: \").concat(config.fontSize+2,\"px; \\n        margin-bottom: 5px;\\n        text-align: center;\\n        font-weight: bold;\\n      }\\n      \\n      .info-row { \\n        margin-bottom: 3px; \\n        font-size: \").concat(config.fontSize-1,\"px;\\n        display: flex;\\n        justify-content: space-between;\\n      }\\n      \\n      table { \\n        width: 100%;\\n        font-size: \").concat(config.fontSize-2,\"px; \\n        border-collapse: collapse;\\n      }\\n      \\n      th, td { \\n        padding: 2px; \\n        font-size: \").concat(config.fontSize-2,\"px;\\n        border: 1px solid #000;\\n        text-align: left;\\n      }\\n      \\n      th { \\n        background-color: #f0f0f0;\\n        font-weight: bold;\\n        text-align: center;\\n      }\\n      \\n      .total-row { \\n        font-weight: bold; \\n        background-color: #e0e0e0; \\n      }\\n      \\n      .footer { \\n        font-size: \").concat(config.fontSize-3,\"px; \\n        margin-top: 15px; \\n        text-align: center;\\n        border-top: 1px solid #000;\\n        padding-top: 5px;\\n      }\\n      \\n      .thermal-printer-commands {\\n        display: block;\\n        font-family: monospace;\\n        font-size: 8px;\\n        color: #666;\\n        margin-top: 5px;\\n        text-align: center;\\n      }\\n      \\n      /* Hide elements not suitable for thermal printing */\\n      .no-print, .print-button, .button, .btn {\\n        display: none !important;\\n      }\\n    }\\n  \");};/**\n * Generate ESC/POS commands for thermal printer\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */export const generateESCPOSCommands=(data,title)=>{let commands='';// Initialize printer\ncommands+=ESC_POS_COMMANDS.INITIALIZE;// Center and bold title\ncommands+=ESC_POS_COMMANDS.CENTER;commands+=ESC_POS_COMMANDS.BOLD_ON;commands+=ESC_POS_COMMANDS.DOUBLE_HEIGHT;commands+=title+'\\n';commands+=ESC_POS_COMMANDS.NORMAL_SIZE;commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+=ESC_POS_COMMANDS.FEED_LINE;// Add separator line\ncommands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.FEED_LINE;// Add document info\ncommands+=ESC_POS_COMMANDS.LEFT_ALIGN;commands+=\"Date: \".concat(new Date().toLocaleDateString(),\"\\n\");commands+=\"Time: \".concat(new Date().toLocaleTimeString(),\"\\n\");commands+=\"Print ID: \".concat(data.print_id||'N/A',\"\\n\");commands+=ESC_POS_COMMANDS.FEED_LINE;// Add content based on type\nif(data.sale_number){commands+=\"Sale: \".concat(data.sale_number,\"\\n\");}if(data.customer_name){commands+=\"Customer: \".concat(data.customer_name,\"\\n\");}if(data.customer_phone){commands+=\"Phone: \".concat(data.customer_phone,\"\\n\");}commands+=ESC_POS_COMMANDS.FEED_LINE;commands+='-'.repeat(32)+'\\n';// Add items if present\nif(data.items&&Array.isArray(data.items)){commands+=ESC_POS_COMMANDS.BOLD_ON;commands+='ITEMS:\\n';commands+=ESC_POS_COMMANDS.BOLD_OFF;data.items.forEach(item=>{commands+=\"\".concat(item.product_name||'N/A',\"\\n\");commands+=\"  Qty: \".concat(item.quantity||0,\" \").concat(item.unit_name||'pcs',\"\\n\");commands+=\"  Price: \".concat(parseFloat(item.unit_price||0).toFixed(2),\" MGA\\n\");commands+=\"  Total: \".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\\n\");commands+='\\n';});}// Add packaging items if present\nif(data.packaging_items&&Array.isArray(data.packaging_items)){commands+=ESC_POS_COMMANDS.BOLD_ON;commands+='PACKAGING:\\n';commands+=ESC_POS_COMMANDS.BOLD_OFF;data.packaging_items.forEach(item=>{commands+=\"\".concat(item.product_name||'N/A',\"\\n\");commands+=\"  Qty: \".concat(item.quantity||0,\" \").concat(item.unit_name||'pcs',\"\\n\");commands+=\"  Price: \".concat(parseFloat(item.unit_price||0).toFixed(2),\" MGA\\n\");commands+=\"  Total: \".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\\n\");commands+=\"  Status: \".concat(item.status||'N/A',\"\\n\");commands+='\\n';});}// Add totals\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.BOLD_ON;if(data.total_amount){commands+=\"TOTAL: \".concat(parseFloat(data.total_amount).toFixed(2),\" MGA\\n\");}if(data.packaging_total){commands+=\"PACKAGING: \".concat(parseFloat(data.packaging_total).toFixed(2),\" MGA\\n\");}if(data.paid_amount){commands+=\"PAID: \".concat(parseFloat(data.paid_amount).toFixed(2),\" MGA\\n\");}if(data.remaining_amount){commands+=\"REMAINING: \".concat(parseFloat(data.remaining_amount).toFixed(2),\" MGA\\n\");}commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+='='.repeat(32)+'\\n';// Add footer\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='Generated by ______ANTATSIMO______ System\\n';commands+=\"User: \".concat(data.user_name||'System',\"\\n\");commands+=\"Print ID: \".concat(data.print_id||'N/A',\"\\n\");// Feed lines and cut paper\ncommands+=ESC_POS_COMMANDS.FEED_LINES(3);commands+=ESC_POS_COMMANDS.CUT_PAPER;return commands;};/**\n * Detect printer type based on user agent or settings\n * @returns {string} Printer type\n */export const detectPrinterType=()=>{// Check if running in a thermal printer environment\nif(typeof window!=='undefined'){const userAgent=window.navigator.userAgent.toLowerCase();// Check for Xprinter specific indicators\nif(userAgent.includes('xprinter')||userAgent.includes('thermal')||userAgent.includes('receipt')){return'THERMAL_80MM';// Xprinter 80mm\n}// Enhanced mobile detection\nconst isMobile=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent)||window.innerWidth<=768||'ontouchstart'in window||navigator.maxTouchPoints>0;// For mobile devices, still use 80mm for Xprinter compatibility\nif(isMobile){return'THERMAL_80MM';// Force 80mm for Xprinter compatibility\n}}// Default to 80mm thermal printer (Xprinter standard)\nreturn'THERMAL_80MM';};/**\n * Check if device supports modern printing APIs\n * @returns {boolean} True if modern printing is supported\n */export const supportsModernPrinting=()=>{if(typeof window==='undefined')return false;// Check for modern printing APIs\nreturn!!(window.navigator&&(window.navigator.share||window.print||window.matchMedia&&window.matchMedia('print')));};/**\n * Check if device is mobile\n * @returns {boolean} True if mobile device\n */export const isMobileDevice=()=>{if(typeof window==='undefined')return false;const userAgent=window.navigator.userAgent.toLowerCase();return /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent)||window.innerWidth<=768||'ontouchstart'in window||navigator.maxTouchPoints>0;};/**\n * Format text for thermal printer (truncate if too long)\n * @param {string} text - Text to format\n * @param {number} maxLength - Maximum length\n * @returns {string} Formatted text\n */export const formatForThermalPrinter=function(text){let maxLength=arguments.length>1&&arguments[1]!==undefined?arguments[1]:32;if(!text)return'';// Remove HTML tags\nconst cleanText=text.replace(/<[^>]*>/g,'');// Truncate if too long\nif(cleanText.length>maxLength){return cleanText.substring(0,maxLength-3)+'...';}return cleanText;};/**\n * Create a print-ready document with thermal printer compatibility\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @param {string} printerType - Printer type\n * @returns {string} HTML content\n */export const createThermalPrintDocument=function(data,title,type,t){let printerType=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;const detectedType=printerType||detectPrinterType();const css=generateThermalPrinterCSS(detectedType);const escPosCommands=generateESCPOSCommands(data,title);return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"utf-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1\\\">\\n      <style>\\n        \").concat(css,\"\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"header\\\">\\n        <h1>\").concat(formatForThermalPrinter(title,32),\"</h1>\\n        <div class=\\\"date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n        <div class=\\\"print-info\\\">ID: \").concat(data.print_id||'N/A',\"</div>\\n      </div>\\n      \\n      <div class=\\\"thermal-printer-commands\\\">\\n        <pre>\").concat(escPosCommands,\"</pre>\\n      </div>\\n      \\n      <div class=\\\"footer\\\">\\n        <p>______ANTATSIMO______ System</p>\\n        <p>Print ID: \").concat(data.print_id||'N/A',\"</p>\\n      </div>\\n    </body>\\n    </html>\\n  \");};/**\n * Generate ESC/POS commands for direct printer communication\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */export const generateESCPOSForReceiptApp=(data,title)=>{try{// Validate inputs\nif(!data||!title){console.error('Invalid data or title provided to generateESCPOSForReceiptApp');return'';}let commands='';// Initialize printer\ncommands+=ESC_POS_COMMANDS.XPRINTER_INIT;// Center and bold title\ncommands+=ESC_POS_COMMANDS.CENTER;commands+=ESC_POS_COMMANDS.BOLD_ON;commands+=ESC_POS_COMMANDS.DOUBLE_HEIGHT;commands+=title+'\\n';commands+=ESC_POS_COMMANDS.NORMAL_SIZE;commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+=ESC_POS_COMMANDS.FEED_LINE;// Add separator line\ncommands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.FEED_LINE;// Add document info\ncommands+=ESC_POS_COMMANDS.LEFT_ALIGN;commands+=\"Date: \".concat(new Date().toLocaleDateString(),\"\\n\");commands+=\"Time: \".concat(new Date().toLocaleTimeString(),\"\\n\");commands+=\"Print ID: \".concat(data.print_id||'N/A',\"\\n\");commands+=ESC_POS_COMMANDS.FEED_LINE;// Add sale info\nif(data.sale_number){commands+=\"Sale: \".concat(data.sale_number,\"\\n\");}if(data.customer_name){commands+=\"Customer: \".concat(data.customer_name,\"\\n\");}if(data.customer_phone){commands+=\"Phone: \".concat(data.customer_phone,\"\\n\");}commands+=ESC_POS_COMMANDS.FEED_LINE;commands+='-'.repeat(32)+'\\n';// Add items\nif(data.items&&Array.isArray(data.items)){commands+=ESC_POS_COMMANDS.BOLD_ON;commands+='ITEMS:\\n';commands+=ESC_POS_COMMANDS.BOLD_OFF;data.items.forEach(item=>{commands+=\"\".concat((item.product_name||'N/A').substring(0,25),\"\\n\");commands+=\"  Qty: \".concat(item.quantity_display||item.quantity||0,\" x \").concat(parseFloat(item.unit_price||0).toFixed(2),\"\\n\");commands+=\"  Total: \".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\\n\");commands+='\\n';});}// Add totals\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='='.repeat(32)+'\\n';commands+=ESC_POS_COMMANDS.BOLD_ON;if(data.total_amount){commands+=\"TOTAL: \".concat(parseFloat(data.total_amount).toFixed(2),\" MGA\\n\");}if(data.paid_amount){commands+=\"PAID: \".concat(parseFloat(data.paid_amount).toFixed(2),\" MGA\\n\");}if(data.remaining_amount&&data.remaining_amount>0){commands+=\"DUE: \".concat(parseFloat(data.remaining_amount).toFixed(2),\" MGA\\n\");}commands+=ESC_POS_COMMANDS.BOLD_OFF;commands+='='.repeat(32)+'\\n';// Add footer\ncommands+=ESC_POS_COMMANDS.FEED_LINE;commands+='Thank you for your business!\\n';commands+='______ANTATSIMO______ System\\n';commands+=\"Print ID: \".concat(data.print_id||'N/A',\"\\n\");// Feed lines and cut paper\ncommands+=ESC_POS_COMMANDS.XPRINTER_FEED;commands+=ESC_POS_COMMANDS.XPRINTER_CUT;return commands;}catch(error){console.error('Error generating ESC/POS commands:',error);return'';}};/**\n * Create downloadable file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} File content for download\n */export const createReceiptAppFile=(data,title)=>{const escPosCommands=generateESCPOSForReceiptApp(data,title);// Create a simple translation function for the HTML content\nconst simpleT=(key,fallback)=>fallback||key;const htmlContent=generateXprinterPrintContent(data,title,'sale',simpleT);// Create a combined file that works with receipt printer apps\nreturn\"# Receipt Printer App File\\n# Generated: \".concat(new Date().toISOString(),\"\\n# Title: \").concat(title,\"\\n\\n# ESC/POS Commands (for direct printer communication)\\n\").concat(escPosCommands,\"\\n\\n# HTML Content (for preview and fallback printing)\\n\").concat(htmlContent,\"\\n\\n# End of file\");};/**\n * Generate PDF content for receipt\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} PDF-ready HTML content\n */export const generatePDFContent=(data,title)=>{const isMobile=isMobileDevice();const width='80mm';// Standard for Xprinter\nconst fontSize='12px';const maxChars=32;return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n      <style>\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: \").concat(fontSize,\";\\n          line-height: 1.2;\\n          color: #000;\\n          width: \").concat(width,\";\\n          max-width: \").concat(width,\";\\n          margin: 0 auto;\\n          padding: 2mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: 14px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: 13px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: 11px;\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: 11px;\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 1px 3px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-size: 11px;\\n        }\\n        \\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n          max-width: 22ch;\\n        }\\n        \\n        .item-details {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: 10px;\\n          color: #555;\\n        }\\n        \\n        .receipt-totals {\\n          margin: 6px 0;\\n          padding-top: 4px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-weight: bold;\\n          font-size: 11px;\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 8px;\\n          padding-top: 4px;\\n          border-top: 1px dashed #000;\\n          font-size: 10px;\\n          color: #666;\\n        }\\n        \\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 1mm;\\n            width: \").concat(width,\";\\n          }\\n          \\n          @page {\\n            size: \").concat(width,\" auto;\\n            margin: 0;\\n          }\\n        }\\n        \\n        @media screen {\\n          body {\\n            border: 1px solid #ccc;\\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\\n          }\\n        }\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\">______ANTATSIMO______</div>\\n        <div class=\\\"document-title\\\">\").concat(title.toUpperCase(),\"</div>\\n        <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n      </div>\\n      \\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">SALE INFO</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale No:</span>\\n          <span>\").concat(data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Status:</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Customer:</span>\\n          <span>\").concat((data.customer_name||'Walk-in Customer').substring(0,22),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Phone:</span>\\n            <span>\".concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Peyment Status:</span>\\n          <span>\").concat(data.payment_status,\"</span>\\n        </div>\\n      </div>\\n      \\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">ITEMS</div>\\n        \").concat(data.items&&Array.isArray(data.items)?data.items.map(item=>\"\\n          <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,22),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity_display||item.quantity||0,\" x \").concat(parseFloat(item.unit_price||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat(item.total_price||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n      </div>\\n      \\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"total-row\\\">\\n          <span>Total:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"total-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"total-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n      </div>\\n      \\n      <div class=\\\"receipt-footer\\\">\\n        <div>Thank you for your business!</div>\\n        <div>Print ID: \").concat(data.print_id||'N/A',\"</div>\\n        <div>Created by: \").concat(data.created_by_name||data.sold_by_name||'N/A',\"</div>\\n      </div>\\n    </body>\\n    </html>\\n  \");};/**\n * Download PDF file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */export const downloadReceiptFile=(data,title)=>{try{// Validate inputs\nif(!data||!title){console.error('Invalid data or title provided to downloadReceiptFile');return false;}const pdfContent=generatePDFContent(data,title);if(!pdfContent){console.error('Failed to create PDF content');return false;}// Create a blob with HTML content that can be saved as PDF\nconst blob=new Blob([pdfContent],{type:'text/html'});const url=URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download=\"receipt_\".concat(data.sale_number||Date.now(),\".html\");link.style.display='none';document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(url);return true;}catch(error){console.error('Failed to download receipt file:',error);return false;}};/**\n * Mobile-friendly print function with fallbacks\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */export const mobilePrint=async function(printContent){let title=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Document';try{// Method 1: Try Web Share API with file (modern mobile browsers)\nif(navigator.share&&isMobileDevice()){try{// Create a blob with the content\nconst blob=new Blob([printContent],{type:'text/html'});const file=new File([blob],\"\".concat(title,\".html\"),{type:'text/html'});await navigator.share({title:title,text:'Print this receipt',files:[file]});return true;}catch(shareError){console.log('Web Share API with file failed, trying other methods:',shareError);}}// Method 2: Try direct window.print() on current page\nif(window.print&&!isMobileDevice()){// Create a temporary element with the content\nconst tempDiv=document.createElement('div');tempDiv.innerHTML=printContent;tempDiv.style.position='absolute';tempDiv.style.left='-9999px';tempDiv.style.top='-9999px';document.body.appendChild(tempDiv);// Replace body content temporarily\nconst originalBody=document.body.innerHTML;document.body.innerHTML=printContent;// Print\nwindow.print();// Restore original content\ndocument.body.innerHTML=originalBody;document.body.removeChild(tempDiv);return true;}// Method 3: Try popup window (with better error handling)\nreturn await openPrintWindow(printContent,title);}catch(error){console.error('All print methods failed:',error);return false;}};/**\n * Open print window with enhanced error handling\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */export const openPrintWindow=function(printContent){let title=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Document';return new Promise(resolve=>{try{// Enhanced window.open parameters for better mobile compatibility\nconst windowFeatures=isMobileDevice()?'width=400,height=600,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no':'width=900,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no';const printWindow=window.open('','_blank',windowFeatures);if(!printWindow){throw new Error('Popup blocked or window.open failed');}// Set window title\nprintWindow.document.title=title;// Write content to window\nprintWindow.document.write(printContent);printWindow.document.close();// Make sure window is visible and focused\nprintWindow.focus();// Wait for content to load and show the window\nconst showAndPrint=()=>{try{// Ensure window is visible\nprintWindow.focus();// Add a small delay to ensure content is rendered\nsetTimeout(()=>{try{// Show print dialog\nprintWindow.print();// Keep window open longer for user interaction\nsetTimeout(()=>{if(!printWindow.closed){// Ask user if they want to close the window\nif(window.confirm('Close the print preview window?')){printWindow.close();}}},5000);resolve(true);}catch(printError){console.error('Print failed:',printError);// Don't close window immediately, let user see the content\nresolve(false);}},500);}catch(error){console.error('Error in showAndPrint:',error);resolve(false);}};// Check if content is loaded\nif(printWindow.document.readyState==='complete'){showAndPrint();}else{printWindow.onload=showAndPrint;}// Fallback timeout - don't auto-close\nsetTimeout(()=>{if(!printWindow.closed){console.log('Print window timeout - window remains open for user interaction');}},30000);}catch(error){console.error('Failed to open print window:',error);resolve(false);}});};/**\n * Open print preview window (visible, doesn't auto-close)\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */export const openPrintPreview=function(printContent){let title=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Document';try{// Create a larger window for better visibility\nconst windowFeatures=isMobileDevice()?'width=500,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes':'width=1000,height=800,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes';const previewWindow=window.open('','_blank',windowFeatures);if(!previewWindow){throw new Error('Popup blocked or window.open failed');}// Set window title\npreviewWindow.document.title=\"\".concat(title,\" - Print Preview\");// Add print button and styling\nconst enhancedContent=\"\\n      <!DOCTYPE html>\\n      <html>\\n      <head>\\n        <title>\".concat(title,\" - Print Preview</title>\\n        <meta charset=\\\"UTF-8\\\">\\n        <style>\\n          body {\\n            margin: 0;\\n            padding: 20px;\\n            font-family: Arial, sans-serif;\\n            background: #f5f5f5;\\n          }\\n          .print-controls {\\n            position: fixed;\\n            top: 10px;\\n            right: 10px;\\n            background: white;\\n            padding: 10px;\\n            border-radius: 5px;\\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\n            z-index: 1000;\\n          }\\n          .print-controls button {\\n            margin: 5px;\\n            padding: 8px 16px;\\n            border: none;\\n            border-radius: 3px;\\n            cursor: pointer;\\n            font-size: 14px;\\n          }\\n          .print-btn {\\n            background: #007bff;\\n            color: white;\\n          }\\n          .close-btn {\\n            background: #6c757d;\\n            color: white;\\n          }\\n          .print-content {\\n            background: white;\\n            padding: 20px;\\n            border-radius: 5px;\\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\n            max-width: 800px;\\n            margin: 0 auto;\\n          }\\n        </style>\\n      </head>\\n      <body>\\n        <div class=\\\"print-controls\\\">\\n          <button class=\\\"print-btn\\\" onclick=\\\"window.print()\\\">\\uD83D\\uDDA8\\uFE0F Print</button>\\n          <button class=\\\"close-btn\\\" onclick=\\\"window.close()\\\">\\u274C Close</button>\\n        </div>\\n        <div class=\\\"print-content\\\">\\n          \").concat(printContent.replace('<!DOCTYPE html>','').replace('<html>','').replace('<head>','').replace('</head>','').replace('<body>','').replace('</body>','').replace('</html>',''),\"\\n        </div>\\n      </body>\\n      </html>\\n    \");// Write content to window\npreviewWindow.document.write(enhancedContent);previewWindow.document.close();// Focus the window\npreviewWindow.focus();return true;}catch(error){console.error('Failed to open print preview:',error);return false;}};/**\n * Generate Xprinter 80mm optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Xprinter-optimized HTML content\n */export const generateXprinterPrintContent=(data,title,type,t)=>{return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n      <style>\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: 12px;\\n          line-height: 1.2;\\n          color: #000;\\n          width: 80mm;\\n          max-width: 80mm;\\n          margin: 0 auto;\\n          padding: 2mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: 14px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: 13px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: 11px;\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: 11px;\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 1px 3px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-size: 11px;\\n        }\\n        \\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n          max-width: 22ch; /* 80mm = ~32 chars, leave space for price */\\n        }\\n        \\n        .item-details {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: 10px;\\n          color: #555;\\n        }\\n        \\n        .receipt-totals {\\n          margin: 6px 0;\\n          padding-top: 4px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-weight: bold;\\n          font-size: 11px;\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 8px;\\n          padding-top: 4px;\\n          border-top: 1px dashed #000;\\n          font-size: 10px;\\n          color: #666;\\n        }\\n        \\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 1mm;\\n            width: 80mm;\\n          }\\n          \\n          @page {\\n            size: 80mm auto;\\n            margin: 0;\\n          }\\n        }\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">________ANTATSIMO_______</div>\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"document-title\\\" style=\\\"text-align: center;\\\">SALE RECEIPT</div>\\n        <div class=\\\"receipt-date\\\" style=\\\"text-align: center;\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"section-title\\\">SALE INFO</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale No:</span>\\n          <span>\").concat(data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale Status:</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Customer:</span>\\n          <span>\").concat((data.customer_name||'Walk-in Customer').substring(0,25),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Phone:</span>\\n            <span>\".concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Peyment Status:</span>\\n          <span>\").concat(data.payment_status,\"</span>\\n        </div>\\n\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"no-data\\\">==================================================</div>\\n\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">ITEMS SOLD</div>    \\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"item-details\\\">\\n          <span>Info</span>\\n          <span>\\n            Qte\").concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n          </span>\\n        </div>\\n        <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div> \\n        \").concat(data.items&&Array.isArray(data.items)?data.items.map(item=>\"\\n          <div class=\\\"sale-item\\\">\\n            <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n            <div class=\\\"item-details\\\">\\n              <span>\\n                \").concat(\"(\".concat(item.unit_name,\")\").concat(parseFloat(item.unit_price||0).toFixed(2)).padEnd(26,'\\u00A0'),\"\\n                \").concat((item.quantity_display||item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                \").concat(parseFloat(item.total_price||0).toFixed(2).padStart(12,'\\u00A0'),\" MGA\\n              </span>\\n            </div>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n\\n      </div>      \\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"receipt-row\\\">\\n          <span>Subtotal:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-footer\\\">\\n        <div class=\\\"thank-you\\\">Thank you!</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Created by: \").concat(data.created_by_name||data.sold_by_name||'N/A',\"</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Print id : \").concat(data.print_id||'N/A',\"</div>\\n      </div>\\n    </body>\\n    </html>\\n  \");};/**\n * Generate mobile-optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Mobile-optimized HTML content\n */export const generateMobilePrintContent=(data,title,type,t)=>{const isMobile=isMobileDevice();const printerType=detectPrinterType();// Use smaller dimensions for mobile\nconst width=isMobile?'58mm':'80mm';const fontSize=isMobile?'10px':'12px';const maxChars=isMobile?24:32;return\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n      <style>\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: \").concat(fontSize,\";\\n          line-height: 1.2;\\n          color: #000;\\n          width: \").concat(width,\";\\n          max-width: \").concat(width,\";\\n          margin: 0 auto;\\n          padding: 2mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'12px':'14px',\";\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'11px':'13px',\";\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 6px;\\n          padding-bottom: 4px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 1px 3px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n        }\\n        \\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n          max-width: \").concat(maxChars-10,\"ch;\\n        }\\n        \\n        .item-details {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: \").concat(isMobile?'8px':'10px',\";\\n          color: #555;\\n        }\\n        \\n        .receipt-totals {\\n          margin: 6px 0;\\n          padding-top: 4px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 2px;\\n          font-weight: bold;\\n          font-size: \").concat(isMobile?'9px':'11px',\";\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 8px;\\n          padding-top: 4px;\\n          border-top: 1px dashed #000;\\n          font-size: \").concat(isMobile?'8px':'10px',\";\\n          color: #666;\\n        }\\n        \\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 1mm;\\n            width: \").concat(width,\";\\n          }\\n          \\n          @page {\\n            size: \").concat(width,\" auto;\\n            margin: 0;\\n          }\\n        }\\n      </style>\\n    </head>\\n    <body>\\n      <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">________ANTATSIMO_______</div>\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"document-title\\\" style=\\\"text-align: center;\\\">SALE RECEIPT</div>\\n        <div class=\\\"receipt-date\\\" style=\\\"text-align: center;\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"section-title\\\">SALE INFO</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale No:</span>\\n          <span>\").concat(data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale Status:</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Customer:</span>\\n          <span>\").concat((data.customer_name||'Walk-in Customer').substring(0,25),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Phone:</span>\\n            <span>\".concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Peyment Status:</span>\\n          <span>\").concat(data.payment_status,\"</span>\\n        </div>\\n\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n        <div class=\\\"no-data\\\">==================================================</div>\\n\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">ITEMS SOLD</div>             \\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"item-details\\\">\\n          <span>Info</span>\\n          <span>\\n            Qte\").concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n          </span>\\n        </div>\\n        <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div> \\n        \").concat(data.items&&Array.isArray(data.items)?data.items.map(item=>\"\\n          <div class=\\\"sale-item\\\">\\n            <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n            <div class=\\\"item-details\\\">\\n              <span>\\n                \").concat(\"(\".concat(item.unit_name,\")\").concat(parseFloat(item.unit_price||0).toFixed(2)).padEnd(26,'\\u00A0'),\"\\n                \").concat((item.quantity_display||item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                \").concat(parseFloat(item.total_price||0).toFixed(2).padStart(12,'\\u00A0'),\" MGA\\n              </span>\\n            </div>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n\\n      </div>        \\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"receipt-row\\\">\\n          <span>Subtotal:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">==================================================</</div>\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-footer\\\">\\n        <div class=\\\"thank-you\\\">Thank you!</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Created by: \").concat(data.created_by_name||data.sold_by_name||'N/A',\"</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Print id : \").concat(data.print_id||'N/A',\"</div>\\n      </div>\\n    </body>\\n    </html>\\n  \");};// Print content from print button\n// Helper functions for generating print content optimized for 80mm thermal printers\nconst generateInventoryContent=(data,t)=>{let products=data;if(!Array.isArray(data)){if(data.results&&Array.isArray(data.results)){products=data.results;}else if(data.data&&Array.isArray(data.data)){products=data.data;}else if(data.items&&Array.isArray(data.items)){products=data.items;}else{const numberedKeys=Object.keys(data).filter(key=>/^\\d+$/.test(key));if(numberedKeys.length>0){products=numberedKeys.map(key=>data[key]).filter(item=>item&&typeof item==='object');}else{products=[];}}}return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">\").concat(t('titles.inventory_summary','INVENTORY SUMMARY'),\"</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">SUMMARY</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Products:</span>\\n        <span>\").concat(Array.isArray(products)?products.length:0,\"</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">PRODUCTS</div>\\n      \").concat(Array.isArray(products)?products.map(item=>\"\\n        <div class=\\\"product-item\\\">\\n          <div class=\\\"product-name\\\">\".concat((item.name||'N/A').substring(0,20),\"</div>\\n          <div class=\\\"product-details\\\">\\n            <span>SKU: \").concat((item.sku||'N/A').substring(0,8),\"</span>\\n            <span>Qty: \").concat(item.stock_quantity||0,\"</span>\\n            <span>\").concat(parseFloat(item.price||0).toFixed(2),\" MGA</span>\\n          </div>\\n        </div>\\n      \")).join(''):'<div class=\"no-data\">No products found</div>',\"\\n      \").concat(Array.isArray(products)&&products.length>20?\"\\n        <div class=\\\"truncated-warning\\\">... and \".concat(products.length-20,\" more products</div>\\n      \"):'',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">\").concat(t('footer.generated_by','Generated by ______ANTATSIMO______ System'),\"</div>\\n    </div>\\n  \");};const generatePurchaseOrderContent=(data,t)=>{var _data$supplier;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">PURCHASE ORDER</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">ORDER INFO</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Order No:</span>\\n        <span>\").concat(data.order_number||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Supplier:</span>\\n        <span>\").concat((((_data$supplier=data.supplier)===null||_data$supplier===void 0?void 0:_data$supplier.name)||'N/A').substring(0,25),\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Date:</span>\\n        <span>\").concat(data.order_date?new Date(data.order_date).toLocaleDateString():'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Status:</span>\\n        <span>\").concat(data.status||'N/A',\"</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">ITEMS</div>\\n      \").concat(data.items?data.items.map(item=>{var _item$product;return\"\\n        <div class=\\\"order-item\\\">\\n          <div class=\\\"item-name\\\">\".concat((((_item$product=item.product)===null||_item$product===void 0?void 0:_item$product.name)||'N/A').substring(0,25),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity_ordered||0,\" x \").concat(parseFloat(item.unit_cost||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat((item.quantity_ordered||0)*(item.unit_cost||0)).toFixed(2),\" MGA</span>\\n          </div>\\n        </div>\\n      \");}).join(''):'<div class=\"no-data\">No items found</div>',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-total\\\">\\n      <div class=\\\"total-row\\\">\\n        <span>TOTAL AMOUNT:</span>\\n        <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">End of Purchase Order</div>\\n    </div>\\n  \");};const generateDeliveryContent=(data,t)=>{var _data$purchase_order;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">DELIVERY RECEIPT</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">DELIVERY INFO</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Delivery No:</span>\\n        <span>\").concat(data.delivery_number||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>PO Number:</span>\\n        <span>\").concat(((_data$purchase_order=data.purchase_order)===null||_data$purchase_order===void 0?void 0:_data$purchase_order.order_number)||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Date:</span>\\n        <span>\").concat(data.delivery_date?new Date(data.delivery_date).toLocaleDateString():'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Status:</span>\\n        <span>\").concat(data.status||'N/A',\"</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">ITEMS RECEIVED</div>\\n      \").concat(data.items?data.items.map(item=>{var _item$product2;return\"\\n        <div class=\\\"delivery-item\\\">\\n          <div class=\\\"item-name\\\">\".concat((item.product_name||((_item$product2=item.product)===null||_item$product2===void 0?void 0:_item$product2.name)||'N/A').substring(0,25),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity_received||item.delivered_quantity||0,\" x \").concat(parseFloat(item.unit_cost||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat((item.quantity_received||item.delivered_quantity||0)*(item.unit_cost||0)).toFixed(2),\" MGA</span>\\n          </div>\\n        </div>\\n      \");}).join(''):'<div class=\"no-data\">No items found</div>',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-total\\\">\\n      <div class=\\\"total-row\\\">\\n        <span>TOTAL AMOUNT:</span>\\n        <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Delivery completed</div>\\n    </div>\\n  \");};const generateSaleContent=(data,t)=>{let items=data.items;if(!items){const numberedKeys=Object.keys(data).filter(key=>/^\\d+$/.test(key));if(numberedKeys.length>0){items=numberedKeys.map(key=>data[key]).filter(item=>item&&typeof item==='object');}}const paymentStatusText=data.payment_status==='paid'?'PAID':data.payment_status==='partial'?'PARTIAL':data.payment_status==='pending'?'PENDING':'UNKNOWN';console.log(data);return\"\\n    <div class=\\\"receipt-header\\\">\\n        <div class=\\\"company-name\\\" style=\\\"text-align: center;\\\">________ANTATSIMO_______</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"no-data\\\">\".concat('\\u00A0',\"</div>\\n        <div class=\\\"section-title\\\">SALE INFO</div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale No:</span>\\n          <span>\",data.sale_number||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Sale Status:</span>\\n          <span>\").concat(data.status||'N/A',\"</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Customer:</span>\\n          <span>\").concat((data.customer_name||'Walk-in Customer').substring(0,25),\"</span>\\n        </div>\\n        \").concat(data.customer_phone?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Phone:</span>\\n            <span>\".concat(data.customer_phone,\"</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Peyment Status:</span>\\n          <span>\").concat(paymentStatusText,\"</span>\\n        </div>\\n\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-section\\\">\\n        <div class=\\\"section-title\\\">ITEMS SOLD</div>    \\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"item-details\\\">\\n          <span>Info</span>\\n          <span>\\n            Qte\").concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n          </span>\\n        </div>\\n      \\n        \").concat(items&&Array.isArray(items)?items.map(item=>\"\\n          <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div>         \\n          <div class=\\\"sale-item\\\">\\n            <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n            <div class=\\\"item-details\\\">\\n              <span>\\n                \").concat(\"(\".concat(item.unit_name,\")\").concat(parseFloat(item.unit_price||0).toFixed(2)).padEnd(26,'\\u00A0'),\"\\n                \").concat((item.quantity_display||item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                \").concat(parseFloat(item.total_price||0).toFixed(2).padStart(12,'\\u00A0'),\" MGA\\n              </span>\\n            </div>\\n          </div>\\n        \")).join(''):'<div class=\"no-data\">No items found</div>',\"\\n\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n      </div>\\n      \").concat(data.packaging_items&&data.packaging_items.length>0?\"\\n        <div class=\\\"receipt-section\\\">\\n          <div class=\\\"section-title\\\">PACKAGINGS</div>    \\n          <div class=\\\"no-data\\\">__________________________________________________</div>\\n          <div class=\\\"item-details\\\">\\n            <span>Info</span>\\n            <span>\\n              Qte\".concat('\\u00A0'.repeat(10),\"Total\").concat('\\u00A0'.repeat(2),\"\\n            </span>\\n          </div>\\n        \\n          \").concat(data.packaging_items.map(item=>{let unitPriceDisplay,totalPriceDisplay;if(item.status==='consignation'){unitPriceDisplay=\"\".concat(parseFloat(item.unit_price||0).toFixed(2));totalPriceDisplay=\"\".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\");}else if(item.status==='exchange'){unitPriceDisplay='0.00';totalPriceDisplay='0.00 MGA';}else if(item.status==='due'){unitPriceDisplay='DUE';totalPriceDisplay='DUE';}else{unitPriceDisplay=\"\".concat(parseFloat(item.unit_price||0).toFixed(2));totalPriceDisplay=\"\".concat(parseFloat(item.total_price||0).toFixed(2),\" MGA\");}return\"\\n            <div class=\\\"no-data\\\">\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF\\xAF</div>         \\n            <div class=\\\"packaging-item\\\">\\n              <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\" </div>\\n              <div class=\\\"item-details\\\">\\n                <span>\\n                  \").concat(unitPriceDisplay.padEnd(26,'\\u00A0'),\"\\n                  \").concat((item.quantity||0).toString().padStart(3,'\\u00A0'),\"\\n                  \").concat(totalPriceDisplay.padStart(12,'\\u00A0'),\"\\n                </span>\\n              </div>\\n            </div>\\n          \");}).join(''),\"\\n\\n          <div class=\\\"no-data\\\">__________________________________________________</div>\\n        </div>\\n      \"):'',\"\\n      <div class=\\\"receipt-totals\\\">\\n        <div class=\\\"receipt-row\\\">\\n          <span>Subtotal:</span>\\n          <span>\").concat(parseFloat(data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.packaging_total&&data.packaging_total>0?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Packagings:</span>\\n            <span>\".concat(parseFloat(data.packaging_total||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Total:</span>\\n          <span>\").concat(parseFloat(data.grand_total||data.total_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        <div class=\\\"receipt-row\\\">\\n          <span>Paid:</span>\\n          <span>\").concat(parseFloat(data.paid_amount||0).toFixed(2),\" MGA</span>\\n        </div>\\n        \").concat(data.payment_status==='partial'?\"\\n          <div class=\\\"receipt-row\\\">\\n            <span>Due:</span>\\n            <span>\".concat(parseFloat(data.remaining_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n        \"):'',\"\\n        <div class=\\\"no-data\\\">__________________________________________________</div>\\n        <div class=\\\"no-data\\\">\",'\\u00A0',\"</div>\\n      </div>\\n      <div class=\\\"receipt-footer\\\">\\n        <div class=\\\"thank-you\\\">Thank you!</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Created by: \").concat(data.created_by_name||data.sold_by_name||data.user_name||'N/A',\" -- \").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n        <div class=\\\"footer-text\\\" style=\\\"text-align: center;\\\">Print id : \").concat(data.print_id||'N/A',\"</div>\\n      </div>\\n  \");};const generateSalesHistoryContent=(data,t)=>{let sales=data;if(!Array.isArray(data)){if(data.results&&Array.isArray(data.results)){sales=data.results;}else if(data.data&&Array.isArray(data.data)){sales=data.data;}else if(data.items&&Array.isArray(data.items)){sales=data.items;}else{const numberedKeys=Object.keys(data).filter(key=>/^\\d+$/.test(key));if(numberedKeys.length>0){sales=numberedKeys.map(key=>data[key]).filter(item=>item&&typeof item==='object');}else{sales=[];}}}const totalRevenue=Array.isArray(sales)?sales.reduce((sum,sale)=>sum+parseFloat(sale.total_amount||0),0):0;return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">SALES REPORT</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">SUMMARY</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Sales:</span>\\n        <span>\").concat(Array.isArray(sales)?sales.length:0,\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Revenue:</span>\\n        <span>\").concat(totalRevenue.toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">RECENT SALES</div>\\n      \").concat(Array.isArray(sales)?sales.map(sale=>\"\\n        <div class=\\\"sale-summary\\\">\\n          <div class=\\\"sale-info\\\">\\n            <span>\".concat(sale.sale_number||'N/A',\"</span>\\n            <span>\").concat(parseFloat(sale.total_amount||0).toFixed(2),\" MGA</span>\\n          </div>\\n          <div class=\\\"sale-details\\\">\\n            <span>\").concat((sale.customer_name||t('customer.walk_in','Walk-in')).substring(0,15),\"</span>\\n            <span>\").concat(sale.created_at?new Date(sale.created_at).toLocaleDateString():'N/A',\"</span>\\n          </div>\\n        </div>\\n      \")).join(''):'<div class=\"no-data\">No sales data</div>',\"\\n      \").concat(Array.isArray(sales)&&sales.length>20?\"\\n        <div class=\\\"truncated-warning\\\">... and \".concat(sales.length-20,\" more sales</div>\\n      \"):'',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Sales report generated</div>\\n    </div>\\n  \");};const generatePackagingValidationContent=(data,t)=>{return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">PACKAGING VALIDATION</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">VALIDATION INFO</div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Sale No:</span>\\n        <span>\").concat(data.sale_number||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Status:</span>\\n        <span>\").concat(data.status||'N/A',\"</span>\\n      </div>\\n      <div class=\\\"receipt-row\\\">\\n        <span>Customer:</span>\\n        <span>\").concat((data.customer_name||t('customer.walk_in','Walk-in Customer')).substring(0,25),\"</span>\\n      </div>\\n      \").concat(data.customer_phone?\"\\n        <div class=\\\"receipt-row\\\">\\n          <span>Phone:</span>\\n          <span>\".concat(data.customer_phone,\"</span>\\n        </div>\\n      \"):'',\"\\n      <div class=\\\"receipt-row\\\">\\n        <span>Total Items:</span>\\n        <span>\").concat(data.packaging_items?data.packaging_items.length:0,\"</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">PACKAGING ITEMS</div>\\n      \").concat(data.packaging_items&&Array.isArray(data.packaging_items)?data.packaging_items.map(item=>\"\\n        <div class=\\\"packaging-item\\\">\\n          <div class=\\\"item-name\\\">\".concat((item.product_name||'N/A').substring(0,25),\"</div>\\n          <div class=\\\"item-details\\\">\\n            <span>\").concat(item.quantity||0,\" x \").concat(parseFloat(item.unit_price||0).toFixed(2),\"</span>\\n            <span>\").concat(parseFloat(item.total_price||0).toFixed(2),\" MGA</span>\\n            <span class=\\\"status-\").concat(item.status,\"\\\">\").concat(item.status==='consignation'?'PAID':item.status==='exchange'?'EXCH':item.status==='due'?'DUE':item.status,\"</span>\\n          </div>\\n        </div>\\n      \")).join(''):'<div class=\"no-data\">No packaging items</div>',\"\\n    </div>\\n    \\n    <div class=\\\"receipt-total\\\">\\n      <div class=\\\"total-row\\\">\\n        <span>PACKAGING TOTAL:</span>\\n        <span>\").concat(parseFloat(data.packaging_total||0).toFixed(2),\" MGA</span>\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Packaging validation completed</div>\\n    </div>\\n  \");};const generateDefaultContent=(data,t)=>{return\"\\n    <div class=\\\"receipt-header\\\">\\n      <div class=\\\"company-name\\\">\".concat(t('company.name','______ANTATSIMO______'),\"</div>\\n      <div class=\\\"document-title\\\">DOCUMENT</div>\\n      <div class=\\\"receipt-date\\\">\").concat(new Date().toLocaleDateString(),\" \").concat(new Date().toLocaleTimeString(),\"</div>\\n    </div>\\n    \\n    <div class=\\\"receipt-section\\\">\\n      <div class=\\\"section-title\\\">CONTENT</div>\\n      <div class=\\\"default-content\\\">\\n        Document generated successfully\\n      </div>\\n    </div>\\n    \\n    <div class=\\\"receipt-footer\\\">\\n      <div class=\\\"footer-text\\\">Document printed</div>\\n    </div>\\n  \");};// Export the generatePrintContent function\nexport const generatePrintContent=(data,title,type,t)=>{const currentDate=new Date().toLocaleDateString();const currentTime=new Date().toLocaleTimeString();let content=\"\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <title>\".concat(title,\"</title>\\n      <meta charset=\\\"UTF-8\\\">\\n      <style>\\n        /* 80mm Thermal Printer Receipt Styles */\\n        * {\\n          margin: 0;\\n          padding: 0;\\n          box-sizing: border-box;\\n        }\\n        \\n        body {\\n          font-family: 'Courier New', Courier, monospace;\\n          font-size: 12px;\\n          line-height: 1.2;\\n          color: #000;\\n          width: 80mm;\\n          max-width: 80mm;\\n          margin: 0 auto;\\n          padding: 3mm;\\n          background: white;\\n        }\\n        \\n        .receipt-header {\\n          text-align: center;\\n          margin-bottom: 8px;\\n          padding-bottom: 6px;\\n          border-bottom: 1px dashed #000;\\n        }\\n        \\n        .company-name {\\n          font-weight: bold;\\n          font-size: 14px;\\n          margin-bottom: 2px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .document-title {\\n          font-weight: bold;\\n          font-size: 13px;\\n          margin-bottom: 3px;\\n          text-transform: uppercase;\\n        }\\n        \\n        .receipt-date {\\n          font-size: 11px;\\n          color: #555;\\n        }\\n        \\n        .receipt-section {\\n          margin-bottom: 8px;\\n          padding-bottom: 6px;\\n          border-bottom: 1px dotted #ccc;\\n        }\\n        \\n        .section-title {\\n          font-weight: bold;\\n          font-size: 11px;\\n          margin-bottom: 4px;\\n          text-transform: uppercase;\\n          background: #f0f0f0;\\n          padding: 2px 4px;\\n        }\\n        \\n        .receipt-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 3px;\\n          font-size: 11px;\\n        }\\n        \\n        .product-item,\\n        .order-item,\\n        .delivery-item,\\n        .sale-item,\\n        .packaging-item,\\n        .sale-summary {\\n          margin-bottom: 4px;\\n          padding: 2px 0;\\n        }\\n        \\n        .product-name,\\n        .item-name {\\n          font-weight: bold;\\n          margin-bottom: 1px;\\n          word-wrap: break-word;\\n        }\\n        \\n        .product-details,\\n        .item-details,\\n        .sale-info {\\n          display: flex;\\n          justify-content: space-between;\\n          font-size: 10px;\\n          color: #555;\\n        }\\n        \\n        .receipt-totals,\\n        .receipt-total {\\n          margin: 8px 0;\\n          padding-top: 6px;\\n          border-top: 2px solid #000;\\n        }\\n        \\n        .total-row {\\n          display: flex;\\n          justify-content: space-between;\\n          margin-bottom: 3px;\\n          font-weight: bold;\\n        }\\n        \\n        .due-amount {\\n          color: #d00;\\n        }\\n        \\n        .no-data {\\n          text-align: center;\\n          color: #888;\\n          font-style: italic;\\n          padding: 8px 0;\\n        }\\n        \\n        .truncated-warning {\\n          text-align: center;\\n          color: #888;\\n          font-size: 10px;\\n          font-style: italic;\\n          margin-top: 4px;\\n        }\\n        \\n        .thank-you {\\n          text-align: center;\\n          font-weight: bold;\\n          margin: 6px 0;\\n        }\\n        \\n        .receipt-footer {\\n          text-align: center;\\n          margin-top: 10px;\\n          padding-top: 6px;\\n          border-top: 1px dashed #000;\\n          font-size: 10px;\\n          color: #666;\\n        }\\n        \\n        .footer-text {\\n          margin-bottom: 2px;\\n        }\\n        \\n        .status-consignation { color: #090; }\\n        .status-exchange { color: #009; }\\n        .status-due { color: #d00; font-weight: bold; }\\n        \\n        /* Print-specific styles */\\n        @media print {\\n          body {\\n            margin: 0;\\n            padding: 2mm;\\n            width: 80mm;\\n          }\\n          \\n          .no-print {\\n            display: none;\\n          }\\n          \\n          /* Ensure proper sizing for thermal paper */\\n          @page {\\n            size: 80mm auto;\\n            margin: 0;\\n          }\\n        }\\n        \\n        /* Force monospace and proper breaking */\\n        * {\\n          font-family: 'Courier New', Courier, monospace !important;\\n        }\\n        \\n        .default-content {\\n          text-align: center;\\n          padding: 10px 0;\\n          color: #666;\\n        }\\n      </style>\\n    </head>\\n    <body>\\n  \");// Add type-specific content\nswitch(type){case'inventory':content+=generateInventoryContent(data,t);break;case'purchase_order':content+=generatePurchaseOrderContent(data,t);break;case'delivery':content+=generateDeliveryContent(data,t);break;case'sale':content+=generateSaleContent(data,t);break;case'sales_history':content+=generateSalesHistoryContent(data,t);break;case'packaging_validation':content+=generatePackagingValidationContent(data,t);break;default:content+=generateDefaultContent(data,t);}content+=\"\\n    </body>\\n    </html>\\n  \";return content;};","map":{"version":3,"names":["ESC_POS_COMMANDS","INITIALIZE","CENTER","LEFT_ALIGN","RIGHT_ALIGN","BOLD_ON","BOLD_OFF","DOUBLE_HEIGHT","NORMAL_SIZE","CUT_PAPER","FEED_LINE","FEED_LINES","n","concat","String","fromCharCode","UNDERLINE_ON","UNDERLINE_OFF","REVERSE_ON","REVERSE_OFF","XPRINTER_INIT","XPRINTER_CUT","XPRINTER_FEED","XPRINTER_BEEP","PRINTER_CONFIGS","THERMAL_80MM","width","maxChars","fontSize","lineHeight","margins","THERMAL_58MM","STANDARD_A4","generateThermalPrinterCSS","printerType","arguments","length","undefined","config","generateESCPOSCommands","data","title","commands","repeat","Date","toLocaleDateString","toLocaleTimeString","print_id","sale_number","customer_name","customer_phone","items","Array","isArray","forEach","item","product_name","quantity","unit_name","parseFloat","unit_price","toFixed","total_price","packaging_items","status","total_amount","packaging_total","paid_amount","remaining_amount","user_name","detectPrinterType","window","userAgent","navigator","toLowerCase","includes","isMobile","test","innerWidth","maxTouchPoints","supportsModernPrinting","share","print","matchMedia","isMobileDevice","formatForThermalPrinter","text","maxLength","cleanText","replace","substring","createThermalPrintDocument","type","t","detectedType","css","escPosCommands","generateESCPOSForReceiptApp","console","error","quantity_display","createReceiptAppFile","simpleT","key","fallback","htmlContent","generateXprinterPrintContent","toISOString","generatePDFContent","toUpperCase","payment_status","map","join","created_by_name","sold_by_name","downloadReceiptFile","pdfContent","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","now","style","display","body","appendChild","click","removeChild","revokeObjectURL","mobilePrint","printContent","file","File","files","shareError","log","tempDiv","innerHTML","position","left","top","originalBody","openPrintWindow","Promise","resolve","windowFeatures","printWindow","open","Error","write","close","focus","showAndPrint","setTimeout","closed","confirm","printError","readyState","onload","openPrintPreview","previewWindow","enhancedContent","padEnd","toString","padStart","generateMobilePrintContent","generateInventoryContent","products","results","numberedKeys","Object","keys","filter","name","sku","stock_quantity","price","generatePurchaseOrderContent","_data$supplier","order_number","supplier","order_date","_item$product","product","quantity_ordered","unit_cost","generateDeliveryContent","_data$purchase_order","delivery_number","purchase_order","delivery_date","_item$product2","quantity_received","delivered_quantity","generateSaleContent","paymentStatusText","unitPriceDisplay","totalPriceDisplay","grand_total","generateSalesHistoryContent","sales","totalRevenue","reduce","sum","sale","created_at","generatePackagingValidationContent","generateDefaultContent","generatePrintContent","currentDate","currentTime","content"],"sources":["/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/src/utils/printUtils.js"],"sourcesContent":["/**\n * Print utilities for thermal receipt printer compatibility\n * Supports 80mm and 58mm thermal printers with ESC/POS commands\n */\n\n// ESC/POS Commands for thermal printers (Xprinter 80mm compatible)\nexport const ESC_POS_COMMANDS = {\n  INITIALIZE: '\\x1B\\x40',           // Initialize printer\n  CENTER: '\\x1B\\x61\\x01',          // Center text\n  LEFT_ALIGN: '\\x1B\\x61\\x00',      // Left align text\n  RIGHT_ALIGN: '\\x1B\\x61\\x02',     // Right align text\n  BOLD_ON: '\\x1B\\x45\\x01',         // Bold on\n  BOLD_OFF: '\\x1B\\x45\\x00',        // Bold off\n  DOUBLE_HEIGHT: '\\x1B\\x21\\x10',   // Double height\n  NORMAL_SIZE: '\\x1B\\x21\\x00',     // Normal size\n  CUT_PAPER: '\\x1D\\x56\\x00',       // Cut paper\n  FEED_LINE: '\\x0A',               // Feed line\n  FEED_LINES: (n) => `\\x1B\\x64${String.fromCharCode(n)}`, // Feed n lines\n  UNDERLINE_ON: '\\x1B\\x2D\\x01',    // Underline on\n  UNDERLINE_OFF: '\\x1B\\x2D\\x00',   // Underline off\n  REVERSE_ON: '\\x1D\\x42\\x01',      // Reverse on\n  REVERSE_OFF: '\\x1D\\x42\\x00',     // Reverse off\n  // Xprinter specific commands\n  XPRINTER_INIT: '\\x1B\\x40',       // Xprinter initialization\n  XPRINTER_CUT: '\\x1D\\x56\\x42\\x00', // Xprinter cut paper\n  XPRINTER_FEED: '\\x1B\\x64\\x03',   // Xprinter feed 3 lines\n  XPRINTER_BEEP: '\\x1B\\x42\\x01\\x01', // Xprinter beep\n};\n\n// Printer configurations\nexport const PRINTER_CONFIGS = {\n  THERMAL_80MM: {\n    width: '80mm',\n    maxChars: 32,\n    fontSize: 12,\n    lineHeight: 1.2,\n    margins: '5mm'\n  },\n  THERMAL_58MM: {\n    width: '58mm',\n    maxChars: 24,\n    fontSize: 10,\n    lineHeight: 1.1,\n    margins: '3mm'\n  },\n  STANDARD_A4: {\n    width: '210mm',\n    maxChars: 80,\n    fontSize: 14,\n    lineHeight: 1.4,\n    margins: '20mm'\n  }\n};\n\n/**\n * Generate CSS for thermal printer compatibility\n * @param {string} printerType - Type of printer (THERMAL_80MM, THERMAL_58MM, STANDARD_A4)\n * @returns {string} CSS styles\n */\nexport const generateThermalPrinterCSS = (printerType = 'THERMAL_80MM') => {\n  const config = PRINTER_CONFIGS[printerType];\n  \n  return `\n    @media print {\n      @page {\n        size: ${config.width} auto;\n        margin: ${config.margins};\n      }\n      \n      body { \n        margin: 0; \n        font-size: ${config.fontSize}px;\n        line-height: ${config.lineHeight};\n        font-family: 'Courier New', monospace;\n        max-width: ${config.width};\n      }\n      \n      .header h1 { \n        font-size: ${config.fontSize + 6}px; \n        margin-bottom: 5px;\n        text-align: center;\n      }\n      \n      .header .date, .header .print-info { \n        font-size: ${config.fontSize - 2}px; \n        text-align: center;\n      }\n      \n      .info-section { \n        padding: 8px; \n        margin-bottom: 10px; \n        border: 1px solid #000;\n      }\n      \n      .info-section h3 { \n        font-size: ${config.fontSize + 2}px; \n        margin-bottom: 5px;\n        text-align: center;\n        font-weight: bold;\n      }\n      \n      .info-row { \n        margin-bottom: 3px; \n        font-size: ${config.fontSize - 1}px;\n        display: flex;\n        justify-content: space-between;\n      }\n      \n      table { \n        width: 100%;\n        font-size: ${config.fontSize - 2}px; \n        border-collapse: collapse;\n      }\n      \n      th, td { \n        padding: 2px; \n        font-size: ${config.fontSize - 2}px;\n        border: 1px solid #000;\n        text-align: left;\n      }\n      \n      th { \n        background-color: #f0f0f0;\n        font-weight: bold;\n        text-align: center;\n      }\n      \n      .total-row { \n        font-weight: bold; \n        background-color: #e0e0e0; \n      }\n      \n      .footer { \n        font-size: ${config.fontSize - 3}px; \n        margin-top: 15px; \n        text-align: center;\n        border-top: 1px solid #000;\n        padding-top: 5px;\n      }\n      \n      .thermal-printer-commands {\n        display: block;\n        font-family: monospace;\n        font-size: 8px;\n        color: #666;\n        margin-top: 5px;\n        text-align: center;\n      }\n      \n      /* Hide elements not suitable for thermal printing */\n      .no-print, .print-button, .button, .btn {\n        display: none !important;\n      }\n    }\n  `;\n};\n\n/**\n * Generate ESC/POS commands for thermal printer\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */\nexport const generateESCPOSCommands = (data, title) => {\n  let commands = '';\n  \n  // Initialize printer\n  commands += ESC_POS_COMMANDS.INITIALIZE;\n  \n  // Center and bold title\n  commands += ESC_POS_COMMANDS.CENTER;\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  commands += ESC_POS_COMMANDS.DOUBLE_HEIGHT;\n  commands += title + '\\n';\n  commands += ESC_POS_COMMANDS.NORMAL_SIZE;\n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add separator line\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add document info\n  commands += ESC_POS_COMMANDS.LEFT_ALIGN;\n  commands += `Date: ${new Date().toLocaleDateString()}\\n`;\n  commands += `Time: ${new Date().toLocaleTimeString()}\\n`;\n  commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add content based on type\n  if (data.sale_number) {\n    commands += `Sale: ${data.sale_number}\\n`;\n  }\n  if (data.customer_name) {\n    commands += `Customer: ${data.customer_name}\\n`;\n  }\n  if (data.customer_phone) {\n    commands += `Phone: ${data.customer_phone}\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '-'.repeat(32) + '\\n';\n  \n  // Add items if present\n  if (data.items && Array.isArray(data.items)) {\n    commands += ESC_POS_COMMANDS.BOLD_ON;\n    commands += 'ITEMS:\\n';\n    commands += ESC_POS_COMMANDS.BOLD_OFF;\n    \n    data.items.forEach(item => {\n      commands += `${item.product_name || 'N/A'}\\n`;\n      commands += `  Qty: ${item.quantity || 0} ${item.unit_name || 'pcs'}\\n`;\n      commands += `  Price: ${parseFloat(item.unit_price || 0).toFixed(2)} MGA\\n`;\n      commands += `  Total: ${parseFloat(item.total_price || 0).toFixed(2)} MGA\\n`;\n      commands += '\\n';\n    });\n  }\n  \n  // Add packaging items if present\n  if (data.packaging_items && Array.isArray(data.packaging_items)) {\n    commands += ESC_POS_COMMANDS.BOLD_ON;\n    commands += 'PACKAGING:\\n';\n    commands += ESC_POS_COMMANDS.BOLD_OFF;\n    \n    data.packaging_items.forEach(item => {\n      commands += `${item.product_name || 'N/A'}\\n`;\n      commands += `  Qty: ${item.quantity || 0} ${item.unit_name || 'pcs'}\\n`;\n      commands += `  Price: ${parseFloat(item.unit_price || 0).toFixed(2)} MGA\\n`;\n      commands += `  Total: ${parseFloat(item.total_price || 0).toFixed(2)} MGA\\n`;\n      commands += `  Status: ${item.status || 'N/A'}\\n`;\n      commands += '\\n';\n    });\n  }\n  \n  // Add totals\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  \n  if (data.total_amount) {\n    commands += `TOTAL: ${parseFloat(data.total_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.packaging_total) {\n    commands += `PACKAGING: ${parseFloat(data.packaging_total).toFixed(2)} MGA\\n`;\n  }\n  if (data.paid_amount) {\n    commands += `PAID: ${parseFloat(data.paid_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.remaining_amount) {\n    commands += `REMAINING: ${parseFloat(data.remaining_amount).toFixed(2)} MGA\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += '='.repeat(32) + '\\n';\n  \n  // Add footer\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += 'Generated by ______ANTATSIMO______ System\\n';\n  commands += `User: ${data.user_name || 'System'}\\n`;\n  commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  \n  // Feed lines and cut paper\n  commands += ESC_POS_COMMANDS.FEED_LINES(3);\n  commands += ESC_POS_COMMANDS.CUT_PAPER;\n  \n  return commands;\n};\n\n/**\n * Detect printer type based on user agent or settings\n * @returns {string} Printer type\n */\nexport const detectPrinterType = () => {\n  // Check if running in a thermal printer environment\n  if (typeof window !== 'undefined') {\n    const userAgent = window.navigator.userAgent.toLowerCase();\n    \n    // Check for Xprinter specific indicators\n    if (userAgent.includes('xprinter') || userAgent.includes('thermal') || userAgent.includes('receipt')) {\n      return 'THERMAL_80MM'; // Xprinter 80mm\n    }\n    \n    // Enhanced mobile detection\n    const isMobile = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent) ||\n                     (window.innerWidth <= 768) ||\n                     ('ontouchstart' in window) ||\n                     (navigator.maxTouchPoints > 0);\n    \n    // For mobile devices, still use 80mm for Xprinter compatibility\n    if (isMobile) {\n      return 'THERMAL_80MM'; // Force 80mm for Xprinter compatibility\n    }\n  }\n  \n  // Default to 80mm thermal printer (Xprinter standard)\n  return 'THERMAL_80MM';\n};\n\n/**\n * Check if device supports modern printing APIs\n * @returns {boolean} True if modern printing is supported\n */\nexport const supportsModernPrinting = () => {\n  if (typeof window === 'undefined') return false;\n  \n  // Check for modern printing APIs\n  return !!(window.navigator && (\n    window.navigator.share ||\n    window.print ||\n    (window.matchMedia && window.matchMedia('print'))\n  ));\n};\n\n/**\n * Check if device is mobile\n * @returns {boolean} True if mobile device\n */\nexport const isMobileDevice = () => {\n  if (typeof window === 'undefined') return false;\n  \n  const userAgent = window.navigator.userAgent.toLowerCase();\n  return /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent) ||\n         (window.innerWidth <= 768) ||\n         ('ontouchstart' in window) ||\n         (navigator.maxTouchPoints > 0);\n};\n\n/**\n * Format text for thermal printer (truncate if too long)\n * @param {string} text - Text to format\n * @param {number} maxLength - Maximum length\n * @returns {string} Formatted text\n */\nexport const formatForThermalPrinter = (text, maxLength = 32) => {\n  if (!text) return '';\n  \n  // Remove HTML tags\n  const cleanText = text.replace(/<[^>]*>/g, '');\n  \n  // Truncate if too long\n  if (cleanText.length > maxLength) {\n    return cleanText.substring(0, maxLength - 3) + '...';\n  }\n  \n  return cleanText;\n};\n\n/**\n * Create a print-ready document with thermal printer compatibility\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @param {string} printerType - Printer type\n * @returns {string} HTML content\n */\nexport const createThermalPrintDocument = (data, title, type, t, printerType = null) => {\n  const detectedType = printerType || detectPrinterType();\n  const css = generateThermalPrinterCSS(detectedType);\n  const escPosCommands = generateESCPOSCommands(data, title);\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"utf-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n      <style>\n        ${css}\n      </style>\n    </head>\n    <body>\n      <div class=\"header\">\n        <h1>${formatForThermalPrinter(title, 32)}</h1>\n        <div class=\"date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n        <div class=\"print-info\">ID: ${data.print_id || 'N/A'}</div>\n      </div>\n      \n      <div class=\"thermal-printer-commands\">\n        <pre>${escPosCommands}</pre>\n      </div>\n      \n      <div class=\"footer\">\n        <p>______ANTATSIMO______ System</p>\n        <p>Print ID: ${data.print_id || 'N/A'}</p>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n/**\n * Generate ESC/POS commands for direct printer communication\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} ESC/POS formatted string\n */\nexport const generateESCPOSForReceiptApp = (data, title) => {\n  try {\n    // Validate inputs\n    if (!data || !title) {\n      console.error('Invalid data or title provided to generateESCPOSForReceiptApp');\n      return '';\n    }\n    \n    let commands = '';\n    \n    // Initialize printer\n    commands += ESC_POS_COMMANDS.XPRINTER_INIT;\n  \n  // Center and bold title\n  commands += ESC_POS_COMMANDS.CENTER;\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  commands += ESC_POS_COMMANDS.DOUBLE_HEIGHT;\n  commands += title + '\\n';\n  commands += ESC_POS_COMMANDS.NORMAL_SIZE;\n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add separator line\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add document info\n  commands += ESC_POS_COMMANDS.LEFT_ALIGN;\n  commands += `Date: ${new Date().toLocaleDateString()}\\n`;\n  commands += `Time: ${new Date().toLocaleTimeString()}\\n`;\n  commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  \n  // Add sale info\n  if (data.sale_number) {\n    commands += `Sale: ${data.sale_number}\\n`;\n  }\n  if (data.customer_name) {\n    commands += `Customer: ${data.customer_name}\\n`;\n  }\n  if (data.customer_phone) {\n    commands += `Phone: ${data.customer_phone}\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '-'.repeat(32) + '\\n';\n  \n  // Add items\n  if (data.items && Array.isArray(data.items)) {\n    commands += ESC_POS_COMMANDS.BOLD_ON;\n    commands += 'ITEMS:\\n';\n    commands += ESC_POS_COMMANDS.BOLD_OFF;\n    \n    data.items.forEach(item => {\n      commands += `${(item.product_name || 'N/A').substring(0, 25)}\\n`;\n      commands += `  Qty: ${item.quantity_display || item.quantity || 0} x ${parseFloat(item.unit_price || 0).toFixed(2)}\\n`;\n      commands += `  Total: ${parseFloat(item.total_price || 0).toFixed(2)} MGA\\n`;\n      commands += '\\n';\n    });\n  }\n  \n  // Add totals\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += '='.repeat(32) + '\\n';\n  commands += ESC_POS_COMMANDS.BOLD_ON;\n  \n  if (data.total_amount) {\n    commands += `TOTAL: ${parseFloat(data.total_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.paid_amount) {\n    commands += `PAID: ${parseFloat(data.paid_amount).toFixed(2)} MGA\\n`;\n  }\n  if (data.remaining_amount && data.remaining_amount > 0) {\n    commands += `DUE: ${parseFloat(data.remaining_amount).toFixed(2)} MGA\\n`;\n  }\n  \n  commands += ESC_POS_COMMANDS.BOLD_OFF;\n  commands += '='.repeat(32) + '\\n';\n  \n  // Add footer\n  commands += ESC_POS_COMMANDS.FEED_LINE;\n  commands += 'Thank you for your business!\\n';\n  commands += '______ANTATSIMO______ System\\n';\n  commands += `Print ID: ${data.print_id || 'N/A'}\\n`;\n  \n  // Feed lines and cut paper\n  commands += ESC_POS_COMMANDS.XPRINTER_FEED;\n  commands += ESC_POS_COMMANDS.XPRINTER_CUT;\n  \n  return commands;\n  } catch (error) {\n    console.error('Error generating ESC/POS commands:', error);\n    return '';\n  }\n};\n\n/**\n * Create downloadable file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} File content for download\n */\nexport const createReceiptAppFile = (data, title) => {\n  const escPosCommands = generateESCPOSForReceiptApp(data, title);\n  \n  // Create a simple translation function for the HTML content\n  const simpleT = (key, fallback) => fallback || key;\n  const htmlContent = generateXprinterPrintContent(data, title, 'sale', simpleT);\n  \n  // Create a combined file that works with receipt printer apps\n  return `# Receipt Printer App File\n# Generated: ${new Date().toISOString()}\n# Title: ${title}\n\n# ESC/POS Commands (for direct printer communication)\n${escPosCommands}\n\n# HTML Content (for preview and fallback printing)\n${htmlContent}\n\n# End of file`;\n};\n\n/**\n * Generate PDF content for receipt\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {string} PDF-ready HTML content\n */\nexport const generatePDFContent = (data, title) => {\n  const isMobile = isMobileDevice();\n  const width = '80mm'; // Standard for Xprinter\n  const fontSize = '12px';\n  const maxChars = 32;\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <style>\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: ${fontSize};\n          line-height: 1.2;\n          color: #000;\n          width: ${width};\n          max-width: ${width};\n          margin: 0 auto;\n          padding: 2mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: 14px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: 13px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: 11px;\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: 11px;\n          margin-bottom: 3px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 1px 3px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-size: 11px;\n        }\n        \n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n          max-width: 22ch;\n        }\n        \n        .item-details {\n          display: flex;\n          justify-content: space-between;\n          font-size: 10px;\n          color: #555;\n        }\n        \n        .receipt-totals {\n          margin: 6px 0;\n          padding-top: 4px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-weight: bold;\n          font-size: 11px;\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 8px;\n          padding-top: 4px;\n          border-top: 1px dashed #000;\n          font-size: 10px;\n          color: #666;\n        }\n        \n        @media print {\n          body {\n            margin: 0;\n            padding: 1mm;\n            width: ${width};\n          }\n          \n          @page {\n            size: ${width} auto;\n            margin: 0;\n          }\n        }\n        \n        @media screen {\n          body {\n            border: 1px solid #ccc;\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"receipt-header\">\n        <div class=\"company-name\">______ANTATSIMO______</div>\n        <div class=\"document-title\">${title.toUpperCase()}</div>\n        <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n      </div>\n      \n      <div class=\"receipt-section\">\n        <div class=\"section-title\">SALE INFO</div>\n        <div class=\"receipt-row\">\n          <span>Sale No:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Status:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Customer:</span>\n          <span>${(data.customer_name || 'Walk-in Customer').substring(0, 22)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>Phone:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Peyment Status:</span>\n          <span>${data.payment_status}</span>\n        </div>\n      </div>\n      \n      <div class=\"receipt-section\">\n        <div class=\"section-title\">ITEMS</div>\n        ${data.items && Array.isArray(data.items) ? data.items.map(item => `\n          <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 22)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity_display || item.quantity || 0} x ${parseFloat(item.unit_price || 0).toFixed(2)}</span>\n            <span>${parseFloat(item.total_price || 0).toFixed(2)} MGA</span>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n      </div>\n      \n      <div class=\"receipt-totals\">\n        <div class=\"total-row\">\n          <span>Total:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"total-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"total-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n      </div>\n      \n      <div class=\"receipt-footer\">\n        <div>Thank you for your business!</div>\n        <div>Print ID: ${data.print_id || 'N/A'}</div>\n        <div>Created by: ${(data.created_by_name || data.sold_by_name || 'N/A')}</div>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n/**\n * Download PDF file for receipt printer apps\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */\nexport const downloadReceiptFile = (data, title) => {\n  try {\n    // Validate inputs\n    if (!data || !title) {\n      console.error('Invalid data or title provided to downloadReceiptFile');\n      return false;\n    }\n    \n    const pdfContent = generatePDFContent(data, title);\n    if (!pdfContent) {\n      console.error('Failed to create PDF content');\n      return false;\n    }\n    \n    // Create a blob with HTML content that can be saved as PDF\n    const blob = new Blob([pdfContent], { type: 'text/html' });\n    const url = URL.createObjectURL(blob);\n    \n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `receipt_${data.sale_number || Date.now()}.html`;\n    link.style.display = 'none';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n    \n    return true;\n  } catch (error) {\n    console.error('Failed to download receipt file:', error);\n    return false;\n  }\n};\n\n/**\n * Mobile-friendly print function with fallbacks\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */\nexport const mobilePrint = async (printContent, title = 'Document') => {\n  try {\n    // Method 1: Try Web Share API with file (modern mobile browsers)\n    if (navigator.share && isMobileDevice()) {\n      try {\n        // Create a blob with the content\n        const blob = new Blob([printContent], { type: 'text/html' });\n        const file = new File([blob], `${title}.html`, { type: 'text/html' });\n        \n        await navigator.share({\n          title: title,\n          text: 'Print this receipt',\n          files: [file]\n        });\n        \n        return true;\n      } catch (shareError) {\n        console.log('Web Share API with file failed, trying other methods:', shareError);\n      }\n    }\n\n    // Method 2: Try direct window.print() on current page\n    if (window.print && !isMobileDevice()) {\n      // Create a temporary element with the content\n      const tempDiv = document.createElement('div');\n      tempDiv.innerHTML = printContent;\n      tempDiv.style.position = 'absolute';\n      tempDiv.style.left = '-9999px';\n      tempDiv.style.top = '-9999px';\n      document.body.appendChild(tempDiv);\n      \n      // Replace body content temporarily\n      const originalBody = document.body.innerHTML;\n      document.body.innerHTML = printContent;\n      \n      // Print\n      window.print();\n      \n      // Restore original content\n      document.body.innerHTML = originalBody;\n      document.body.removeChild(tempDiv);\n      \n      return true;\n    }\n\n    // Method 3: Try popup window (with better error handling)\n    return await openPrintWindow(printContent, title);\n    \n  } catch (error) {\n    console.error('All print methods failed:', error);\n    return false;\n  }\n};\n\n/**\n * Open print window with enhanced error handling\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {Promise<boolean>} Success status\n */\nexport const openPrintWindow = (printContent, title = 'Document') => {\n  return new Promise((resolve) => {\n    try {\n      // Enhanced window.open parameters for better mobile compatibility\n      const windowFeatures = isMobileDevice() \n        ? 'width=400,height=600,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no'\n        : 'width=900,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=no';\n      \n      const printWindow = window.open('', '_blank', windowFeatures);\n      \n      if (!printWindow) {\n        throw new Error('Popup blocked or window.open failed');\n      }\n      \n      // Set window title\n      printWindow.document.title = title;\n      \n      // Write content to window\n      printWindow.document.write(printContent);\n      printWindow.document.close();\n      \n      // Make sure window is visible and focused\n      printWindow.focus();\n      \n      // Wait for content to load and show the window\n      const showAndPrint = () => {\n        try {\n          // Ensure window is visible\n          printWindow.focus();\n          \n          // Add a small delay to ensure content is rendered\n          setTimeout(() => {\n            try {\n              // Show print dialog\n              printWindow.print();\n              \n              // Keep window open longer for user interaction\n              setTimeout(() => {\n                if (!printWindow.closed) {\n                  // Ask user if they want to close the window\n                  if (window.confirm('Close the print preview window?')) {\n                    printWindow.close();\n                  }\n                }\n              }, 5000);\n              \n              resolve(true);\n            } catch (printError) {\n              console.error('Print failed:', printError);\n              // Don't close window immediately, let user see the content\n              resolve(false);\n            }\n          }, 500);\n          \n        } catch (error) {\n          console.error('Error in showAndPrint:', error);\n          resolve(false);\n        }\n      };\n      \n      // Check if content is loaded\n      if (printWindow.document.readyState === 'complete') {\n        showAndPrint();\n      } else {\n        printWindow.onload = showAndPrint;\n      }\n      \n      // Fallback timeout - don't auto-close\n      setTimeout(() => {\n        if (!printWindow.closed) {\n          console.log('Print window timeout - window remains open for user interaction');\n        }\n      }, 30000);\n      \n    } catch (error) {\n      console.error('Failed to open print window:', error);\n      resolve(false);\n    }\n  });\n};\n\n/**\n * Open print preview window (visible, doesn't auto-close)\n * @param {string} printContent - HTML content to print\n * @param {string} title - Document title\n * @returns {boolean} Success status\n */\nexport const openPrintPreview = (printContent, title = 'Document') => {\n  try {\n    // Create a larger window for better visibility\n    const windowFeatures = isMobileDevice() \n      ? 'width=500,height=700,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes'\n      : 'width=1000,height=800,scrollbars=yes,resizable=yes,toolbar=yes,menubar=yes,location=no,status=yes';\n    \n    const previewWindow = window.open('', '_blank', windowFeatures);\n    \n    if (!previewWindow) {\n      throw new Error('Popup blocked or window.open failed');\n    }\n    \n    // Set window title\n    previewWindow.document.title = `${title} - Print Preview`;\n    \n    // Add print button and styling\n    const enhancedContent = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>${title} - Print Preview</title>\n        <meta charset=\"UTF-8\">\n        <style>\n          body {\n            margin: 0;\n            padding: 20px;\n            font-family: Arial, sans-serif;\n            background: #f5f5f5;\n          }\n          .print-controls {\n            position: fixed;\n            top: 10px;\n            right: 10px;\n            background: white;\n            padding: 10px;\n            border-radius: 5px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            z-index: 1000;\n          }\n          .print-controls button {\n            margin: 5px;\n            padding: 8px 16px;\n            border: none;\n            border-radius: 3px;\n            cursor: pointer;\n            font-size: 14px;\n          }\n          .print-btn {\n            background: #007bff;\n            color: white;\n          }\n          .close-btn {\n            background: #6c757d;\n            color: white;\n          }\n          .print-content {\n            background: white;\n            padding: 20px;\n            border-radius: 5px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            max-width: 800px;\n            margin: 0 auto;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"print-controls\">\n          <button class=\"print-btn\" onclick=\"window.print()\"> Print</button>\n          <button class=\"close-btn\" onclick=\"window.close()\"> Close</button>\n        </div>\n        <div class=\"print-content\">\n          ${printContent.replace('<!DOCTYPE html>', '').replace('<html>', '').replace('<head>', '').replace('</head>', '').replace('<body>', '').replace('</body>', '').replace('</html>', '')}\n        </div>\n      </body>\n      </html>\n    `;\n    \n    // Write content to window\n    previewWindow.document.write(enhancedContent);\n    previewWindow.document.close();\n    \n    // Focus the window\n    previewWindow.focus();\n    \n    return true;\n  } catch (error) {\n    console.error('Failed to open print preview:', error);\n    return false;\n  }\n};\n\n/**\n * Generate Xprinter 80mm optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Xprinter-optimized HTML content\n */\nexport const generateXprinterPrintContent = (data, title, type, t) => {\n\n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <style>\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: 12px;\n          line-height: 1.2;\n          color: #000;\n          width: 80mm;\n          max-width: 80mm;\n          margin: 0 auto;\n          padding: 2mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: 14px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: 13px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: 11px;\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: 11px;\n          margin-bottom: 3px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 1px 3px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-size: 11px;\n        }\n        \n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n          max-width: 22ch; /* 80mm = ~32 chars, leave space for price */\n        }\n        \n        .item-details {\n          display: flex;\n          justify-content: space-between;\n          font-size: 10px;\n          color: #555;\n        }\n        \n        .receipt-totals {\n          margin: 6px 0;\n          padding-top: 4px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-weight: bold;\n          font-size: 11px;\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 8px;\n          padding-top: 4px;\n          border-top: 1px dashed #000;\n          font-size: 10px;\n          color: #666;\n        }\n        \n        @media print {\n          body {\n            margin: 0;\n            padding: 1mm;\n            width: 80mm;\n          }\n          \n          @page {\n            size: 80mm auto;\n            margin: 0;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"receipt-header\">\n        <div class=\"company-name\" style=\"text-align: center;\">________ANTATSIMO_______</div>\n        <div class=\"company-name\" style=\"text-align: center;\">${'\\u00A0'}</div>\n        <div class=\"document-title\" style=\"text-align: center;\">SALE RECEIPT</div>\n        <div class=\"receipt-date\" style=\"text-align: center;\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"section-title\">SALE INFO</div>\n        <div class=\"receipt-row\">\n          <span>Sale No:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Sale Status:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Customer:</span>\n          <span>${(data.customer_name || 'Walk-in Customer').substring(0, 25)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>Phone:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Peyment Status:</span>\n          <span>${data.payment_status}</span>\n        </div>\n\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"no-data\">==================================================</div>\n\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">ITEMS SOLD</div>    \n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"item-details\">\n          <span>Info</span>\n          <span>\n            Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n          </span>\n        </div>\n        <div class=\"no-data\"></div> \n        ${data.items && Array.isArray(data.items) ? data.items.map(item => `\n          <div class=\"sale-item\">\n            <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n            <div class=\"item-details\">\n              <span>\n                ${`(${item.unit_name})${parseFloat(item.unit_price || 0).toFixed(2)}`.padEnd(26, '\\u00A0')}\n                ${(item.quantity_display || item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                ${parseFloat(item.total_price || 0).toFixed(2).padStart(12, '\\u00A0')} MGA\n              </span>\n            </div>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n\n      </div>      \n      <div class=\"receipt-totals\">\n        <div class=\"receipt-row\">\n          <span>Subtotal:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"receipt-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-footer\">\n        <div class=\"thank-you\">Thank you!</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Created by: ${(data.created_by_name || data.sold_by_name || 'N/A')}</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Print id : ${data.print_id || 'N/A'}</div>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n/**\n * Generate mobile-optimized print content\n * @param {Object} data - Data to print\n * @param {string} title - Document title\n * @param {string} type - Document type\n * @param {Function} t - Translation function\n * @returns {string} Mobile-optimized HTML content\n */\nexport const generateMobilePrintContent = (data, title, type, t) => {\n  const isMobile = isMobileDevice();\n  const printerType = detectPrinterType();\n  \n  // Use smaller dimensions for mobile\n  const width = isMobile ? '58mm' : '80mm';\n  const fontSize = isMobile ? '10px' : '12px';\n  const maxChars = isMobile ? 24 : 32;\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <style>\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: ${fontSize};\n          line-height: 1.2;\n          color: #000;\n          width: ${width};\n          max-width: ${width};\n          margin: 0 auto;\n          padding: 2mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: ${isMobile ? '12px' : '14px'};\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: ${isMobile ? '11px' : '13px'};\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: ${isMobile ? '9px' : '11px'};\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 6px;\n          padding-bottom: 4px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: ${isMobile ? '9px' : '11px'};\n          margin-bottom: 3px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 1px 3px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-size: ${isMobile ? '9px' : '11px'};\n        }\n        \n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n          max-width: ${maxChars - 10}ch;\n        }\n        \n        .item-details {\n          display: flex;\n          justify-content: space-between;\n          font-size: ${isMobile ? '8px' : '10px'};\n          color: #555;\n        }\n        \n        .receipt-totals {\n          margin: 6px 0;\n          padding-top: 4px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 2px;\n          font-weight: bold;\n          font-size: ${isMobile ? '9px' : '11px'};\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 8px;\n          padding-top: 4px;\n          border-top: 1px dashed #000;\n          font-size: ${isMobile ? '8px' : '10px'};\n          color: #666;\n        }\n        \n        @media print {\n          body {\n            margin: 0;\n            padding: 1mm;\n            width: ${width};\n          }\n          \n          @page {\n            size: ${width} auto;\n            margin: 0;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"receipt-header\">\n        <div class=\"company-name\" style=\"text-align: center;\">________ANTATSIMO_______</div>\n        <div class=\"company-name\" style=\"text-align: center;\">${'\\u00A0'}</div>\n        <div class=\"document-title\" style=\"text-align: center;\">SALE RECEIPT</div>\n        <div class=\"receipt-date\" style=\"text-align: center;\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"section-title\">SALE INFO</div>\n        <div class=\"receipt-row\">\n          <span>Sale No:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Sale Status:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Customer:</span>\n          <span>${(data.customer_name || 'Walk-in Customer').substring(0, 25)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>Phone:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Peyment Status:</span>\n          <span>${data.payment_status}</span>\n        </div>\n\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"no-data\">==================================================</div>\n\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">ITEMS SOLD</div>             \n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"item-details\">\n          <span>Info</span>\n          <span>\n            Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n          </span>\n        </div>\n        <div class=\"no-data\"></div> \n        ${data.items && Array.isArray(data.items) ? data.items.map(item => `\n          <div class=\"sale-item\">\n            <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n            <div class=\"item-details\">\n              <span>\n                ${`(${item.unit_name})${parseFloat(item.unit_price || 0).toFixed(2)}`.padEnd(26, '\\u00A0')}\n                ${(item.quantity_display || item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                ${parseFloat(item.total_price || 0).toFixed(2).padStart(12, '\\u00A0')} MGA\n              </span>\n            </div>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n\n      </div>        \n      <div class=\"receipt-totals\">\n        <div class=\"receipt-row\">\n          <span>Subtotal:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"receipt-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">==================================================</</div>\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-footer\">\n        <div class=\"thank-you\">Thank you!</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Created by: ${(data.created_by_name || data.sold_by_name || 'N/A')}</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Print id : ${data.print_id || 'N/A'}</div>\n      </div>\n    </body>\n    </html>\n  `;\n};\n\n\n\n\n\n// Print content from print button\n// Helper functions for generating print content optimized for 80mm thermal printers\nconst generateInventoryContent = (data, t) => {\n  let products = data;\n  if (!Array.isArray(data)) {\n    if (data.results && Array.isArray(data.results)) {\n      products = data.results;\n    } else if (data.data && Array.isArray(data.data)) {\n      products = data.data;\n    } else if (data.items && Array.isArray(data.items)) {\n      products = data.items;\n    } else {\n      const numberedKeys = Object.keys(data).filter(key => /^\\d+$/.test(key));\n      if (numberedKeys.length > 0) {\n        products = numberedKeys.map(key => data[key]).filter(item => item && typeof item === 'object');\n      } else {\n        products = [];\n      }\n    }\n  }\n\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">${t('titles.inventory_summary', 'INVENTORY SUMMARY')}</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">SUMMARY</div>\n      <div class=\"receipt-row\">\n        <span>Total Products:</span>\n        <span>${Array.isArray(products) ? products.length : 0}</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">PRODUCTS</div>\n      ${Array.isArray(products) ? products.map(item => `\n        <div class=\"product-item\">\n          <div class=\"product-name\">${(item.name || 'N/A').substring(0, 20)}</div>\n          <div class=\"product-details\">\n            <span>SKU: ${(item.sku || 'N/A').substring(0, 8)}</span>\n            <span>Qty: ${item.stock_quantity || 0}</span>\n            <span>${parseFloat(item.price || 0).toFixed(2)} MGA</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No products found</div>'}\n      ${Array.isArray(products) && products.length > 20 ? `\n        <div class=\"truncated-warning\">... and ${products.length - 20} more products</div>\n      ` : ''}\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">${t('footer.generated_by', 'Generated by ______ANTATSIMO______ System')}</div>\n    </div>\n  `;\n};\n\nconst generatePurchaseOrderContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">PURCHASE ORDER</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">ORDER INFO</div>\n      <div class=\"receipt-row\">\n        <span>Order No:</span>\n        <span>${data.order_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Supplier:</span>\n        <span>${(data.supplier?.name || 'N/A').substring(0, 25)}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Date:</span>\n        <span>${data.order_date ? new Date(data.order_date).toLocaleDateString() : 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Status:</span>\n        <span>${data.status || 'N/A'}</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">ITEMS</div>\n      ${data.items ? data.items.map(item => `\n        <div class=\"order-item\">\n          <div class=\"item-name\">${(item.product?.name || 'N/A').substring(0, 25)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity_ordered || 0} x ${parseFloat(item.unit_cost || 0).toFixed(2)}</span>\n            <span>${parseFloat((item.quantity_ordered || 0) * (item.unit_cost || 0)).toFixed(2)} MGA</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No items found</div>'}\n    </div>\n    \n    <div class=\"receipt-total\">\n      <div class=\"total-row\">\n        <span>TOTAL AMOUNT:</span>\n        <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">End of Purchase Order</div>\n    </div>\n  `;\n};\n\nconst generateDeliveryContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">DELIVERY RECEIPT</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">DELIVERY INFO</div>\n      <div class=\"receipt-row\">\n        <span>Delivery No:</span>\n        <span>${data.delivery_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>PO Number:</span>\n        <span>${data.purchase_order?.order_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Date:</span>\n        <span>${data.delivery_date ? new Date(data.delivery_date).toLocaleDateString() : 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Status:</span>\n        <span>${data.status || 'N/A'}</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">ITEMS RECEIVED</div>\n      ${data.items ? data.items.map(item => `\n        <div class=\"delivery-item\">\n          <div class=\"item-name\">${(item.product_name || item.product?.name || 'N/A').substring(0, 25)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity_received || item.delivered_quantity || 0} x ${parseFloat(item.unit_cost || 0).toFixed(2)}</span>\n            <span>${parseFloat((item.quantity_received || item.delivered_quantity || 0) * (item.unit_cost || 0)).toFixed(2)} MGA</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No items found</div>'}\n    </div>\n    \n    <div class=\"receipt-total\">\n      <div class=\"total-row\">\n        <span>TOTAL AMOUNT:</span>\n        <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Delivery completed</div>\n    </div>\n  `;\n};\n\nconst generateSaleContent = (data, t) => {\n  let items = data.items;\n  if (!items) {\n    const numberedKeys = Object.keys(data).filter(key => /^\\d+$/.test(key));\n    if (numberedKeys.length > 0) {\n      items = numberedKeys.map(key => data[key]).filter(item => item && typeof item === 'object');\n    }\n  }\n\n  const paymentStatusText = data.payment_status === 'paid' ? 'PAID' : \n                          data.payment_status === 'partial' ? 'PARTIAL' : \n                          data.payment_status === 'pending' ? 'PENDING' : \n                          'UNKNOWN';\n  console.log(data);\n\n  return `\n    <div class=\"receipt-header\">\n        <div class=\"company-name\" style=\"text-align: center;\">________ANTATSIMO_______</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"no-data\">${'\\u00A0'}</div>\n        <div class=\"section-title\">SALE INFO</div>\n        <div class=\"receipt-row\">\n          <span>Sale No:</span>\n          <span>${data.sale_number || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Sale Status:</span>\n          <span>${data.status || 'N/A'}</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Customer:</span>\n          <span>${(data.customer_name || 'Walk-in Customer').substring(0, 25)}</span>\n        </div>\n        ${data.customer_phone ? `\n          <div class=\"receipt-row\">\n            <span>Phone:</span>\n            <span>${data.customer_phone}</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Peyment Status:</span>\n          <span>${paymentStatusText}</span>\n        </div>\n\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-section\">\n        <div class=\"section-title\">ITEMS SOLD</div>    \n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"item-details\">\n          <span>Info</span>\n          <span>\n            Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n          </span>\n        </div>\n      \n        ${items && Array.isArray(items) ? items.map(item => `\n          <div class=\"no-data\"></div>         \n          <div class=\"sale-item\">\n            <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n            <div class=\"item-details\">\n              <span>\n                ${`(${item.unit_name})${parseFloat(item.unit_price || 0).toFixed(2)}`.padEnd(26, '\\u00A0')}\n                ${(item.quantity_display || item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                ${parseFloat(item.total_price || 0).toFixed(2).padStart(12, '\\u00A0')} MGA\n              </span>\n            </div>\n          </div>\n        `).join('') : '<div class=\"no-data\">No items found</div>'}\n\n        <div class=\"no-data\">__________________________________________________</div>\n      </div>\n      ${data.packaging_items && data.packaging_items.length > 0 ? `\n        <div class=\"receipt-section\">\n          <div class=\"section-title\">PACKAGINGS</div>    \n          <div class=\"no-data\">__________________________________________________</div>\n          <div class=\"item-details\">\n            <span>Info</span>\n            <span>\n              Qte${'\\u00A0'.repeat(10)}Total${'\\u00A0'.repeat(2)}\n            </span>\n          </div>\n        \n          ${data.packaging_items.map(item => {\n            let unitPriceDisplay, totalPriceDisplay;\n            \n            if (item.status === 'consignation') {\n              unitPriceDisplay = `${parseFloat(item.unit_price || 0).toFixed(2)}`;\n              totalPriceDisplay = `${parseFloat(item.total_price || 0).toFixed(2)} MGA`;\n            } else if (item.status === 'exchange') {\n              unitPriceDisplay = '0.00';\n              totalPriceDisplay = '0.00 MGA';\n            } else if (item.status === 'due') {\n              unitPriceDisplay = 'DUE';\n              totalPriceDisplay = 'DUE';\n            } else {\n              unitPriceDisplay = `${parseFloat(item.unit_price || 0).toFixed(2)}`;\n              totalPriceDisplay = `${parseFloat(item.total_price || 0).toFixed(2)} MGA`;\n            }\n            \n            return `\n            <div class=\"no-data\"></div>         \n            <div class=\"packaging-item\">\n              <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)} </div>\n              <div class=\"item-details\">\n                <span>\n                  ${unitPriceDisplay.padEnd(26, '\\u00A0')}\n                  ${(item.quantity || 0).toString().padStart(3, '\\u00A0')}\n                  ${totalPriceDisplay.padStart(12, '\\u00A0')}\n                </span>\n              </div>\n            </div>\n          `;\n          }).join('')}\n\n          <div class=\"no-data\">__________________________________________________</div>\n        </div>\n      ` : ''}\n      <div class=\"receipt-totals\">\n        <div class=\"receipt-row\">\n          <span>Subtotal:</span>\n          <span>${parseFloat(data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.packaging_total && data.packaging_total > 0 ? `\n          <div class=\"receipt-row\">\n            <span>Packagings:</span>\n            <span>${parseFloat(data.packaging_total || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"receipt-row\">\n          <span>Total:</span>\n          <span>${parseFloat(data.grand_total || data.total_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        <div class=\"receipt-row\">\n          <span>Paid:</span>\n          <span>${parseFloat(data.paid_amount || 0).toFixed(2)} MGA</span>\n        </div>\n        ${data.payment_status === 'partial' ? `\n          <div class=\"receipt-row\">\n            <span>Due:</span>\n            <span>${parseFloat(data.remaining_amount || 0).toFixed(2)} MGA</span>\n          </div>\n        ` : ''}\n        <div class=\"no-data\">__________________________________________________</div>\n        <div class=\"no-data\">${'\\u00A0'}</div>\n      </div>\n      <div class=\"receipt-footer\">\n        <div class=\"thank-you\">Thank you!</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Created by: ${(data.created_by_name || data.sold_by_name || data.user_name || 'N/A')} -- ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n        <div class=\"footer-text\" style=\"text-align: center;\">Print id : ${data.print_id || 'N/A'}</div>\n      </div>\n  `;\n};\n\nconst generateSalesHistoryContent = (data, t) => {\n  let sales = data;\n  if (!Array.isArray(data)) {\n    if (data.results && Array.isArray(data.results)) {\n      sales = data.results;\n    } else if (data.data && Array.isArray(data.data)) {\n      sales = data.data;\n    } else if (data.items && Array.isArray(data.items)) {\n      sales = data.items;\n    } else {\n      const numberedKeys = Object.keys(data).filter(key => /^\\d+$/.test(key));\n      if (numberedKeys.length > 0) {\n        sales = numberedKeys.map(key => data[key]).filter(item => item && typeof item === 'object');\n      } else {\n        sales = [];\n      }\n    }\n  }\n\n  const totalRevenue = Array.isArray(sales) ? sales.reduce((sum, sale) => sum + parseFloat(sale.total_amount || 0), 0) : 0;\n\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">SALES REPORT</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">SUMMARY</div>\n      <div class=\"receipt-row\">\n        <span>Total Sales:</span>\n        <span>${Array.isArray(sales) ? sales.length : 0}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Total Revenue:</span>\n        <span>${totalRevenue.toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">RECENT SALES</div>\n      ${Array.isArray(sales) ? sales.map(sale => `\n        <div class=\"sale-summary\">\n          <div class=\"sale-info\">\n            <span>${sale.sale_number || 'N/A'}</span>\n            <span>${parseFloat(sale.total_amount || 0).toFixed(2)} MGA</span>\n          </div>\n          <div class=\"sale-details\">\n            <span>${(sale.customer_name || t('customer.walk_in', 'Walk-in')).substring(0, 15)}</span>\n            <span>${sale.created_at ? new Date(sale.created_at).toLocaleDateString() : 'N/A'}</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No sales data</div>'}\n      ${Array.isArray(sales) && sales.length > 20 ? `\n        <div class=\"truncated-warning\">... and ${sales.length - 20} more sales</div>\n      ` : ''}\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Sales report generated</div>\n    </div>\n  `;\n};\n\nconst generatePackagingValidationContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">PACKAGING VALIDATION</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">VALIDATION INFO</div>\n      <div class=\"receipt-row\">\n        <span>Sale No:</span>\n        <span>${data.sale_number || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Status:</span>\n        <span>${data.status || 'N/A'}</span>\n      </div>\n      <div class=\"receipt-row\">\n        <span>Customer:</span>\n        <span>${(data.customer_name || t('customer.walk_in', 'Walk-in Customer')).substring(0, 25)}</span>\n      </div>\n      ${data.customer_phone ? `\n        <div class=\"receipt-row\">\n          <span>Phone:</span>\n          <span>${data.customer_phone}</span>\n        </div>\n      ` : ''}\n      <div class=\"receipt-row\">\n        <span>Total Items:</span>\n        <span>${data.packaging_items ? data.packaging_items.length : 0}</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">PACKAGING ITEMS</div>\n      ${data.packaging_items && Array.isArray(data.packaging_items) ? data.packaging_items.map(item => `\n        <div class=\"packaging-item\">\n          <div class=\"item-name\">${(item.product_name || 'N/A').substring(0, 25)}</div>\n          <div class=\"item-details\">\n            <span>${item.quantity || 0} x ${parseFloat(item.unit_price || 0).toFixed(2)}</span>\n            <span>${parseFloat(item.total_price || 0).toFixed(2)} MGA</span>\n            <span class=\"status-${item.status}\">${item.status === 'consignation' ? 'PAID' : \n                   item.status === 'exchange' ? 'EXCH' : \n                   item.status === 'due' ? 'DUE' : item.status}</span>\n          </div>\n        </div>\n      `).join('') : '<div class=\"no-data\">No packaging items</div>'}\n    </div>\n    \n    <div class=\"receipt-total\">\n      <div class=\"total-row\">\n        <span>PACKAGING TOTAL:</span>\n        <span>${parseFloat(data.packaging_total || 0).toFixed(2)} MGA</span>\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Packaging validation completed</div>\n    </div>\n  `;\n};\n\nconst generateDefaultContent = (data, t) => {\n  return `\n    <div class=\"receipt-header\">\n      <div class=\"company-name\">${t('company.name', '______ANTATSIMO______')}</div>\n      <div class=\"document-title\">DOCUMENT</div>\n      <div class=\"receipt-date\">${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>\n    </div>\n    \n    <div class=\"receipt-section\">\n      <div class=\"section-title\">CONTENT</div>\n      <div class=\"default-content\">\n        Document generated successfully\n      </div>\n    </div>\n    \n    <div class=\"receipt-footer\">\n      <div class=\"footer-text\">Document printed</div>\n    </div>\n  `;\n};\n\n// Export the generatePrintContent function\nexport const generatePrintContent = (data, title, type, t) => {\n  const currentDate = new Date().toLocaleDateString();\n  const currentTime = new Date().toLocaleTimeString();\n  \n  let content = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${title}</title>\n      <meta charset=\"UTF-8\">\n      <style>\n        /* 80mm Thermal Printer Receipt Styles */\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Courier New', Courier, monospace;\n          font-size: 12px;\n          line-height: 1.2;\n          color: #000;\n          width: 80mm;\n          max-width: 80mm;\n          margin: 0 auto;\n          padding: 3mm;\n          background: white;\n        }\n        \n        .receipt-header {\n          text-align: center;\n          margin-bottom: 8px;\n          padding-bottom: 6px;\n          border-bottom: 1px dashed #000;\n        }\n        \n        .company-name {\n          font-weight: bold;\n          font-size: 14px;\n          margin-bottom: 2px;\n          text-transform: uppercase;\n        }\n        \n        .document-title {\n          font-weight: bold;\n          font-size: 13px;\n          margin-bottom: 3px;\n          text-transform: uppercase;\n        }\n        \n        .receipt-date {\n          font-size: 11px;\n          color: #555;\n        }\n        \n        .receipt-section {\n          margin-bottom: 8px;\n          padding-bottom: 6px;\n          border-bottom: 1px dotted #ccc;\n        }\n        \n        .section-title {\n          font-weight: bold;\n          font-size: 11px;\n          margin-bottom: 4px;\n          text-transform: uppercase;\n          background: #f0f0f0;\n          padding: 2px 4px;\n        }\n        \n        .receipt-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 3px;\n          font-size: 11px;\n        }\n        \n        .product-item,\n        .order-item,\n        .delivery-item,\n        .sale-item,\n        .packaging-item,\n        .sale-summary {\n          margin-bottom: 4px;\n          padding: 2px 0;\n        }\n        \n        .product-name,\n        .item-name {\n          font-weight: bold;\n          margin-bottom: 1px;\n          word-wrap: break-word;\n        }\n        \n        .product-details,\n        .item-details,\n        .sale-info {\n          display: flex;\n          justify-content: space-between;\n          font-size: 10px;\n          color: #555;\n        }\n        \n        .receipt-totals,\n        .receipt-total {\n          margin: 8px 0;\n          padding-top: 6px;\n          border-top: 2px solid #000;\n        }\n        \n        .total-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 3px;\n          font-weight: bold;\n        }\n        \n        .due-amount {\n          color: #d00;\n        }\n        \n        .no-data {\n          text-align: center;\n          color: #888;\n          font-style: italic;\n          padding: 8px 0;\n        }\n        \n        .truncated-warning {\n          text-align: center;\n          color: #888;\n          font-size: 10px;\n          font-style: italic;\n          margin-top: 4px;\n        }\n        \n        .thank-you {\n          text-align: center;\n          font-weight: bold;\n          margin: 6px 0;\n        }\n        \n        .receipt-footer {\n          text-align: center;\n          margin-top: 10px;\n          padding-top: 6px;\n          border-top: 1px dashed #000;\n          font-size: 10px;\n          color: #666;\n        }\n        \n        .footer-text {\n          margin-bottom: 2px;\n        }\n        \n        .status-consignation { color: #090; }\n        .status-exchange { color: #009; }\n        .status-due { color: #d00; font-weight: bold; }\n        \n        /* Print-specific styles */\n        @media print {\n          body {\n            margin: 0;\n            padding: 2mm;\n            width: 80mm;\n          }\n          \n          .no-print {\n            display: none;\n          }\n          \n          /* Ensure proper sizing for thermal paper */\n          @page {\n            size: 80mm auto;\n            margin: 0;\n          }\n        }\n        \n        /* Force monospace and proper breaking */\n        * {\n          font-family: 'Courier New', Courier, monospace !important;\n        }\n        \n        .default-content {\n          text-align: center;\n          padding: 10px 0;\n          color: #666;\n        }\n      </style>\n    </head>\n    <body>\n  `;\n\n  // Add type-specific content\n  switch (type) {\n    case 'inventory':\n      content += generateInventoryContent(data, t);\n      break;\n    case 'purchase_order':\n      content += generatePurchaseOrderContent(data, t);\n      break;\n    case 'delivery':\n      content += generateDeliveryContent(data, t);\n      break;\n    case 'sale':\n      content += generateSaleContent(data, t);\n      break;\n    case 'sales_history':\n      content += generateSalesHistoryContent(data, t);\n      break;\n    case 'packaging_validation':\n      content += generatePackagingValidationContent(data, t);\n      break;\n    default:\n      content += generateDefaultContent(data, t);\n  }\n\n  content += `\n    </body>\n    </html>\n  `;\n\n  return content;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}