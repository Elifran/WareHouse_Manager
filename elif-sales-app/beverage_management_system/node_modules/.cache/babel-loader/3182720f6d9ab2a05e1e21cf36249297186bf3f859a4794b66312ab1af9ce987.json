{"ast":null,"code":"import _objectSpread from\"/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useTranslation}from'react-i18next';import api from'../services/api';import Button from'../components/Button';import PrintButton from'../components/PrintButton';import{formatCurrency,formatDate}from'../utils/helpers';import{useAuth}from'../contexts/AuthContext';import PackagingValidation from'./PackagingValidation';import'./PendingSales.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PendingSales=()=>{var _selectedSale$payment,_selectedSale$items,_selectedSale$items2,_selectedSale$items3,_stockValidationStatu4,_stockValidationStatu5,_stockValidationStatu6,_editFormData$items2,_editFormData$items3;const{t}=useTranslation();const{user,loading:authLoading}=useAuth();const[pendingSales,setPendingSales]=useState([]);const[loading,setLoading]=useState(true);const[showSaleModal,setShowSaleModal]=useState(false);const[selectedSale,setSelectedSale]=useState(null);const[showEditModal,setShowEditModal]=useState(false);const[editingSale,setEditingSale]=useState(null);const[editFormData,setEditFormData]=useState({});const[editTotals,setEditTotals]=useState({subtotal:0,total_amount:0});const[completingSale,setCompletingSale]=useState(null);const[stockValidationStatus,setStockValidationStatus]=useState({});const[paymentType,setPaymentType]=useState('full');const[paidAmount,setPaidAmount]=useState(0);const[showPackagingValidation,setShowPackagingValidation]=useState(false);const[packagingValidationSaleId,setPackagingValidationSaleId]=useState(null);useEffect(()=>{if(!authLoading&&user){fetchPendingSales();}},[authLoading,user]);useEffect(()=>{if(pendingSales.length>0){validateStockForAllSales();}},[pendingSales]);const fetchPendingSales=async()=>{try{setLoading(true);// Check if user is authenticated\nconst token=localStorage.getItem('accessToken');const response=await api.get('/api/sales/pending/');setPendingSales(response.data);}catch(error){var _error$response,_error$response2,_error$response3,_error$response4;console.error('Error fetching pending sales:',error);console.error('Error details:',{message:error.message,response:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data,status:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status,statusText:(_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.statusText});// More specific error handling\nif(((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.status)===401){alert('Authentication required. Please log in again.');// Redirect to login or refresh token\nwindow.location.href='/login';}else{var _error$response5,_error$response5$data;alert('Error fetching pending sales: '+(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.detail)||error.message));}}finally{setLoading(false);}};const validateStockForAllSales=async()=>{const validationStatus={};for(const sale of pendingSales){let hasInsufficientStock=false;for(const item of sale.items||[]){try{const response=await api.get(\"/api/products/\".concat(item.product,\"/stock-availability/\"));const stockData=response.data;if(stockData.available_units){const unitData=stockData.available_units.find(unit=>unit.id===item.unit);if(unitData&&unitData.available_quantity<item.quantity_display){hasInsufficientStock=true;break;}}}catch(error){console.error(\"Error checking stock for product \".concat(item.product,\":\"),error);}}validationStatus[sale.id]={hasInsufficientStock};}setStockValidationStatus(validationStatus);};const completeSale=async saleId=>{try{var _sale$items;setCompletingSale(saleId);// Check if sale has items with packaging that need validation\nconst sale=pendingSales.find(s=>s.id===saleId);const hasPackagingItems=(_sale$items=sale.items)===null||_sale$items===void 0?void 0:_sale$items.some(item=>item.product_has_packaging);if(hasPackagingItems){// Show packaging validation page\nsetPackagingValidationSaleId(saleId);setShowPackagingValidation(true);setCompletingSale(null);return;}// Proceed with normal completion if no packaging items\nawait performSaleCompletion(saleId);}catch(error){var _error$response6,_error$response6$data;console.error('Error completing sale:',error);alert('Error completing sale: '+(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.detail)||error.message));setCompletingSale(null);}};const performSaleCompletion=async saleId=>{try{// Check stock before completing\nconst sale=pendingSales.find(s=>s.id===saleId);const stockValidationErrors=[];for(const item of sale.items||[]){try{const response=await api.get(\"/api/products/\".concat(item.product,\"/stock-availability/\"));const stockData=response.data;if(stockData.available_units){const unitData=stockData.available_units.find(unit=>unit.id===item.unit);if(unitData&&unitData.available_quantity<item.quantity_display){stockValidationErrors.push(\"\".concat(item.product_name,\": Required \").concat(item.quantity_display,\" \").concat(item.unit_name,\", but only \").concat(unitData.available_quantity,\" available\"));}}}catch(error){console.error(\"Error checking stock for product \".concat(item.product,\":\"),error);stockValidationErrors.push(\"\".concat(item.product_name,\": Unable to check stock availability\"));}}if(stockValidationErrors.length>0){alert('Cannot complete sale due to insufficient stock:\\n'+stockValidationErrors.join('\\n'));return;}await api.post(\"/api/sales/\".concat(saleId,\"/complete/\"));// Print receipt after successful completion using PrintButton logic\nconst completedSale=_objectSpread(_objectSpread({},sale),{},{status:'completed'});// Remove from pending sales list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale completed successfully!');}catch(error){var _error$response7,_error$response7$data;console.error('Error completing sale:',error);alert('Error completing sale: '+(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.detail)||error.message));}finally{setCompletingSale(null);}};const handlePackagingValidationComplete=async()=>{try{await performSaleCompletion(packagingValidationSaleId);setShowPackagingValidation(false);setPackagingValidationSaleId(null);}catch(error){console.error('Error completing sale after packaging validation:',error);}};const handlePackagingValidationCancel=()=>{setShowPackagingValidation(false);setPackagingValidationSaleId(null);setCompletingSale(null);};const cancelSale=async saleId=>{if(window.confirm('Are you sure you want to cancel this sale?')){try{await api.delete(\"/api/sales/\".concat(saleId,\"/\"));setPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale cancelled successfully!');}catch(error){var _error$response8,_error$response8$data;console.error('Error cancelling sale:',error);alert('Error cancelling sale: '+(((_error$response8=error.response)===null||_error$response8===void 0?void 0:(_error$response8$data=_error$response8.data)===null||_error$response8$data===void 0?void 0:_error$response8$data.detail)||error.message));}}};// Prepare print data for PrintButton component (consistent with POS logic)\nconst preparePrintData=sale=>{var _sale$items2;return{sale_number:sale.sale_number,customer_name:sale.customer_name||'Walk-in Customer',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',user_name:(user===null||user===void 0?void 0:user.username)||t('app.unknown_user'),user_id:(user===null||user===void 0?void 0:user.id)||'unknown',created_at:sale.created_at,print_timestamp:new Date().toISOString(),print_id:\"PRINT-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9)),status:sale.status==='completed'?'completed':'pending',payment_status:sale.payment_status||'pending',payment_method:sale.payment_method||'cash',total_amount:sale.total_amount||sale.subtotal,paid_amount:sale.paid_amount||0,remaining_amount:sale.remaining_amount||parseFloat(sale.total_amount||sale.subtotal)-parseFloat(sale.paid_amount||0),due_date:sale.due_date||null,subtotal:sale.subtotal,discount_amount:sale.discount_amount||0,tax_amount:sale.tax_amount||0,items:((_sale$items2=sale.items)===null||_sale$items2===void 0?void 0:_sale$items2.map(item=>({product_name:item.product_name,product_sku:item.product_sku,quantity:item.quantity,quantity_display:item.quantity_display,unit_name:item.unit_name,unit_price:item.unit_price,total_price:item.total_price})))||[]};};const editSale=sale=>{var _sale$items3;setEditingSale(sale);// Initialize items with proper quantities and calculate totals\nconst items=((_sale$items3=sale.items)===null||_sale$items3===void 0?void 0:_sale$items3.map(item=>{const quantity=parseFloat(item.quantity_display||item.quantity)||0;const unitPrice=parseFloat(item.unit_price)||0;const calculatedTotalPrice=quantity*unitPrice;return _objectSpread(_objectSpread({},item),{},{quantity:quantity,unit_price:unitPrice,total_price:calculatedTotalPrice});}))||[];// Calculate initial totals based on current item data\nconst calculatedSubtotal=items.reduce((sum,item)=>sum+item.total_price,0);// If no tax_amount is provided, assume 0% tax (common for many sales)\nconst taxAmount=parseFloat(sale.tax_amount||0)||0;const discountAmount=parseFloat(sale.discount_amount||0)||0;const calculatedTotal=calculatedSubtotal+taxAmount-discountAmount;// Always use calculated totals to ensure accuracy\nconst subtotal=calculatedSubtotal;const total_amount=calculatedTotal;const formData={customer_name:sale.customer_name||'',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',payment_method:sale.payment_method||'cash',items:items,subtotal:subtotal,total_amount:total_amount,tax_amount:sale.tax_amount||0,discount_amount:sale.discount_amount||0};setEditFormData(formData);setEditTotals({subtotal:subtotal,total_amount:total_amount});// Initialize payment options\nconst currentPaidAmount=parseFloat(sale.paid_amount)||0;const calculatedTotalAmount=total_amount;// Use the calculated total from form data\nif(currentPaidAmount>=calculatedTotalAmount){setPaymentType('full');setPaidAmount(calculatedTotalAmount);}else if(currentPaidAmount>0){setPaymentType('partial');setPaidAmount(currentPaidAmount);}else{setPaymentType('full');setPaidAmount(calculatedTotalAmount);}setShowEditModal(true);setShowSaleModal(false);};const handleEditItemQuantity=(itemIndex,newQuantity)=>{if(!editFormData.items||!Array.isArray(editFormData.items)){console.error('editFormData.items is not properly initialized:',editFormData);return;}const updatedItems=[...editFormData.items];updatedItems[itemIndex].quantity=parseFloat(newQuantity)||0;updatedItems[itemIndex].total_price=updatedItems[itemIndex].quantity*parseFloat(updatedItems[itemIndex].unit_price)||0;const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal}));// Fallback to original sale values if editFormData doesn't have them\nconst taxAmount=parseFloat(editFormData.tax_amount!==undefined?editFormData.tax_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.tax_amount)||0)||0;const discountAmount=parseFloat(editFormData.discount_amount!==undefined?editFormData.discount_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.discount_amount)||0)||0;const newTotalAmount=subtotal+taxAmount-discountAmount;setEditTotals({subtotal:subtotal,taxAmount:taxAmount,discountAmount:discountAmount,newTotalAmount:newTotalAmount,editFormDataTax:editFormData.tax_amount,editFormDataDiscount:editFormData.discount_amount});const newEditFormData=_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:newTotalAmount});setEditFormData(newEditFormData);setEditTotals({subtotal:subtotal,total_amount:newTotalAmount});// Force a re-render by logging the state after setting it\nsetTimeout(()=>{},100);};const removeEditItem=itemIndex=>{const updatedItems=editFormData.items.filter((_,index)=>index!==itemIndex);const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);// Fallback to original sale values if editFormData doesn't have them\nconst taxAmount=parseFloat(editFormData.tax_amount!==undefined?editFormData.tax_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.tax_amount)||0)||0;const discountAmount=parseFloat(editFormData.discount_amount!==undefined?editFormData.discount_amount:(editingSale===null||editingSale===void 0?void 0:editingSale.discount_amount)||0)||0;const newTotalAmount=subtotal+taxAmount-discountAmount;setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:newTotalAmount}));setEditTotals({subtotal:subtotal,total_amount:newTotalAmount});};const calculateEditTotal=()=>{var _editFormData$items;return((_editFormData$items=editFormData.items)===null||_editFormData$items===void 0?void 0:_editFormData$items.reduce((total,item)=>{return total+parseFloat(item.total_price||0);},0))||0;};// Update paid amount when payment type changes or subtotal changes\nuseEffect(()=>{if(paymentType==='full'){setPaidAmount(editTotals.subtotal||0);}},[paymentType,editTotals.subtotal]);const saveEditedSale=async()=>{try{const updateData={customer_name:editFormData.customer_name,customer_phone:editFormData.customer_phone,customer_email:editFormData.customer_email,payment_method:editFormData.payment_method,paid_amount:paidAmount,items:editFormData.items.map(item=>({id:item.id,quantity:item.quantity,unit_price:item.unit_price}))};console.log('Saving edited sale:',{saleId:editingSale.id,updateData:updateData,editFormData:editFormData});const response=await api.patch(\"/sales/\".concat(editingSale.id,\"/\"),updateData);setShowEditModal(false);setEditingSale(null);setEditFormData({});// Refresh the pending sales list\nfetchPendingSales();alert('Sale updated successfully!');}catch(error){var _error$response9,_error$response9$data;console.error('Error updating sale:',error);alert('Error updating sale: '+(((_error$response9=error.response)===null||_error$response9===void 0?void 0:(_error$response9$data=_error$response9.data)===null||_error$response9$data===void 0?void 0:_error$response9$data.detail)||error.message));}};if(authLoading||loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')})}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"Loading pending sales...\"})]});}if(!user){return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')})}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"Please log in to view pending sales.\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sales-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:t('titles.pending_sales')}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage and validate pending sales before completion\"})]}),pendingSales.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-pending-sales\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"no-sales-icon\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{children:t('titles.no_pending_sales')}),/*#__PURE__*/_jsx(\"p\",{children:\"All sales have been completed or there are no pending sales at the moment.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales-grid\",children:pendingSales.map(sale=>{var _sale$items4,_sale$items5,_sale$items6,_stockValidationStatu,_stockValidationStatu2,_stockValidationStatu3;return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sale-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sale-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sale-number\",children:sale.sale_number}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-date\",children:formatDate(sale.created_at)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-customer\",children:/*#__PURE__*/_jsx(\"strong\",{children:sale.customer_name||'Walk-in Customer'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-items\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"items-count\",children:[((_sale$items4=sale.items)===null||_sale$items4===void 0?void 0:_sale$items4.length)||0,\" items\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-preview\",children:[(_sale$items5=sale.items)===null||_sale$items5===void 0?void 0:_sale$items5.slice(0,3).map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-preview\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-quantity\",children:[item.quantity_display||item.quantity,\" \",item.unit_name]}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]},index)),((_sale$items6=sale.items)===null||_sale$items6===void 0?void 0:_sale$items6.length)>3&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-items\",children:[\"+\",sale.items.length-3,\" more items\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-total\",children:/*#__PURE__*/_jsx(\"strong\",{children:formatCurrency(sale.total_amount)})}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu=stockValidationStatus[sale.id])!==null&&_stockValidationStatu!==void 0&&_stockValidationStatu.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-actions\",children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:async()=>{try{// Fetch complete sale data including items\nconst response=await api.get(\"/api/sales/\".concat(sale.id,\"/\"));setSelectedSale(response.data);setShowSaleModal(true);}catch(error){console.error('Error fetching sale details:',error);// Fallback to using the sale data from the list\nsetSelectedSale(sale);setShowSaleModal(true);}},children:\"View Details\"}),/*#__PURE__*/_jsx(PrintButton,{data:preparePrintData(sale),title:t('titles.sale_receipt'),type:\"sale\",printText:\"\\uD83D\\uDDA8\\uFE0F Print\",className:\"print-sale-btn\",variant:\"outline\",size:\"small\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>editSale(sale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"primary\",disabled:(_stockValidationStatu2=stockValidationStatus[sale.id])===null||_stockValidationStatu2===void 0?void 0:_stockValidationStatu2.hasInsufficientStock,onClick:()=>completeSale(sale.id),loading:completingSale===sale.id,children:(_stockValidationStatu3=stockValidationStatus[sale.id])!==null&&_stockValidationStatu3!==void 0&&_stockValidationStatu3.hasInsufficientStock?t('buttons.insufficient_stock'):t('buttons.complete_sale')})]})]},sale.id);})}),showSaleModal&&selectedSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal sale-details-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Sale Details - \",selectedSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_phone||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_email||'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sale Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:formatDate(selectedSale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Payment Method:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:(_selectedSale$payment=selectedSale.payment_method)===null||_selectedSale$payment===void 0?void 0:_selectedSale$payment.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_selectedSale$items=selectedSale.items)===null||_selectedSale$items===void 0?void 0:_selectedSale$items.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-container\",style:{minHeight:\"\".concat(Math.max(200,(((_selectedSale$items2=selectedSale.items)===null||_selectedSale$items2===void 0?void 0:_selectedSale$items2.length)||0)*120),\"px\"),maxHeight:'500px'},children:(_selectedSale$items3=selectedSale.items)===null||_selectedSale$items3===void 0?void 0:_selectedSale$items3.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-card\",style:{marginBottom:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-quantity\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"quantity\",children:item.quantity_display||item.quantity||'N/A'}),/*#__PURE__*/_jsx(\"span\",{className:\"unit\",children:item.unit_name||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"unit-price\",children:[item.unit_price?formatCurrency(item.unit_price):'N/A',\" each\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"total-price\",children:item.total_price?formatCurrency(item.total_price):'N/A'})]})]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.subtotal)})]}),selectedSale.discount_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Discount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[\"-\",formatCurrency(selectedSale.discount_amount)]})]}),selectedSale.tax_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Tax:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.tax_amount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(selectedSale.total_amount)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stock-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Stock Status\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu4=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu4!==void 0&&_stockValidationStatu4.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"Close\"}),/*#__PURE__*/_jsx(PrintButton,{data:preparePrintData(selectedSale),title:t('titles.sale_receipt'),type:\"sale\",printText:\"\\uD83D\\uDDA8\\uFE0F Print Receipt\",className:\"print-sale-btn\",variant:\"secondary\"}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>editSale(selectedSale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",disabled:(_stockValidationStatu5=stockValidationStatus[selectedSale.id])===null||_stockValidationStatu5===void 0?void 0:_stockValidationStatu5.hasInsufficientStock,onClick:()=>completeSale(selectedSale.id),children:(_stockValidationStatu6=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu6!==void 0&&_stockValidationStatu6.hasInsufficientStock?t('buttons.insufficient_stock'):t('buttons.complete_sale')})]})]})}),showEditModal&&editingSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal edit-sale-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Edit Sale - \",editingSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_name||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_name:e.target.value})),placeholder:t('forms.customer_name')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_phone||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_phone:e.target.value})),placeholder:t('forms.phone_number')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:editFormData.customer_email||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_email:e.target.value})),placeholder:t('forms.email_address')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:editFormData.payment_method||'cash',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{payment_method:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"card\",children:\"Card\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mobile_money\",children:\"Mobile Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_transfer\",children:\"Bank Transfer\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Payment Type\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-types\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"payment-type\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"paymentType\",value:\"full\",checked:paymentType==='full',onChange:e=>setPaymentType(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"Full Payment (100%)\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"payment-type\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"paymentType\",value:\"partial\",checked:paymentType==='partial',onChange:e=>setPaymentType(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"Partial Payment (0-99.99%)\"})]})]}),paymentType==='partial'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount to Pay\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",min:\"0\",max:editTotals.subtotal||0,value:paidAmount||0,onChange:e=>{const value=parseFloat(e.target.value)||0;setPaidAmount(value);},placeholder:t('forms.enter_amount_to_pay')}),/*#__PURE__*/_jsxs(\"small\",{children:[\"Total: \",formatCurrency(editTotals.subtotal||0),\" | Remaining: \",formatCurrency((editTotals.subtotal||0)-(paidAmount||0))]})]}),paymentType==='full'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount to Pay\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:editTotals.subtotal||0,readOnly:true,className:\"form-control\"}),/*#__PURE__*/_jsx(\"small\",{children:\"Full payment for the total amount.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_editFormData$items2=editFormData.items)===null||_editFormData$items2===void 0?void 0:_editFormData$items2.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-edit-container\",children:(_editFormData$items3=editFormData.items)===null||_editFormData$items3===void 0?void 0:_editFormData$items3.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"edit-item-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-unit\",children:item.unit_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[formatCurrency(item.unit_price),\" each\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Quantity:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.01\",value:item.quantity,onChange:e=>handleEditItemQuantity(index,e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price Mode:\"}),/*#__PURE__*/_jsxs(\"select\",{value:item.price_mode,disabled:true,style:{backgroundColor:'#f5f5f5',color:'#666'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"standard\",children:\"Standard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"wholesale\",children:\"Wholesale\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-total\",children:formatCurrency(item.total_price)}),/*#__PURE__*/_jsx(\"div\",{className:\"item-actions\",children:/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>removeEditItem(index),children:\"Remove\"})})]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(editTotals.subtotal||0)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"total-value\",children:formatCurrency(editTotals.total_amount||0)})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:saveEditedSale,children:\"Save Changes\"})]})]})}),showPackagingValidation&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-content packaging-validation-modal\",children:/*#__PURE__*/_jsx(PackagingValidation,{saleId:packagingValidationSaleId,onComplete:handlePackagingValidationComplete,onCancel:handlePackagingValidationCancel})})})]});};export default PendingSales;","map":{"version":3,"names":["React","useState","useEffect","useTranslation","api","Button","PrintButton","formatCurrency","formatDate","useAuth","PackagingValidation","jsx","_jsx","jsxs","_jsxs","PendingSales","_selectedSale$payment","_selectedSale$items","_selectedSale$items2","_selectedSale$items3","_stockValidationStatu4","_stockValidationStatu5","_stockValidationStatu6","_editFormData$items2","_editFormData$items3","t","user","loading","authLoading","pendingSales","setPendingSales","setLoading","showSaleModal","setShowSaleModal","selectedSale","setSelectedSale","showEditModal","setShowEditModal","editingSale","setEditingSale","editFormData","setEditFormData","editTotals","setEditTotals","subtotal","total_amount","completingSale","setCompletingSale","stockValidationStatus","setStockValidationStatus","paymentType","setPaymentType","paidAmount","setPaidAmount","showPackagingValidation","setShowPackagingValidation","packagingValidationSaleId","setPackagingValidationSaleId","fetchPendingSales","length","validateStockForAllSales","token","localStorage","getItem","response","get","data","error","_error$response","_error$response2","_error$response3","_error$response4","console","message","status","statusText","alert","window","location","href","_error$response5","_error$response5$data","detail","validationStatus","sale","hasInsufficientStock","item","items","concat","product","stockData","available_units","unitData","find","unit","id","available_quantity","quantity_display","completeSale","saleId","_sale$items","s","hasPackagingItems","some","product_has_packaging","performSaleCompletion","_error$response6","_error$response6$data","stockValidationErrors","push","product_name","unit_name","join","post","completedSale","_objectSpread","prev","filter","_error$response7","_error$response7$data","handlePackagingValidationComplete","handlePackagingValidationCancel","cancelSale","confirm","delete","_error$response8","_error$response8$data","preparePrintData","_sale$items2","sale_number","customer_name","customer_phone","customer_email","user_name","username","user_id","created_at","print_timestamp","Date","toISOString","print_id","now","Math","random","toString","substr","payment_status","payment_method","paid_amount","remaining_amount","parseFloat","due_date","discount_amount","tax_amount","map","product_sku","quantity","unit_price","total_price","editSale","_sale$items3","unitPrice","calculatedTotalPrice","calculatedSubtotal","reduce","sum","taxAmount","discountAmount","calculatedTotal","formData","currentPaidAmount","calculatedTotalAmount","handleEditItemQuantity","itemIndex","newQuantity","Array","isArray","updatedItems","undefined","newTotalAmount","editFormDataTax","editFormDataDiscount","newEditFormData","setTimeout","removeEditItem","_","index","calculateEditTotal","_editFormData$items","total","saveEditedSale","updateData","log","patch","_error$response9","_error$response9$data","className","children","_sale$items4","_sale$items5","_sale$items6","_stockValidationStatu","_stockValidationStatu2","_stockValidationStatu3","slice","price_mode","size","variant","onClick","title","type","printText","disabled","replace","toUpperCase","style","minHeight","max","maxHeight","marginBottom","value","onChange","e","target","placeholder","name","checked","step","min","readOnly","backgroundColor","color","onComplete","onCancel"],"sources":["/home/el-ifran/WareHouse_Manager/elif-sales-app/beverage_management_system/src/pages/PendingSales.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport api from '../services/api';\nimport Button from '../components/Button';\nimport PrintButton from '../components/PrintButton';\nimport { formatCurrency, formatDate } from '../utils/helpers';\nimport { useAuth } from '../contexts/AuthContext';\nimport PackagingValidation from './PackagingValidation';\nimport './PendingSales.css';\n\nconst PendingSales = () => {\n  const { t } = useTranslation();\n  const { user, loading: authLoading } = useAuth();\n  const [pendingSales, setPendingSales] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showSaleModal, setShowSaleModal] = useState(false);\n  const [selectedSale, setSelectedSale] = useState(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editingSale, setEditingSale] = useState(null);\n  const [editFormData, setEditFormData] = useState({});\n  const [editTotals, setEditTotals] = useState({ subtotal: 0, total_amount: 0 });\n  const [completingSale, setCompletingSale] = useState(null);\n  const [stockValidationStatus, setStockValidationStatus] = useState({});\n  const [paymentType, setPaymentType] = useState('full');\n  const [paidAmount, setPaidAmount] = useState(0);\n  const [showPackagingValidation, setShowPackagingValidation] = useState(false);\n  const [packagingValidationSaleId, setPackagingValidationSaleId] = useState(null);\n\n  useEffect(() => {\n    if (!authLoading && user) {\n      fetchPendingSales();\n    }\n  }, [authLoading, user]);\n\n  useEffect(() => {\n    if (pendingSales.length > 0) {\n      validateStockForAllSales();\n    }\n  }, [pendingSales]);\n\n  const fetchPendingSales = async () => {\n    try {\n      setLoading(true);\n      \n      // Check if user is authenticated\n      const token = localStorage.getItem('accessToken');\n      \n      const response = await api.get('/api/sales/pending/');\n      setPendingSales(response.data);\n    } catch (error) {\n      console.error('Error fetching pending sales:', error);\n      console.error('Error details:', {\n        message: error.message,\n        response: error.response?.data,\n        status: error.response?.status,\n        statusText: error.response?.statusText\n      });\n      \n      // More specific error handling\n      if (error.response?.status === 401) {\n        alert('Authentication required. Please log in again.');\n        // Redirect to login or refresh token\n        window.location.href = '/login';\n      } else {\n        alert('Error fetching pending sales: ' + (error.response?.data?.detail || error.message));\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateStockForAllSales = async () => {\n    const validationStatus = {};\n    \n    for (const sale of pendingSales) {\n      let hasInsufficientStock = false;\n      \n      for (const item of sale.items || []) {\n        try {\n          const response = await api.get(`/api/products/${item.product}/stock-availability/`);\n          const stockData = response.data;\n          \n          if (stockData.available_units) {\n            const unitData = stockData.available_units.find(unit => unit.id === item.unit);\n            if (unitData && unitData.available_quantity < item.quantity_display) {\n              hasInsufficientStock = true;\n              break;\n            }\n          }\n        } catch (error) {\n          console.error(`Error checking stock for product ${item.product}:`, error);\n        }\n      }\n      \n      validationStatus[sale.id] = { hasInsufficientStock };\n    }\n    \n    setStockValidationStatus(validationStatus);\n  };\n\n  const completeSale = async (saleId) => {\n    try {\n      setCompletingSale(saleId);\n      \n      // Check if sale has items with packaging that need validation\n      const sale = pendingSales.find(s => s.id === saleId);\n      const hasPackagingItems = sale.items?.some(item => item.product_has_packaging);\n      \n      if (hasPackagingItems) {\n        // Show packaging validation page\n        setPackagingValidationSaleId(saleId);\n        setShowPackagingValidation(true);\n        setCompletingSale(null);\n        return;\n      }\n      \n      // Proceed with normal completion if no packaging items\n      await performSaleCompletion(saleId);\n    } catch (error) {\n      console.error('Error completing sale:', error);\n      alert('Error completing sale: ' + (error.response?.data?.detail || error.message));\n      setCompletingSale(null);\n    }\n  };\n\n  const performSaleCompletion = async (saleId) => {\n    try {\n      // Check stock before completing\n      const sale = pendingSales.find(s => s.id === saleId);\n      const stockValidationErrors = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          const response = await api.get(`/api/products/${item.product}/stock-availability/`);\n          const stockData = response.data;\n          \n          if (stockData.available_units) {\n            const unitData = stockData.available_units.find(unit => unit.id === item.unit);\n            if (unitData && unitData.available_quantity < item.quantity_display) {\n              stockValidationErrors.push(`${item.product_name}: Required ${item.quantity_display} ${item.unit_name}, but only ${unitData.available_quantity} available`);\n            }\n          }\n        } catch (error) {\n          console.error(`Error checking stock for product ${item.product}:`, error);\n          stockValidationErrors.push(`${item.product_name}: Unable to check stock availability`);\n        }\n      }\n      \n      if (stockValidationErrors.length > 0) {\n        alert('Cannot complete sale due to insufficient stock:\\n' + stockValidationErrors.join('\\n'));\n        return;\n      }\n      \n      await api.post(`/api/sales/${saleId}/complete/`);\n      \n      // Print receipt after successful completion using PrintButton logic\n      const completedSale = { ...sale, status: 'completed' };\n      \n      // Remove from pending sales list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      setShowSaleModal(false);\n      setSelectedSale(null);\n      \n      alert('Sale completed successfully!');\n    } catch (error) {\n      console.error('Error completing sale:', error);\n      alert('Error completing sale: ' + (error.response?.data?.detail || error.message));\n    } finally {\n      setCompletingSale(null);\n    }\n  };\n\n  const handlePackagingValidationComplete = async () => {\n    try {\n      await performSaleCompletion(packagingValidationSaleId);\n      setShowPackagingValidation(false);\n      setPackagingValidationSaleId(null);\n    } catch (error) {\n      console.error('Error completing sale after packaging validation:', error);\n    }\n  };\n\n  const handlePackagingValidationCancel = () => {\n    setShowPackagingValidation(false);\n    setPackagingValidationSaleId(null);\n    setCompletingSale(null);\n  };\n\n  const cancelSale = async (saleId) => {\n    if (window.confirm('Are you sure you want to cancel this sale?')) {\n      try {\n        await api.delete(`/api/sales/${saleId}/`);\n        setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n        setShowSaleModal(false);\n        setSelectedSale(null);\n        alert('Sale cancelled successfully!');\n      } catch (error) {\n        console.error('Error cancelling sale:', error);\n        alert('Error cancelling sale: ' + (error.response?.data?.detail || error.message));\n      }\n    }\n  };\n\n  // Prepare print data for PrintButton component (consistent with POS logic)\n  const preparePrintData = (sale) => {\n    return {\n      sale_number: sale.sale_number,\n      customer_name: sale.customer_name || 'Walk-in Customer',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      user_name: user?.username || t('app.unknown_user'),\n      user_id: user?.id || 'unknown',\n      created_at: sale.created_at,\n      print_timestamp: new Date().toISOString(),\n      print_id: `PRINT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      status: sale.status === 'completed' ? 'completed' : 'pending',\n      payment_status: sale.payment_status || 'pending',\n      payment_method: sale.payment_method || 'cash',\n      total_amount: sale.total_amount || sale.subtotal,\n      paid_amount: sale.paid_amount || 0,\n      remaining_amount: sale.remaining_amount || (parseFloat(sale.total_amount || sale.subtotal) - parseFloat(sale.paid_amount || 0)),\n      due_date: sale.due_date || null,\n      subtotal: sale.subtotal,\n      discount_amount: sale.discount_amount || 0,\n      tax_amount: sale.tax_amount || 0,\n      items: sale.items?.map(item => ({\n        product_name: item.product_name,\n        product_sku: item.product_sku,\n        quantity: item.quantity,\n        quantity_display: item.quantity_display,\n        unit_name: item.unit_name,\n        unit_price: item.unit_price,\n        total_price: item.total_price\n      })) || []\n    };\n  };\n\n  const editSale = (sale) => {\n    setEditingSale(sale);\n    \n    // Initialize items with proper quantities and calculate totals\n    const items = sale.items?.map(item => {\n      const quantity = parseFloat(item.quantity_display || item.quantity) || 0;\n      const unitPrice = parseFloat(item.unit_price) || 0;\n      const calculatedTotalPrice = quantity * unitPrice;\n      \n      return {\n        ...item,\n        quantity: quantity,\n        unit_price: unitPrice,\n        total_price: calculatedTotalPrice\n      };\n    }) || [];\n    \n    // Calculate initial totals based on current item data\n    const calculatedSubtotal = items.reduce((sum, item) => sum + item.total_price, 0);\n    \n    // If no tax_amount is provided, assume 0% tax (common for many sales)\n    const taxAmount = parseFloat(sale.tax_amount || 0) || 0;\n    const discountAmount = parseFloat(sale.discount_amount || 0) || 0;\n    const calculatedTotal = calculatedSubtotal + taxAmount - discountAmount;\n    \n    // Always use calculated totals to ensure accuracy\n    const subtotal = calculatedSubtotal;\n    const total_amount = calculatedTotal;\n    \n    const formData = {\n      customer_name: sale.customer_name || '',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      payment_method: sale.payment_method || 'cash',\n      items: items,\n      subtotal: subtotal,\n      total_amount: total_amount,\n      tax_amount: sale.tax_amount || 0,\n      discount_amount: sale.discount_amount || 0\n    };\n    \n    \n    setEditFormData(formData);\n    setEditTotals({ subtotal: subtotal, total_amount: total_amount });\n    \n    // Initialize payment options\n    const currentPaidAmount = parseFloat(sale.paid_amount) || 0;\n    const calculatedTotalAmount = total_amount; // Use the calculated total from form data\n    \n    if (currentPaidAmount >= calculatedTotalAmount) {\n      setPaymentType('full');\n      setPaidAmount(calculatedTotalAmount);\n    } else if (currentPaidAmount > 0) {\n      setPaymentType('partial');\n      setPaidAmount(currentPaidAmount);\n    } else {\n      setPaymentType('full');\n      setPaidAmount(calculatedTotalAmount);\n    }\n    \n    setShowEditModal(true);\n    setShowSaleModal(false);\n  };\n\n  const handleEditItemQuantity = (itemIndex, newQuantity) => {\n    \n    if (!editFormData.items || !Array.isArray(editFormData.items)) {\n      console.error('editFormData.items is not properly initialized:', editFormData);\n      return;\n    }\n    \n    const updatedItems = [...editFormData.items];\n    updatedItems[itemIndex].quantity = parseFloat(newQuantity) || 0;\n    updatedItems[itemIndex].total_price = updatedItems[itemIndex].quantity * parseFloat(updatedItems[itemIndex].unit_price) || 0;\n    \n    \n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal\n    });\n    \n    // Fallback to original sale values if editFormData doesn't have them\n    const taxAmount = parseFloat(editFormData.tax_amount !== undefined ? editFormData.tax_amount : (editingSale?.tax_amount || 0)) || 0;\n    const discountAmount = parseFloat(editFormData.discount_amount !== undefined ? editFormData.discount_amount : (editingSale?.discount_amount || 0)) || 0;\n    const newTotalAmount = subtotal + taxAmount - discountAmount;\n    \n    setEditTotals({\n      subtotal: subtotal,\n      taxAmount: taxAmount,\n      discountAmount: discountAmount,\n      newTotalAmount: newTotalAmount,\n      editFormDataTax: editFormData.tax_amount,\n      editFormDataDiscount: editFormData.discount_amount\n    });\n    \n    const newEditFormData = {\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: newTotalAmount\n    };\n    \n    \n    setEditFormData(newEditFormData);\n    setEditTotals({ subtotal: subtotal, total_amount: newTotalAmount });\n    \n    // Force a re-render by logging the state after setting it\n    setTimeout(() => {\n    }, 100);\n  };\n\n  const removeEditItem = (itemIndex) => {\n    const updatedItems = editFormData.items.filter((_, index) => index !== itemIndex);\n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    // Fallback to original sale values if editFormData doesn't have them\n    const taxAmount = parseFloat(editFormData.tax_amount !== undefined ? editFormData.tax_amount : (editingSale?.tax_amount || 0)) || 0;\n    const discountAmount = parseFloat(editFormData.discount_amount !== undefined ? editFormData.discount_amount : (editingSale?.discount_amount || 0)) || 0;\n    const newTotalAmount = subtotal + taxAmount - discountAmount;\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: newTotalAmount\n    });\n    setEditTotals({ subtotal: subtotal, total_amount: newTotalAmount });\n  };\n\n  const calculateEditTotal = () => {\n    return editFormData.items?.reduce((total, item) => {\n      return total + (parseFloat(item.total_price || 0));\n    }, 0) || 0;\n  };\n\n  // Update paid amount when payment type changes or subtotal changes\n  useEffect(() => {\n    if (paymentType === 'full') {\n      setPaidAmount(editTotals.subtotal || 0);\n    }\n  }, [paymentType, editTotals.subtotal]);\n\n\n  const saveEditedSale = async () => {\n    try {\n      const updateData = {\n        customer_name: editFormData.customer_name,\n        customer_phone: editFormData.customer_phone,\n        customer_email: editFormData.customer_email,\n        payment_method: editFormData.payment_method,\n        paid_amount: paidAmount,\n        items: editFormData.items.map(item => ({\n          id: item.id,\n          quantity: item.quantity,\n          unit_price: item.unit_price\n        }))\n      };\n      \n      console.log('Saving edited sale:', {\n        saleId: editingSale.id,\n        updateData: updateData,\n        editFormData: editFormData\n      });\n      \n      const response = await api.patch(`/sales/${editingSale.id}/`, updateData);\n      \n      setShowEditModal(false);\n      setEditingSale(null);\n      setEditFormData({});\n      \n      // Refresh the pending sales list\n      fetchPendingSales();\n      \n      alert('Sale updated successfully!');\n    } catch (error) {\n      console.error('Error updating sale:', error);\n      alert('Error updating sale: ' + (error.response?.data?.detail || error.message));\n    }\n  };\n\n  if (authLoading || loading) {\n    return (\n      <div className=\"pending-sales-page\">\n        <div className=\"page-header\">\n          <h1>{t('titles.pending_sales')}</h1>\n        </div>\n        <div className=\"loading-message\">Loading pending sales...</div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"pending-sales-page\">\n        <div className=\"page-header\">\n          <h1>{t('titles.pending_sales')}</h1>\n        </div>\n        <div className=\"loading-message\">Please log in to view pending sales.</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"pending-sales-page\">\n      <div className=\"page-header\">\n        <h1>{t('titles.pending_sales')}</h1>\n        <p>Manage and validate pending sales before completion</p>\n      </div>\n\n      {pendingSales.length === 0 ? (\n        <div className=\"no-pending-sales\">\n          <div className=\"no-sales-icon\"></div>\n          <h3>{t('titles.no_pending_sales')}</h3>\n          <p>All sales have been completed or there are no pending sales at the moment.</p>\n        </div>\n      ) : (\n        <div className=\"pending-sales-grid\">\n          {pendingSales.map((sale) => (\n            <div key={sale.id} className=\"pending-sale-card\">\n              <div className=\"sale-header\">\n                <div className=\"sale-number\">{sale.sale_number}</div>\n                <div className=\"sale-date\">{formatDate(sale.created_at)}</div>\n              </div>\n              \n              <div className=\"sale-customer\">\n                <strong>{sale.customer_name || 'Walk-in Customer'}</strong>\n              </div>\n              \n              <div className=\"sale-items\">\n                <div className=\"items-count\">{sale.items?.length || 0} items</div>\n                <div className=\"items-preview\">\n                  {sale.items?.slice(0, 3).map((item, index) => (\n                    <div key={index} className=\"item-preview\">\n                      <span className=\"item-name\">{item.product_name}</span>\n                      <span className=\"item-quantity\">{item.quantity_display || item.quantity} {item.unit_name}</span>\n                      <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                        {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                      </span>\n                    </div>\n                  ))}\n                  {sale.items?.length > 3 && (\n                    <div className=\"more-items\">+{sale.items.length - 3} more items</div>\n                  )}\n                </div>\n              </div>\n              \n              <div className=\"sale-total\">\n                <strong>{formatCurrency(sale.total_amount)}</strong>\n              </div>\n              \n              <div className=\"stock-status\">\n                {stockValidationStatus[sale.id]?.hasInsufficientStock ? (\n                  <div className=\"stock-insufficient\"> Insufficient Stock</div>\n                ) : (\n                  <div className=\"stock-sufficient\"> Stock Available</div>\n                )}\n              </div>\n              \n              <div className=\"sale-actions\">\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={async () => {\n                    try {\n                      // Fetch complete sale data including items\n                      const response = await api.get(`/api/sales/${sale.id}/`);\n                      setSelectedSale(response.data);\n                      setShowSaleModal(true);\n                    } catch (error) {\n                      console.error('Error fetching sale details:', error);\n                      // Fallback to using the sale data from the list\n                      setSelectedSale(sale);\n                      setShowSaleModal(true);\n                    }\n                  }}\n                >\n                  View Details\n                </Button>\n                \n                {/* Use PrintButton component instead of custom print function */}\n                <PrintButton\n                  data={preparePrintData(sale)}\n                  title={t('titles.sale_receipt')}\n                  type=\"sale\"\n                  printText=\" Print\"\n                  className=\"print-sale-btn\"\n                  variant=\"outline\"\n                  size=\"small\"\n                />\n                \n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => editSale(sale)}\n                >\n                   Edit\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"primary\"\n                  disabled={stockValidationStatus[sale.id]?.hasInsufficientStock}\n                  onClick={() => completeSale(sale.id)}\n                  loading={completingSale === sale.id}\n                >\n                  {stockValidationStatus[sale.id]?.hasInsufficientStock ? t('buttons.insufficient_stock') : t('buttons.complete_sale')}\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Sale Details Modal */}\n      {showSaleModal && selectedSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal sale-details-modal\">\n            <div className=\"modal-header\">\n              <h2>Sale Details - {selectedSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                \n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"info-section\">\n                <h3>Customer Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Name:</span>\n                    <span className=\"info-value\">{selectedSale.customer_name || 'Walk-in Customer'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Phone:</span>\n                    <span className=\"info-value\">{selectedSale.customer_phone || 'N/A'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Email:</span>\n                    <span className=\"info-value\">{selectedSale.customer_email || 'N/A'}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Sale Information */}\n              <div className=\"info-section\">\n                <h3>Sale Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Date:</span>\n                    <span className=\"info-value\">{formatDate(selectedSale.created_at)}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Payment Method:</span>\n                    <span className=\"info-value\">{selectedSale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Status:</span>\n                    <span className=\"status-badge pending\">Pending</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Items List */}\n              <div className=\"items-section\">\n                <h3>Items ({selectedSale.items?.length || 0})</h3>\n                <div \n                  className=\"items-container\"\n                  style={{\n                    minHeight: `${Math.max(200, (selectedSale.items?.length || 0) * 120)}px`,\n                    maxHeight: '500px'\n                  }}\n                >\n                  {selectedSale.items?.map((item, index) => (\n                    <div key={index} className=\"item-card\" style={{marginBottom: '12px'}}>\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-quantity\">\n                          <span className=\"quantity\">{item.quantity_display || item.quantity || 'N/A'}</span>\n                          <span className=\"unit\">{item.unit_name || 'N/A'}</span>\n                        </div>\n                        <div className=\"item-price\">\n                          <span className=\"unit-price\">{item.unit_price ? formatCurrency(item.unit_price) : 'N/A'} each</span>\n                          <span className=\"total-price\">{item.total_price ? formatCurrency(item.total_price) : 'N/A'}</span>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.subtotal)}</span>\n                  </div>\n                  {selectedSale.discount_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Discount:</span>\n                      <span className=\"total-value\">-{formatCurrency(selectedSale.discount_amount)}</span>\n                    </div>\n                  )}\n                  {selectedSale.tax_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Tax:</span>\n                      <span className=\"total-value\">{formatCurrency(selectedSale.tax_amount)}</span>\n                    </div>\n                  )}\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.total_amount)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Stock Status */}\n              <div className=\"stock-section\">\n                <h3>Stock Status</h3>\n                <div className=\"stock-status\">\n                  {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? (\n                    <div className=\"stock-insufficient\">\n                       Insufficient Stock\n                    </div>\n                  ) : (\n                    <div className=\"stock-sufficient\">\n                       Stock Available\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                Close\n              </Button>\n              \n              {/* Use PrintButton component in modal footer */}\n              <PrintButton\n                data={preparePrintData(selectedSale)}\n                title={t('titles.sale_receipt')}\n                type=\"sale\"\n                printText=\" Print Receipt\"\n                className=\"print-sale-btn\"\n                variant=\"secondary\"\n              />\n              \n              <Button\n                variant=\"secondary\"\n                onClick={() => editSale(selectedSale)}\n              >\n                 Edit\n              </Button>\n              <Button\n                variant=\"success\"\n                disabled={stockValidationStatus[selectedSale.id]?.hasInsufficientStock}\n                onClick={() => completeSale(selectedSale.id)}\n              >\n                {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? t('buttons.insufficient_stock') : t('buttons.complete_sale')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Sale Modal */}\n      {showEditModal && editingSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal edit-sale-modal\">\n            <div className=\"modal-header\">\n              <h2>Edit Sale - {editingSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                \n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"form-section\">\n                <h3>Customer Information</h3>\n                <div className=\"form-grid\">\n                  <div className=\"form-group\">\n                    <label>Customer Name</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_name || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_name: e.target.value})}\n                      placeholder={t('forms.customer_name')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Phone</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_phone || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_phone: e.target.value})}\n                      placeholder={t('forms.phone_number')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Email</label>\n                    <input\n                      type=\"email\"\n                      value={editFormData.customer_email || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_email: e.target.value})}\n                      placeholder={t('forms.email_address')}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Payment Method</label>\n                    <select\n                      value={editFormData.payment_method || 'cash'}\n                      onChange={(e) => setEditFormData({...editFormData, payment_method: e.target.value})}\n                    >\n                      <option value=\"cash\">Cash</option>\n                      <option value=\"card\">Card</option>\n                      <option value=\"mobile_money\">Mobile Money</option>\n                      <option value=\"bank_transfer\">Bank Transfer</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n\n              {/* Payment Options */}\n              <div className=\"form-section\">\n                <h3>Payment Type</h3>\n                <div className=\"payment-types\">\n                  <label className=\"payment-type\">\n                    <input\n                      type=\"radio\"\n                      name=\"paymentType\"\n                      value=\"full\"\n                      checked={paymentType === 'full'}\n                      onChange={(e) => setPaymentType(e.target.value)}\n                    />\n                    <span>Full Payment (100%)</span>\n                  </label>\n                  <label className=\"payment-type\">\n                    <input\n                      type=\"radio\"\n                      name=\"paymentType\"\n                      value=\"partial\"\n                      checked={paymentType === 'partial'}\n                      onChange={(e) => setPaymentType(e.target.value)}\n                    />\n                    <span>Partial Payment (0-99.99%)</span>\n                  </label>\n                </div>\n                \n                {paymentType === 'partial' && (\n                  <div className=\"form-group\">\n                    <label>Amount to Pay</label>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      max={editTotals.subtotal || 0}\n                      value={paidAmount || 0}\n                      onChange={(e) => {\n                        const value = parseFloat(e.target.value) || 0;\n                        setPaidAmount(value);\n                      }}\n                      placeholder={t('forms.enter_amount_to_pay')}\n                    />\n                    <small>\n                      Total: {formatCurrency(editTotals.subtotal || 0)} | \n                      Remaining: {formatCurrency((editTotals.subtotal || 0) - (paidAmount || 0))}\n                    </small>\n                  </div>\n                )}\n                \n                {paymentType === 'full' && (\n                  <div className=\"form-group\">\n                    <label>Amount to Pay</label>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      value={editTotals.subtotal || 0}\n                      readOnly\n                      className=\"form-control\"\n                    />\n                    <small>Full payment for the total amount.</small>\n                  </div>\n                )}\n              </div>\n\n              {/* Items */}\n              <div className=\"form-section\">\n                <h3>Items ({editFormData.items?.length || 0})</h3>\n                <div className=\"items-edit-container\">\n                  {editFormData.items?.map((item, index) => (\n                    <div key={index} className=\"edit-item-card\">\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-unit\">{item.unit_name}</div>\n                        <div className=\"item-price\">{formatCurrency(item.unit_price)} each</div>\n                      </div>\n                      <div className=\"item-controls\">\n                        <div className=\"control-group\">\n                          <label>Quantity:</label>\n                          <input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            value={item.quantity}\n                            onChange={(e) => handleEditItemQuantity(index, e.target.value)}\n                          />\n                        </div>\n                        <div className=\"control-group\">\n                          <label>Price Mode:</label>\n                          <select\n                            value={item.price_mode}\n                            disabled\n                            style={{ backgroundColor: '#f5f5f5', color: '#666' }}\n                          >\n                            <option value=\"standard\">Standard</option>\n                            <option value=\"wholesale\">Wholesale</option>\n                          </select>\n                        </div>\n                        <div className=\"item-total\">\n                          {formatCurrency(item.total_price)}\n                        </div>\n                        <div className=\"item-actions\">\n                          <Button\n                            size=\"small\"\n                            variant=\"danger\"\n                            onClick={() => removeEditItem(index)}\n                          >\n                            Remove\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(editTotals.subtotal || 0)}</span>\n                  </div>\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(editTotals.total_amount || 0)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={saveEditedSale}\n              >\n                Save Changes\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Packaging Validation Modal */}\n      {showPackagingValidation && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal-content packaging-validation-modal\">\n            <PackagingValidation\n              saleId={packagingValidationSaleId}\n              onComplete={handlePackagingValidationComplete}\n              onCancel={handlePackagingValidationCancel}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PendingSales;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}