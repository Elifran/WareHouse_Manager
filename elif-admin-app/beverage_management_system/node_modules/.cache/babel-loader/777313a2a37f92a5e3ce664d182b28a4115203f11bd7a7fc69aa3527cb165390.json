{"ast":null,"code":"import _objectSpread from\"/home/el-ifran/WareHouse_Manager/beverage_management_system/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{api}from'../utils/api';import Button from'../components/Button';import{formatCurrency,formatDate}from'../utils/helpers';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PendingSales=()=>{var _selectedSale$payment,_selectedSale$items,_selectedSale$items2,_stockValidationStatu4,_stockValidationStatu5,_stockValidationStatu6,_editFormData$items,_editFormData$items2;const[pendingSales,setPendingSales]=useState([]);const[loading,setLoading]=useState(true);const[showSaleModal,setShowSaleModal]=useState(false);const[selectedSale,setSelectedSale]=useState(null);const[showEditModal,setShowEditModal]=useState(false);const[editingSale,setEditingSale]=useState(null);const[editFormData,setEditFormData]=useState({});const[completingSale,setCompletingSale]=useState(null);const[stockValidationStatus,setStockValidationStatus]=useState({});useEffect(()=>{fetchPendingSales();},[]);useEffect(()=>{if(pendingSales.length>0){validateStockForAllSales();}},[pendingSales]);const fetchPendingSales=async()=>{try{setLoading(true);const response=await api.get('/sales/pending/');setPendingSales(response.data);}catch(error){var _error$response,_error$response$data;console.error('Error fetching pending sales:',error);alert('Error fetching pending sales: '+(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||error.message));}finally{setLoading(false);}};const validateStockForAllSales=async()=>{const validationStatus={};for(const sale of pendingSales){let hasInsufficientStock=false;for(const item of sale.items||[]){try{const response=await api.get(\"/products/\".concat(item.product,\"/stock-availability/\"));const stockData=response.data;if(stockData.available_units){const unitData=stockData.available_units.find(unit=>unit.id===item.unit);if(unitData&&unitData.available_quantity<item.quantity_display){hasInsufficientStock=true;break;}}}catch(error){console.error(\"Error checking stock for product \".concat(item.product,\":\"),error);}}validationStatus[sale.id]={hasInsufficientStock};}setStockValidationStatus(validationStatus);};const completeSale=async saleId=>{try{setCompletingSale(saleId);// Check stock before completing\nconst sale=pendingSales.find(s=>s.id===saleId);const stockValidationErrors=[];for(const item of sale.items||[]){try{const response=await api.get(\"/products/\".concat(item.product,\"/stock-availability/\"));const stockData=response.data;if(stockData.available_units){const unitData=stockData.available_units.find(unit=>unit.id===item.unit);if(unitData&&unitData.available_quantity<item.quantity_display){stockValidationErrors.push(\"\".concat(item.product_name,\": Required \").concat(item.quantity_display,\" \").concat(item.unit_name,\", but only \").concat(unitData.available_quantity,\" available\"));}}}catch(error){console.error(\"Error checking stock for product \".concat(item.product,\":\"),error);stockValidationErrors.push(\"\".concat(item.product_name,\": Unable to check stock availability\"));}}if(stockValidationErrors.length>0){alert('Cannot complete sale due to insufficient stock:\\n'+stockValidationErrors.join('\\n'));return;}await api.post(\"/sales/\".concat(saleId,\"/complete/\"));// Print receipt after successful completion\nconst completedSale=_objectSpread(_objectSpread({},sale),{},{status:'completed'});printPendingSale(completedSale);// Remove from pending sales list\nsetPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale completed successfully!');}catch(error){var _error$response2,_error$response2$data;console.error('Error completing sale:',error);alert('Error completing sale: '+(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||error.message));}finally{setCompletingSale(null);}};const cancelSale=async saleId=>{if(window.confirm('Are you sure you want to cancel this sale?')){try{await api.delete(\"/sales/\".concat(saleId,\"/\"));setPendingSales(prev=>prev.filter(sale=>sale.id!==saleId));setShowSaleModal(false);setSelectedSale(null);alert('Sale cancelled successfully!');}catch(error){var _error$response3,_error$response3$data;console.error('Error cancelling sale:',error);alert('Error cancelling sale: '+(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.detail)||error.message));}}};const printPendingSale=sale=>{var _sale$payment_method,_sale$items;const printData=_objectSpread(_objectSpread({},sale),{},{status:sale.status==='completed'?'completed':'pending',statusText:sale.status==='completed'?'This sale has been completed':'This sale is pending'});// Create a new window for printing\nconst printWindow=window.open('','_blank');printWindow.document.write(\"\\n      <!DOCTYPE html>\\n      <html>\\n        <head>\\n          <title>Receipt - \".concat(sale.sale_number,\"</title>\\n          <style>\\n            body { font-family: Arial, sans-serif; margin: 20px; }\\n            .header { text-align: center; margin-bottom: 20px; }\\n            .receipt-info { margin-bottom: 20px; }\\n            .items { margin-bottom: 20px; }\\n            .item { display: flex; justify-content: space-between; margin-bottom: 5px; }\\n            .totals { border-top: 1px solid #000; padding-top: 10px; }\\n            .total-row { display: flex; justify-content: space-between; margin-bottom: 5px; }\\n            .total-final { font-weight: bold; font-size: 1.2em; }\\n            .status { text-align: center; margin-top: 20px; font-weight: bold; }\\n          </style>\\n        </head>\\n        <body>\\n          <div class=\\\"header\\\">\\n            <h1>Beverage Management System</h1>\\n            <h2>Receipt - \").concat(sale.sale_number,\"</h2>\\n          </div>\\n          \\n          <div class=\\\"receipt-info\\\">\\n            <p><strong>Date:</strong> \").concat(formatDate(sale.created_at),\"</p>\\n            <p><strong>Customer:</strong> \").concat(sale.customer_name||'Walk-in Customer',\"</p>\\n            <p><strong>Payment Method:</strong> \").concat((_sale$payment_method=sale.payment_method)===null||_sale$payment_method===void 0?void 0:_sale$payment_method.replace('_',' ').toUpperCase(),\"</p>\\n          </div>\\n          \\n          <div class=\\\"items\\\">\\n            <h3>Items:</h3>\\n            \").concat((_sale$items=sale.items)===null||_sale$items===void 0?void 0:_sale$items.map(item=>\"\\n              <div class=\\\"item\\\">\\n                <span>\".concat(item.product_name,\" - \").concat(item.quantity_display||item.quantity,\" \").concat(item.unit_name,\" \\xD7 \").concat(formatCurrency(item.unit_price),\" MGA</span>\\n                <span>\").concat(formatCurrency(item.total_price),\" MGA</span>\\n              </div>\\n            \")).join(''),\"\\n          </div>\\n          \\n          <div class=\\\"totals\\\">\\n            <div class=\\\"total-row\\\">\\n              <span>Subtotal:</span>\\n              <span>\").concat(formatCurrency(sale.subtotal),\" MGA</span>\\n            </div>\\n            \").concat(sale.discount_amount>0?\"\\n              <div class=\\\"total-row\\\">\\n                <span>Discount:</span>\\n                <span>-\".concat(formatCurrency(sale.discount_amount),\" MGA</span>\\n              </div>\\n            \"):'',\"\\n            \").concat(sale.tax_amount>0?\"\\n              <div class=\\\"total-row\\\">\\n                <span>Tax:</span>\\n                <span>\".concat(formatCurrency(sale.tax_amount),\" MGA</span>\\n              </div>\\n            \"):'',\"\\n            <div class=\\\"total-row total-final\\\">\\n              <span>Total:</span>\\n              <span>\").concat(formatCurrency(sale.total_amount),\" MGA</span>\\n            </div>\\n          </div>\\n          \\n          <div class=\\\"status\\\">\\n            <p>\").concat(printData.statusText,\"</p>\\n          </div>\\n        </body>\\n      </html>\\n    \"));printWindow.document.close();printWindow.print();};const editSale=sale=>{var _sale$items2;setEditingSale(sale);setEditFormData({customer_name:sale.customer_name||'',customer_phone:sale.customer_phone||'',customer_email:sale.customer_email||'',payment_method:sale.payment_method||'cash',items:((_sale$items2=sale.items)===null||_sale$items2===void 0?void 0:_sale$items2.map(item=>_objectSpread(_objectSpread({},item),{},{quantity:item.quantity_display||item.quantity})))||[]});setShowEditModal(true);setShowSaleModal(false);};const handleEditItemQuantity=(itemIndex,newQuantity)=>{const updatedItems=[...editFormData.items];updatedItems[itemIndex].quantity=parseFloat(newQuantity)||0;updatedItems[itemIndex].total_price=updatedItems[itemIndex].quantity*updatedItems[itemIndex].unit_price;const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:subtotal+(editFormData.tax_amount||0)-(editFormData.discount_amount||0)}));};const removeEditItem=itemIndex=>{const updatedItems=editFormData.items.filter((_,index)=>index!==itemIndex);const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:subtotal+(editFormData.tax_amount||0)-(editFormData.discount_amount||0)}));};const handleEditItemPriceMode=async(itemIndex,newPriceMode)=>{try{const item=editFormData.items[itemIndex];const response=await api.get(\"/products/\".concat(item.product,\"/\"));const product=response.data;let newUnitPrice;if(newPriceMode==='wholesale'){newUnitPrice=product.wholesale_price||product.price;}else{newUnitPrice=product.price;}const updatedItems=[...editFormData.items];updatedItems[itemIndex].price_mode=newPriceMode;updatedItems[itemIndex].unit_price=newUnitPrice;updatedItems[itemIndex].total_price=updatedItems[itemIndex].quantity*newUnitPrice;const subtotal=updatedItems.reduce((sum,item)=>sum+item.total_price,0);setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{items:updatedItems,subtotal:subtotal,total_amount:subtotal+(editFormData.tax_amount||0)-(editFormData.discount_amount||0)}));}catch(error){var _error$response4,_error$response4$data;console.error('Error updating price mode:',error);alert('Error updating price mode: '+(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.detail)||error.message));}};const saveEditedSale=async()=>{try{const updateData={customer_name:editFormData.customer_name,customer_phone:editFormData.customer_phone,customer_email:editFormData.customer_email,payment_method:editFormData.payment_method,items:editFormData.items.map(item=>({id:item.id,quantity:item.quantity,unit_price:item.unit_price,price_mode:item.price_mode}))};await api.patch(\"/sales/\".concat(editingSale.id,\"/\"),updateData);setShowEditModal(false);setEditingSale(null);setEditFormData({});// Refresh the pending sales list\nfetchPendingSales();alert('Sale updated successfully!');}catch(error){var _error$response5,_error$response5$data;console.error('Error updating sale:',error);alert('Error updating sale: '+(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.detail)||error.message));}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Pending Sales\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"Loading pending sales...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Pending Sales\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage and validate pending sales before completion\"})]}),pendingSales.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-pending-sales\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"no-sales-icon\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Pending Sales\"}),/*#__PURE__*/_jsx(\"p\",{children:\"All sales have been completed or there are no pending sales at the moment.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"pending-sales-grid\",children:pendingSales.map(sale=>{var _sale$items3,_sale$items4,_sale$items5,_stockValidationStatu,_stockValidationStatu2,_stockValidationStatu3;return/*#__PURE__*/_jsxs(\"div\",{className:\"pending-sale-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sale-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sale-number\",children:sale.sale_number}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-date\",children:formatDate(sale.created_at)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-customer\",children:/*#__PURE__*/_jsx(\"strong\",{children:sale.customer_name||'Walk-in Customer'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-items\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"items-count\",children:[((_sale$items3=sale.items)===null||_sale$items3===void 0?void 0:_sale$items3.length)||0,\" items\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-preview\",children:[(_sale$items4=sale.items)===null||_sale$items4===void 0?void 0:_sale$items4.slice(0,3).map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-preview\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-quantity\",children:[item.quantity_display||item.quantity,\" \",item.unit_name]}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]},index)),((_sale$items5=sale.items)===null||_sale$items5===void 0?void 0:_sale$items5.length)>3&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-items\",children:[\"+\",sale.items.length-3,\" more items\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sale-total\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[formatCurrency(sale.total_amount),\" MGA\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu=stockValidationStatus[sale.id])!==null&&_stockValidationStatu!==void 0&&_stockValidationStatu.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sale-actions\",children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>{setSelectedSale(sale);setShowSaleModal(true);},children:\"View Details\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>printPendingSale(sale),children:\"\\uD83D\\uDDA8\\uFE0F Print\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outline\",onClick:()=>editSale(sale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"primary\",disabled:(_stockValidationStatu2=stockValidationStatus[sale.id])===null||_stockValidationStatu2===void 0?void 0:_stockValidationStatu2.hasInsufficientStock,onClick:()=>completeSale(sale.id),loading:completingSale===sale.id,children:(_stockValidationStatu3=stockValidationStatus[sale.id])!==null&&_stockValidationStatu3!==void 0&&_stockValidationStatu3.hasInsufficientStock?'Insufficient Stock':'Complete Sale'})]})]},sale.id);})}),showSaleModal&&selectedSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal sale-details-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Sale Details - \",selectedSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_name||'Walk-in Customer'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_phone||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:selectedSale.customer_email||'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sale Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:formatDate(selectedSale.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Payment Method:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:(_selectedSale$payment=selectedSale.payment_method)===null||_selectedSale$payment===void 0?void 0:_selectedSale$payment.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge pending\",children:\"Pending\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"items-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_selectedSale$items=selectedSale.items)===null||_selectedSale$items===void 0?void 0:_selectedSale$items.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-container\",children:(_selectedSale$items2=selectedSale.items)===null||_selectedSale$items2===void 0?void 0:_selectedSale$items2.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-quantity\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"quantity\",children:item.quantity_display||item.quantity}),/*#__PURE__*/_jsx(\"span\",{className:\"unit\",children:item.unit_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"unit-price\",children:[formatCurrency(item.unit_price),\" MGA each\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-price\",children:[formatCurrency(item.total_price),\" MGA\"]})]})]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[formatCurrency(selectedSale.subtotal),\" MGA\"]})]}),selectedSale.discount_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Discount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[\"-\",formatCurrency(selectedSale.discount_amount),\" MGA\"]})]}),selectedSale.tax_amount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Tax:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[formatCurrency(selectedSale.tax_amount),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[formatCurrency(selectedSale.total_amount),\" MGA\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stock-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Stock Status\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-status\",children:(_stockValidationStatu4=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu4!==void 0&&_stockValidationStatu4.hasInsufficientStock?/*#__PURE__*/_jsx(\"div\",{className:\"stock-insufficient\",children:\"\\u26A0\\uFE0F Insufficient Stock\"}):/*#__PURE__*/_jsx(\"div\",{className:\"stock-sufficient\",children:\"\\u2705 Stock Available\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowSaleModal(false);setSelectedSale(null);},children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>printPendingSale(selectedSale),children:\"\\uD83D\\uDDA8\\uFE0F Print Receipt\"}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>editSale(selectedSale),children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",disabled:(_stockValidationStatu5=stockValidationStatus[selectedSale.id])===null||_stockValidationStatu5===void 0?void 0:_stockValidationStatu5.hasInsufficientStock,onClick:()=>completeSale(selectedSale.id),children:(_stockValidationStatu6=stockValidationStatus[selectedSale.id])!==null&&_stockValidationStatu6!==void 0&&_stockValidationStatu6.hasInsufficientStock?'Insufficient Stock':'Complete Sale'})]})]})}),showEditModal&&editingSale&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal edit-sale-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Edit Sale - \",editingSale.sale_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_name||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_name:e.target.value})),placeholder:\"Customer name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editFormData.customer_phone||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_phone:e.target.value})),placeholder:\"Phone number\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:editFormData.customer_email||'',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{customer_email:e.target.value})),placeholder:\"Email address\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:editFormData.payment_method||'cash',onChange:e=>setEditFormData(_objectSpread(_objectSpread({},editFormData),{},{payment_method:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"card\",children:\"Card\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mobile_money\",children:\"Mobile Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_transfer\",children:\"Bank Transfer\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Items (\",((_editFormData$items=editFormData.items)===null||_editFormData$items===void 0?void 0:_editFormData$items.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"items-edit-container\",children:(_editFormData$items2=editFormData.items)===null||_editFormData$items2===void 0?void 0:_editFormData$items2.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"edit-item-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.product_name}),/*#__PURE__*/_jsx(\"span\",{className:\"price-mode-badge \".concat(item.price_mode==='wholesale'?'wholesale':''),children:item.price_mode==='wholesale'?'WS':'STD'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-unit\",children:item.unit_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[formatCurrency(item.unit_price),\" MGA each\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Quantity:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.01\",value:item.quantity,onChange:e=>handleEditItemQuantity(index,e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price Mode:\"}),/*#__PURE__*/_jsxs(\"select\",{value:item.price_mode,onChange:e=>handleEditItemPriceMode(index,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"standard\",children:\"Standard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"wholesale\",children:\"Wholesale\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-total\",children:[formatCurrency(item.total_price),\" MGA\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-actions\",children:/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"danger\",onClick:()=>removeEditItem(index),children:\"Remove\"})})]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Totals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[formatCurrency(editFormData.subtotal||0),\" MGA\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-item total-final\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"total-label\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"total-value\",children:[formatCurrency(editFormData.total_amount||0),\" MGA\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setShowEditModal(false);setEditingSale(null);setEditFormData({});},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:saveEditedSale,children:\"Save Changes\"})]})]})})]});};export default PendingSales;","map":{"version":3,"names":["React","useState","useEffect","api","Button","formatCurrency","formatDate","jsx","_jsx","jsxs","_jsxs","PendingSales","_selectedSale$payment","_selectedSale$items","_selectedSale$items2","_stockValidationStatu4","_stockValidationStatu5","_stockValidationStatu6","_editFormData$items","_editFormData$items2","pendingSales","setPendingSales","loading","setLoading","showSaleModal","setShowSaleModal","selectedSale","setSelectedSale","showEditModal","setShowEditModal","editingSale","setEditingSale","editFormData","setEditFormData","completingSale","setCompletingSale","stockValidationStatus","setStockValidationStatus","fetchPendingSales","length","validateStockForAllSales","response","get","data","error","_error$response","_error$response$data","console","alert","detail","message","validationStatus","sale","hasInsufficientStock","item","items","concat","product","stockData","available_units","unitData","find","unit","id","available_quantity","quantity_display","completeSale","saleId","s","stockValidationErrors","push","product_name","unit_name","join","post","completedSale","_objectSpread","status","printPendingSale","prev","filter","_error$response2","_error$response2$data","cancelSale","window","confirm","delete","_error$response3","_error$response3$data","_sale$payment_method","_sale$items","printData","statusText","printWindow","open","document","write","sale_number","created_at","customer_name","payment_method","replace","toUpperCase","map","quantity","unit_price","total_price","subtotal","discount_amount","tax_amount","total_amount","close","print","editSale","_sale$items2","customer_phone","customer_email","handleEditItemQuantity","itemIndex","newQuantity","updatedItems","parseFloat","reduce","sum","removeEditItem","_","index","handleEditItemPriceMode","newPriceMode","newUnitPrice","wholesale_price","price","price_mode","_error$response4","_error$response4$data","saveEditedSale","updateData","patch","_error$response5","_error$response5$data","className","children","_sale$items3","_sale$items4","_sale$items5","_stockValidationStatu","_stockValidationStatu2","_stockValidationStatu3","slice","size","variant","onClick","disabled","type","value","onChange","e","target","placeholder","min","step"],"sources":["/home/el-ifran/WareHouse_Manager/beverage_management_system/src/pages/PendingSales.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { api } from '../utils/api';\nimport Button from '../components/Button';\nimport { formatCurrency, formatDate } from '../utils/helpers';\n\nconst PendingSales = () => {\n  const [pendingSales, setPendingSales] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showSaleModal, setShowSaleModal] = useState(false);\n  const [selectedSale, setSelectedSale] = useState(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editingSale, setEditingSale] = useState(null);\n  const [editFormData, setEditFormData] = useState({});\n  const [completingSale, setCompletingSale] = useState(null);\n  const [stockValidationStatus, setStockValidationStatus] = useState({});\n\n  useEffect(() => {\n    fetchPendingSales();\n  }, []);\n\n  useEffect(() => {\n    if (pendingSales.length > 0) {\n      validateStockForAllSales();\n    }\n  }, [pendingSales]);\n\n  const fetchPendingSales = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get('/sales/pending/');\n      setPendingSales(response.data);\n    } catch (error) {\n      console.error('Error fetching pending sales:', error);\n      alert('Error fetching pending sales: ' + (error.response?.data?.detail || error.message));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateStockForAllSales = async () => {\n    const validationStatus = {};\n    \n    for (const sale of pendingSales) {\n      let hasInsufficientStock = false;\n      \n      for (const item of sale.items || []) {\n        try {\n          const response = await api.get(`/products/${item.product}/stock-availability/`);\n          const stockData = response.data;\n          \n          if (stockData.available_units) {\n            const unitData = stockData.available_units.find(unit => unit.id === item.unit);\n            if (unitData && unitData.available_quantity < item.quantity_display) {\n              hasInsufficientStock = true;\n              break;\n            }\n          }\n        } catch (error) {\n          console.error(`Error checking stock for product ${item.product}:`, error);\n        }\n      }\n      \n      validationStatus[sale.id] = { hasInsufficientStock };\n    }\n    \n    setStockValidationStatus(validationStatus);\n  };\n\n  const completeSale = async (saleId) => {\n    try {\n      setCompletingSale(saleId);\n      \n      // Check stock before completing\n      const sale = pendingSales.find(s => s.id === saleId);\n      const stockValidationErrors = [];\n      \n      for (const item of sale.items || []) {\n        try {\n          const response = await api.get(`/products/${item.product}/stock-availability/`);\n          const stockData = response.data;\n          \n          if (stockData.available_units) {\n            const unitData = stockData.available_units.find(unit => unit.id === item.unit);\n            if (unitData && unitData.available_quantity < item.quantity_display) {\n              stockValidationErrors.push(`${item.product_name}: Required ${item.quantity_display} ${item.unit_name}, but only ${unitData.available_quantity} available`);\n            }\n          }\n        } catch (error) {\n          console.error(`Error checking stock for product ${item.product}:`, error);\n          stockValidationErrors.push(`${item.product_name}: Unable to check stock availability`);\n        }\n      }\n      \n      if (stockValidationErrors.length > 0) {\n        alert('Cannot complete sale due to insufficient stock:\\n' + stockValidationErrors.join('\\n'));\n        return;\n      }\n      \n      await api.post(`/sales/${saleId}/complete/`);\n      \n      // Print receipt after successful completion\n      const completedSale = { ...sale, status: 'completed' };\n      printPendingSale(completedSale);\n      \n      // Remove from pending sales list\n      setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n      setShowSaleModal(false);\n      setSelectedSale(null);\n      \n      alert('Sale completed successfully!');\n    } catch (error) {\n      console.error('Error completing sale:', error);\n      alert('Error completing sale: ' + (error.response?.data?.detail || error.message));\n    } finally {\n      setCompletingSale(null);\n    }\n  };\n\n  const cancelSale = async (saleId) => {\n    if (window.confirm('Are you sure you want to cancel this sale?')) {\n      try {\n        await api.delete(`/sales/${saleId}/`);\n        setPendingSales(prev => prev.filter(sale => sale.id !== saleId));\n        setShowSaleModal(false);\n        setSelectedSale(null);\n        alert('Sale cancelled successfully!');\n      } catch (error) {\n        console.error('Error cancelling sale:', error);\n        alert('Error cancelling sale: ' + (error.response?.data?.detail || error.message));\n      }\n    }\n  };\n\n  const printPendingSale = (sale) => {\n    const printData = {\n      ...sale,\n      status: sale.status === 'completed' ? 'completed' : 'pending',\n      statusText: sale.status === 'completed' ? 'This sale has been completed' : 'This sale is pending'\n    };\n    \n    // Create a new window for printing\n    const printWindow = window.open('', '_blank');\n    printWindow.document.write(`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Receipt - ${sale.sale_number}</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            .header { text-align: center; margin-bottom: 20px; }\n            .receipt-info { margin-bottom: 20px; }\n            .items { margin-bottom: 20px; }\n            .item { display: flex; justify-content: space-between; margin-bottom: 5px; }\n            .totals { border-top: 1px solid #000; padding-top: 10px; }\n            .total-row { display: flex; justify-content: space-between; margin-bottom: 5px; }\n            .total-final { font-weight: bold; font-size: 1.2em; }\n            .status { text-align: center; margin-top: 20px; font-weight: bold; }\n          </style>\n        </head>\n        <body>\n          <div class=\"header\">\n            <h1>Beverage Management System</h1>\n            <h2>Receipt - ${sale.sale_number}</h2>\n          </div>\n          \n          <div class=\"receipt-info\">\n            <p><strong>Date:</strong> ${formatDate(sale.created_at)}</p>\n            <p><strong>Customer:</strong> ${sale.customer_name || 'Walk-in Customer'}</p>\n            <p><strong>Payment Method:</strong> ${sale.payment_method?.replace('_', ' ').toUpperCase()}</p>\n          </div>\n          \n          <div class=\"items\">\n            <h3>Items:</h3>\n            ${sale.items?.map(item => `\n              <div class=\"item\">\n                <span>${item.product_name} - ${item.quantity_display || item.quantity} ${item.unit_name} × ${formatCurrency(item.unit_price)} MGA</span>\n                <span>${formatCurrency(item.total_price)} MGA</span>\n              </div>\n            `).join('')}\n          </div>\n          \n          <div class=\"totals\">\n            <div class=\"total-row\">\n              <span>Subtotal:</span>\n              <span>${formatCurrency(sale.subtotal)} MGA</span>\n            </div>\n            ${sale.discount_amount > 0 ? `\n              <div class=\"total-row\">\n                <span>Discount:</span>\n                <span>-${formatCurrency(sale.discount_amount)} MGA</span>\n              </div>\n            ` : ''}\n            ${sale.tax_amount > 0 ? `\n              <div class=\"total-row\">\n                <span>Tax:</span>\n                <span>${formatCurrency(sale.tax_amount)} MGA</span>\n              </div>\n            ` : ''}\n            <div class=\"total-row total-final\">\n              <span>Total:</span>\n              <span>${formatCurrency(sale.total_amount)} MGA</span>\n            </div>\n          </div>\n          \n          <div class=\"status\">\n            <p>${printData.statusText}</p>\n          </div>\n        </body>\n      </html>\n    `);\n    printWindow.document.close();\n    printWindow.print();\n  };\n\n  const editSale = (sale) => {\n    setEditingSale(sale);\n    setEditFormData({\n      customer_name: sale.customer_name || '',\n      customer_phone: sale.customer_phone || '',\n      customer_email: sale.customer_email || '',\n      payment_method: sale.payment_method || 'cash',\n      items: sale.items?.map(item => ({\n        ...item,\n        quantity: item.quantity_display || item.quantity\n      })) || []\n    });\n    setShowEditModal(true);\n    setShowSaleModal(false);\n  };\n\n  const handleEditItemQuantity = (itemIndex, newQuantity) => {\n    const updatedItems = [...editFormData.items];\n    updatedItems[itemIndex].quantity = parseFloat(newQuantity) || 0;\n    updatedItems[itemIndex].total_price = updatedItems[itemIndex].quantity * updatedItems[itemIndex].unit_price;\n    \n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: subtotal + (editFormData.tax_amount || 0) - (editFormData.discount_amount || 0)\n    });\n  };\n\n  const removeEditItem = (itemIndex) => {\n    const updatedItems = editFormData.items.filter((_, index) => index !== itemIndex);\n    const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n    \n    setEditFormData({\n      ...editFormData,\n      items: updatedItems,\n      subtotal: subtotal,\n      total_amount: subtotal + (editFormData.tax_amount || 0) - (editFormData.discount_amount || 0)\n    });\n  };\n\n  const handleEditItemPriceMode = async (itemIndex, newPriceMode) => {\n    try {\n      const item = editFormData.items[itemIndex];\n      const response = await api.get(`/products/${item.product}/`);\n      const product = response.data;\n      \n      let newUnitPrice;\n      if (newPriceMode === 'wholesale') {\n        newUnitPrice = product.wholesale_price || product.price;\n      } else {\n        newUnitPrice = product.price;\n      }\n      \n      const updatedItems = [...editFormData.items];\n      updatedItems[itemIndex].price_mode = newPriceMode;\n      updatedItems[itemIndex].unit_price = newUnitPrice;\n      updatedItems[itemIndex].total_price = updatedItems[itemIndex].quantity * newUnitPrice;\n      \n      const subtotal = updatedItems.reduce((sum, item) => sum + item.total_price, 0);\n      \n      setEditFormData({\n        ...editFormData,\n        items: updatedItems,\n        subtotal: subtotal,\n        total_amount: subtotal + (editFormData.tax_amount || 0) - (editFormData.discount_amount || 0)\n      });\n    } catch (error) {\n      console.error('Error updating price mode:', error);\n      alert('Error updating price mode: ' + (error.response?.data?.detail || error.message));\n    }\n  };\n\n  const saveEditedSale = async () => {\n    try {\n      const updateData = {\n        customer_name: editFormData.customer_name,\n        customer_phone: editFormData.customer_phone,\n        customer_email: editFormData.customer_email,\n        payment_method: editFormData.payment_method,\n        items: editFormData.items.map(item => ({\n          id: item.id,\n          quantity: item.quantity,\n          unit_price: item.unit_price,\n          price_mode: item.price_mode\n        }))\n      };\n      \n      await api.patch(`/sales/${editingSale.id}/`, updateData);\n      \n      setShowEditModal(false);\n      setEditingSale(null);\n      setEditFormData({});\n      \n      // Refresh the pending sales list\n      fetchPendingSales();\n      \n      alert('Sale updated successfully!');\n    } catch (error) {\n      console.error('Error updating sale:', error);\n      alert('Error updating sale: ' + (error.response?.data?.detail || error.message));\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"page\">\n        <div className=\"page-header\">\n          <h1>Pending Sales</h1>\n        </div>\n        <div className=\"loading-message\">Loading pending sales...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"page\">\n      <div className=\"page-header\">\n        <h1>Pending Sales</h1>\n        <p>Manage and validate pending sales before completion</p>\n      </div>\n\n      {pendingSales.length === 0 ? (\n        <div className=\"no-pending-sales\">\n          <div className=\"no-sales-icon\">📋</div>\n          <h3>No Pending Sales</h3>\n          <p>All sales have been completed or there are no pending sales at the moment.</p>\n        </div>\n      ) : (\n        <div className=\"pending-sales-grid\">\n          {pendingSales.map((sale) => (\n            <div key={sale.id} className=\"pending-sale-card\">\n              <div className=\"sale-header\">\n                <div className=\"sale-number\">{sale.sale_number}</div>\n                <div className=\"sale-date\">{formatDate(sale.created_at)}</div>\n              </div>\n              \n              <div className=\"sale-customer\">\n                <strong>{sale.customer_name || 'Walk-in Customer'}</strong>\n              </div>\n              \n              <div className=\"sale-items\">\n                <div className=\"items-count\">{sale.items?.length || 0} items</div>\n                <div className=\"items-preview\">\n                  {sale.items?.slice(0, 3).map((item, index) => (\n                    <div key={index} className=\"item-preview\">\n                      <span className=\"item-name\">{item.product_name}</span>\n                      <span className=\"item-quantity\">{item.quantity_display || item.quantity} {item.unit_name}</span>\n                      <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                        {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                      </span>\n                    </div>\n                  ))}\n                  {sale.items?.length > 3 && (\n                    <div className=\"more-items\">+{sale.items.length - 3} more items</div>\n                  )}\n                </div>\n              </div>\n              \n              <div className=\"sale-total\">\n                <strong>{formatCurrency(sale.total_amount)} MGA</strong>\n              </div>\n              \n              <div className=\"stock-status\">\n                {stockValidationStatus[sale.id]?.hasInsufficientStock ? (\n                  <div className=\"stock-insufficient\">⚠️ Insufficient Stock</div>\n                ) : (\n                  <div className=\"stock-sufficient\">✅ Stock Available</div>\n                )}\n              </div>\n              \n              <div className=\"sale-actions\">\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => {\n                    setSelectedSale(sale);\n                    setShowSaleModal(true);\n                  }}\n                >\n                  View Details\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => printPendingSale(sale)}\n                >\n                  🖨️ Print\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"outline\"\n                  onClick={() => editSale(sale)}\n                >\n                  ✏️ Edit\n                </Button>\n                <Button\n                  size=\"small\"\n                  variant=\"primary\"\n                  disabled={stockValidationStatus[sale.id]?.hasInsufficientStock}\n                  onClick={() => completeSale(sale.id)}\n                  loading={completingSale === sale.id}\n                >\n                  {stockValidationStatus[sale.id]?.hasInsufficientStock ? 'Insufficient Stock' : 'Complete Sale'}\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Sale Details Modal */}\n      {showSaleModal && selectedSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal sale-details-modal\">\n            <div className=\"modal-header\">\n              <h2>Sale Details - {selectedSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"info-section\">\n                <h3>Customer Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Name:</span>\n                    <span className=\"info-value\">{selectedSale.customer_name || 'Walk-in Customer'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Phone:</span>\n                    <span className=\"info-value\">{selectedSale.customer_phone || 'N/A'}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Email:</span>\n                    <span className=\"info-value\">{selectedSale.customer_email || 'N/A'}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Sale Information */}\n              <div className=\"info-section\">\n                <h3>Sale Information</h3>\n                <div className=\"info-grid\">\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Date:</span>\n                    <span className=\"info-value\">{formatDate(selectedSale.created_at)}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Payment Method:</span>\n                    <span className=\"info-value\">{selectedSale.payment_method?.replace('_', ' ').toUpperCase()}</span>\n                  </div>\n                  <div className=\"info-item\">\n                    <span className=\"info-label\">Status:</span>\n                    <span className=\"status-badge pending\">Pending</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Items List */}\n              <div className=\"items-section\">\n                <h3>Items ({selectedSale.items?.length || 0})</h3>\n                <div className=\"items-container\">\n                  {selectedSale.items?.map((item, index) => (\n                    <div key={index} className=\"item-card\">\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-quantity\">\n                          <span className=\"quantity\">{item.quantity_display || item.quantity}</span>\n                          <span className=\"unit\">{item.unit_name}</span>\n                        </div>\n                        <div className=\"item-price\">\n                          <span className=\"unit-price\">{formatCurrency(item.unit_price)} MGA each</span>\n                          <span className=\"total-price\">{formatCurrency(item.total_price)} MGA</span>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.subtotal)} MGA</span>\n                  </div>\n                  {selectedSale.discount_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Discount:</span>\n                      <span className=\"total-value\">-{formatCurrency(selectedSale.discount_amount)} MGA</span>\n                    </div>\n                  )}\n                  {selectedSale.tax_amount > 0 && (\n                    <div className=\"total-item\">\n                      <span className=\"total-label\">Tax:</span>\n                      <span className=\"total-value\">{formatCurrency(selectedSale.tax_amount)} MGA</span>\n                    </div>\n                  )}\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(selectedSale.total_amount)} MGA</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Stock Status */}\n              <div className=\"stock-section\">\n                <h3>Stock Status</h3>\n                <div className=\"stock-status\">\n                  {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? (\n                    <div className=\"stock-insufficient\">\n                      ⚠️ Insufficient Stock\n                    </div>\n                  ) : (\n                    <div className=\"stock-sufficient\">\n                      ✅ Stock Available\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowSaleModal(false);\n                  setSelectedSale(null);\n                }}\n              >\n                Close\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={() => printPendingSale(selectedSale)}\n              >\n                🖨️ Print Receipt\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={() => editSale(selectedSale)}\n              >\n                ✏️ Edit\n              </Button>\n              <Button\n                variant=\"success\"\n                disabled={stockValidationStatus[selectedSale.id]?.hasInsufficientStock}\n                onClick={() => completeSale(selectedSale.id)}\n              >\n                {stockValidationStatus[selectedSale.id]?.hasInsufficientStock ? 'Insufficient Stock' : 'Complete Sale'}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Sale Modal */}\n      {showEditModal && editingSale && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal edit-sale-modal\">\n            <div className=\"modal-header\">\n              <h2>Edit Sale - {editingSale.sale_number}</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              {/* Customer Information */}\n              <div className=\"form-section\">\n                <h3>Customer Information</h3>\n                <div className=\"form-grid\">\n                  <div className=\"form-group\">\n                    <label>Customer Name</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_name || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_name: e.target.value})}\n                      placeholder=\"Customer name\"\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Phone</label>\n                    <input\n                      type=\"text\"\n                      value={editFormData.customer_phone || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_phone: e.target.value})}\n                      placeholder=\"Phone number\"\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Email</label>\n                    <input\n                      type=\"email\"\n                      value={editFormData.customer_email || ''}\n                      onChange={(e) => setEditFormData({...editFormData, customer_email: e.target.value})}\n                      placeholder=\"Email address\"\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label>Payment Method</label>\n                    <select\n                      value={editFormData.payment_method || 'cash'}\n                      onChange={(e) => setEditFormData({...editFormData, payment_method: e.target.value})}\n                    >\n                      <option value=\"cash\">Cash</option>\n                      <option value=\"card\">Card</option>\n                      <option value=\"mobile_money\">Mobile Money</option>\n                      <option value=\"bank_transfer\">Bank Transfer</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n\n              {/* Items */}\n              <div className=\"form-section\">\n                <h3>Items ({editFormData.items?.length || 0})</h3>\n                <div className=\"items-edit-container\">\n                  {editFormData.items?.map((item, index) => (\n                    <div key={index} className=\"edit-item-card\">\n                      <div className=\"item-header\">\n                        <div className=\"item-name\">{item.product_name}</div>\n                        <span className={`price-mode-badge ${item.price_mode === 'wholesale' ? 'wholesale' : ''}`}>\n                          {item.price_mode === 'wholesale' ? 'WS' : 'STD'}\n                        </span>\n                      </div>\n                      <div className=\"item-details\">\n                        <div className=\"item-unit\">{item.unit_name}</div>\n                        <div className=\"item-price\">{formatCurrency(item.unit_price)} MGA each</div>\n                      </div>\n                      <div className=\"item-controls\">\n                        <div className=\"control-group\">\n                          <label>Quantity:</label>\n                          <input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            value={item.quantity}\n                            onChange={(e) => handleEditItemQuantity(index, e.target.value)}\n                          />\n                        </div>\n                        <div className=\"control-group\">\n                          <label>Price Mode:</label>\n                          <select\n                            value={item.price_mode}\n                            onChange={(e) => handleEditItemPriceMode(index, e.target.value)}\n                          >\n                            <option value=\"standard\">Standard</option>\n                            <option value=\"wholesale\">Wholesale</option>\n                          </select>\n                        </div>\n                        <div className=\"item-total\">\n                          {formatCurrency(item.total_price)} MGA\n                        </div>\n                        <div className=\"item-actions\">\n                          <Button\n                            size=\"small\"\n                            variant=\"danger\"\n                            onClick={() => removeEditItem(index)}\n                          >\n                            Remove\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Totals */}\n              <div className=\"totals-section\">\n                <h3>Totals</h3>\n                <div className=\"totals-grid\">\n                  <div className=\"total-item\">\n                    <span className=\"total-label\">Subtotal:</span>\n                    <span className=\"total-value\">{formatCurrency(editFormData.subtotal || 0)} MGA</span>\n                  </div>\n                  <div className=\"total-item total-final\">\n                    <span className=\"total-label\">Total:</span>\n                    <span className=\"total-value\">{formatCurrency(editFormData.total_amount || 0)} MGA</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"modal-footer\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setShowEditModal(false);\n                  setEditingSale(null);\n                  setEditFormData({});\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={saveEditedSale}\n              >\n                Save Changes\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PendingSales;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}